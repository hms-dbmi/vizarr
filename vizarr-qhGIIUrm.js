const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./blosc-CAH7LpMT.js","./chunk-INHXZS53-BwBC_UMW.js","./lz4-CQc_tcCf.js","./zstd-CIO_1wnt.js","./deflate-BTTP7dV-.js","./pako.esm-CpTEATNv.js","./lerc-Dqj69v3t.js"])))=>i.map(i=>d[i]);
var eI=Object.defineProperty;var pb=n=>{throw TypeError(n)};var tI=(n,e,t)=>e in n?eI(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var E=(n,e,t)=>tI(n,typeof e!="symbol"?e+"":e,t),qm=(n,e,t)=>e.has(n)||pb("Cannot "+t);var Te=(n,e,t)=>(qm(n,e,"read from private field"),t?t.call(n):e.get(n)),yt=(n,e,t)=>e.has(n)?pb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),rt=(n,e,t,r)=>(qm(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),Nt=(n,e,t)=>(qm(n,e,"access private method"),t);var Km=(n,e,t,r)=>({set _(s){rt(n,e,s,t)},get _(){return Te(n,e,r)}});function nI(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}function ka(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Zm={exports:{}},Kc={},Qm={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gb;function rI(){if(gb)return ut;gb=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function m(T){return T===null||typeof T!="object"?null:(T=p&&T[p]||T["@@iterator"],typeof T=="function"?T:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,b={};function w(T,N,W){this.props=T,this.context=N,this.refs=b,this.updater=W||v}w.prototype.isReactComponent={},w.prototype.setState=function(T,N){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,N,"setState")},w.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function S(){}S.prototype=w.prototype;function R(T,N,W){this.props=T,this.context=N,this.refs=b,this.updater=W||v}var C=R.prototype=new S;C.constructor=R,x(C,w.prototype),C.isPureReactComponent=!0;var O=Array.isArray,I=Object.prototype.hasOwnProperty,F={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function q(T,N,W){var Z,te={},re=null,ue=null;if(N!=null)for(Z in N.ref!==void 0&&(ue=N.ref),N.key!==void 0&&(re=""+N.key),N)I.call(N,Z)&&!$.hasOwnProperty(Z)&&(te[Z]=N[Z]);var ve=arguments.length-2;if(ve===1)te.children=W;else if(1<ve){for(var be=Array(ve),Pe=0;Pe<ve;Pe++)be[Pe]=arguments[Pe+2];te.children=be}if(T&&T.defaultProps)for(Z in ve=T.defaultProps,ve)te[Z]===void 0&&(te[Z]=ve[Z]);return{$$typeof:n,type:T,key:re,ref:ue,props:te,_owner:F.current}}function K(T,N){return{$$typeof:n,type:T.type,key:N,ref:T.ref,props:T.props,_owner:T._owner}}function le(T){return typeof T=="object"&&T!==null&&T.$$typeof===n}function he(T){var N={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(W){return N[W]})}var pe=/\/+/g;function se(T,N){return typeof T=="object"&&T!==null&&T.key!=null?he(""+T.key):N.toString(36)}function ye(T,N,W,Z,te){var re=typeof T;(re==="undefined"||re==="boolean")&&(T=null);var ue=!1;if(T===null)ue=!0;else switch(re){case"string":case"number":ue=!0;break;case"object":switch(T.$$typeof){case n:case e:ue=!0}}if(ue)return ue=T,te=te(ue),T=Z===""?"."+se(ue,0):Z,O(te)?(W="",T!=null&&(W=T.replace(pe,"$&/")+"/"),ye(te,N,W,"",function(Pe){return Pe})):te!=null&&(le(te)&&(te=K(te,W+(!te.key||ue&&ue.key===te.key?"":(""+te.key).replace(pe,"$&/")+"/")+T)),N.push(te)),1;if(ue=0,Z=Z===""?".":Z+":",O(T))for(var ve=0;ve<T.length;ve++){re=T[ve];var be=Z+se(re,ve);ue+=ye(re,N,W,be,te)}else if(be=m(T),typeof be=="function")for(T=be.call(T),ve=0;!(re=T.next()).done;)re=re.value,be=Z+se(re,ve++),ue+=ye(re,N,W,be,te);else if(re==="object")throw N=String(T),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.");return ue}function Me(T,N,W){if(T==null)return T;var Z=[],te=0;return ye(T,Z,"","",function(re){return N.call(W,re,te++)}),Z}function U(T){if(T._status===-1){var N=T._result;N=N(),N.then(function(W){(T._status===0||T._status===-1)&&(T._status=1,T._result=W)},function(W){(T._status===0||T._status===-1)&&(T._status=2,T._result=W)}),T._status===-1&&(T._status=0,T._result=N)}if(T._status===1)return T._result.default;throw T._result}var H={current:null},D={transition:null},Y={ReactCurrentDispatcher:H,ReactCurrentBatchConfig:D,ReactCurrentOwner:F};function M(){throw Error("act(...) is not supported in production builds of React.")}return ut.Children={map:Me,forEach:function(T,N,W){Me(T,function(){N.apply(this,arguments)},W)},count:function(T){var N=0;return Me(T,function(){N++}),N},toArray:function(T){return Me(T,function(N){return N})||[]},only:function(T){if(!le(T))throw Error("React.Children.only expected to receive a single React element child.");return T}},ut.Component=w,ut.Fragment=t,ut.Profiler=s,ut.PureComponent=R,ut.StrictMode=r,ut.Suspense=u,ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,ut.act=M,ut.cloneElement=function(T,N,W){if(T==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+T+".");var Z=x({},T.props),te=T.key,re=T.ref,ue=T._owner;if(N!=null){if(N.ref!==void 0&&(re=N.ref,ue=F.current),N.key!==void 0&&(te=""+N.key),T.type&&T.type.defaultProps)var ve=T.type.defaultProps;for(be in N)I.call(N,be)&&!$.hasOwnProperty(be)&&(Z[be]=N[be]===void 0&&ve!==void 0?ve[be]:N[be])}var be=arguments.length-2;if(be===1)Z.children=W;else if(1<be){ve=Array(be);for(var Pe=0;Pe<be;Pe++)ve[Pe]=arguments[Pe+2];Z.children=ve}return{$$typeof:n,type:T.type,key:te,ref:re,props:Z,_owner:ue}},ut.createContext=function(T){return T={$$typeof:o,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},T.Provider={$$typeof:i,_context:T},T.Consumer=T},ut.createElement=q,ut.createFactory=function(T){var N=q.bind(null,T);return N.type=T,N},ut.createRef=function(){return{current:null}},ut.forwardRef=function(T){return{$$typeof:a,render:T}},ut.isValidElement=le,ut.lazy=function(T){return{$$typeof:d,_payload:{_status:-1,_result:T},_init:U}},ut.memo=function(T,N){return{$$typeof:f,type:T,compare:N===void 0?null:N}},ut.startTransition=function(T){var N=D.transition;D.transition={};try{T()}finally{D.transition=N}},ut.unstable_act=M,ut.useCallback=function(T,N){return H.current.useCallback(T,N)},ut.useContext=function(T){return H.current.useContext(T)},ut.useDebugValue=function(){},ut.useDeferredValue=function(T){return H.current.useDeferredValue(T)},ut.useEffect=function(T,N){return H.current.useEffect(T,N)},ut.useId=function(){return H.current.useId()},ut.useImperativeHandle=function(T,N,W){return H.current.useImperativeHandle(T,N,W)},ut.useInsertionEffect=function(T,N){return H.current.useInsertionEffect(T,N)},ut.useLayoutEffect=function(T,N){return H.current.useLayoutEffect(T,N)},ut.useMemo=function(T,N){return H.current.useMemo(T,N)},ut.useReducer=function(T,N,W){return H.current.useReducer(T,N,W)},ut.useRef=function(T){return H.current.useRef(T)},ut.useState=function(T){return H.current.useState(T)},ut.useSyncExternalStore=function(T,N,W){return H.current.useSyncExternalStore(T,N,W)},ut.useTransition=function(){return H.current.useTransition()},ut.version="18.3.1",ut}var mb;function d_(){return mb||(mb=1,Qm.exports=rI()),Qm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vb;function sI(){if(vb)return Kc;vb=1;var n=d_(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,f){var d,p={},m=null,v=null;f!==void 0&&(m=""+f),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(v=u.ref);for(d in u)r.call(u,d)&&!i.hasOwnProperty(d)&&(p[d]=u[d]);if(a&&a.defaultProps)for(d in u=a.defaultProps,u)p[d]===void 0&&(p[d]=u[d]);return{$$typeof:e,type:a,key:m,ref:v,props:p,_owner:s.current}}return Kc.Fragment=t,Kc.jsx=o,Kc.jsxs=o,Kc}var yb;function iI(){return yb||(yb=1,Zm.exports=sI()),Zm.exports}var ae=iI(),kh={black:"#000",white:"#fff"},Gm={300:"#e57373",500:"#f44336",700:"#d32f2f"},Jm={A200:"#ff4081",A400:"#f50057",A700:"#c51162"},e0={300:"#7986cb",500:"#3f51b5",700:"#303f9f"},t0={300:"#64b5f6",500:"#2196f3",700:"#1976d2"},n0={300:"#81c784",500:"#4caf50",700:"#388e3c"},r0={300:"#ffb74d",500:"#ff9800",700:"#f57c00"},h_={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#d5d5d5",A200:"#aaaaaa",A400:"#303030",A700:"#616161"};function Ee(){return Ee=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ee.apply(null,arguments)}function Kl(n){"@babel/helpers - typeof";return Kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kl(n)}function s0(n){return n&&Kl(n)==="object"&&n.constructor===Object}function Zl(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{clone:!0},r=t.clone?Ee({},n):n;return s0(n)&&s0(e)&&Object.keys(e).forEach(function(s){s!=="__proto__"&&(s0(e[s])&&s in n?r[s]=Zl(n[s],e[s],t):r[s]=e[s])}),r}function oI(n,e){if(Kl(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Kl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function FS(n){var e=oI(n,"string");return Kl(e)=="symbol"?e:e+""}function i0(n,e,t){return(e=FS(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fu(n){for(var e="https://mui.com/production-error/?code="+n,t=1;t<arguments.length;t+=1)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified Material-UI error #"+n+"; visit "+e+" for the full message."}var o0={exports:{}},Dt={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _b;function aI(){if(_b)return Dt;_b=1;var n=60103,e=60106,t=60107,r=60108,s=60114,i=60109,o=60110,a=60112,u=60113,f=60120,d=60115,p=60116,m=60121,v=60122,x=60117,b=60129,w=60131;if(typeof Symbol=="function"&&Symbol.for){var S=Symbol.for;n=S("react.element"),e=S("react.portal"),t=S("react.fragment"),r=S("react.strict_mode"),s=S("react.profiler"),i=S("react.provider"),o=S("react.context"),a=S("react.forward_ref"),u=S("react.suspense"),f=S("react.suspense_list"),d=S("react.memo"),p=S("react.lazy"),m=S("react.block"),v=S("react.server.block"),x=S("react.fundamental"),b=S("react.debug_trace_mode"),w=S("react.legacy_hidden")}function R(se){if(typeof se=="object"&&se!==null){var ye=se.$$typeof;switch(ye){case n:switch(se=se.type,se){case t:case s:case r:case u:case f:return se;default:switch(se=se&&se.$$typeof,se){case o:case a:case p:case d:case i:return se;default:return ye}}case e:return ye}}}var C=i,O=n,I=a,F=t,$=p,q=d,K=e,le=s,he=r,pe=u;return Dt.ContextConsumer=o,Dt.ContextProvider=C,Dt.Element=O,Dt.ForwardRef=I,Dt.Fragment=F,Dt.Lazy=$,Dt.Memo=q,Dt.Portal=K,Dt.Profiler=le,Dt.StrictMode=he,Dt.Suspense=pe,Dt.isAsyncMode=function(){return!1},Dt.isConcurrentMode=function(){return!1},Dt.isContextConsumer=function(se){return R(se)===o},Dt.isContextProvider=function(se){return R(se)===i},Dt.isElement=function(se){return typeof se=="object"&&se!==null&&se.$$typeof===n},Dt.isForwardRef=function(se){return R(se)===a},Dt.isFragment=function(se){return R(se)===t},Dt.isLazy=function(se){return R(se)===p},Dt.isMemo=function(se){return R(se)===d},Dt.isPortal=function(se){return R(se)===e},Dt.isProfiler=function(se){return R(se)===s},Dt.isStrictMode=function(se){return R(se)===r},Dt.isSuspense=function(se){return R(se)===u},Dt.isValidElementType=function(se){return typeof se=="string"||typeof se=="function"||se===t||se===s||se===b||se===r||se===u||se===f||se===w||typeof se=="object"&&se!==null&&(se.$$typeof===p||se.$$typeof===d||se.$$typeof===i||se.$$typeof===o||se.$$typeof===a||se.$$typeof===x||se.$$typeof===m||se[0]===v)},Dt.typeOf=R,Dt}var xb;function lI(){return xb||(xb=1,o0.exports=aI()),o0.exports}lI();function p_(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.min(Math.max(e,n),t)}function cI(n){n=n.substr(1);var e=new RegExp(".{1,".concat(n.length>=6?2:1,"}"),"g"),t=n.match(e);return t&&t[0].length===1&&(t=t.map(function(r){return r+r})),t?"rgb".concat(t.length===4?"a":"","(").concat(t.map(function(r,s){return s<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3}).join(", "),")"):""}function uI(n){n=ya(n);var e=n,t=e.values,r=t[0],s=t[1]/100,i=t[2]/100,o=s*Math.min(i,1-i),a=function(p){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(p+r/30)%12;return i-o*Math.max(Math.min(m-3,9-m,1),-1)},u="rgb",f=[Math.round(a(0)*255),Math.round(a(8)*255),Math.round(a(4)*255)];return n.type==="hsla"&&(u+="a",f.push(t[3])),jp({type:u,values:f})}function ya(n){if(n.type)return n;if(n.charAt(0)==="#")return ya(cI(n));var e=n.indexOf("("),t=n.substring(0,e);if(["rgb","rgba","hsl","hsla"].indexOf(t)===-1)throw new Error(Fu(3,n));var r=n.substring(e+1,n.length-1).split(",");return r=r.map(function(s){return parseFloat(s)}),{type:t,values:r}}function jp(n){var e=n.type,t=n.values;return e.indexOf("rgb")!==-1?t=t.map(function(r,s){return s<3?parseInt(r,10):r}):e.indexOf("hsl")!==-1&&(t[1]="".concat(t[1],"%"),t[2]="".concat(t[2],"%")),"".concat(e,"(").concat(t.join(", "),")")}function fI(n,e){var t=bb(n),r=bb(e);return(Math.max(t,r)+.05)/(Math.min(t,r)+.05)}function bb(n){n=ya(n);var e=n.type==="hsl"?ya(uI(n)).values:n.values;return e=e.map(function(t){return t/=255,t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function fo(n,e){return n=ya(n),e=p_(e),(n.type==="rgb"||n.type==="hsl")&&(n.type+="a"),n.values[3]=e,jp(n)}function BS(n,e){if(n=ya(n),e=p_(e),n.type.indexOf("hsl")!==-1)n.values[2]*=1-e;else if(n.type.indexOf("rgb")!==-1)for(var t=0;t<3;t+=1)n.values[t]*=1-e;return jp(n)}function US(n,e){if(n=ya(n),e=p_(e),n.type.indexOf("hsl")!==-1)n.values[2]+=(100-n.values[2])*e;else if(n.type.indexOf("rgb")!==-1)for(var t=0;t<3;t+=1)n.values[t]+=(255-n.values[t])*e;return jp(n)}function Wp(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function Ct(n,e){if(n==null)return{};var t,r,s=Wp(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(r=0;r<i.length;r++)t=i[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(n,t)&&(s[t]=n[t])}return s}var Gi=["xs","sm","md","lg","xl"];function dI(n){var e=n.values,t=e===void 0?{xs:0,sm:600,md:960,lg:1280,xl:1920}:e,r=n.unit,s=r===void 0?"px":r,i=n.step,o=i===void 0?5:i,a=Ct(n,["values","unit","step"]);function u(v){var x=typeof t[v]=="number"?t[v]:v;return"@media (min-width:".concat(x).concat(s,")")}function f(v){var x=Gi.indexOf(v)+1,b=t[Gi[x]];if(x===Gi.length)return u("xs");var w=typeof b=="number"&&x>0?b:v;return"@media (max-width:".concat(w-o/100).concat(s,")")}function d(v,x){var b=Gi.indexOf(x);return b===Gi.length-1?u(v):"@media (min-width:".concat(typeof t[v]=="number"?t[v]:v).concat(s,") and ")+"(max-width:".concat((b!==-1&&typeof t[Gi[b+1]]=="number"?t[Gi[b+1]]:x)-o/100).concat(s,")")}function p(v){return d(v,v)}function m(v){return t[v]}return Ee({keys:Gi,values:t,up:u,down:f,between:d,only:p,width:m},a)}function hI(n,e,t){var r;return Ee({gutters:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return console.warn(["Material-UI: theme.mixins.gutters() is deprecated.","You can use the source of the mixin directly:",`
      paddingLeft: theme.spacing(2),
      paddingRight: theme.spacing(2),
      [theme.breakpoints.up('sm')]: {
        paddingLeft: theme.spacing(3),
        paddingRight: theme.spacing(3),
      },
      `].join(`
`)),Ee({paddingLeft:e(2),paddingRight:e(2)},i,i0({},n.up("sm"),Ee({paddingLeft:e(3),paddingRight:e(3)},i[n.up("sm")])))},toolbar:(r={minHeight:56},i0(r,"".concat(n.up("xs")," and (orientation: landscape)"),{minHeight:48}),i0(r,n.up("sm"),{minHeight:64}),r)},t)}var wb={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:kh.white,default:h_[50]},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},a0={text:{primary:kh.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",hint:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:h_[800],default:"#303030"},action:{active:kh.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function Tb(n,e,t,r){var s=r.light||r,i=r.dark||r*1.5;n[e]||(n.hasOwnProperty(t)?n[e]=n[t]:e==="light"?n.light=US(n.main,s):e==="dark"&&(n.dark=BS(n.main,i)))}function pI(n){var e=n.primary,t=e===void 0?{light:e0[300],main:e0[500],dark:e0[700]}:e,r=n.secondary,s=r===void 0?{light:Jm.A200,main:Jm.A400,dark:Jm.A700}:r,i=n.error,o=i===void 0?{light:Gm[300],main:Gm[500],dark:Gm[700]}:i,a=n.warning,u=a===void 0?{light:r0[300],main:r0[500],dark:r0[700]}:a,f=n.info,d=f===void 0?{light:t0[300],main:t0[500],dark:t0[700]}:f,p=n.success,m=p===void 0?{light:n0[300],main:n0[500],dark:n0[700]}:p,v=n.type,x=v===void 0?"light":v,b=n.contrastThreshold,w=b===void 0?3:b,S=n.tonalOffset,R=S===void 0?.2:S,C=Ct(n,["primary","secondary","error","warning","info","success","type","contrastThreshold","tonalOffset"]);function O(q){var K=fI(q,a0.text.primary)>=w?a0.text.primary:wb.text.primary;return K}var I=function(K){var le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:500,he=arguments.length>2&&arguments[2]!==void 0?arguments[2]:300,pe=arguments.length>3&&arguments[3]!==void 0?arguments[3]:700;if(K=Ee({},K),!K.main&&K[le]&&(K.main=K[le]),!K.main)throw new Error(Fu(4,le));if(typeof K.main!="string")throw new Error(Fu(5,JSON.stringify(K.main)));return Tb(K,"light",he,R),Tb(K,"dark",pe,R),K.contrastText||(K.contrastText=O(K.main)),K},F={dark:a0,light:wb},$=Zl(Ee({common:kh,type:x,primary:I(t),secondary:I(s,"A400","A200","A700"),error:I(o),warning:I(u),info:I(d),success:I(m),grey:h_,contrastThreshold:w,getContrastText:O,augmentColor:I,tonalOffset:R},F[x]),C);return $}function VS(n){return Math.round(n*1e5)/1e5}function gI(n){return VS(n)}var Sb={textTransform:"uppercase"},Eb='"Roboto", "Helvetica", "Arial", sans-serif';function mI(n,e){var t=typeof e=="function"?e(n):e,r=t.fontFamily,s=r===void 0?Eb:r,i=t.fontSize,o=i===void 0?14:i,a=t.fontWeightLight,u=a===void 0?300:a,f=t.fontWeightRegular,d=f===void 0?400:f,p=t.fontWeightMedium,m=p===void 0?500:p,v=t.fontWeightBold,x=v===void 0?700:v,b=t.htmlFontSize,w=b===void 0?16:b,S=t.allVariants,R=t.pxToRem,C=Ct(t,["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"]),O=o/14,I=R||function(q){return"".concat(q/w*O,"rem")},F=function(K,le,he,pe,se){return Ee({fontFamily:s,fontWeight:K,fontSize:I(le),lineHeight:he},s===Eb?{letterSpacing:"".concat(VS(pe/le),"em")}:{},se,S)},$={h1:F(u,96,1.167,-1.5),h2:F(u,60,1.2,-.5),h3:F(d,48,1.167,0),h4:F(d,34,1.235,.25),h5:F(d,24,1.334,0),h6:F(m,20,1.6,.15),subtitle1:F(d,16,1.75,.15),subtitle2:F(m,14,1.57,.1),body1:F(d,16,1.5,.15),body2:F(d,14,1.43,.15),button:F(m,14,1.75,.4,Sb),caption:F(d,12,1.66,.4),overline:F(d,12,2.66,1,Sb)};return Zl(Ee({htmlFontSize:w,pxToRem:I,round:gI,fontFamily:s,fontSize:o,fontWeightLight:u,fontWeightRegular:d,fontWeightMedium:m,fontWeightBold:x},$),C,{clone:!1})}var vI=.2,yI=.14,_I=.12;function Jt(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(vI,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(yI,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(_I,")")].join(",")}var xI=["none",Jt(0,2,1,-1,0,1,1,0,0,1,3,0),Jt(0,3,1,-2,0,2,2,0,0,1,5,0),Jt(0,3,3,-2,0,3,4,0,0,1,8,0),Jt(0,2,4,-1,0,4,5,0,0,1,10,0),Jt(0,3,5,-1,0,5,8,0,0,1,14,0),Jt(0,3,5,-1,0,6,10,0,0,1,18,0),Jt(0,4,5,-2,0,7,10,1,0,2,16,1),Jt(0,5,5,-3,0,8,10,1,0,3,14,2),Jt(0,5,6,-3,0,9,12,1,0,3,16,2),Jt(0,6,6,-3,0,10,14,1,0,4,18,3),Jt(0,6,7,-4,0,11,15,1,0,4,20,3),Jt(0,7,8,-4,0,12,17,2,0,5,22,4),Jt(0,7,8,-4,0,13,19,2,0,5,24,4),Jt(0,7,9,-4,0,14,21,2,0,5,26,4),Jt(0,8,9,-5,0,15,22,2,0,6,28,5),Jt(0,8,10,-5,0,16,24,2,0,6,30,5),Jt(0,8,11,-5,0,17,26,2,0,6,32,5),Jt(0,9,11,-5,0,18,28,2,0,7,34,6),Jt(0,9,12,-6,0,19,29,2,0,7,36,6),Jt(0,10,13,-6,0,20,31,3,0,8,38,7),Jt(0,10,13,-6,0,21,33,3,0,8,40,7),Jt(0,10,14,-6,0,22,35,3,0,8,42,7),Jt(0,11,14,-7,0,23,36,3,0,9,44,8),Jt(0,11,15,-7,0,24,38,3,0,9,46,8)],bI={borderRadius:4};function Tv(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function wI(n){if(Array.isArray(n))return Tv(n)}function zS(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function g_(n,e){if(n){if(typeof n=="string")return Tv(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Tv(n,e):void 0}}function TI(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hp(n){return wI(n)||zS(n)||g_(n)||TI()}function $S(n){if(Array.isArray(n))return n}function SI(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,s,i,o,a=[],u=!0,f=!1;try{if(i=(t=t.call(n)).next,e!==0)for(;!(u=(r=i.call(t)).done)&&(a.push(r.value),a.length!==e);u=!0);}catch(d){f=!0,s=d}finally{try{if(!u&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw s}}return a}}function jS(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xp(n,e){return $S(n)||SI(n,e)||g_(n,e)||jS()}function EI(n){var e=n.spacing||8;return typeof e=="number"?function(t){return e*t}:Array.isArray(e)?function(t){return e[t]}:typeof e=="function"?e:function(){}}function AI(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:8;if(n.mui)return n;var e=EI({spacing:n}),t=function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return i.length===0?e(1):i.length===1?e(i[0]):i.map(function(a){if(typeof a=="string")return a;var u=e(a);return typeof u=="number"?"".concat(u,"px"):u}).join(" ")};return Object.defineProperty(t,"unit",{get:function(){return n}}),t.mui=!0,t}var Ab={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Sv={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Cb(n){return"".concat(Math.round(n),"ms")}const CI={easing:Ab,duration:Sv,create:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["all"],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.duration,s=r===void 0?Sv.standard:r,i=t.easing,o=i===void 0?Ab.easeInOut:i,a=t.delay,u=a===void 0?0:a;return Ct(t,["duration","easing","delay"]),(Array.isArray(e)?e:[e]).map(function(f){return"".concat(f," ").concat(typeof s=="string"?s:Cb(s)," ").concat(o," ").concat(typeof u=="string"?u:Cb(u))}).join(",")},getAutoHeightDuration:function(e){if(!e)return 0;var t=e/36;return Math.round((4+15*Math.pow(t,.25)+t/5)*10)}};var WS={mobileStepper:1e3,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function HS(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.breakpoints,t=e===void 0?{}:e,r=n.mixins,s=r===void 0?{}:r,i=n.palette,o=i===void 0?{}:i,a=n.spacing,u=n.typography,f=u===void 0?{}:u,d=Ct(n,["breakpoints","mixins","palette","spacing","typography"]),p=pI(o),m=dI(t),v=AI(a),x=Zl({breakpoints:m,direction:"ltr",mixins:hI(m,v,s),overrides:{},palette:p,props:{},shadows:xI,typography:mI(p,f),spacing:v,shape:bI,transitions:CI,zIndex:WS},d),b=arguments.length,w=new Array(b>1?b-1:0),S=1;S<b;S++)w[S-1]=arguments[S];return x=w.reduce(function(R,C){return Zl(R,C)},x),x}var RI=typeof Symbol=="function"&&Symbol.for;const XS=RI?Symbol.for("mui.nested"):"__THEME_NESTED__";var PI=["checked","disabled","error","focused","focusVisible","required","expanded","selected"];function II(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.disableGlobal,t=e===void 0?!1:e,r=n.productionPrefix,s=r===void 0?"jss":r,i=n.seed,o=i===void 0?"":i,a=o===""?"":"".concat(o,"-"),u=0,f=function(){return u+=1,u};return function(d,p){var m=p.options.name;if(m&&m.indexOf("Mui")===0&&!p.options.link&&!t){if(PI.indexOf(d.key)!==-1)return"Mui-".concat(d.key);var v="".concat(a).concat(m,"-").concat(d.key);return!p.options.theme[XS]||o!==""?v:"".concat(v,"-").concat(f())}return"".concat(a).concat(s).concat(f())}}function YS(n){var e=n.theme,t=n.name,r=n.props;if(!e||!e.props||!e.props[t])return r;var s=e.props[t],i;for(i in s)r[i]===void 0&&(r[i]=s[i]);return r}var Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},pf=(typeof window>"u"?"undefined":Rb(window))==="object"&&(typeof document>"u"?"undefined":Rb(document))==="object"&&document.nodeType===9;function kI(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,FS(r.key),r)}}function m_(n,e,t){return e&&kI(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function Ev(n,e){return Ev=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Ev(n,e)}function Yp(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Ev(n,e)}function Av(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}var MI={}.constructor;function Cv(n){if(n==null||typeof n!="object")return n;if(Array.isArray(n))return n.map(Cv);if(n.constructor!==MI)return n;var e={};for(var t in n)e[t]=Cv(n[t]);return e}function v_(n,e,t){n===void 0&&(n="unnamed");var r=t.jss,s=Cv(e),i=r.plugins.onCreateRule(n,s,t);return i||(n[0],null)}var Pb=function(e,t){for(var r="",s=0;s<e.length&&e[s]!=="!important";s++)r&&(r+=t),r+=e[s];return r},fa=function(e){if(!Array.isArray(e))return e;var t="";if(Array.isArray(e[0]))for(var r=0;r<e.length&&e[r]!=="!important";r++)t&&(t+=", "),t+=Pb(e[r]," ");else t=Pb(e,", ");return e[e.length-1]==="!important"&&(t+=" !important"),t};function uc(n){return n&&n.format===!1?{linebreak:"",space:""}:{linebreak:`
`,space:" "}}function Zc(n,e){for(var t="",r=0;r<e;r++)t+="  ";return t+n}function Bu(n,e,t){t===void 0&&(t={});var r="";if(!e)return r;var s=t,i=s.indent,o=i===void 0?0:i,a=e.fallbacks;t.format===!1&&(o=-1/0);var u=uc(t),f=u.linebreak,d=u.space;if(n&&o++,a)if(Array.isArray(a))for(var p=0;p<a.length;p++){var m=a[p];for(var v in m){var x=m[v];x!=null&&(r&&(r+=f),r+=Zc(v+":"+d+fa(x)+";",o))}}else for(var b in a){var w=a[b];w!=null&&(r&&(r+=f),r+=Zc(b+":"+d+fa(w)+";",o))}for(var S in e){var R=e[S];R!=null&&S!=="fallbacks"&&(r&&(r+=f),r+=Zc(S+":"+d+fa(R)+";",o))}return!r&&!t.allowEmpty||!n?r:(o--,r&&(r=""+f+r+f),Zc(""+n+d+"{"+r,o)+Zc("}",o))}var OI=/([[\].#*$><+~=|^:(),"'`\s])/g,Ib=typeof CSS<"u"&&CSS.escape,y_=function(n){return Ib?Ib(n):n.replace(OI,"\\$1")},qS=function(){function n(t,r,s){this.type="style",this.isProcessed=!1;var i=s.sheet,o=s.Renderer;this.key=t,this.options=s,this.style=r,i?this.renderer=i.renderer:o&&(this.renderer=new o)}var e=n.prototype;return e.prop=function(r,s,i){if(s===void 0)return this.style[r];var o=i?i.force:!1;if(!o&&this.style[r]===s)return this;var a=s;(!i||i.process!==!1)&&(a=this.options.jss.plugins.onChangeValue(s,r,this));var u=a==null||a===!1,f=r in this.style;if(u&&!f&&!o)return this;var d=u&&f;if(d?delete this.style[r]:this.style[r]=a,this.renderable&&this.renderer)return d?this.renderer.removeProperty(this.renderable,r):this.renderer.setProperty(this.renderable,r,a),this;var p=this.options.sheet;return p&&p.attached,this},n}(),Rv=function(n){Yp(e,n);function e(r,s,i){var o;o=n.call(this,r,s,i)||this;var a=i.selector,u=i.scoped,f=i.sheet,d=i.generateId;return a?o.selectorText=a:u!==!1&&(o.id=d(Av(Av(o)),f),o.selectorText="."+y_(o.id)),o}var t=e.prototype;return t.applyTo=function(s){var i=this.renderer;if(i){var o=this.toJSON();for(var a in o)i.setProperty(s,a,o[a])}return this},t.toJSON=function(){var s={};for(var i in this.style){var o=this.style[i];typeof o!="object"?s[i]=o:Array.isArray(o)&&(s[i]=fa(o))}return s},t.toString=function(s){var i=this.options.sheet,o=i?i.options.link:!1,a=o?Ee({},s,{allowEmpty:!0}):s;return Bu(this.selectorText,this.style,a)},m_(e,[{key:"selector",set:function(s){if(s!==this.selectorText){this.selectorText=s;var i=this.renderer,o=this.renderable;if(!(!o||!i)){var a=i.setSelector(o,s);a||i.replaceRule(o,this)}}},get:function(){return this.selectorText}}]),e}(qS),NI={onCreateRule:function(e,t,r){return e[0]==="@"||r.parent&&r.parent.type==="keyframes"?null:new Rv(e,t,r)}},l0={indent:1,children:!0},DI=/@([\w-]+)/,LI=function(){function n(t,r,s){this.type="conditional",this.isProcessed=!1,this.key=t;var i=t.match(DI);this.at=i?i[1]:"unknown",this.query=s.name||"@"+this.at,this.options=s,this.rules=new qp(Ee({},s,{parent:this}));for(var o in r)this.rules.add(o,r[o]);this.rules.process()}var e=n.prototype;return e.getRule=function(r){return this.rules.get(r)},e.indexOf=function(r){return this.rules.indexOf(r)},e.addRule=function(r,s,i){var o=this.rules.add(r,s,i);return o?(this.options.jss.plugins.onProcessRule(o),o):null},e.replaceRule=function(r,s,i){var o=this.rules.replace(r,s,i);return o&&this.options.jss.plugins.onProcessRule(o),o},e.toString=function(r){r===void 0&&(r=l0);var s=uc(r),i=s.linebreak;if(r.indent==null&&(r.indent=l0.indent),r.children==null&&(r.children=l0.children),r.children===!1)return this.query+" {}";var o=this.rules.toString(r);return o?this.query+" {"+i+o+i+"}":""},n}(),FI=/@container|@media|@supports\s+/,BI={onCreateRule:function(e,t,r){return FI.test(e)?new LI(e,t,r):null}},c0={indent:1,children:!0},UI=/@keyframes\s+([\w-]+)/,Pv=function(){function n(t,r,s){this.type="keyframes",this.at="@keyframes",this.isProcessed=!1;var i=t.match(UI);i&&i[1]?this.name=i[1]:this.name="noname",this.key=this.type+"-"+this.name,this.options=s;var o=s.scoped,a=s.sheet,u=s.generateId;this.id=o===!1?this.name:y_(u(this,a)),this.rules=new qp(Ee({},s,{parent:this}));for(var f in r)this.rules.add(f,r[f],Ee({},s,{parent:this}));this.rules.process()}var e=n.prototype;return e.toString=function(r){r===void 0&&(r=c0);var s=uc(r),i=s.linebreak;if(r.indent==null&&(r.indent=c0.indent),r.children==null&&(r.children=c0.children),r.children===!1)return this.at+" "+this.id+" {}";var o=this.rules.toString(r);return o&&(o=""+i+o+i),this.at+" "+this.id+" {"+o+"}"},n}(),VI=/@keyframes\s+/,zI=/\$([\w-]+)/g,Iv=function(e,t){return typeof e=="string"?e.replace(zI,function(r,s){return s in t?t[s]:r}):e},kb=function(e,t,r){var s=e[t],i=Iv(s,r);i!==s&&(e[t]=i)},$I={onCreateRule:function(e,t,r){return typeof e=="string"&&VI.test(e)?new Pv(e,t,r):null},onProcessStyle:function(e,t,r){return t.type!=="style"||!r||("animation-name"in e&&kb(e,"animation-name",r.keyframes),"animation"in e&&kb(e,"animation",r.keyframes)),e},onChangeValue:function(e,t,r){var s=r.options.sheet;if(!s)return e;switch(t){case"animation":return Iv(e,s.keyframes);case"animation-name":return Iv(e,s.keyframes);default:return e}}},jI=function(n){Yp(e,n);function e(){return n.apply(this,arguments)||this}var t=e.prototype;return t.toString=function(s){var i=this.options.sheet,o=i?i.options.link:!1,a=o?Ee({},s,{allowEmpty:!0}):s;return Bu(this.key,this.style,a)},e}(qS),WI={onCreateRule:function(e,t,r){return r.parent&&r.parent.type==="keyframes"?new jI(e,t,r):null}},HI=function(){function n(t,r,s){this.type="font-face",this.at="@font-face",this.isProcessed=!1,this.key=t,this.style=r,this.options=s}var e=n.prototype;return e.toString=function(r){var s=uc(r),i=s.linebreak;if(Array.isArray(this.style)){for(var o="",a=0;a<this.style.length;a++)o+=Bu(this.at,this.style[a]),this.style[a+1]&&(o+=i);return o}return Bu(this.at,this.style,r)},n}(),XI=/@font-face/,YI={onCreateRule:function(e,t,r){return XI.test(e)?new HI(e,t,r):null}},qI=function(){function n(t,r,s){this.type="viewport",this.at="@viewport",this.isProcessed=!1,this.key=t,this.style=r,this.options=s}var e=n.prototype;return e.toString=function(r){return Bu(this.key,this.style,r)},n}(),KI={onCreateRule:function(e,t,r){return e==="@viewport"||e==="@-ms-viewport"?new qI(e,t,r):null}},ZI=function(){function n(t,r,s){this.type="simple",this.isProcessed=!1,this.key=t,this.value=r,this.options=s}var e=n.prototype;return e.toString=function(r){if(Array.isArray(this.value)){for(var s="",i=0;i<this.value.length;i++)s+=this.key+" "+this.value[i]+";",this.value[i+1]&&(s+=`
`);return s}return this.key+" "+this.value+";"},n}(),QI={"@charset":!0,"@import":!0,"@namespace":!0},GI={onCreateRule:function(e,t,r){return e in QI?new ZI(e,t,r):null}},Mb=[NI,BI,$I,WI,YI,KI,GI],JI={process:!0},Ob={force:!0,process:!0},qp=function(){function n(t){this.map={},this.raw={},this.index=[],this.counter=0,this.options=t,this.classes=t.classes,this.keyframes=t.keyframes}var e=n.prototype;return e.add=function(r,s,i){var o=this.options,a=o.parent,u=o.sheet,f=o.jss,d=o.Renderer,p=o.generateId,m=o.scoped,v=Ee({classes:this.classes,parent:a,sheet:u,jss:f,Renderer:d,generateId:p,scoped:m,name:r,keyframes:this.keyframes,selector:void 0},i),x=r;r in this.raw&&(x=r+"-d"+this.counter++),this.raw[x]=s,x in this.classes&&(v.selector="."+y_(this.classes[x]));var b=v_(x,s,v);if(!b)return null;this.register(b);var w=v.index===void 0?this.index.length:v.index;return this.index.splice(w,0,b),b},e.replace=function(r,s,i){var o=this.get(r),a=this.index.indexOf(o);o&&this.remove(o);var u=i;return a!==-1&&(u=Ee({},i,{index:a})),this.add(r,s,u)},e.get=function(r){return this.map[r]},e.remove=function(r){this.unregister(r),delete this.raw[r.key],this.index.splice(this.index.indexOf(r),1)},e.indexOf=function(r){return this.index.indexOf(r)},e.process=function(){var r=this.options.jss.plugins;this.index.slice(0).forEach(r.onProcessRule,r)},e.register=function(r){this.map[r.key]=r,r instanceof Rv?(this.map[r.selector]=r,r.id&&(this.classes[r.key]=r.id)):r instanceof Pv&&this.keyframes&&(this.keyframes[r.name]=r.id)},e.unregister=function(r){delete this.map[r.key],r instanceof Rv?(delete this.map[r.selector],delete this.classes[r.key]):r instanceof Pv&&delete this.keyframes[r.name]},e.update=function(){var r,s,i;if(typeof(arguments.length<=0?void 0:arguments[0])=="string"?(r=arguments.length<=0?void 0:arguments[0],s=arguments.length<=1?void 0:arguments[1],i=arguments.length<=2?void 0:arguments[2]):(s=arguments.length<=0?void 0:arguments[0],i=arguments.length<=1?void 0:arguments[1],r=null),r)this.updateOne(this.get(r),s,i);else for(var o=0;o<this.index.length;o++)this.updateOne(this.index[o],s,i)},e.updateOne=function(r,s,i){i===void 0&&(i=JI);var o=this.options,a=o.jss.plugins,u=o.sheet;if(r.rules instanceof n){r.rules.update(s,i);return}var f=r.style;if(a.onUpdate(s,r,u,i),i.process&&f&&f!==r.style){a.onProcessStyle(r.style,r,u);for(var d in r.style){var p=r.style[d],m=f[d];p!==m&&r.prop(d,p,Ob)}for(var v in f){var x=r.style[v],b=f[v];x==null&&x!==b&&r.prop(v,null,Ob)}}},e.toString=function(r){for(var s="",i=this.options.sheet,o=i?i.options.link:!1,a=uc(r),u=a.linebreak,f=0;f<this.index.length;f++){var d=this.index[f],p=d.toString(r);!p&&!o||(s&&(s+=u),s+=p)}return s},n}(),KS=function(){function n(t,r){this.attached=!1,this.deployed=!1,this.classes={},this.keyframes={},this.options=Ee({},r,{sheet:this,parent:this,classes:this.classes,keyframes:this.keyframes}),r.Renderer&&(this.renderer=new r.Renderer(this)),this.rules=new qp(this.options);for(var s in t)this.rules.add(s,t[s]);this.rules.process()}var e=n.prototype;return e.attach=function(){return this.attached?this:(this.renderer&&this.renderer.attach(),this.attached=!0,this.deployed||this.deploy(),this)},e.detach=function(){return this.attached?(this.renderer&&this.renderer.detach(),this.attached=!1,this):this},e.addRule=function(r,s,i){var o=this.queue;this.attached&&!o&&(this.queue=[]);var a=this.rules.add(r,s,i);return a?(this.options.jss.plugins.onProcessRule(a),this.attached?(this.deployed&&(o?o.push(a):(this.insertRule(a),this.queue&&(this.queue.forEach(this.insertRule,this),this.queue=void 0))),a):(this.deployed=!1,a)):null},e.replaceRule=function(r,s,i){var o=this.rules.get(r);if(!o)return this.addRule(r,s,i);var a=this.rules.replace(r,s,i);return a&&this.options.jss.plugins.onProcessRule(a),this.attached?(this.deployed&&this.renderer&&(a?o.renderable&&this.renderer.replaceRule(o.renderable,a):this.renderer.deleteRule(o)),a):(this.deployed=!1,a)},e.insertRule=function(r){this.renderer&&this.renderer.insertRule(r)},e.addRules=function(r,s){var i=[];for(var o in r){var a=this.addRule(o,r[o],s);a&&i.push(a)}return i},e.getRule=function(r){return this.rules.get(r)},e.deleteRule=function(r){var s=typeof r=="object"?r:this.rules.get(r);return!s||this.attached&&!s.renderable?!1:(this.rules.remove(s),this.attached&&s.renderable&&this.renderer?this.renderer.deleteRule(s.renderable):!0)},e.indexOf=function(r){return this.rules.indexOf(r)},e.deploy=function(){return this.renderer&&this.renderer.deploy(),this.deployed=!0,this},e.update=function(){var r;return(r=this.rules).update.apply(r,arguments),this},e.updateOne=function(r,s,i){return this.rules.updateOne(r,s,i),this},e.toString=function(r){return this.rules.toString(r)},n}(),e6=function(){function n(){this.plugins={internal:[],external:[]},this.registry={}}var e=n.prototype;return e.onCreateRule=function(r,s,i){for(var o=0;o<this.registry.onCreateRule.length;o++){var a=this.registry.onCreateRule[o](r,s,i);if(a)return a}return null},e.onProcessRule=function(r){if(!r.isProcessed){for(var s=r.options.sheet,i=0;i<this.registry.onProcessRule.length;i++)this.registry.onProcessRule[i](r,s);r.style&&this.onProcessStyle(r.style,r,s),r.isProcessed=!0}},e.onProcessStyle=function(r,s,i){for(var o=0;o<this.registry.onProcessStyle.length;o++)s.style=this.registry.onProcessStyle[o](s.style,s,i)},e.onProcessSheet=function(r){for(var s=0;s<this.registry.onProcessSheet.length;s++)this.registry.onProcessSheet[s](r)},e.onUpdate=function(r,s,i,o){for(var a=0;a<this.registry.onUpdate.length;a++)this.registry.onUpdate[a](r,s,i,o)},e.onChangeValue=function(r,s,i){for(var o=r,a=0;a<this.registry.onChangeValue.length;a++)o=this.registry.onChangeValue[a](o,s,i);return o},e.use=function(r,s){s===void 0&&(s={queue:"external"});var i=this.plugins[s.queue];i.indexOf(r)===-1&&(i.push(r),this.registry=[].concat(this.plugins.external,this.plugins.internal).reduce(function(o,a){for(var u in a)u in o&&o[u].push(a[u]);return o},{onCreateRule:[],onProcessRule:[],onProcessStyle:[],onProcessSheet:[],onChangeValue:[],onUpdate:[]}))},n}(),t6=function(){function n(){this.registry=[]}var e=n.prototype;return e.add=function(r){var s=this.registry,i=r.options.index;if(s.indexOf(r)===-1){if(s.length===0||i>=this.index){s.push(r);return}for(var o=0;o<s.length;o++)if(s[o].options.index>i){s.splice(o,0,r);return}}},e.reset=function(){this.registry=[]},e.remove=function(r){var s=this.registry.indexOf(r);this.registry.splice(s,1)},e.toString=function(r){for(var s=r===void 0?{}:r,i=s.attached,o=Wp(s,["attached"]),a=uc(o),u=a.linebreak,f="",d=0;d<this.registry.length;d++){var p=this.registry[d];i!=null&&p.attached!==i||(f&&(f+=u),f+=p.toString(o))}return f},m_(n,[{key:"index",get:function(){return this.registry.length===0?0:this.registry[this.registry.length-1].options.index}}]),n}(),bu=new t6,kv=typeof globalThis<"u"?globalThis:typeof window<"u"&&window.Math===Math?window:typeof self<"u"&&self.Math===Math?self:Function("return this")(),Mv="2f1acc6c3a606b082e5eef5e54414ffb";kv[Mv]==null&&(kv[Mv]=0);var Nb=kv[Mv]++,Db=function(e){e===void 0&&(e={});var t=0,r=function(i,o){t+=1;var a="",u="";return o&&(o.options.classNamePrefix&&(u=o.options.classNamePrefix),o.options.jss.id!=null&&(a=String(o.options.jss.id))),e.minify?""+(u||"c")+Nb+a+t:u+i.key+"-"+Nb+(a?"-"+a:"")+"-"+t};return r},ZS=function(e){var t;return function(){return t||(t=e()),t}},n6=function(e,t){try{return e.attributeStyleMap?e.attributeStyleMap.get(t):e.style.getPropertyValue(t)}catch{return""}},r6=function(e,t,r){try{var s=r;if(Array.isArray(r)&&(s=fa(r)),e.attributeStyleMap)e.attributeStyleMap.set(t,s);else{var i=s?s.indexOf("!important"):-1,o=i>-1?s.substr(0,i-1):s;e.style.setProperty(t,o,i>-1?"important":"")}}catch{return!1}return!0},s6=function(e,t){try{e.attributeStyleMap?e.attributeStyleMap.delete(t):e.style.removeProperty(t)}catch{}},i6=function(e,t){return e.selectorText=t,e.selectorText===t},QS=ZS(function(){return document.querySelector("head")});function o6(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.attached&&r.options.index>e.index&&r.options.insertionPoint===e.insertionPoint)return r}return null}function a6(n,e){for(var t=n.length-1;t>=0;t--){var r=n[t];if(r.attached&&r.options.insertionPoint===e.insertionPoint)return r}return null}function l6(n){for(var e=QS(),t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType===8&&r.nodeValue.trim()===n)return r}return null}function c6(n){var e=bu.registry;if(e.length>0){var t=o6(e,n);if(t&&t.renderer)return{parent:t.renderer.element.parentNode,node:t.renderer.element};if(t=a6(e,n),t&&t.renderer)return{parent:t.renderer.element.parentNode,node:t.renderer.element.nextSibling}}var r=n.insertionPoint;if(r&&typeof r=="string"){var s=l6(r);if(s)return{parent:s.parentNode,node:s.nextSibling}}return!1}function u6(n,e){var t=e.insertionPoint,r=c6(e);if(r!==!1&&r.parent){r.parent.insertBefore(n,r.node);return}if(t&&typeof t.nodeType=="number"){var s=t,i=s.parentNode;i&&i.insertBefore(n,s.nextSibling);return}QS().appendChild(n)}var f6=ZS(function(){var n=document.querySelector('meta[property="csp-nonce"]');return n?n.getAttribute("content"):null}),Lb=function(e,t,r){try{"insertRule"in e?e.insertRule(t,r):"appendRule"in e&&e.appendRule(t)}catch{return!1}return e.cssRules[r]},Fb=function(e,t){var r=e.cssRules.length;return t===void 0||t>r?r:t},d6=function(){var e=document.createElement("style");return e.textContent=`
`,e},h6=function(){function n(t){this.getPropertyValue=n6,this.setProperty=r6,this.removeProperty=s6,this.setSelector=i6,this.hasInsertedRules=!1,this.cssRules=[],t&&bu.add(t),this.sheet=t;var r=this.sheet?this.sheet.options:{},s=r.media,i=r.meta,o=r.element;this.element=o||d6(),this.element.setAttribute("data-jss",""),s&&this.element.setAttribute("media",s),i&&this.element.setAttribute("data-meta",i);var a=f6();a&&this.element.setAttribute("nonce",a)}var e=n.prototype;return e.attach=function(){if(!(this.element.parentNode||!this.sheet)){u6(this.element,this.sheet.options);var r=!!(this.sheet&&this.sheet.deployed);this.hasInsertedRules&&r&&(this.hasInsertedRules=!1,this.deploy())}},e.detach=function(){if(this.sheet){var r=this.element.parentNode;r&&r.removeChild(this.element),this.sheet.options.link&&(this.cssRules=[],this.element.textContent=`
`)}},e.deploy=function(){var r=this.sheet;if(r){if(r.options.link){this.insertRules(r.rules);return}this.element.textContent=`
`+r.toString()+`
`}},e.insertRules=function(r,s){for(var i=0;i<r.index.length;i++)this.insertRule(r.index[i],i,s)},e.insertRule=function(r,s,i){if(i===void 0&&(i=this.element.sheet),r.rules){var o=r,a=i;if(r.type==="conditional"||r.type==="keyframes"){var u=Fb(i,s);if(a=Lb(i,o.toString({children:!1}),u),a===!1)return!1;this.refCssRule(r,u,a)}return this.insertRules(o.rules,a),a}var f=r.toString();if(!f)return!1;var d=Fb(i,s),p=Lb(i,f,d);return p===!1?!1:(this.hasInsertedRules=!0,this.refCssRule(r,d,p),p)},e.refCssRule=function(r,s,i){r.renderable=i,r.options.parent instanceof KS&&this.cssRules.splice(s,0,i)},e.deleteRule=function(r){var s=this.element.sheet,i=this.indexOf(r);return i===-1?!1:(s.deleteRule(i),this.cssRules.splice(i,1),!0)},e.indexOf=function(r){return this.cssRules.indexOf(r)},e.replaceRule=function(r,s){var i=this.indexOf(r);return i===-1?!1:(this.element.sheet.deleteRule(i),this.cssRules.splice(i,1),this.insertRule(s,i))},e.getRules=function(){return this.element.sheet.cssRules},n}(),p6=0,g6=function(){function n(t){this.id=p6++,this.version="10.10.0",this.plugins=new e6,this.options={id:{minify:!1},createGenerateId:Db,Renderer:pf?h6:null,plugins:[]},this.generateId=Db({minify:!1});for(var r=0;r<Mb.length;r++)this.plugins.use(Mb[r],{queue:"internal"});this.setup(t)}var e=n.prototype;return e.setup=function(r){return r===void 0&&(r={}),r.createGenerateId&&(this.options.createGenerateId=r.createGenerateId),r.id&&(this.options.id=Ee({},this.options.id,r.id)),(r.createGenerateId||r.id)&&(this.generateId=this.options.createGenerateId(this.options.id)),r.insertionPoint!=null&&(this.options.insertionPoint=r.insertionPoint),"Renderer"in r&&(this.options.Renderer=r.Renderer),r.plugins&&this.use.apply(this,r.plugins),this},e.createStyleSheet=function(r,s){s===void 0&&(s={});var i=s,o=i.index;typeof o!="number"&&(o=bu.index===0?0:bu.index+1);var a=new KS(r,Ee({},s,{jss:this,generateId:s.generateId||this.generateId,insertionPoint:this.options.insertionPoint,Renderer:this.options.Renderer,index:o}));return this.plugins.onProcessSheet(a),a},e.removeStyleSheet=function(r){return r.detach(),bu.remove(r),this},e.createRule=function(r,s,i){if(s===void 0&&(s={}),i===void 0&&(i={}),typeof r=="object")return this.createRule(void 0,r,s);var o=Ee({},i,{name:r,jss:this,Renderer:this.options.Renderer});o.generateId||(o.generateId=this.generateId),o.classes||(o.classes={}),o.keyframes||(o.keyframes={});var a=v_(r,s,o);return a&&this.plugins.onProcessRule(a),a},e.use=function(){for(var r=this,s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return i.forEach(function(a){r.plugins.use(a)}),this},n}(),GS=function(e){return new g6(e)},__=typeof CSS=="object"&&CSS!=null&&"number"in CSS;function JS(n){var e=null;for(var t in n){var r=n[t],s=typeof r;if(s==="function")e||(e={}),e[t]=r;else if(s==="object"&&r!==null&&!Array.isArray(r)){var i=JS(r);i&&(e||(e={}),e[t]=i)}}return e}/**
 * A better abstraction over CSS.
 *
 * @copyright Oleg Isonen (Slobodskoi) / Isonen 2014-present
 * @website https://github.com/cssinjs/jss
 * @license MIT
 */GS();var eE=Date.now(),u0="fnValues"+eE,f0="fnStyle"+ ++eE,m6=function(){return{onCreateRule:function(t,r,s){if(typeof r!="function")return null;var i=v_(t,{},s);return i[f0]=r,i},onProcessStyle:function(t,r){if(u0 in r||f0 in r)return t;var s={};for(var i in t){var o=t[i];typeof o=="function"&&(delete t[i],s[i]=o)}return r[u0]=s,t},onUpdate:function(t,r,s,i){var o=r,a=o[f0];a&&(o.style=a(t)||{});var u=o[u0];if(u)for(var f in u)o.prop(f,u[f](t),i)}}},vo="@global",Ov="@global ",v6=function(){function n(t,r,s){this.type="global",this.at=vo,this.isProcessed=!1,this.key=t,this.options=s,this.rules=new qp(Ee({},s,{parent:this}));for(var i in r)this.rules.add(i,r[i]);this.rules.process()}var e=n.prototype;return e.getRule=function(r){return this.rules.get(r)},e.addRule=function(r,s,i){var o=this.rules.add(r,s,i);return o&&this.options.jss.plugins.onProcessRule(o),o},e.replaceRule=function(r,s,i){var o=this.rules.replace(r,s,i);return o&&this.options.jss.plugins.onProcessRule(o),o},e.indexOf=function(r){return this.rules.indexOf(r)},e.toString=function(r){return this.rules.toString(r)},n}(),y6=function(){function n(t,r,s){this.type="global",this.at=vo,this.isProcessed=!1,this.key=t,this.options=s;var i=t.substr(Ov.length);this.rule=s.jss.createRule(i,r,Ee({},s,{parent:this}))}var e=n.prototype;return e.toString=function(r){return this.rule?this.rule.toString(r):""},n}(),_6=/\s*,\s*/g;function tE(n,e){for(var t=n.split(_6),r="",s=0;s<t.length;s++)r+=e+" "+t[s].trim(),t[s+1]&&(r+=", ");return r}function x6(n,e){var t=n.options,r=n.style,s=r?r[vo]:null;if(s){for(var i in s)e.addRule(i,s[i],Ee({},t,{selector:tE(i,n.selector)}));delete r[vo]}}function b6(n,e){var t=n.options,r=n.style;for(var s in r)if(!(s[0]!=="@"||s.substr(0,vo.length)!==vo)){var i=tE(s.substr(vo.length),n.selector);e.addRule(i,r[s],Ee({},t,{selector:i})),delete r[s]}}function w6(){function n(t,r,s){if(!t)return null;if(t===vo)return new v6(t,r,s);if(t[0]==="@"&&t.substr(0,Ov.length)===Ov)return new y6(t,r,s);var i=s.parent;return i&&(i.type==="global"||i.options.parent&&i.options.parent.type==="global")&&(s.scoped=!1),!s.selector&&s.scoped===!1&&(s.selector=t),null}function e(t,r){t.type!=="style"||!r||(x6(t,r),b6(t,r))}return{onCreateRule:n,onProcessRule:e}}var Bb=/\s*,\s*/g,T6=/&/g,S6=/\$([\w-]+)/g;function E6(){function n(s,i){return function(o,a){var u=s.getRule(a)||i&&i.getRule(a);return u?u.selector:a}}function e(s,i){for(var o=i.split(Bb),a=s.split(Bb),u="",f=0;f<o.length;f++)for(var d=o[f],p=0;p<a.length;p++){var m=a[p];u&&(u+=", "),u+=m.indexOf("&")!==-1?m.replace(T6,d):d+" "+m}return u}function t(s,i,o){if(o)return Ee({},o,{index:o.index+1});var a=s.options.nestingLevel;a=a===void 0?1:a+1;var u=Ee({},s.options,{nestingLevel:a,index:i.indexOf(s)+1});return delete u.name,u}function r(s,i,o){if(i.type!=="style")return s;var a=i,u=a.options.parent,f,d;for(var p in s){var m=p.indexOf("&")!==-1,v=p[0]==="@";if(!(!m&&!v)){if(f=t(a,u,f),m){var x=e(p,a.selector);d||(d=n(u,o)),x=x.replace(S6,d);var b=a.key+"-"+p;"replaceRule"in u?u.replaceRule(b,s[p],Ee({},f,{selector:x})):u.addRule(b,s[p],Ee({},f,{selector:x}))}else v&&u.addRule(p,{},f).addRule(a.key,s[p],{selector:a.selector});delete s[p]}}return s}return{onProcessStyle:r}}var A6=/[A-Z]/g,C6=/^ms-/,d0={};function R6(n){return"-"+n.toLowerCase()}function nE(n){if(d0.hasOwnProperty(n))return d0[n];var e=n.replace(A6,R6);return d0[n]=C6.test(e)?"-"+e:e}function Mh(n){var e={};for(var t in n){var r=t.indexOf("--")===0?t:nE(t);e[r]=n[t]}return n.fallbacks&&(Array.isArray(n.fallbacks)?e.fallbacks=n.fallbacks.map(Mh):e.fallbacks=Mh(n.fallbacks)),e}function P6(){function n(t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)t[r]=Mh(t[r]);return t}return Mh(t)}function e(t,r,s){if(r.indexOf("--")===0)return t;var i=nE(r);return r===i?t:(s.prop(i,t),null)}return{onProcessStyle:n,onChangeValue:e}}var ge=__&&CSS?CSS.px:"px",Dd=__&&CSS?CSS.ms:"ms",dl=__&&CSS?CSS.percent:"%",I6={"animation-delay":Dd,"animation-duration":Dd,"background-position":ge,"background-position-x":ge,"background-position-y":ge,"background-size":ge,border:ge,"border-bottom":ge,"border-bottom-left-radius":ge,"border-bottom-right-radius":ge,"border-bottom-width":ge,"border-left":ge,"border-left-width":ge,"border-radius":ge,"border-right":ge,"border-right-width":ge,"border-top":ge,"border-top-left-radius":ge,"border-top-right-radius":ge,"border-top-width":ge,"border-width":ge,"border-block":ge,"border-block-end":ge,"border-block-end-width":ge,"border-block-start":ge,"border-block-start-width":ge,"border-block-width":ge,"border-inline":ge,"border-inline-end":ge,"border-inline-end-width":ge,"border-inline-start":ge,"border-inline-start-width":ge,"border-inline-width":ge,"border-start-start-radius":ge,"border-start-end-radius":ge,"border-end-start-radius":ge,"border-end-end-radius":ge,margin:ge,"margin-bottom":ge,"margin-left":ge,"margin-right":ge,"margin-top":ge,"margin-block":ge,"margin-block-end":ge,"margin-block-start":ge,"margin-inline":ge,"margin-inline-end":ge,"margin-inline-start":ge,padding:ge,"padding-bottom":ge,"padding-left":ge,"padding-right":ge,"padding-top":ge,"padding-block":ge,"padding-block-end":ge,"padding-block-start":ge,"padding-inline":ge,"padding-inline-end":ge,"padding-inline-start":ge,"mask-position-x":ge,"mask-position-y":ge,"mask-size":ge,height:ge,width:ge,"min-height":ge,"max-height":ge,"min-width":ge,"max-width":ge,bottom:ge,left:ge,top:ge,right:ge,inset:ge,"inset-block":ge,"inset-block-end":ge,"inset-block-start":ge,"inset-inline":ge,"inset-inline-end":ge,"inset-inline-start":ge,"box-shadow":ge,"text-shadow":ge,"column-gap":ge,"column-rule":ge,"column-rule-width":ge,"column-width":ge,"font-size":ge,"font-size-delta":ge,"letter-spacing":ge,"text-decoration-thickness":ge,"text-indent":ge,"text-stroke":ge,"text-stroke-width":ge,"word-spacing":ge,motion:ge,"motion-offset":ge,outline:ge,"outline-offset":ge,"outline-width":ge,perspective:ge,"perspective-origin-x":dl,"perspective-origin-y":dl,"transform-origin":dl,"transform-origin-x":dl,"transform-origin-y":dl,"transform-origin-z":dl,"transition-delay":Dd,"transition-duration":Dd,"vertical-align":ge,"flex-basis":ge,"shape-margin":ge,size:ge,gap:ge,grid:ge,"grid-gap":ge,"row-gap":ge,"grid-row-gap":ge,"grid-column-gap":ge,"grid-template-rows":ge,"grid-template-columns":ge,"grid-auto-rows":ge,"grid-auto-columns":ge,"box-shadow-x":ge,"box-shadow-y":ge,"box-shadow-blur":ge,"box-shadow-spread":ge,"font-line-height":ge,"text-shadow-x":ge,"text-shadow-y":ge,"text-shadow-blur":ge};function rE(n){var e=/(-[a-z])/g,t=function(o){return o[1].toUpperCase()},r={};for(var s in n)r[s]=n[s],r[s.replace(e,t)]=n[s];return r}var k6=rE(I6);function wu(n,e,t){if(e==null)return e;if(Array.isArray(e))for(var r=0;r<e.length;r++)e[r]=wu(n,e[r],t);else if(typeof e=="object")if(n==="fallbacks")for(var s in e)e[s]=wu(s,e[s],t);else for(var i in e)e[i]=wu(n+"-"+i,e[i],t);else if(typeof e=="number"&&isNaN(e)===!1){var o=t[n]||k6[n];return o&&!(e===0&&o===ge)?typeof o=="function"?o(e).toString():""+e+o:e.toString()}return e}function M6(n){n===void 0&&(n={});var e=rE(n);function t(s,i){if(i.type!=="style")return s;for(var o in s)s[o]=wu(o,s[o],e);return s}function r(s,i){return wu(i,s,e)}return{onProcessStyle:t,onChangeValue:r}}var lu="",Nv="",sE="",iE="",O6=pf&&"ontouchstart"in document.documentElement;if(pf){var h0={Moz:"-moz-",ms:"-ms-",O:"-o-",Webkit:"-webkit-"},N6=document.createElement("p"),p0=N6.style,D6="Transform";for(var g0 in h0)if(g0+D6 in p0){lu=g0,Nv=h0[g0];break}lu==="Webkit"&&"msHyphens"in p0&&(lu="ms",Nv=h0.ms,iE="edge"),lu==="Webkit"&&"-apple-trailing-word"in p0&&(sE="apple")}var it={js:lu,css:Nv,vendor:sE,browser:iE,isTouch:O6};function L6(n){return n[1]==="-"||it.js==="ms"?n:"@"+it.css+"keyframes"+n.substr(10)}var F6={noPrefill:["appearance"],supportedProperty:function(e){return e!=="appearance"?!1:it.js==="ms"?"-webkit-"+e:it.css+e}},B6={noPrefill:["color-adjust"],supportedProperty:function(e){return e!=="color-adjust"?!1:it.js==="Webkit"?it.css+"print-"+e:e}},U6=/[-\s]+(.)?/g;function V6(n,e){return e?e.toUpperCase():""}function x_(n){return n.replace(U6,V6)}function bo(n){return x_("-"+n)}var z6={noPrefill:["mask"],supportedProperty:function(e,t){if(!/^mask/.test(e))return!1;if(it.js==="Webkit"){var r="mask-image";if(x_(r)in t)return e;if(it.js+bo(r)in t)return it.css+e}return e}},$6={noPrefill:["text-orientation"],supportedProperty:function(e){return e!=="text-orientation"?!1:it.vendor==="apple"&&!it.isTouch?it.css+e:e}},j6={noPrefill:["transform"],supportedProperty:function(e,t,r){return e!=="transform"?!1:r.transform?e:it.css+e}},W6={noPrefill:["transition"],supportedProperty:function(e,t,r){return e!=="transition"?!1:r.transition?e:it.css+e}},H6={noPrefill:["writing-mode"],supportedProperty:function(e){return e!=="writing-mode"?!1:it.js==="Webkit"||it.js==="ms"&&it.browser!=="edge"?it.css+e:e}},X6={noPrefill:["user-select"],supportedProperty:function(e){return e!=="user-select"?!1:it.js==="Moz"||it.js==="ms"||it.vendor==="apple"?it.css+e:e}},Y6={supportedProperty:function(e,t){if(!/^break-/.test(e))return!1;if(it.js==="Webkit"){var r="WebkitColumn"+bo(e);return r in t?it.css+"column-"+e:!1}if(it.js==="Moz"){var s="page"+bo(e);return s in t?"page-"+e:!1}return!1}},q6={supportedProperty:function(e,t){if(!/^(border|margin|padding)-inline/.test(e))return!1;if(it.js==="Moz")return e;var r=e.replace("-inline","");return it.js+bo(r)in t?it.css+r:!1}},K6={supportedProperty:function(e,t){return x_(e)in t?e:!1}},Z6={supportedProperty:function(e,t){var r=bo(e);return e[0]==="-"||e[0]==="-"&&e[1]==="-"?e:it.js+r in t?it.css+e:it.js!=="Webkit"&&"Webkit"+r in t?"-webkit-"+e:!1}},Q6={supportedProperty:function(e){return e.substring(0,11)!=="scroll-snap"?!1:it.js==="ms"?""+it.css+e:e}},G6={supportedProperty:function(e){return e!=="overscroll-behavior"?!1:it.js==="ms"?it.css+"scroll-chaining":e}},J6={"flex-grow":"flex-positive","flex-shrink":"flex-negative","flex-basis":"flex-preferred-size","justify-content":"flex-pack",order:"flex-order","align-items":"flex-align","align-content":"flex-line-pack"},ek={supportedProperty:function(e,t){var r=J6[e];return r&&it.js+bo(r)in t?it.css+r:!1}},oE={flex:"box-flex","flex-grow":"box-flex","flex-direction":["box-orient","box-direction"],order:"box-ordinal-group","align-items":"box-align","flex-flow":["box-orient","box-direction"],"justify-content":"box-pack"},tk=Object.keys(oE),nk=function(e){return it.css+e},rk={supportedProperty:function(e,t,r){var s=r.multiple;if(tk.indexOf(e)>-1){var i=oE[e];if(!Array.isArray(i))return it.js+bo(i)in t?it.css+i:!1;if(!s)return!1;for(var o=0;o<i.length;o++)if(!(it.js+bo(i[0])in t))return!1;return i.map(nk)}return!1}},aE=[F6,B6,z6,$6,j6,W6,H6,X6,Y6,q6,K6,Z6,Q6,G6,ek,rk],Ub=aE.filter(function(n){return n.supportedProperty}).map(function(n){return n.supportedProperty}),sk=aE.filter(function(n){return n.noPrefill}).reduce(function(n,e){return n.push.apply(n,Hp(e.noPrefill)),n},[]),cu,ta={};if(pf){cu=document.createElement("p");var m0=window.getComputedStyle(document.documentElement,"");for(var v0 in m0)isNaN(v0)||(ta[m0[v0]]=m0[v0]);sk.forEach(function(n){return delete ta[n]})}function Dv(n,e){if(e===void 0&&(e={}),!cu)return n;if(ta[n]!=null)return ta[n];(n==="transition"||n==="transform")&&(e[n]=n in cu.style);for(var t=0;t<Ub.length&&(ta[n]=Ub[t](n,cu.style,e),!ta[n]);t++);try{cu.style[n]=""}catch{return!1}return ta[n]}var hl={},ik={transition:1,"transition-property":1,"-webkit-transition":1,"-webkit-transition-property":1},ok=/(^\s*[\w-]+)|, (\s*[\w-]+)(?![^()]*\))/g,so;function ak(n,e,t){if(e==="var")return"var";if(e==="all")return"all";if(t==="all")return", all";var r=e?Dv(e):", "+Dv(t);return r||e||t}pf&&(so=document.createElement("p"));function Vb(n,e){var t=e;if(!so||n==="content")return e;if(typeof t!="string"||!isNaN(parseInt(t,10)))return t;var r=n+t;if(hl[r]!=null)return hl[r];try{so.style[n]=t}catch{return hl[r]=!1,!1}if(ik[n])t=t.replace(ok,ak);else if(so.style[n]===""&&(t=it.css+t,t==="-ms-flex"&&(so.style[n]="-ms-flexbox"),so.style[n]=t,so.style[n]===""))return hl[r]=!1,!1;return so.style[n]="",hl[r]=t,hl[r]}function lk(){function n(s){if(s.type==="keyframes"){var i=s;i.at=L6(i.at)}}function e(s){for(var i in s){var o=s[i];if(i==="fallbacks"&&Array.isArray(o)){s[i]=o.map(e);continue}var a=!1,u=Dv(i);u&&u!==i&&(a=!0);var f=!1,d=Vb(u,fa(o));d&&d!==o&&(f=!0),(a||f)&&(a&&delete s[i],s[u||i]=d||o)}return s}function t(s,i){return i.type!=="style"?s:e(s)}function r(s,i){return Vb(i,fa(s))||s}return{onProcessRule:n,onProcessStyle:t,onChangeValue:r}}function ck(){var n=function(t,r){return t.length===r.length?t>r?1:-1:t.length-r.length};return{onProcessStyle:function(t,r){if(r.type!=="style")return t;for(var s={},i=Object.keys(t).sort(n),o=0;o<i.length;o++)s[i[o]]=t[i[o]];return s}}}function uk(){return{plugins:[m6(),w6(),E6(),P6(),M6(),typeof window>"u"?null:lk(),ck()]}}var B=d_();const Xt=ka(B);function lE(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.baseClasses,t=n.newClasses;if(n.Component,!t)return e;var r=Ee({},e);return Object.keys(t).forEach(function(s){t[s]&&(r[s]="".concat(e[s]," ").concat(t[s]))}),r}var Cl={set:function(e,t,r,s){var i=e.get(t);i||(i=new Map,e.set(t,i)),i.set(r,s)},get:function(e,t,r){var s=e.get(t);return s?s.get(r):void 0},delete:function(e,t,r){var s=e.get(t);s.delete(r)}},cE=Xt.createContext(null);function gf(){var n=Xt.useContext(cE);return n}var fk=GS(uk()),dk=II(),hk=new Map,pk={disableGeneration:!1,generateClassName:dk,jss:fk,sheetsCache:null,sheetsManager:hk,sheetsRegistry:null},gk=Xt.createContext(pk),zb=-1e9;function mk(){return zb+=1,zb}var vk={};function yk(n){var e=typeof n=="function";return{create:function(r,s){var i;try{i=e?n(r):n}catch(u){throw u}if(!s||!r.overrides||!r.overrides[s])return i;var o=r.overrides[s],a=Ee({},i);return Object.keys(o).forEach(function(u){a[u]=Zl(a[u],o[u])}),a},options:{}}}function _k(n,e,t){var r=n.state,s=n.stylesOptions;if(s.disableGeneration)return e||{};r.cacheClasses||(r.cacheClasses={value:null,lastProp:null,lastJSS:{}});var i=!1;return r.classes!==r.cacheClasses.lastJSS&&(r.cacheClasses.lastJSS=r.classes,i=!0),e!==r.cacheClasses.lastProp&&(r.cacheClasses.lastProp=e,i=!0),i&&(r.cacheClasses.value=lE({baseClasses:r.cacheClasses.lastJSS,newClasses:e,Component:t})),r.cacheClasses.value}function xk(n,e){var t=n.state,r=n.theme,s=n.stylesOptions,i=n.stylesCreator,o=n.name;if(!s.disableGeneration){var a=Cl.get(s.sheetsManager,i,r);a||(a={refs:0,staticSheet:null,dynamicStyles:null},Cl.set(s.sheetsManager,i,r,a));var u=Ee({},i.options,s,{theme:r,flip:typeof s.flip=="boolean"?s.flip:r.direction==="rtl"});u.generateId=u.serverGenerateClassName||u.generateClassName;var f=s.sheetsRegistry;if(a.refs===0){var d;s.sheetsCache&&(d=Cl.get(s.sheetsCache,i,r));var p=i.create(r,o);d||(d=s.jss.createStyleSheet(p,Ee({link:!1},u)),d.attach(),s.sheetsCache&&Cl.set(s.sheetsCache,i,r,d)),f&&f.add(d),a.staticSheet=d,a.dynamicStyles=JS(p)}if(a.dynamicStyles){var m=s.jss.createStyleSheet(a.dynamicStyles,Ee({link:!0},u));m.update(e),m.attach(),t.dynamicSheet=m,t.classes=lE({baseClasses:a.staticSheet.classes,newClasses:m.classes}),f&&f.add(m)}else t.classes=a.staticSheet.classes;a.refs+=1}}function bk(n,e){var t=n.state;t.dynamicSheet&&t.dynamicSheet.update(e)}function wk(n){var e=n.state,t=n.theme,r=n.stylesOptions,s=n.stylesCreator;if(!r.disableGeneration){var i=Cl.get(r.sheetsManager,s,t);i.refs-=1;var o=r.sheetsRegistry;i.refs===0&&(Cl.delete(r.sheetsManager,s,t),r.jss.removeStyleSheet(i.staticSheet),o&&o.remove(i.staticSheet)),e.dynamicSheet&&(r.jss.removeStyleSheet(e.dynamicSheet),o&&o.remove(e.dynamicSheet))}}function Tk(n,e){var t=Xt.useRef([]),r,s=Xt.useMemo(function(){return{}},e);t.current!==s&&(t.current=s,r=n()),Xt.useEffect(function(){return function(){r&&r()}},[s])}function Kp(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.name,r=e.classNamePrefix,s=e.Component,i=e.defaultTheme,o=i===void 0?vk:i,a=Ct(e,["name","classNamePrefix","Component","defaultTheme"]),u=yk(n),f=t||r||"makeStyles";u.options={index:mk(),name:t,meta:f,classNamePrefix:f};var d=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v=gf()||o,x=Ee({},Xt.useContext(gk),a),b=Xt.useRef(),w=Xt.useRef();Tk(function(){var R={name:t,state:{},stylesCreator:u,stylesOptions:x,theme:v};return xk(R,m),w.current=!1,b.current=R,function(){wk(R)}},[v,u]),Xt.useEffect(function(){w.current&&bk(b.current,m),w.current=!0});var S=_k(b.current,m.classes,s);return S};return d}function Sk(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function uE(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n))for(e=0;e<n.length;e++)n[e]&&(t=uE(n[e]))&&(r&&(r+=" "),r+=t);else for(e in n)n[e]&&(r&&(r+=" "),r+=e);return r}function Et(){for(var n,e,t=0,r="";t<arguments.length;)(n=arguments[t++])&&(e=uE(n))&&(r&&(r+=" "),r+=e);return r}var y0={exports:{}},Pt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $b;function Ek(){if($b)return Pt;$b=1;var n=typeof Symbol=="function"&&Symbol.for,e=n?Symbol.for("react.element"):60103,t=n?Symbol.for("react.portal"):60106,r=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,i=n?Symbol.for("react.profiler"):60114,o=n?Symbol.for("react.provider"):60109,a=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,m=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,x=n?Symbol.for("react.lazy"):60116,b=n?Symbol.for("react.block"):60121,w=n?Symbol.for("react.fundamental"):60117,S=n?Symbol.for("react.responder"):60118,R=n?Symbol.for("react.scope"):60119;function C(I){if(typeof I=="object"&&I!==null){var F=I.$$typeof;switch(F){case e:switch(I=I.type,I){case u:case f:case r:case i:case s:case p:return I;default:switch(I=I&&I.$$typeof,I){case a:case d:case x:case v:case o:return I;default:return F}}case t:return F}}}function O(I){return C(I)===f}return Pt.AsyncMode=u,Pt.ConcurrentMode=f,Pt.ContextConsumer=a,Pt.ContextProvider=o,Pt.Element=e,Pt.ForwardRef=d,Pt.Fragment=r,Pt.Lazy=x,Pt.Memo=v,Pt.Portal=t,Pt.Profiler=i,Pt.StrictMode=s,Pt.Suspense=p,Pt.isAsyncMode=function(I){return O(I)||C(I)===u},Pt.isConcurrentMode=O,Pt.isContextConsumer=function(I){return C(I)===a},Pt.isContextProvider=function(I){return C(I)===o},Pt.isElement=function(I){return typeof I=="object"&&I!==null&&I.$$typeof===e},Pt.isForwardRef=function(I){return C(I)===d},Pt.isFragment=function(I){return C(I)===r},Pt.isLazy=function(I){return C(I)===x},Pt.isMemo=function(I){return C(I)===v},Pt.isPortal=function(I){return C(I)===t},Pt.isProfiler=function(I){return C(I)===i},Pt.isStrictMode=function(I){return C(I)===s},Pt.isSuspense=function(I){return C(I)===p},Pt.isValidElementType=function(I){return typeof I=="string"||typeof I=="function"||I===r||I===f||I===i||I===s||I===p||I===m||typeof I=="object"&&I!==null&&(I.$$typeof===x||I.$$typeof===v||I.$$typeof===o||I.$$typeof===a||I.$$typeof===d||I.$$typeof===w||I.$$typeof===S||I.$$typeof===R||I.$$typeof===b)},Pt.typeOf=C,Pt}var jb;function Ak(){return jb||(jb=1,y0.exports=Ek()),y0.exports}var _0,Wb;function Ck(){if(Wb)return _0;Wb=1;var n=Ak(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},i={};i[n.ForwardRef]=r,i[n.Memo]=s;function o(x){return n.isMemo(x)?s:i[x.$$typeof]||e}var a=Object.defineProperty,u=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,m=Object.prototype;function v(x,b,w){if(typeof b!="string"){if(m){var S=p(b);S&&S!==m&&v(x,S,w)}var R=u(b);f&&(R=R.concat(f(b)));for(var C=o(x),O=o(b),I=0;I<R.length;++I){var F=R[I];if(!t[F]&&!(w&&w[F])&&!(O&&O[F])&&!(C&&C[F])){var $=d(b,F);try{a(x,F,$)}catch{}}}}return x}return _0=v,_0}var Rk=Ck();const Pk=ka(Rk);function Ik(n,e){if(typeof e=="function"){var t=e(n);return t}return Ee({},n,e)}function kk(n){var e=n.children,t=n.theme,r=gf(),s=Xt.useMemo(function(){var i=r===null?t:Ik(r,t);return i!=null&&(i[XS]=r!==null),i},[t,r]);return Xt.createElement(cE.Provider,{value:s},e)}var Po=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function(r){var s=t.defaultTheme,i=t.withTheme,o=i===void 0?!1:i,a=t.name,u=Ct(t,["defaultTheme","withTheme","name"]),f=a,d=Kp(e,Ee({defaultTheme:s,Component:r,name:a||r.displayName,classNamePrefix:f},u)),p=Xt.forwardRef(function(v,x){v.classes;var b=v.innerRef,w=Ct(v,["classes","innerRef"]),S=d(Ee({},r.defaultProps,v)),R,C=w;return(typeof a=="string"||o)&&(R=gf()||s,a&&(C=YS({theme:R,name:a,props:w})),o&&!C.theme&&(C.theme=R)),Xt.createElement(r,Ee({ref:b||x,classes:S},C))});return Pk(p,r),p}},fE=HS();function b_(){var n=gf()||fE;return n}function Pn(n,e){return Po(n,Ee({defaultTheme:fE},e))}function Gr(n){if(typeof n!="string")throw new Error(Fu(7));return n.charAt(0).toUpperCase()+n.slice(1)}function Lv(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.reduce(function(r,s){return s==null?r:function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];r.apply(this,a),s.apply(this,a)}},function(){})}var Mk=function(e){return{root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:e.typography.pxToRem(24),transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorAction:{color:e.palette.action.active},colorError:{color:e.palette.error.main},colorDisabled:{color:e.palette.action.disabled},fontSizeInherit:{fontSize:"inherit"},fontSizeSmall:{fontSize:e.typography.pxToRem(20)},fontSizeLarge:{fontSize:e.typography.pxToRem(35)}}},dE=B.forwardRef(function(e,t){var r=e.children,s=e.classes,i=e.className,o=e.color,a=o===void 0?"inherit":o,u=e.component,f=u===void 0?"svg":u,d=e.fontSize,p=d===void 0?"medium":d,m=e.htmlColor,v=e.titleAccess,x=e.viewBox,b=x===void 0?"0 0 24 24":x,w=Ct(e,["children","classes","className","color","component","fontSize","htmlColor","titleAccess","viewBox"]);return B.createElement(f,Ee({className:Et(s.root,i,a!=="inherit"&&s["color".concat(Gr(a))],p!=="default"&&p!=="medium"&&s["fontSize".concat(Gr(p))]),focusable:"false",viewBox:b,color:m,"aria-hidden":v?void 0:!0,role:v?"img":void 0,ref:t},w),r,v?B.createElement("title",null,v):null)});dE.muiName="SvgIcon";const Hb=Pn(Mk,{name:"MuiSvgIcon"})(dE);function Ti(n,e){var t=function(s,i){return Xt.createElement(Hb,Ee({ref:i},s),n)};return t.muiName=Hb.muiName,Xt.memo(Xt.forwardRef(t))}function hE(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:166,t;function r(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];var a=this,u=function(){n.apply(a,i)};clearTimeout(t),t=setTimeout(u,e)}return r.clear=function(){clearTimeout(t)},r}function ms(n){return n&&n.ownerDocument||document}function pE(n){var e=ms(n);return e.defaultView||window}function Oh(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function gE(n){var e=n.controlled,t=n.default;n.name,n.state;var r=B.useRef(e!==void 0),s=r.current,i=B.useState(t),o=i[0],a=i[1],u=s?e:o,f=B.useCallback(function(d){s||a(d)},[]);return[u,f]}var Ok=typeof window<"u"?B.useLayoutEffect:B.useEffect;function Gn(n){var e=B.useRef(n);return Ok(function(){e.current=n}),B.useCallback(function(){return e.current.apply(void 0,arguments)},[])}function nr(n,e){return B.useMemo(function(){return n==null&&e==null?null:function(t){Oh(n,t),Oh(e,t)}},[n,e])}var x0={exports:{}},br={},b0={exports:{}},w0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xb;function Nk(){return Xb||(Xb=1,function(n){function e(D,Y){var M=D.length;D.push(Y);e:for(;0<M;){var T=M-1>>>1,N=D[T];if(0<s(N,Y))D[T]=Y,D[M]=N,M=T;else break e}}function t(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var Y=D[0],M=D.pop();if(M!==Y){D[0]=M;e:for(var T=0,N=D.length,W=N>>>1;T<W;){var Z=2*(T+1)-1,te=D[Z],re=Z+1,ue=D[re];if(0>s(te,M))re<N&&0>s(ue,te)?(D[T]=ue,D[re]=M,T=re):(D[T]=te,D[Z]=M,T=Z);else if(re<N&&0>s(ue,M))D[T]=ue,D[re]=M,T=re;else break e}}return Y}function s(D,Y){var M=D.sortIndex-Y.sortIndex;return M!==0?M:D.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],f=[],d=1,p=null,m=3,v=!1,x=!1,b=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(D){for(var Y=t(f);Y!==null;){if(Y.callback===null)r(f);else if(Y.startTime<=D)r(f),Y.sortIndex=Y.expirationTime,e(u,Y);else break;Y=t(f)}}function O(D){if(b=!1,C(D),!x)if(t(u)!==null)x=!0,U(I);else{var Y=t(f);Y!==null&&H(O,Y.startTime-D)}}function I(D,Y){x=!1,b&&(b=!1,S(q),q=-1),v=!0;var M=m;try{for(C(Y),p=t(u);p!==null&&(!(p.expirationTime>Y)||D&&!he());){var T=p.callback;if(typeof T=="function"){p.callback=null,m=p.priorityLevel;var N=T(p.expirationTime<=Y);Y=n.unstable_now(),typeof N=="function"?p.callback=N:p===t(u)&&r(u),C(Y)}else r(u);p=t(u)}if(p!==null)var W=!0;else{var Z=t(f);Z!==null&&H(O,Z.startTime-Y),W=!1}return W}finally{p=null,m=M,v=!1}}var F=!1,$=null,q=-1,K=5,le=-1;function he(){return!(n.unstable_now()-le<K)}function pe(){if($!==null){var D=n.unstable_now();le=D;var Y=!0;try{Y=$(!0,D)}finally{Y?se():(F=!1,$=null)}}else F=!1}var se;if(typeof R=="function")se=function(){R(pe)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,Me=ye.port2;ye.port1.onmessage=pe,se=function(){Me.postMessage(null)}}else se=function(){w(pe,0)};function U(D){$=D,F||(F=!0,se())}function H(D,Y){q=w(function(){D(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(D){D.callback=null},n.unstable_continueExecution=function(){x||v||(x=!0,U(I))},n.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<D?Math.floor(1e3/D):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(D){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var M=m;m=Y;try{return D()}finally{m=M}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(D,Y){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var M=m;m=D;try{return Y()}finally{m=M}},n.unstable_scheduleCallback=function(D,Y,M){var T=n.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?T+M:T):M=T,D){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=M+N,D={id:d++,callback:Y,priorityLevel:D,startTime:M,expirationTime:N,sortIndex:-1},M>T?(D.sortIndex=M,e(f,D),t(u)===null&&D===t(f)&&(b?(S(q),q=-1):b=!0,H(O,M-T))):(D.sortIndex=N,e(u,D),x||v||(x=!0,U(I))),D},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(D){var Y=m;return function(){var M=m;m=Y;try{return D.apply(this,arguments)}finally{m=M}}}}(w0)),w0}var Yb;function Dk(){return Yb||(Yb=1,b0.exports=Nk()),b0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qb;function Lk(){if(qb)return br;qb=1;var n=d_(),e=Dk();function t(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function i(l,c){o(l,c),o(l+"Capture",c)}function o(l,c){for(s[l]=c,l=0;l<c.length;l++)r.add(c[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function m(l){return u.call(p,l)?!0:u.call(d,l)?!1:f.test(l)?p[l]=!0:(d[l]=!0,!1)}function v(l,c,h,g){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return g?!1:h!==null?!h.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function x(l,c,h,g){if(c===null||typeof c>"u"||v(l,c,h,g))return!0;if(g)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function b(l,c,h,g,y,_,A){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=g,this.attributeNamespace=y,this.mustUseProperty=h,this.propertyName=l,this.type=c,this.sanitizeURL=_,this.removeEmptyString=A}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){w[l]=new b(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var c=l[0];w[c]=new b(c,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){w[l]=new b(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){w[l]=new b(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){w[l]=new b(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){w[l]=new b(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){w[l]=new b(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){w[l]=new b(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){w[l]=new b(l,5,!1,l.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function R(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var c=l.replace(S,R);w[c]=new b(c,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var c=l.replace(S,R);w[c]=new b(c,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var c=l.replace(S,R);w[c]=new b(c,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){w[l]=new b(l,1,!1,l.toLowerCase(),null,!1,!1)}),w.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){w[l]=new b(l,1,!1,l.toLowerCase(),null,!0,!0)});function C(l,c,h,g){var y=w.hasOwnProperty(c)?w[c]:null;(y!==null?y.type!==0:g||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(x(c,h,y,g)&&(h=null),g||y===null?m(c)&&(h===null?l.removeAttribute(c):l.setAttribute(c,""+h)):y.mustUseProperty?l[y.propertyName]=h===null?y.type===3?!1:"":h:(c=y.attributeName,g=y.attributeNamespace,h===null?l.removeAttribute(c):(y=y.type,h=y===3||y===4&&h===!0?"":""+h,g?l.setAttributeNS(g,c,h):l.setAttribute(c,h))))}var O=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),F=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),le=Symbol.for("react.provider"),he=Symbol.for("react.context"),pe=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),ye=Symbol.for("react.suspense_list"),Me=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),H=Symbol.for("react.offscreen"),D=Symbol.iterator;function Y(l){return l===null||typeof l!="object"?null:(l=D&&l[D]||l["@@iterator"],typeof l=="function"?l:null)}var M=Object.assign,T;function N(l){if(T===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);T=c&&c[1]||""}return`
`+T+l}var W=!1;function Z(l,c){if(!l||W)return"";W=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(de){var g=de}Reflect.construct(l,[],c)}else{try{c.call()}catch(de){g=de}l.call(c.prototype)}else{try{throw Error()}catch(de){g=de}l()}}catch(de){if(de&&g&&typeof de.stack=="string"){for(var y=de.stack.split(`
`),_=g.stack.split(`
`),A=y.length-1,z=_.length-1;1<=A&&0<=z&&y[A]!==_[z];)z--;for(;1<=A&&0<=z;A--,z--)if(y[A]!==_[z]){if(A!==1||z!==1)do if(A--,z--,0>z||y[A]!==_[z]){var X=`
`+y[A].replace(" at new "," at ");return l.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",l.displayName)),X}while(1<=A&&0<=z);break}}}finally{W=!1,Error.prepareStackTrace=h}return(l=l?l.displayName||l.name:"")?N(l):""}function te(l){switch(l.tag){case 5:return N(l.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return l=Z(l.type,!1),l;case 11:return l=Z(l.type.render,!1),l;case 1:return l=Z(l.type,!0),l;default:return""}}function re(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case $:return"Fragment";case F:return"Portal";case K:return"Profiler";case q:return"StrictMode";case se:return"Suspense";case ye:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case he:return(l.displayName||"Context")+".Consumer";case le:return(l._context.displayName||"Context")+".Provider";case pe:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case Me:return c=l.displayName||null,c!==null?c:re(l.type)||"Memo";case U:c=l._payload,l=l._init;try{return re(l(c))}catch{}}return null}function ue(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return re(c);case 8:return c===q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function ve(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function be(l){var c=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Pe(l){var c=be(l)?"checked":"value",h=Object.getOwnPropertyDescriptor(l.constructor.prototype,c),g=""+l[c];if(!l.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var y=h.get,_=h.set;return Object.defineProperty(l,c,{configurable:!0,get:function(){return y.call(this)},set:function(A){g=""+A,_.call(this,A)}}),Object.defineProperty(l,c,{enumerable:h.enumerable}),{getValue:function(){return g},setValue:function(A){g=""+A},stopTracking:function(){l._valueTracker=null,delete l[c]}}}}function Ue(l){l._valueTracker||(l._valueTracker=Pe(l))}function Ke(l){if(!l)return!1;var c=l._valueTracker;if(!c)return!0;var h=c.getValue(),g="";return l&&(g=be(l)?l.checked?"true":"false":l.value),l=g,l!==h?(c.setValue(l),!0):!1}function nt(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function Ge(l,c){var h=c.checked;return M({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??l._wrapperState.initialChecked})}function He(l,c){var h=c.defaultValue==null?"":c.defaultValue,g=c.checked!=null?c.checked:c.defaultChecked;h=ve(c.value!=null?c.value:h),l._wrapperState={initialChecked:g,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Ie(l,c){c=c.checked,c!=null&&C(l,"checked",c,!1)}function ct(l,c){Ie(l,c);var h=ve(c.value),g=c.type;if(h!=null)g==="number"?(h===0&&l.value===""||l.value!=h)&&(l.value=""+h):l.value!==""+h&&(l.value=""+h);else if(g==="submit"||g==="reset"){l.removeAttribute("value");return}c.hasOwnProperty("value")?$t(l,c.type,h):c.hasOwnProperty("defaultValue")&&$t(l,c.type,ve(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(l.defaultChecked=!!c.defaultChecked)}function xn(l,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var g=c.type;if(!(g!=="submit"&&g!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+l._wrapperState.initialValue,h||c===l.value||(l.value=c),l.defaultValue=c}h=l.name,h!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,h!==""&&(l.name=h)}function $t(l,c,h){(c!=="number"||nt(l.ownerDocument)!==l)&&(h==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+h&&(l.defaultValue=""+h))}var Ot=Array.isArray;function ht(l,c,h,g){if(l=l.options,c){c={};for(var y=0;y<h.length;y++)c["$"+h[y]]=!0;for(h=0;h<l.length;h++)y=c.hasOwnProperty("$"+l[h].value),l[h].selected!==y&&(l[h].selected=y),y&&g&&(l[h].defaultSelected=!0)}else{for(h=""+ve(h),c=null,y=0;y<l.length;y++){if(l[y].value===h){l[y].selected=!0,g&&(l[y].defaultSelected=!0);return}c!==null||l[y].disabled||(c=l[y])}c!==null&&(c.selected=!0)}}function at(l,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return M({},c,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Mt(l,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(t(92));if(Ot(h)){if(1<h.length)throw Error(t(93));h=h[0]}c=h}c==null&&(c=""),h=c}l._wrapperState={initialValue:ve(h)}}function Ut(l,c){var h=ve(c.value),g=ve(c.defaultValue);h!=null&&(h=""+h,h!==l.value&&(l.value=h),c.defaultValue==null&&l.defaultValue!==h&&(l.defaultValue=h)),g!=null&&(l.defaultValue=""+g)}function In(l){var c=l.textContent;c===l._wrapperState.initialValue&&c!==""&&c!==null&&(l.value=c)}function bn(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ur(l,c){return l==null||l==="http://www.w3.org/1999/xhtml"?bn(c):l==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Qt,mt=function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,g,y){MSApp.execUnsafeLocalFunction(function(){return l(c,h,g,y)})}:l}(function(l,c){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=c;else{for(Qt=Qt||document.createElement("div"),Qt.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Qt.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;c.firstChild;)l.appendChild(c.firstChild)}});function Ln(l,c){if(c){var h=l.firstChild;if(h&&h===l.lastChild&&h.nodeType===3){h.nodeValue=c;return}}l.textContent=c}var Vt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sr=["Webkit","ms","Moz","O"];Object.keys(Vt).forEach(function(l){Sr.forEach(function(c){c=c+l.charAt(0).toUpperCase()+l.substring(1),Vt[c]=Vt[l]})});function cr(l,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||Vt.hasOwnProperty(l)&&Vt[l]?(""+c).trim():c+"px"}function Ai(l,c){l=l.style;for(var h in c)if(c.hasOwnProperty(h)){var g=h.indexOf("--")===0,y=cr(h,c[h],g);h==="float"&&(h="cssFloat"),g?l.setProperty(h,y):l[h]=y}}var Do=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ks(l,c){if(c){if(Do[l]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Qe(l,c){if(l.indexOf("-")===-1)return typeof c.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kn=null;function Zs(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var is=null,wn=null,ur=null;function fr(l){if(l=Nc(l)){if(typeof is!="function")throw Error(t(280));var c=l.stateNode;c&&(c=Zf(c),is(l.stateNode,l.type,c))}}function Vr(l){wn?ur?ur.push(l):ur=[l]:wn=l}function Ci(){if(wn){var l=wn,c=ur;if(ur=wn=null,fr(l),c)for(l=0;l<c.length;l++)fr(c[l])}}function Ba(l,c){return l(c)}function Ri(){}var Lo=!1;function Ua(l,c,h){if(Lo)return l(c,h);Lo=!0;try{return Ba(l,c,h)}finally{Lo=!1,(wn!==null||ur!==null)&&(Ri(),Ci())}}function ze(l,c){var h=l.stateNode;if(h===null)return null;var g=Zf(h);if(g===null)return null;h=g[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(l=l.type,g=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!g;break e;default:l=!1}if(l)return null;if(h&&typeof h!="function")throw Error(t(231,c,typeof h));return h}var Xe=!1;if(a)try{var Rt={};Object.defineProperty(Rt,"passive",{get:function(){Xe=!0}}),window.addEventListener("test",Rt,Rt),window.removeEventListener("test",Rt,Rt)}catch{Xe=!1}function Yt(l,c,h,g,y,_,A,z,X){var de=Array.prototype.slice.call(arguments,3);try{c.apply(h,de)}catch(we){this.onError(we)}}var pt=!1,Tn=null,wt=!1,Ss=null,Es={onError:function(l){pt=!0,Tn=l}};function Pi(l,c,h,g,y,_,A,z,X){pt=!1,Tn=null,Yt.apply(Es,arguments)}function Ii(l,c,h,g,y,_,A,z,X){if(Pi.apply(this,arguments),pt){if(pt){var de=Tn;pt=!1,Tn=null}else throw Error(t(198));wt||(wt=!0,Ss=de)}}function zr(l){var c=l,h=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,(c.flags&4098)!==0&&(h=c.return),l=c.return;while(l)}return c.tag===3?h:null}function Fo(l){if(l.tag===13){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function $r(l){if(zr(l)!==l)throw Error(t(188))}function tn(l){var c=l.alternate;if(!c){if(c=zr(l),c===null)throw Error(t(188));return c!==l?null:l}for(var h=l,g=c;;){var y=h.return;if(y===null)break;var _=y.alternate;if(_===null){if(g=y.return,g!==null){h=g;continue}break}if(y.child===_.child){for(_=y.child;_;){if(_===h)return $r(y),l;if(_===g)return $r(y),c;_=_.sibling}throw Error(t(188))}if(h.return!==g.return)h=y,g=_;else{for(var A=!1,z=y.child;z;){if(z===h){A=!0,h=y,g=_;break}if(z===g){A=!0,g=y,h=_;break}z=z.sibling}if(!A){for(z=_.child;z;){if(z===h){A=!0,h=_,g=y;break}if(z===g){A=!0,g=_,h=y;break}z=z.sibling}if(!A)throw Error(t(189))}}if(h.alternate!==g)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?l:c}function os(l){return l=tn(l),l!==null?As(l):null}function As(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=As(l);if(c!==null)return c;l=l.sibling}return null}var dr=e.unstable_scheduleCallback,ki=e.unstable_cancelCallback,mc=e.unstable_shouldYield,vg=e.unstable_requestPaint,jt=e.unstable_now,hr=e.unstable_getCurrentPriorityLevel,Cs=e.unstable_ImmediatePriority,as=e.unstable_UserBlockingPriority,pr=e.unstable_NormalPriority,Bo=e.unstable_LowPriority,Er=e.unstable_IdlePriority,gr=null,Ar=null;function Df(l){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(gr,l,void 0,(l.current.flags&128)===128)}catch{}}var jn=Math.clz32?Math.clz32:vc,Cr=Math.log,Va=Math.LN2;function vc(l){return l>>>=0,l===0?32:31-(Cr(l)/Va|0)|0}var Mi=64,Oi=4194304;function Qs(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Gs(l,c){var h=l.pendingLanes;if(h===0)return 0;var g=0,y=l.suspendedLanes,_=l.pingedLanes,A=h&268435455;if(A!==0){var z=A&~y;z!==0?g=Qs(z):(_&=A,_!==0&&(g=Qs(_)))}else A=h&~y,A!==0?g=Qs(A):_!==0&&(g=Qs(_));if(g===0)return 0;if(c!==0&&c!==g&&(c&y)===0&&(y=g&-g,_=c&-c,y>=_||y===16&&(_&4194240)!==0))return c;if((g&4)!==0&&(g|=h&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=g;0<c;)h=31-jn(c),y=1<<h,g|=l[h],c&=~y;return g}function Rs(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yg(l,c){for(var h=l.suspendedLanes,g=l.pingedLanes,y=l.expirationTimes,_=l.pendingLanes;0<_;){var A=31-jn(_),z=1<<A,X=y[A];X===-1?((z&h)===0||(z&g)!==0)&&(y[A]=Rs(z,c)):X<=c&&(l.expiredLanes|=z),_&=~z}}function za(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function $a(){var l=Mi;return Mi<<=1,(Mi&4194240)===0&&(Mi=64),l}function ja(l){for(var c=[],h=0;31>h;h++)c.push(l);return c}function Uo(l,c,h){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-jn(c),l[c]=h}function _g(l,c){var h=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var g=l.eventTimes;for(l=l.expirationTimes;0<h;){var y=31-jn(h),_=1<<y;c[y]=0,g[y]=-1,l[y]=-1,h&=~_}}function P(l,c){var h=l.entangledLanes|=c;for(l=l.entanglements;h;){var g=31-jn(h),y=1<<g;y&c|l[g]&c&&(l[g]|=c),h&=~y}}var k=0;function j(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var fe,xe,Ne,lt,dn,hn=!1,gn=[],Sn=null,Ni=null,Di=null,yc=new Map,_c=new Map,Li=[],wR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Q1(l,c){switch(l){case"focusin":case"focusout":Sn=null;break;case"dragenter":case"dragleave":Ni=null;break;case"mouseover":case"mouseout":Di=null;break;case"pointerover":case"pointerout":yc.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":_c.delete(c.pointerId)}}function xc(l,c,h,g,y,_){return l===null||l.nativeEvent!==_?(l={blockedOn:c,domEventName:h,eventSystemFlags:g,nativeEvent:_,targetContainers:[y]},c!==null&&(c=Nc(c),c!==null&&xe(c)),l):(l.eventSystemFlags|=g,c=l.targetContainers,y!==null&&c.indexOf(y)===-1&&c.push(y),l)}function TR(l,c,h,g,y){switch(c){case"focusin":return Sn=xc(Sn,l,c,h,g,y),!0;case"dragenter":return Ni=xc(Ni,l,c,h,g,y),!0;case"mouseover":return Di=xc(Di,l,c,h,g,y),!0;case"pointerover":var _=y.pointerId;return yc.set(_,xc(yc.get(_)||null,l,c,h,g,y)),!0;case"gotpointercapture":return _=y.pointerId,_c.set(_,xc(_c.get(_)||null,l,c,h,g,y)),!0}return!1}function G1(l){var c=Vo(l.target);if(c!==null){var h=zr(c);if(h!==null){if(c=h.tag,c===13){if(c=Fo(h),c!==null){l.blockedOn=c,dn(l.priority,function(){Ne(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){l.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Lf(l){if(l.blockedOn!==null)return!1;for(var c=l.targetContainers;0<c.length;){var h=bg(l.domEventName,l.eventSystemFlags,c[0],l.nativeEvent);if(h===null){h=l.nativeEvent;var g=new h.constructor(h.type,h);kn=g,h.target.dispatchEvent(g),kn=null}else return c=Nc(h),c!==null&&xe(c),l.blockedOn=h,!1;c.shift()}return!0}function J1(l,c,h){Lf(l)&&h.delete(c)}function SR(){hn=!1,Sn!==null&&Lf(Sn)&&(Sn=null),Ni!==null&&Lf(Ni)&&(Ni=null),Di!==null&&Lf(Di)&&(Di=null),yc.forEach(J1),_c.forEach(J1)}function bc(l,c){l.blockedOn===c&&(l.blockedOn=null,hn||(hn=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,SR)))}function wc(l){function c(y){return bc(y,l)}if(0<gn.length){bc(gn[0],l);for(var h=1;h<gn.length;h++){var g=gn[h];g.blockedOn===l&&(g.blockedOn=null)}}for(Sn!==null&&bc(Sn,l),Ni!==null&&bc(Ni,l),Di!==null&&bc(Di,l),yc.forEach(c),_c.forEach(c),h=0;h<Li.length;h++)g=Li[h],g.blockedOn===l&&(g.blockedOn=null);for(;0<Li.length&&(h=Li[0],h.blockedOn===null);)G1(h),h.blockedOn===null&&Li.shift()}var Wa=O.ReactCurrentBatchConfig,Ff=!0;function ER(l,c,h,g){var y=k,_=Wa.transition;Wa.transition=null;try{k=1,xg(l,c,h,g)}finally{k=y,Wa.transition=_}}function AR(l,c,h,g){var y=k,_=Wa.transition;Wa.transition=null;try{k=4,xg(l,c,h,g)}finally{k=y,Wa.transition=_}}function xg(l,c,h,g){if(Ff){var y=bg(l,c,h,g);if(y===null)Bg(l,c,g,Bf,h),Q1(l,g);else if(TR(y,l,c,h,g))g.stopPropagation();else if(Q1(l,g),c&4&&-1<wR.indexOf(l)){for(;y!==null;){var _=Nc(y);if(_!==null&&fe(_),_=bg(l,c,h,g),_===null&&Bg(l,c,g,Bf,h),_===y)break;y=_}y!==null&&g.stopPropagation()}else Bg(l,c,g,null,h)}}var Bf=null;function bg(l,c,h,g){if(Bf=null,l=Zs(g),l=Vo(l),l!==null)if(c=zr(l),c===null)l=null;else if(h=c.tag,h===13){if(l=Fo(c),l!==null)return l;l=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;l=null}else c!==l&&(l=null);return Bf=l,null}function ex(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hr()){case Cs:return 1;case as:return 4;case pr:case Bo:return 16;case Er:return 536870912;default:return 16}default:return 16}}var Fi=null,wg=null,Uf=null;function tx(){if(Uf)return Uf;var l,c=wg,h=c.length,g,y="value"in Fi?Fi.value:Fi.textContent,_=y.length;for(l=0;l<h&&c[l]===y[l];l++);var A=h-l;for(g=1;g<=A&&c[h-g]===y[_-g];g++);return Uf=y.slice(l,1<g?1-g:void 0)}function Vf(l){var c=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&c===13&&(l=13)):l=c,l===10&&(l=13),32<=l||l===13?l:0}function zf(){return!0}function nx(){return!1}function Rr(l){function c(h,g,y,_,A){this._reactName=h,this._targetInst=y,this.type=g,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var z in l)l.hasOwnProperty(z)&&(h=l[z],this[z]=h?h(_):_[z]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?zf:nx,this.isPropagationStopped=nx,this}return M(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=zf)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=zf)},persist:function(){},isPersistent:zf}),c}var Ha={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tg=Rr(Ha),Tc=M({},Ha,{view:0,detail:0}),CR=Rr(Tc),Sg,Eg,Sc,$f=M({},Tc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cg,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Sc&&(Sc&&l.type==="mousemove"?(Sg=l.screenX-Sc.screenX,Eg=l.screenY-Sc.screenY):Eg=Sg=0,Sc=l),Sg)},movementY:function(l){return"movementY"in l?l.movementY:Eg}}),rx=Rr($f),RR=M({},$f,{dataTransfer:0}),PR=Rr(RR),IR=M({},Tc,{relatedTarget:0}),Ag=Rr(IR),kR=M({},Ha,{animationName:0,elapsedTime:0,pseudoElement:0}),MR=Rr(kR),OR=M({},Ha,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),NR=Rr(OR),DR=M({},Ha,{data:0}),sx=Rr(DR),LR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UR(l){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(l):(l=BR[l])?!!c[l]:!1}function Cg(){return UR}var VR=M({},Tc,{key:function(l){if(l.key){var c=LR[l.key]||l.key;if(c!=="Unidentified")return c}return l.type==="keypress"?(l=Vf(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?FR[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cg,charCode:function(l){return l.type==="keypress"?Vf(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Vf(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),zR=Rr(VR),$R=M({},$f,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ix=Rr($R),jR=M({},Tc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cg}),WR=Rr(jR),HR=M({},Ha,{propertyName:0,elapsedTime:0,pseudoElement:0}),XR=Rr(HR),YR=M({},$f,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),qR=Rr(YR),KR=[9,13,27,32],Rg=a&&"CompositionEvent"in window,Ec=null;a&&"documentMode"in document&&(Ec=document.documentMode);var ZR=a&&"TextEvent"in window&&!Ec,ox=a&&(!Rg||Ec&&8<Ec&&11>=Ec),ax=" ",lx=!1;function cx(l,c){switch(l){case"keyup":return KR.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ux(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Xa=!1;function QR(l,c){switch(l){case"compositionend":return ux(c);case"keypress":return c.which!==32?null:(lx=!0,ax);case"textInput":return l=c.data,l===ax&&lx?null:l;default:return null}}function GR(l,c){if(Xa)return l==="compositionend"||!Rg&&cx(l,c)?(l=tx(),Uf=wg=Fi=null,Xa=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return ox&&c.locale!=="ko"?null:c.data;default:return null}}var JR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fx(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c==="input"?!!JR[l.type]:c==="textarea"}function dx(l,c,h,g){Vr(g),c=Yf(c,"onChange"),0<c.length&&(h=new Tg("onChange","change",null,h,g),l.push({event:h,listeners:c}))}var Ac=null,Cc=null;function eP(l){Ix(l,0)}function jf(l){var c=Qa(l);if(Ke(c))return l}function tP(l,c){if(l==="change")return c}var hx=!1;if(a){var Pg;if(a){var Ig="oninput"in document;if(!Ig){var px=document.createElement("div");px.setAttribute("oninput","return;"),Ig=typeof px.oninput=="function"}Pg=Ig}else Pg=!1;hx=Pg&&(!document.documentMode||9<document.documentMode)}function gx(){Ac&&(Ac.detachEvent("onpropertychange",mx),Cc=Ac=null)}function mx(l){if(l.propertyName==="value"&&jf(Cc)){var c=[];dx(c,Cc,l,Zs(l)),Ua(eP,c)}}function nP(l,c,h){l==="focusin"?(gx(),Ac=c,Cc=h,Ac.attachEvent("onpropertychange",mx)):l==="focusout"&&gx()}function rP(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return jf(Cc)}function sP(l,c){if(l==="click")return jf(c)}function iP(l,c){if(l==="input"||l==="change")return jf(c)}function oP(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var ls=typeof Object.is=="function"?Object.is:oP;function Rc(l,c){if(ls(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var h=Object.keys(l),g=Object.keys(c);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var y=h[g];if(!u.call(c,y)||!ls(l[y],c[y]))return!1}return!0}function vx(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function yx(l,c){var h=vx(l);l=0;for(var g;h;){if(h.nodeType===3){if(g=l+h.textContent.length,l<=c&&g>=c)return{node:h,offset:c-l};l=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=vx(h)}}function _x(l,c){return l&&c?l===c?!0:l&&l.nodeType===3?!1:c&&c.nodeType===3?_x(l,c.parentNode):"contains"in l?l.contains(c):l.compareDocumentPosition?!!(l.compareDocumentPosition(c)&16):!1:!1}function xx(){for(var l=window,c=nt();c instanceof l.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)l=c.contentWindow;else break;c=nt(l.document)}return c}function kg(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c&&(c==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||c==="textarea"||l.contentEditable==="true")}function aP(l){var c=xx(),h=l.focusedElem,g=l.selectionRange;if(c!==h&&h&&h.ownerDocument&&_x(h.ownerDocument.documentElement,h)){if(g!==null&&kg(h)){if(c=g.start,l=g.end,l===void 0&&(l=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(l,h.value.length);else if(l=(c=h.ownerDocument||document)&&c.defaultView||window,l.getSelection){l=l.getSelection();var y=h.textContent.length,_=Math.min(g.start,y);g=g.end===void 0?_:Math.min(g.end,y),!l.extend&&_>g&&(y=g,g=_,_=y),y=yx(h,_);var A=yx(h,g);y&&A&&(l.rangeCount!==1||l.anchorNode!==y.node||l.anchorOffset!==y.offset||l.focusNode!==A.node||l.focusOffset!==A.offset)&&(c=c.createRange(),c.setStart(y.node,y.offset),l.removeAllRanges(),_>g?(l.addRange(c),l.extend(A.node,A.offset)):(c.setEnd(A.node,A.offset),l.addRange(c)))}}for(c=[],l=h;l=l.parentNode;)l.nodeType===1&&c.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)l=c[h],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var lP=a&&"documentMode"in document&&11>=document.documentMode,Ya=null,Mg=null,Pc=null,Og=!1;function bx(l,c,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Og||Ya==null||Ya!==nt(g)||(g=Ya,"selectionStart"in g&&kg(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Pc&&Rc(Pc,g)||(Pc=g,g=Yf(Mg,"onSelect"),0<g.length&&(c=new Tg("onSelect","select",null,c,h),l.push({event:c,listeners:g}),c.target=Ya)))}function Wf(l,c){var h={};return h[l.toLowerCase()]=c.toLowerCase(),h["Webkit"+l]="webkit"+c,h["Moz"+l]="moz"+c,h}var qa={animationend:Wf("Animation","AnimationEnd"),animationiteration:Wf("Animation","AnimationIteration"),animationstart:Wf("Animation","AnimationStart"),transitionend:Wf("Transition","TransitionEnd")},Ng={},wx={};a&&(wx=document.createElement("div").style,"AnimationEvent"in window||(delete qa.animationend.animation,delete qa.animationiteration.animation,delete qa.animationstart.animation),"TransitionEvent"in window||delete qa.transitionend.transition);function Hf(l){if(Ng[l])return Ng[l];if(!qa[l])return l;var c=qa[l],h;for(h in c)if(c.hasOwnProperty(h)&&h in wx)return Ng[l]=c[h];return l}var Tx=Hf("animationend"),Sx=Hf("animationiteration"),Ex=Hf("animationstart"),Ax=Hf("transitionend"),Cx=new Map,Rx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bi(l,c){Cx.set(l,c),i(c,[l])}for(var Dg=0;Dg<Rx.length;Dg++){var Lg=Rx[Dg],cP=Lg.toLowerCase(),uP=Lg[0].toUpperCase()+Lg.slice(1);Bi(cP,"on"+uP)}Bi(Tx,"onAnimationEnd"),Bi(Sx,"onAnimationIteration"),Bi(Ex,"onAnimationStart"),Bi("dblclick","onDoubleClick"),Bi("focusin","onFocus"),Bi("focusout","onBlur"),Bi(Ax,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ic="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ic));function Px(l,c,h){var g=l.type||"unknown-event";l.currentTarget=h,Ii(g,c,void 0,l),l.currentTarget=null}function Ix(l,c){c=(c&4)!==0;for(var h=0;h<l.length;h++){var g=l[h],y=g.event;g=g.listeners;e:{var _=void 0;if(c)for(var A=g.length-1;0<=A;A--){var z=g[A],X=z.instance,de=z.currentTarget;if(z=z.listener,X!==_&&y.isPropagationStopped())break e;Px(y,z,de),_=X}else for(A=0;A<g.length;A++){if(z=g[A],X=z.instance,de=z.currentTarget,z=z.listener,X!==_&&y.isPropagationStopped())break e;Px(y,z,de),_=X}}}if(wt)throw l=Ss,wt=!1,Ss=null,l}function qt(l,c){var h=c[Wg];h===void 0&&(h=c[Wg]=new Set);var g=l+"__bubble";h.has(g)||(kx(c,l,2,!1),h.add(g))}function Fg(l,c,h){var g=0;c&&(g|=4),kx(h,l,g,c)}var Xf="_reactListening"+Math.random().toString(36).slice(2);function kc(l){if(!l[Xf]){l[Xf]=!0,r.forEach(function(h){h!=="selectionchange"&&(fP.has(h)||Fg(h,!1,l),Fg(h,!0,l))});var c=l.nodeType===9?l:l.ownerDocument;c===null||c[Xf]||(c[Xf]=!0,Fg("selectionchange",!1,c))}}function kx(l,c,h,g){switch(ex(c)){case 1:var y=ER;break;case 4:y=AR;break;default:y=xg}h=y.bind(null,c,h,l),y=void 0,!Xe||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(y=!0),g?y!==void 0?l.addEventListener(c,h,{capture:!0,passive:y}):l.addEventListener(c,h,!0):y!==void 0?l.addEventListener(c,h,{passive:y}):l.addEventListener(c,h,!1)}function Bg(l,c,h,g,y){var _=g;if((c&1)===0&&(c&2)===0&&g!==null)e:for(;;){if(g===null)return;var A=g.tag;if(A===3||A===4){var z=g.stateNode.containerInfo;if(z===y||z.nodeType===8&&z.parentNode===y)break;if(A===4)for(A=g.return;A!==null;){var X=A.tag;if((X===3||X===4)&&(X=A.stateNode.containerInfo,X===y||X.nodeType===8&&X.parentNode===y))return;A=A.return}for(;z!==null;){if(A=Vo(z),A===null)return;if(X=A.tag,X===5||X===6){g=_=A;continue e}z=z.parentNode}}g=g.return}Ua(function(){var de=_,we=Zs(h),Se=[];e:{var _e=Cx.get(l);if(_e!==void 0){var De=Tg,Ve=l;switch(l){case"keypress":if(Vf(h)===0)break e;case"keydown":case"keyup":De=zR;break;case"focusin":Ve="focus",De=Ag;break;case"focusout":Ve="blur",De=Ag;break;case"beforeblur":case"afterblur":De=Ag;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":De=rx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":De=PR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":De=WR;break;case Tx:case Sx:case Ex:De=MR;break;case Ax:De=XR;break;case"scroll":De=CR;break;case"wheel":De=qR;break;case"copy":case"cut":case"paste":De=NR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":De=ix}var $e=(c&4)!==0,pn=!$e&&l==="scroll",oe=$e?_e!==null?_e+"Capture":null:_e;$e=[];for(var Q=de,ce;Q!==null;){ce=Q;var Ce=ce.stateNode;if(ce.tag===5&&Ce!==null&&(ce=Ce,oe!==null&&(Ce=ze(Q,oe),Ce!=null&&$e.push(Mc(Q,Ce,ce)))),pn)break;Q=Q.return}0<$e.length&&(_e=new De(_e,Ve,null,h,we),Se.push({event:_e,listeners:$e}))}}if((c&7)===0){e:{if(_e=l==="mouseover"||l==="pointerover",De=l==="mouseout"||l==="pointerout",_e&&h!==kn&&(Ve=h.relatedTarget||h.fromElement)&&(Vo(Ve)||Ve[Js]))break e;if((De||_e)&&(_e=we.window===we?we:(_e=we.ownerDocument)?_e.defaultView||_e.parentWindow:window,De?(Ve=h.relatedTarget||h.toElement,De=de,Ve=Ve?Vo(Ve):null,Ve!==null&&(pn=zr(Ve),Ve!==pn||Ve.tag!==5&&Ve.tag!==6)&&(Ve=null)):(De=null,Ve=de),De!==Ve)){if($e=rx,Ce="onMouseLeave",oe="onMouseEnter",Q="mouse",(l==="pointerout"||l==="pointerover")&&($e=ix,Ce="onPointerLeave",oe="onPointerEnter",Q="pointer"),pn=De==null?_e:Qa(De),ce=Ve==null?_e:Qa(Ve),_e=new $e(Ce,Q+"leave",De,h,we),_e.target=pn,_e.relatedTarget=ce,Ce=null,Vo(we)===de&&($e=new $e(oe,Q+"enter",Ve,h,we),$e.target=ce,$e.relatedTarget=pn,Ce=$e),pn=Ce,De&&Ve)t:{for($e=De,oe=Ve,Q=0,ce=$e;ce;ce=Ka(ce))Q++;for(ce=0,Ce=oe;Ce;Ce=Ka(Ce))ce++;for(;0<Q-ce;)$e=Ka($e),Q--;for(;0<ce-Q;)oe=Ka(oe),ce--;for(;Q--;){if($e===oe||oe!==null&&$e===oe.alternate)break t;$e=Ka($e),oe=Ka(oe)}$e=null}else $e=null;De!==null&&Mx(Se,_e,De,$e,!1),Ve!==null&&pn!==null&&Mx(Se,pn,Ve,$e,!0)}}e:{if(_e=de?Qa(de):window,De=_e.nodeName&&_e.nodeName.toLowerCase(),De==="select"||De==="input"&&_e.type==="file")var je=tP;else if(fx(_e))if(hx)je=iP;else{je=rP;var Ye=nP}else(De=_e.nodeName)&&De.toLowerCase()==="input"&&(_e.type==="checkbox"||_e.type==="radio")&&(je=sP);if(je&&(je=je(l,de))){dx(Se,je,h,we);break e}Ye&&Ye(l,_e,de),l==="focusout"&&(Ye=_e._wrapperState)&&Ye.controlled&&_e.type==="number"&&$t(_e,"number",_e.value)}switch(Ye=de?Qa(de):window,l){case"focusin":(fx(Ye)||Ye.contentEditable==="true")&&(Ya=Ye,Mg=de,Pc=null);break;case"focusout":Pc=Mg=Ya=null;break;case"mousedown":Og=!0;break;case"contextmenu":case"mouseup":case"dragend":Og=!1,bx(Se,h,we);break;case"selectionchange":if(lP)break;case"keydown":case"keyup":bx(Se,h,we)}var qe;if(Rg)e:{switch(l){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else Xa?cx(l,h)&&(et="onCompositionEnd"):l==="keydown"&&h.keyCode===229&&(et="onCompositionStart");et&&(ox&&h.locale!=="ko"&&(Xa||et!=="onCompositionStart"?et==="onCompositionEnd"&&Xa&&(qe=tx()):(Fi=we,wg="value"in Fi?Fi.value:Fi.textContent,Xa=!0)),Ye=Yf(de,et),0<Ye.length&&(et=new sx(et,l,null,h,we),Se.push({event:et,listeners:Ye}),qe?et.data=qe:(qe=ux(h),qe!==null&&(et.data=qe)))),(qe=ZR?QR(l,h):GR(l,h))&&(de=Yf(de,"onBeforeInput"),0<de.length&&(we=new sx("onBeforeInput","beforeinput",null,h,we),Se.push({event:we,listeners:de}),we.data=qe))}Ix(Se,c)})}function Mc(l,c,h){return{instance:l,listener:c,currentTarget:h}}function Yf(l,c){for(var h=c+"Capture",g=[];l!==null;){var y=l,_=y.stateNode;y.tag===5&&_!==null&&(y=_,_=ze(l,h),_!=null&&g.unshift(Mc(l,_,y)),_=ze(l,c),_!=null&&g.push(Mc(l,_,y))),l=l.return}return g}function Ka(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function Mx(l,c,h,g,y){for(var _=c._reactName,A=[];h!==null&&h!==g;){var z=h,X=z.alternate,de=z.stateNode;if(X!==null&&X===g)break;z.tag===5&&de!==null&&(z=de,y?(X=ze(h,_),X!=null&&A.unshift(Mc(h,X,z))):y||(X=ze(h,_),X!=null&&A.push(Mc(h,X,z)))),h=h.return}A.length!==0&&l.push({event:c,listeners:A})}var dP=/\r\n?/g,hP=/\u0000|\uFFFD/g;function Ox(l){return(typeof l=="string"?l:""+l).replace(dP,`
`).replace(hP,"")}function qf(l,c,h){if(c=Ox(c),Ox(l)!==c&&h)throw Error(t(425))}function Kf(){}var Ug=null,Vg=null;function zg(l,c){return l==="textarea"||l==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var $g=typeof setTimeout=="function"?setTimeout:void 0,pP=typeof clearTimeout=="function"?clearTimeout:void 0,Nx=typeof Promise=="function"?Promise:void 0,gP=typeof queueMicrotask=="function"?queueMicrotask:typeof Nx<"u"?function(l){return Nx.resolve(null).then(l).catch(mP)}:$g;function mP(l){setTimeout(function(){throw l})}function jg(l,c){var h=c,g=0;do{var y=h.nextSibling;if(l.removeChild(h),y&&y.nodeType===8)if(h=y.data,h==="/$"){if(g===0){l.removeChild(y),wc(c);return}g--}else h!=="$"&&h!=="$?"&&h!=="$!"||g++;h=y}while(h);wc(c)}function Ui(l){for(;l!=null;l=l.nextSibling){var c=l.nodeType;if(c===1||c===3)break;if(c===8){if(c=l.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return l}function Dx(l){l=l.previousSibling;for(var c=0;l;){if(l.nodeType===8){var h=l.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return l;c--}else h==="/$"&&c++}l=l.previousSibling}return null}var Za=Math.random().toString(36).slice(2),Ps="__reactFiber$"+Za,Oc="__reactProps$"+Za,Js="__reactContainer$"+Za,Wg="__reactEvents$"+Za,vP="__reactListeners$"+Za,yP="__reactHandles$"+Za;function Vo(l){var c=l[Ps];if(c)return c;for(var h=l.parentNode;h;){if(c=h[Js]||h[Ps]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(l=Dx(l);l!==null;){if(h=l[Ps])return h;l=Dx(l)}return c}l=h,h=l.parentNode}return null}function Nc(l){return l=l[Ps]||l[Js],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Qa(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function Zf(l){return l[Oc]||null}var Hg=[],Ga=-1;function Vi(l){return{current:l}}function Kt(l){0>Ga||(l.current=Hg[Ga],Hg[Ga]=null,Ga--)}function Wt(l,c){Ga++,Hg[Ga]=l.current,l.current=c}var zi={},Wn=Vi(zi),mr=Vi(!1),zo=zi;function Ja(l,c){var h=l.type.contextTypes;if(!h)return zi;var g=l.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===c)return g.__reactInternalMemoizedMaskedChildContext;var y={},_;for(_ in h)y[_]=c[_];return g&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=y),y}function vr(l){return l=l.childContextTypes,l!=null}function Qf(){Kt(mr),Kt(Wn)}function Lx(l,c,h){if(Wn.current!==zi)throw Error(t(168));Wt(Wn,c),Wt(mr,h)}function Fx(l,c,h){var g=l.stateNode;if(c=c.childContextTypes,typeof g.getChildContext!="function")return h;g=g.getChildContext();for(var y in g)if(!(y in c))throw Error(t(108,ue(l)||"Unknown",y));return M({},h,g)}function Gf(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||zi,zo=Wn.current,Wt(Wn,l),Wt(mr,mr.current),!0}function Bx(l,c,h){var g=l.stateNode;if(!g)throw Error(t(169));h?(l=Fx(l,c,zo),g.__reactInternalMemoizedMergedChildContext=l,Kt(mr),Kt(Wn),Wt(Wn,l)):Kt(mr),Wt(mr,h)}var ei=null,Jf=!1,Xg=!1;function Ux(l){ei===null?ei=[l]:ei.push(l)}function _P(l){Jf=!0,Ux(l)}function $i(){if(!Xg&&ei!==null){Xg=!0;var l=0,c=k;try{var h=ei;for(k=1;l<h.length;l++){var g=h[l];do g=g(!0);while(g!==null)}ei=null,Jf=!1}catch(y){throw ei!==null&&(ei=ei.slice(l+1)),dr(Cs,$i),y}finally{k=c,Xg=!1}}return null}var el=[],tl=0,ed=null,td=0,jr=[],Wr=0,$o=null,ti=1,ni="";function jo(l,c){el[tl++]=td,el[tl++]=ed,ed=l,td=c}function Vx(l,c,h){jr[Wr++]=ti,jr[Wr++]=ni,jr[Wr++]=$o,$o=l;var g=ti;l=ni;var y=32-jn(g)-1;g&=~(1<<y),h+=1;var _=32-jn(c)+y;if(30<_){var A=y-y%5;_=(g&(1<<A)-1).toString(32),g>>=A,y-=A,ti=1<<32-jn(c)+y|h<<y|g,ni=_+l}else ti=1<<_|h<<y|g,ni=l}function Yg(l){l.return!==null&&(jo(l,1),Vx(l,1,0))}function qg(l){for(;l===ed;)ed=el[--tl],el[tl]=null,td=el[--tl],el[tl]=null;for(;l===$o;)$o=jr[--Wr],jr[Wr]=null,ni=jr[--Wr],jr[Wr]=null,ti=jr[--Wr],jr[Wr]=null}var Pr=null,Ir=null,Gt=!1,cs=null;function zx(l,c){var h=qr(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=l,c=l.deletions,c===null?(l.deletions=[h],l.flags|=16):c.push(h)}function $x(l,c){switch(l.tag){case 5:var h=l.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(l.stateNode=c,Pr=l,Ir=Ui(c.firstChild),!0):!1;case 6:return c=l.pendingProps===""||c.nodeType!==3?null:c,c!==null?(l.stateNode=c,Pr=l,Ir=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=$o!==null?{id:ti,overflow:ni}:null,l.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=qr(18,null,null,0),h.stateNode=c,h.return=l,l.child=h,Pr=l,Ir=null,!0):!1;default:return!1}}function Kg(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Zg(l){if(Gt){var c=Ir;if(c){var h=c;if(!$x(l,c)){if(Kg(l))throw Error(t(418));c=Ui(h.nextSibling);var g=Pr;c&&$x(l,c)?zx(g,h):(l.flags=l.flags&-4097|2,Gt=!1,Pr=l)}}else{if(Kg(l))throw Error(t(418));l.flags=l.flags&-4097|2,Gt=!1,Pr=l}}}function jx(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Pr=l}function nd(l){if(l!==Pr)return!1;if(!Gt)return jx(l),Gt=!0,!1;var c;if((c=l.tag!==3)&&!(c=l.tag!==5)&&(c=l.type,c=c!=="head"&&c!=="body"&&!zg(l.type,l.memoizedProps)),c&&(c=Ir)){if(Kg(l))throw Wx(),Error(t(418));for(;c;)zx(l,c),c=Ui(c.nextSibling)}if(jx(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,c=0;l;){if(l.nodeType===8){var h=l.data;if(h==="/$"){if(c===0){Ir=Ui(l.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}l=l.nextSibling}Ir=null}}else Ir=Pr?Ui(l.stateNode.nextSibling):null;return!0}function Wx(){for(var l=Ir;l;)l=Ui(l.nextSibling)}function nl(){Ir=Pr=null,Gt=!1}function Qg(l){cs===null?cs=[l]:cs.push(l)}var xP=O.ReactCurrentBatchConfig;function Dc(l,c,h){if(l=h.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var g=h.stateNode}if(!g)throw Error(t(147,l));var y=g,_=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===_?c.ref:(c=function(A){var z=y.refs;A===null?delete z[_]:z[_]=A},c._stringRef=_,c)}if(typeof l!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,l))}return l}function rd(l,c){throw l=Object.prototype.toString.call(c),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function Hx(l){var c=l._init;return c(l._payload)}function Xx(l){function c(oe,Q){if(l){var ce=oe.deletions;ce===null?(oe.deletions=[Q],oe.flags|=16):ce.push(Q)}}function h(oe,Q){if(!l)return null;for(;Q!==null;)c(oe,Q),Q=Q.sibling;return null}function g(oe,Q){for(oe=new Map;Q!==null;)Q.key!==null?oe.set(Q.key,Q):oe.set(Q.index,Q),Q=Q.sibling;return oe}function y(oe,Q){return oe=Zi(oe,Q),oe.index=0,oe.sibling=null,oe}function _(oe,Q,ce){return oe.index=ce,l?(ce=oe.alternate,ce!==null?(ce=ce.index,ce<Q?(oe.flags|=2,Q):ce):(oe.flags|=2,Q)):(oe.flags|=1048576,Q)}function A(oe){return l&&oe.alternate===null&&(oe.flags|=2),oe}function z(oe,Q,ce,Ce){return Q===null||Q.tag!==6?(Q=$m(ce,oe.mode,Ce),Q.return=oe,Q):(Q=y(Q,ce),Q.return=oe,Q)}function X(oe,Q,ce,Ce){var je=ce.type;return je===$?we(oe,Q,ce.props.children,Ce,ce.key):Q!==null&&(Q.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===U&&Hx(je)===Q.type)?(Ce=y(Q,ce.props),Ce.ref=Dc(oe,Q,ce),Ce.return=oe,Ce):(Ce=Cd(ce.type,ce.key,ce.props,null,oe.mode,Ce),Ce.ref=Dc(oe,Q,ce),Ce.return=oe,Ce)}function de(oe,Q,ce,Ce){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ce.containerInfo||Q.stateNode.implementation!==ce.implementation?(Q=jm(ce,oe.mode,Ce),Q.return=oe,Q):(Q=y(Q,ce.children||[]),Q.return=oe,Q)}function we(oe,Q,ce,Ce,je){return Q===null||Q.tag!==7?(Q=Qo(ce,oe.mode,Ce,je),Q.return=oe,Q):(Q=y(Q,ce),Q.return=oe,Q)}function Se(oe,Q,ce){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=$m(""+Q,oe.mode,ce),Q.return=oe,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case I:return ce=Cd(Q.type,Q.key,Q.props,null,oe.mode,ce),ce.ref=Dc(oe,null,Q),ce.return=oe,ce;case F:return Q=jm(Q,oe.mode,ce),Q.return=oe,Q;case U:var Ce=Q._init;return Se(oe,Ce(Q._payload),ce)}if(Ot(Q)||Y(Q))return Q=Qo(Q,oe.mode,ce,null),Q.return=oe,Q;rd(oe,Q)}return null}function _e(oe,Q,ce,Ce){var je=Q!==null?Q.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number")return je!==null?null:z(oe,Q,""+ce,Ce);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case I:return ce.key===je?X(oe,Q,ce,Ce):null;case F:return ce.key===je?de(oe,Q,ce,Ce):null;case U:return je=ce._init,_e(oe,Q,je(ce._payload),Ce)}if(Ot(ce)||Y(ce))return je!==null?null:we(oe,Q,ce,Ce,null);rd(oe,ce)}return null}function De(oe,Q,ce,Ce,je){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return oe=oe.get(ce)||null,z(Q,oe,""+Ce,je);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case I:return oe=oe.get(Ce.key===null?ce:Ce.key)||null,X(Q,oe,Ce,je);case F:return oe=oe.get(Ce.key===null?ce:Ce.key)||null,de(Q,oe,Ce,je);case U:var Ye=Ce._init;return De(oe,Q,ce,Ye(Ce._payload),je)}if(Ot(Ce)||Y(Ce))return oe=oe.get(ce)||null,we(Q,oe,Ce,je,null);rd(Q,Ce)}return null}function Ve(oe,Q,ce,Ce){for(var je=null,Ye=null,qe=Q,et=Q=0,Nn=null;qe!==null&&et<ce.length;et++){qe.index>et?(Nn=qe,qe=null):Nn=qe.sibling;var xt=_e(oe,qe,ce[et],Ce);if(xt===null){qe===null&&(qe=Nn);break}l&&qe&&xt.alternate===null&&c(oe,qe),Q=_(xt,Q,et),Ye===null?je=xt:Ye.sibling=xt,Ye=xt,qe=Nn}if(et===ce.length)return h(oe,qe),Gt&&jo(oe,et),je;if(qe===null){for(;et<ce.length;et++)qe=Se(oe,ce[et],Ce),qe!==null&&(Q=_(qe,Q,et),Ye===null?je=qe:Ye.sibling=qe,Ye=qe);return Gt&&jo(oe,et),je}for(qe=g(oe,qe);et<ce.length;et++)Nn=De(qe,oe,et,ce[et],Ce),Nn!==null&&(l&&Nn.alternate!==null&&qe.delete(Nn.key===null?et:Nn.key),Q=_(Nn,Q,et),Ye===null?je=Nn:Ye.sibling=Nn,Ye=Nn);return l&&qe.forEach(function(Qi){return c(oe,Qi)}),Gt&&jo(oe,et),je}function $e(oe,Q,ce,Ce){var je=Y(ce);if(typeof je!="function")throw Error(t(150));if(ce=je.call(ce),ce==null)throw Error(t(151));for(var Ye=je=null,qe=Q,et=Q=0,Nn=null,xt=ce.next();qe!==null&&!xt.done;et++,xt=ce.next()){qe.index>et?(Nn=qe,qe=null):Nn=qe.sibling;var Qi=_e(oe,qe,xt.value,Ce);if(Qi===null){qe===null&&(qe=Nn);break}l&&qe&&Qi.alternate===null&&c(oe,qe),Q=_(Qi,Q,et),Ye===null?je=Qi:Ye.sibling=Qi,Ye=Qi,qe=Nn}if(xt.done)return h(oe,qe),Gt&&jo(oe,et),je;if(qe===null){for(;!xt.done;et++,xt=ce.next())xt=Se(oe,xt.value,Ce),xt!==null&&(Q=_(xt,Q,et),Ye===null?je=xt:Ye.sibling=xt,Ye=xt);return Gt&&jo(oe,et),je}for(qe=g(oe,qe);!xt.done;et++,xt=ce.next())xt=De(qe,oe,et,xt.value,Ce),xt!==null&&(l&&xt.alternate!==null&&qe.delete(xt.key===null?et:xt.key),Q=_(xt,Q,et),Ye===null?je=xt:Ye.sibling=xt,Ye=xt);return l&&qe.forEach(function(JP){return c(oe,JP)}),Gt&&jo(oe,et),je}function pn(oe,Q,ce,Ce){if(typeof ce=="object"&&ce!==null&&ce.type===$&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case I:e:{for(var je=ce.key,Ye=Q;Ye!==null;){if(Ye.key===je){if(je=ce.type,je===$){if(Ye.tag===7){h(oe,Ye.sibling),Q=y(Ye,ce.props.children),Q.return=oe,oe=Q;break e}}else if(Ye.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===U&&Hx(je)===Ye.type){h(oe,Ye.sibling),Q=y(Ye,ce.props),Q.ref=Dc(oe,Ye,ce),Q.return=oe,oe=Q;break e}h(oe,Ye);break}else c(oe,Ye);Ye=Ye.sibling}ce.type===$?(Q=Qo(ce.props.children,oe.mode,Ce,ce.key),Q.return=oe,oe=Q):(Ce=Cd(ce.type,ce.key,ce.props,null,oe.mode,Ce),Ce.ref=Dc(oe,Q,ce),Ce.return=oe,oe=Ce)}return A(oe);case F:e:{for(Ye=ce.key;Q!==null;){if(Q.key===Ye)if(Q.tag===4&&Q.stateNode.containerInfo===ce.containerInfo&&Q.stateNode.implementation===ce.implementation){h(oe,Q.sibling),Q=y(Q,ce.children||[]),Q.return=oe,oe=Q;break e}else{h(oe,Q);break}else c(oe,Q);Q=Q.sibling}Q=jm(ce,oe.mode,Ce),Q.return=oe,oe=Q}return A(oe);case U:return Ye=ce._init,pn(oe,Q,Ye(ce._payload),Ce)}if(Ot(ce))return Ve(oe,Q,ce,Ce);if(Y(ce))return $e(oe,Q,ce,Ce);rd(oe,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"?(ce=""+ce,Q!==null&&Q.tag===6?(h(oe,Q.sibling),Q=y(Q,ce),Q.return=oe,oe=Q):(h(oe,Q),Q=$m(ce,oe.mode,Ce),Q.return=oe,oe=Q),A(oe)):h(oe,Q)}return pn}var rl=Xx(!0),Yx=Xx(!1),sd=Vi(null),id=null,sl=null,Gg=null;function Jg(){Gg=sl=id=null}function em(l){var c=sd.current;Kt(sd),l._currentValue=c}function tm(l,c,h){for(;l!==null;){var g=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,g!==null&&(g.childLanes|=c)):g!==null&&(g.childLanes&c)!==c&&(g.childLanes|=c),l===h)break;l=l.return}}function il(l,c){id=l,Gg=sl=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&c)!==0&&(yr=!0),l.firstContext=null)}function Hr(l){var c=l._currentValue;if(Gg!==l)if(l={context:l,memoizedValue:c,next:null},sl===null){if(id===null)throw Error(t(308));sl=l,id.dependencies={lanes:0,firstContext:l}}else sl=sl.next=l;return c}var Wo=null;function nm(l){Wo===null?Wo=[l]:Wo.push(l)}function qx(l,c,h,g){var y=c.interleaved;return y===null?(h.next=h,nm(c)):(h.next=y.next,y.next=h),c.interleaved=h,ri(l,g)}function ri(l,c){l.lanes|=c;var h=l.alternate;for(h!==null&&(h.lanes|=c),h=l,l=l.return;l!==null;)l.childLanes|=c,h=l.alternate,h!==null&&(h.childLanes|=c),h=l,l=l.return;return h.tag===3?h.stateNode:null}var ji=!1;function rm(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kx(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function si(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function Wi(l,c,h){var g=l.updateQueue;if(g===null)return null;if(g=g.shared,(vt&2)!==0){var y=g.pending;return y===null?c.next=c:(c.next=y.next,y.next=c),g.pending=c,ri(l,h)}return y=g.interleaved,y===null?(c.next=c,nm(g)):(c.next=y.next,y.next=c),g.interleaved=c,ri(l,h)}function od(l,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var g=c.lanes;g&=l.pendingLanes,h|=g,c.lanes=h,P(l,h)}}function Zx(l,c){var h=l.updateQueue,g=l.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var y=null,_=null;if(h=h.firstBaseUpdate,h!==null){do{var A={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};_===null?y=_=A:_=_.next=A,h=h.next}while(h!==null);_===null?y=_=c:_=_.next=c}else y=_=c;h={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:_,shared:g.shared,effects:g.effects},l.updateQueue=h;return}l=h.lastBaseUpdate,l===null?h.firstBaseUpdate=c:l.next=c,h.lastBaseUpdate=c}function ad(l,c,h,g){var y=l.updateQueue;ji=!1;var _=y.firstBaseUpdate,A=y.lastBaseUpdate,z=y.shared.pending;if(z!==null){y.shared.pending=null;var X=z,de=X.next;X.next=null,A===null?_=de:A.next=de,A=X;var we=l.alternate;we!==null&&(we=we.updateQueue,z=we.lastBaseUpdate,z!==A&&(z===null?we.firstBaseUpdate=de:z.next=de,we.lastBaseUpdate=X))}if(_!==null){var Se=y.baseState;A=0,we=de=X=null,z=_;do{var _e=z.lane,De=z.eventTime;if((g&_e)===_e){we!==null&&(we=we.next={eventTime:De,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var Ve=l,$e=z;switch(_e=c,De=h,$e.tag){case 1:if(Ve=$e.payload,typeof Ve=="function"){Se=Ve.call(De,Se,_e);break e}Se=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=$e.payload,_e=typeof Ve=="function"?Ve.call(De,Se,_e):Ve,_e==null)break e;Se=M({},Se,_e);break e;case 2:ji=!0}}z.callback!==null&&z.lane!==0&&(l.flags|=64,_e=y.effects,_e===null?y.effects=[z]:_e.push(z))}else De={eventTime:De,lane:_e,tag:z.tag,payload:z.payload,callback:z.callback,next:null},we===null?(de=we=De,X=Se):we=we.next=De,A|=_e;if(z=z.next,z===null){if(z=y.shared.pending,z===null)break;_e=z,z=_e.next,_e.next=null,y.lastBaseUpdate=_e,y.shared.pending=null}}while(!0);if(we===null&&(X=Se),y.baseState=X,y.firstBaseUpdate=de,y.lastBaseUpdate=we,c=y.shared.interleaved,c!==null){y=c;do A|=y.lane,y=y.next;while(y!==c)}else _===null&&(y.shared.lanes=0);Yo|=A,l.lanes=A,l.memoizedState=Se}}function Qx(l,c,h){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var g=l[c],y=g.callback;if(y!==null){if(g.callback=null,g=h,typeof y!="function")throw Error(t(191,y));y.call(g)}}}var Lc={},Is=Vi(Lc),Fc=Vi(Lc),Bc=Vi(Lc);function Ho(l){if(l===Lc)throw Error(t(174));return l}function sm(l,c){switch(Wt(Bc,c),Wt(Fc,l),Wt(Is,Lc),l=c.nodeType,l){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Ur(null,"");break;default:l=l===8?c.parentNode:c,c=l.namespaceURI||null,l=l.tagName,c=Ur(c,l)}Kt(Is),Wt(Is,c)}function ol(){Kt(Is),Kt(Fc),Kt(Bc)}function Gx(l){Ho(Bc.current);var c=Ho(Is.current),h=Ur(c,l.type);c!==h&&(Wt(Fc,l),Wt(Is,h))}function im(l){Fc.current===l&&(Kt(Is),Kt(Fc))}var nn=Vi(0);function ld(l){for(var c=l;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var om=[];function am(){for(var l=0;l<om.length;l++)om[l]._workInProgressVersionPrimary=null;om.length=0}var cd=O.ReactCurrentDispatcher,lm=O.ReactCurrentBatchConfig,Xo=0,rn=null,En=null,Mn=null,ud=!1,Uc=!1,Vc=0,bP=0;function Hn(){throw Error(t(321))}function cm(l,c){if(c===null)return!1;for(var h=0;h<c.length&&h<l.length;h++)if(!ls(l[h],c[h]))return!1;return!0}function um(l,c,h,g,y,_){if(Xo=_,rn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,cd.current=l===null||l.memoizedState===null?EP:AP,l=h(g,y),Uc){_=0;do{if(Uc=!1,Vc=0,25<=_)throw Error(t(301));_+=1,Mn=En=null,c.updateQueue=null,cd.current=CP,l=h(g,y)}while(Uc)}if(cd.current=hd,c=En!==null&&En.next!==null,Xo=0,Mn=En=rn=null,ud=!1,c)throw Error(t(300));return l}function fm(){var l=Vc!==0;return Vc=0,l}function ks(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?rn.memoizedState=Mn=l:Mn=Mn.next=l,Mn}function Xr(){if(En===null){var l=rn.alternate;l=l!==null?l.memoizedState:null}else l=En.next;var c=Mn===null?rn.memoizedState:Mn.next;if(c!==null)Mn=c,En=l;else{if(l===null)throw Error(t(310));En=l,l={memoizedState:En.memoizedState,baseState:En.baseState,baseQueue:En.baseQueue,queue:En.queue,next:null},Mn===null?rn.memoizedState=Mn=l:Mn=Mn.next=l}return Mn}function zc(l,c){return typeof c=="function"?c(l):c}function dm(l){var c=Xr(),h=c.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=l;var g=En,y=g.baseQueue,_=h.pending;if(_!==null){if(y!==null){var A=y.next;y.next=_.next,_.next=A}g.baseQueue=y=_,h.pending=null}if(y!==null){_=y.next,g=g.baseState;var z=A=null,X=null,de=_;do{var we=de.lane;if((Xo&we)===we)X!==null&&(X=X.next={lane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),g=de.hasEagerState?de.eagerState:l(g,de.action);else{var Se={lane:we,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null};X===null?(z=X=Se,A=g):X=X.next=Se,rn.lanes|=we,Yo|=we}de=de.next}while(de!==null&&de!==_);X===null?A=g:X.next=z,ls(g,c.memoizedState)||(yr=!0),c.memoizedState=g,c.baseState=A,c.baseQueue=X,h.lastRenderedState=g}if(l=h.interleaved,l!==null){y=l;do _=y.lane,rn.lanes|=_,Yo|=_,y=y.next;while(y!==l)}else y===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function hm(l){var c=Xr(),h=c.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=l;var g=h.dispatch,y=h.pending,_=c.memoizedState;if(y!==null){h.pending=null;var A=y=y.next;do _=l(_,A.action),A=A.next;while(A!==y);ls(_,c.memoizedState)||(yr=!0),c.memoizedState=_,c.baseQueue===null&&(c.baseState=_),h.lastRenderedState=_}return[_,g]}function Jx(){}function e2(l,c){var h=rn,g=Xr(),y=c(),_=!ls(g.memoizedState,y);if(_&&(g.memoizedState=y,yr=!0),g=g.queue,pm(r2.bind(null,h,g,l),[l]),g.getSnapshot!==c||_||Mn!==null&&Mn.memoizedState.tag&1){if(h.flags|=2048,$c(9,n2.bind(null,h,g,y,c),void 0,null),On===null)throw Error(t(349));(Xo&30)!==0||t2(h,c,y)}return y}function t2(l,c,h){l.flags|=16384,l={getSnapshot:c,value:h},c=rn.updateQueue,c===null?(c={lastEffect:null,stores:null},rn.updateQueue=c,c.stores=[l]):(h=c.stores,h===null?c.stores=[l]:h.push(l))}function n2(l,c,h,g){c.value=h,c.getSnapshot=g,s2(c)&&i2(l)}function r2(l,c,h){return h(function(){s2(c)&&i2(l)})}function s2(l){var c=l.getSnapshot;l=l.value;try{var h=c();return!ls(l,h)}catch{return!0}}function i2(l){var c=ri(l,1);c!==null&&hs(c,l,1,-1)}function o2(l){var c=ks();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zc,lastRenderedState:l},c.queue=l,l=l.dispatch=SP.bind(null,rn,l),[c.memoizedState,l]}function $c(l,c,h,g){return l={tag:l,create:c,destroy:h,deps:g,next:null},c=rn.updateQueue,c===null?(c={lastEffect:null,stores:null},rn.updateQueue=c,c.lastEffect=l.next=l):(h=c.lastEffect,h===null?c.lastEffect=l.next=l:(g=h.next,h.next=l,l.next=g,c.lastEffect=l)),l}function a2(){return Xr().memoizedState}function fd(l,c,h,g){var y=ks();rn.flags|=l,y.memoizedState=$c(1|c,h,void 0,g===void 0?null:g)}function dd(l,c,h,g){var y=Xr();g=g===void 0?null:g;var _=void 0;if(En!==null){var A=En.memoizedState;if(_=A.destroy,g!==null&&cm(g,A.deps)){y.memoizedState=$c(c,h,_,g);return}}rn.flags|=l,y.memoizedState=$c(1|c,h,_,g)}function l2(l,c){return fd(8390656,8,l,c)}function pm(l,c){return dd(2048,8,l,c)}function c2(l,c){return dd(4,2,l,c)}function u2(l,c){return dd(4,4,l,c)}function f2(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function d2(l,c,h){return h=h!=null?h.concat([l]):null,dd(4,4,f2.bind(null,c,l),h)}function gm(){}function h2(l,c){var h=Xr();c=c===void 0?null:c;var g=h.memoizedState;return g!==null&&c!==null&&cm(c,g[1])?g[0]:(h.memoizedState=[l,c],l)}function p2(l,c){var h=Xr();c=c===void 0?null:c;var g=h.memoizedState;return g!==null&&c!==null&&cm(c,g[1])?g[0]:(l=l(),h.memoizedState=[l,c],l)}function g2(l,c,h){return(Xo&21)===0?(l.baseState&&(l.baseState=!1,yr=!0),l.memoizedState=h):(ls(h,c)||(h=$a(),rn.lanes|=h,Yo|=h,l.baseState=!0),c)}function wP(l,c){var h=k;k=h!==0&&4>h?h:4,l(!0);var g=lm.transition;lm.transition={};try{l(!1),c()}finally{k=h,lm.transition=g}}function m2(){return Xr().memoizedState}function TP(l,c,h){var g=qi(l);if(h={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null},v2(l))y2(c,h);else if(h=qx(l,c,h,g),h!==null){var y=ir();hs(h,l,g,y),_2(h,c,g)}}function SP(l,c,h){var g=qi(l),y={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null};if(v2(l))y2(c,y);else{var _=l.alternate;if(l.lanes===0&&(_===null||_.lanes===0)&&(_=c.lastRenderedReducer,_!==null))try{var A=c.lastRenderedState,z=_(A,h);if(y.hasEagerState=!0,y.eagerState=z,ls(z,A)){var X=c.interleaved;X===null?(y.next=y,nm(c)):(y.next=X.next,X.next=y),c.interleaved=y;return}}catch{}finally{}h=qx(l,c,y,g),h!==null&&(y=ir(),hs(h,l,g,y),_2(h,c,g))}}function v2(l){var c=l.alternate;return l===rn||c!==null&&c===rn}function y2(l,c){Uc=ud=!0;var h=l.pending;h===null?c.next=c:(c.next=h.next,h.next=c),l.pending=c}function _2(l,c,h){if((h&4194240)!==0){var g=c.lanes;g&=l.pendingLanes,h|=g,c.lanes=h,P(l,h)}}var hd={readContext:Hr,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useInsertionEffect:Hn,useLayoutEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useMutableSource:Hn,useSyncExternalStore:Hn,useId:Hn,unstable_isNewReconciler:!1},EP={readContext:Hr,useCallback:function(l,c){return ks().memoizedState=[l,c===void 0?null:c],l},useContext:Hr,useEffect:l2,useImperativeHandle:function(l,c,h){return h=h!=null?h.concat([l]):null,fd(4194308,4,f2.bind(null,c,l),h)},useLayoutEffect:function(l,c){return fd(4194308,4,l,c)},useInsertionEffect:function(l,c){return fd(4,2,l,c)},useMemo:function(l,c){var h=ks();return c=c===void 0?null:c,l=l(),h.memoizedState=[l,c],l},useReducer:function(l,c,h){var g=ks();return c=h!==void 0?h(c):c,g.memoizedState=g.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},g.queue=l,l=l.dispatch=TP.bind(null,rn,l),[g.memoizedState,l]},useRef:function(l){var c=ks();return l={current:l},c.memoizedState=l},useState:o2,useDebugValue:gm,useDeferredValue:function(l){return ks().memoizedState=l},useTransition:function(){var l=o2(!1),c=l[0];return l=wP.bind(null,l[1]),ks().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,h){var g=rn,y=ks();if(Gt){if(h===void 0)throw Error(t(407));h=h()}else{if(h=c(),On===null)throw Error(t(349));(Xo&30)!==0||t2(g,c,h)}y.memoizedState=h;var _={value:h,getSnapshot:c};return y.queue=_,l2(r2.bind(null,g,_,l),[l]),g.flags|=2048,$c(9,n2.bind(null,g,_,h,c),void 0,null),h},useId:function(){var l=ks(),c=On.identifierPrefix;if(Gt){var h=ni,g=ti;h=(g&~(1<<32-jn(g)-1)).toString(32)+h,c=":"+c+"R"+h,h=Vc++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=bP++,c=":"+c+"r"+h.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},AP={readContext:Hr,useCallback:h2,useContext:Hr,useEffect:pm,useImperativeHandle:d2,useInsertionEffect:c2,useLayoutEffect:u2,useMemo:p2,useReducer:dm,useRef:a2,useState:function(){return dm(zc)},useDebugValue:gm,useDeferredValue:function(l){var c=Xr();return g2(c,En.memoizedState,l)},useTransition:function(){var l=dm(zc)[0],c=Xr().memoizedState;return[l,c]},useMutableSource:Jx,useSyncExternalStore:e2,useId:m2,unstable_isNewReconciler:!1},CP={readContext:Hr,useCallback:h2,useContext:Hr,useEffect:pm,useImperativeHandle:d2,useInsertionEffect:c2,useLayoutEffect:u2,useMemo:p2,useReducer:hm,useRef:a2,useState:function(){return hm(zc)},useDebugValue:gm,useDeferredValue:function(l){var c=Xr();return En===null?c.memoizedState=l:g2(c,En.memoizedState,l)},useTransition:function(){var l=hm(zc)[0],c=Xr().memoizedState;return[l,c]},useMutableSource:Jx,useSyncExternalStore:e2,useId:m2,unstable_isNewReconciler:!1};function us(l,c){if(l&&l.defaultProps){c=M({},c),l=l.defaultProps;for(var h in l)c[h]===void 0&&(c[h]=l[h]);return c}return c}function mm(l,c,h,g){c=l.memoizedState,h=h(g,c),h=h==null?c:M({},c,h),l.memoizedState=h,l.lanes===0&&(l.updateQueue.baseState=h)}var pd={isMounted:function(l){return(l=l._reactInternals)?zr(l)===l:!1},enqueueSetState:function(l,c,h){l=l._reactInternals;var g=ir(),y=qi(l),_=si(g,y);_.payload=c,h!=null&&(_.callback=h),c=Wi(l,_,y),c!==null&&(hs(c,l,y,g),od(c,l,y))},enqueueReplaceState:function(l,c,h){l=l._reactInternals;var g=ir(),y=qi(l),_=si(g,y);_.tag=1,_.payload=c,h!=null&&(_.callback=h),c=Wi(l,_,y),c!==null&&(hs(c,l,y,g),od(c,l,y))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var h=ir(),g=qi(l),y=si(h,g);y.tag=2,c!=null&&(y.callback=c),c=Wi(l,y,g),c!==null&&(hs(c,l,g,h),od(c,l,g))}};function x2(l,c,h,g,y,_,A){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(g,_,A):c.prototype&&c.prototype.isPureReactComponent?!Rc(h,g)||!Rc(y,_):!0}function b2(l,c,h){var g=!1,y=zi,_=c.contextType;return typeof _=="object"&&_!==null?_=Hr(_):(y=vr(c)?zo:Wn.current,g=c.contextTypes,_=(g=g!=null)?Ja(l,y):zi),c=new c(h,_),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=pd,l.stateNode=c,c._reactInternals=l,g&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=y,l.__reactInternalMemoizedMaskedChildContext=_),c}function w2(l,c,h,g){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,g),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,g),c.state!==l&&pd.enqueueReplaceState(c,c.state,null)}function vm(l,c,h,g){var y=l.stateNode;y.props=h,y.state=l.memoizedState,y.refs={},rm(l);var _=c.contextType;typeof _=="object"&&_!==null?y.context=Hr(_):(_=vr(c)?zo:Wn.current,y.context=Ja(l,_)),y.state=l.memoizedState,_=c.getDerivedStateFromProps,typeof _=="function"&&(mm(l,c,_,h),y.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(c=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),c!==y.state&&pd.enqueueReplaceState(y,y.state,null),ad(l,h,y,g),y.state=l.memoizedState),typeof y.componentDidMount=="function"&&(l.flags|=4194308)}function al(l,c){try{var h="",g=c;do h+=te(g),g=g.return;while(g);var y=h}catch(_){y=`
Error generating stack: `+_.message+`
`+_.stack}return{value:l,source:c,stack:y,digest:null}}function ym(l,c,h){return{value:l,source:null,stack:h??null,digest:c??null}}function _m(l,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var RP=typeof WeakMap=="function"?WeakMap:Map;function T2(l,c,h){h=si(-1,h),h.tag=3,h.payload={element:null};var g=c.value;return h.callback=function(){bd||(bd=!0,Nm=g),_m(l,c)},h}function S2(l,c,h){h=si(-1,h),h.tag=3;var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var y=c.value;h.payload=function(){return g(y)},h.callback=function(){_m(l,c)}}var _=l.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(h.callback=function(){_m(l,c),typeof g!="function"&&(Xi===null?Xi=new Set([this]):Xi.add(this));var A=c.stack;this.componentDidCatch(c.value,{componentStack:A!==null?A:""})}),h}function E2(l,c,h){var g=l.pingCache;if(g===null){g=l.pingCache=new RP;var y=new Set;g.set(c,y)}else y=g.get(c),y===void 0&&(y=new Set,g.set(c,y));y.has(h)||(y.add(h),l=$P.bind(null,l,c,h),c.then(l,l))}function A2(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function C2(l,c,h,g,y){return(l.mode&1)===0?(l===c?l.flags|=65536:(l.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=si(-1,1),c.tag=2,Wi(h,c,1))),h.lanes|=1),l):(l.flags|=65536,l.lanes=y,l)}var PP=O.ReactCurrentOwner,yr=!1;function sr(l,c,h,g){c.child=l===null?Yx(c,null,h,g):rl(c,l.child,h,g)}function R2(l,c,h,g,y){h=h.render;var _=c.ref;return il(c,y),g=um(l,c,h,g,_,y),h=fm(),l!==null&&!yr?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~y,ii(l,c,y)):(Gt&&h&&Yg(c),c.flags|=1,sr(l,c,g,y),c.child)}function P2(l,c,h,g,y){if(l===null){var _=h.type;return typeof _=="function"&&!zm(_)&&_.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=_,I2(l,c,_,g,y)):(l=Cd(h.type,null,g,c,c.mode,y),l.ref=c.ref,l.return=c,c.child=l)}if(_=l.child,(l.lanes&y)===0){var A=_.memoizedProps;if(h=h.compare,h=h!==null?h:Rc,h(A,g)&&l.ref===c.ref)return ii(l,c,y)}return c.flags|=1,l=Zi(_,g),l.ref=c.ref,l.return=c,c.child=l}function I2(l,c,h,g,y){if(l!==null){var _=l.memoizedProps;if(Rc(_,g)&&l.ref===c.ref)if(yr=!1,c.pendingProps=g=_,(l.lanes&y)!==0)(l.flags&131072)!==0&&(yr=!0);else return c.lanes=l.lanes,ii(l,c,y)}return xm(l,c,h,g,y)}function k2(l,c,h){var g=c.pendingProps,y=g.children,_=l!==null?l.memoizedState:null;if(g.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wt(cl,kr),kr|=h;else{if((h&1073741824)===0)return l=_!==null?_.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,Wt(cl,kr),kr|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=_!==null?_.baseLanes:h,Wt(cl,kr),kr|=g}else _!==null?(g=_.baseLanes|h,c.memoizedState=null):g=h,Wt(cl,kr),kr|=g;return sr(l,c,y,h),c.child}function M2(l,c){var h=c.ref;(l===null&&h!==null||l!==null&&l.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function xm(l,c,h,g,y){var _=vr(h)?zo:Wn.current;return _=Ja(c,_),il(c,y),h=um(l,c,h,g,_,y),g=fm(),l!==null&&!yr?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~y,ii(l,c,y)):(Gt&&g&&Yg(c),c.flags|=1,sr(l,c,h,y),c.child)}function O2(l,c,h,g,y){if(vr(h)){var _=!0;Gf(c)}else _=!1;if(il(c,y),c.stateNode===null)md(l,c),b2(c,h,g),vm(c,h,g,y),g=!0;else if(l===null){var A=c.stateNode,z=c.memoizedProps;A.props=z;var X=A.context,de=h.contextType;typeof de=="object"&&de!==null?de=Hr(de):(de=vr(h)?zo:Wn.current,de=Ja(c,de));var we=h.getDerivedStateFromProps,Se=typeof we=="function"||typeof A.getSnapshotBeforeUpdate=="function";Se||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(z!==g||X!==de)&&w2(c,A,g,de),ji=!1;var _e=c.memoizedState;A.state=_e,ad(c,g,A,y),X=c.memoizedState,z!==g||_e!==X||mr.current||ji?(typeof we=="function"&&(mm(c,h,we,g),X=c.memoizedState),(z=ji||x2(c,h,z,g,_e,X,de))?(Se||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=g,c.memoizedState=X),A.props=g,A.state=X,A.context=de,g=z):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),g=!1)}else{A=c.stateNode,Kx(l,c),z=c.memoizedProps,de=c.type===c.elementType?z:us(c.type,z),A.props=de,Se=c.pendingProps,_e=A.context,X=h.contextType,typeof X=="object"&&X!==null?X=Hr(X):(X=vr(h)?zo:Wn.current,X=Ja(c,X));var De=h.getDerivedStateFromProps;(we=typeof De=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(z!==Se||_e!==X)&&w2(c,A,g,X),ji=!1,_e=c.memoizedState,A.state=_e,ad(c,g,A,y);var Ve=c.memoizedState;z!==Se||_e!==Ve||mr.current||ji?(typeof De=="function"&&(mm(c,h,De,g),Ve=c.memoizedState),(de=ji||x2(c,h,de,g,_e,Ve,X)||!1)?(we||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(g,Ve,X),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(g,Ve,X)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||z===l.memoizedProps&&_e===l.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||z===l.memoizedProps&&_e===l.memoizedState||(c.flags|=1024),c.memoizedProps=g,c.memoizedState=Ve),A.props=g,A.state=Ve,A.context=X,g=de):(typeof A.componentDidUpdate!="function"||z===l.memoizedProps&&_e===l.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||z===l.memoizedProps&&_e===l.memoizedState||(c.flags|=1024),g=!1)}return bm(l,c,h,g,_,y)}function bm(l,c,h,g,y,_){M2(l,c);var A=(c.flags&128)!==0;if(!g&&!A)return y&&Bx(c,h,!1),ii(l,c,_);g=c.stateNode,PP.current=c;var z=A&&typeof h.getDerivedStateFromError!="function"?null:g.render();return c.flags|=1,l!==null&&A?(c.child=rl(c,l.child,null,_),c.child=rl(c,null,z,_)):sr(l,c,z,_),c.memoizedState=g.state,y&&Bx(c,h,!0),c.child}function N2(l){var c=l.stateNode;c.pendingContext?Lx(l,c.pendingContext,c.pendingContext!==c.context):c.context&&Lx(l,c.context,!1),sm(l,c.containerInfo)}function D2(l,c,h,g,y){return nl(),Qg(y),c.flags|=256,sr(l,c,h,g),c.child}var wm={dehydrated:null,treeContext:null,retryLane:0};function Tm(l){return{baseLanes:l,cachePool:null,transitions:null}}function L2(l,c,h){var g=c.pendingProps,y=nn.current,_=!1,A=(c.flags&128)!==0,z;if((z=A)||(z=l!==null&&l.memoizedState===null?!1:(y&2)!==0),z?(_=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(y|=1),Wt(nn,y&1),l===null)return Zg(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((c.mode&1)===0?c.lanes=1:l.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(A=g.children,l=g.fallback,_?(g=c.mode,_=c.child,A={mode:"hidden",children:A},(g&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=A):_=Rd(A,g,0,null),l=Qo(l,g,h,null),_.return=c,l.return=c,_.sibling=l,c.child=_,c.child.memoizedState=Tm(h),c.memoizedState=wm,l):Sm(c,A));if(y=l.memoizedState,y!==null&&(z=y.dehydrated,z!==null))return IP(l,c,A,g,z,y,h);if(_){_=g.fallback,A=c.mode,y=l.child,z=y.sibling;var X={mode:"hidden",children:g.children};return(A&1)===0&&c.child!==y?(g=c.child,g.childLanes=0,g.pendingProps=X,c.deletions=null):(g=Zi(y,X),g.subtreeFlags=y.subtreeFlags&14680064),z!==null?_=Zi(z,_):(_=Qo(_,A,h,null),_.flags|=2),_.return=c,g.return=c,g.sibling=_,c.child=g,g=_,_=c.child,A=l.child.memoizedState,A=A===null?Tm(h):{baseLanes:A.baseLanes|h,cachePool:null,transitions:A.transitions},_.memoizedState=A,_.childLanes=l.childLanes&~h,c.memoizedState=wm,g}return _=l.child,l=_.sibling,g=Zi(_,{mode:"visible",children:g.children}),(c.mode&1)===0&&(g.lanes=h),g.return=c,g.sibling=null,l!==null&&(h=c.deletions,h===null?(c.deletions=[l],c.flags|=16):h.push(l)),c.child=g,c.memoizedState=null,g}function Sm(l,c){return c=Rd({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function gd(l,c,h,g){return g!==null&&Qg(g),rl(c,l.child,null,h),l=Sm(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function IP(l,c,h,g,y,_,A){if(h)return c.flags&256?(c.flags&=-257,g=ym(Error(t(422))),gd(l,c,A,g)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(_=g.fallback,y=c.mode,g=Rd({mode:"visible",children:g.children},y,0,null),_=Qo(_,y,A,null),_.flags|=2,g.return=c,_.return=c,g.sibling=_,c.child=g,(c.mode&1)!==0&&rl(c,l.child,null,A),c.child.memoizedState=Tm(A),c.memoizedState=wm,_);if((c.mode&1)===0)return gd(l,c,A,null);if(y.data==="$!"){if(g=y.nextSibling&&y.nextSibling.dataset,g)var z=g.dgst;return g=z,_=Error(t(419)),g=ym(_,g,void 0),gd(l,c,A,g)}if(z=(A&l.childLanes)!==0,yr||z){if(g=On,g!==null){switch(A&-A){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(g.suspendedLanes|A))!==0?0:y,y!==0&&y!==_.retryLane&&(_.retryLane=y,ri(l,y),hs(g,l,y,-1))}return Vm(),g=ym(Error(t(421))),gd(l,c,A,g)}return y.data==="$?"?(c.flags|=128,c.child=l.child,c=jP.bind(null,l),y._reactRetry=c,null):(l=_.treeContext,Ir=Ui(y.nextSibling),Pr=c,Gt=!0,cs=null,l!==null&&(jr[Wr++]=ti,jr[Wr++]=ni,jr[Wr++]=$o,ti=l.id,ni=l.overflow,$o=c),c=Sm(c,g.children),c.flags|=4096,c)}function F2(l,c,h){l.lanes|=c;var g=l.alternate;g!==null&&(g.lanes|=c),tm(l.return,c,h)}function Em(l,c,h,g,y){var _=l.memoizedState;_===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:y}:(_.isBackwards=c,_.rendering=null,_.renderingStartTime=0,_.last=g,_.tail=h,_.tailMode=y)}function B2(l,c,h){var g=c.pendingProps,y=g.revealOrder,_=g.tail;if(sr(l,c,g.children,h),g=nn.current,(g&2)!==0)g=g&1|2,c.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&F2(l,h,c);else if(l.tag===19)F2(l,h,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}g&=1}if(Wt(nn,g),(c.mode&1)===0)c.memoizedState=null;else switch(y){case"forwards":for(h=c.child,y=null;h!==null;)l=h.alternate,l!==null&&ld(l)===null&&(y=h),h=h.sibling;h=y,h===null?(y=c.child,c.child=null):(y=h.sibling,h.sibling=null),Em(c,!1,y,h,_);break;case"backwards":for(h=null,y=c.child,c.child=null;y!==null;){if(l=y.alternate,l!==null&&ld(l)===null){c.child=y;break}l=y.sibling,y.sibling=h,h=y,y=l}Em(c,!0,h,null,_);break;case"together":Em(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function md(l,c){(c.mode&1)===0&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function ii(l,c,h){if(l!==null&&(c.dependencies=l.dependencies),Yo|=c.lanes,(h&c.childLanes)===0)return null;if(l!==null&&c.child!==l.child)throw Error(t(153));if(c.child!==null){for(l=c.child,h=Zi(l,l.pendingProps),c.child=h,h.return=c;l.sibling!==null;)l=l.sibling,h=h.sibling=Zi(l,l.pendingProps),h.return=c;h.sibling=null}return c.child}function kP(l,c,h){switch(c.tag){case 3:N2(c),nl();break;case 5:Gx(c);break;case 1:vr(c.type)&&Gf(c);break;case 4:sm(c,c.stateNode.containerInfo);break;case 10:var g=c.type._context,y=c.memoizedProps.value;Wt(sd,g._currentValue),g._currentValue=y;break;case 13:if(g=c.memoizedState,g!==null)return g.dehydrated!==null?(Wt(nn,nn.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?L2(l,c,h):(Wt(nn,nn.current&1),l=ii(l,c,h),l!==null?l.sibling:null);Wt(nn,nn.current&1);break;case 19:if(g=(h&c.childLanes)!==0,(l.flags&128)!==0){if(g)return B2(l,c,h);c.flags|=128}if(y=c.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Wt(nn,nn.current),g)break;return null;case 22:case 23:return c.lanes=0,k2(l,c,h)}return ii(l,c,h)}var U2,Am,V2,z2;U2=function(l,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)l.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Am=function(){},V2=function(l,c,h,g){var y=l.memoizedProps;if(y!==g){l=c.stateNode,Ho(Is.current);var _=null;switch(h){case"input":y=Ge(l,y),g=Ge(l,g),_=[];break;case"select":y=M({},y,{value:void 0}),g=M({},g,{value:void 0}),_=[];break;case"textarea":y=at(l,y),g=at(l,g),_=[];break;default:typeof y.onClick!="function"&&typeof g.onClick=="function"&&(l.onclick=Kf)}Ks(h,g);var A;h=null;for(de in y)if(!g.hasOwnProperty(de)&&y.hasOwnProperty(de)&&y[de]!=null)if(de==="style"){var z=y[de];for(A in z)z.hasOwnProperty(A)&&(h||(h={}),h[A]="")}else de!=="dangerouslySetInnerHTML"&&de!=="children"&&de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&de!=="autoFocus"&&(s.hasOwnProperty(de)?_||(_=[]):(_=_||[]).push(de,null));for(de in g){var X=g[de];if(z=y!=null?y[de]:void 0,g.hasOwnProperty(de)&&X!==z&&(X!=null||z!=null))if(de==="style")if(z){for(A in z)!z.hasOwnProperty(A)||X&&X.hasOwnProperty(A)||(h||(h={}),h[A]="");for(A in X)X.hasOwnProperty(A)&&z[A]!==X[A]&&(h||(h={}),h[A]=X[A])}else h||(_||(_=[]),_.push(de,h)),h=X;else de==="dangerouslySetInnerHTML"?(X=X?X.__html:void 0,z=z?z.__html:void 0,X!=null&&z!==X&&(_=_||[]).push(de,X)):de==="children"?typeof X!="string"&&typeof X!="number"||(_=_||[]).push(de,""+X):de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&(s.hasOwnProperty(de)?(X!=null&&de==="onScroll"&&qt("scroll",l),_||z===X||(_=[])):(_=_||[]).push(de,X))}h&&(_=_||[]).push("style",h);var de=_;(c.updateQueue=de)&&(c.flags|=4)}},z2=function(l,c,h,g){h!==g&&(c.flags|=4)};function jc(l,c){if(!Gt)switch(l.tailMode){case"hidden":c=l.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?l.tail=null:h.sibling=null;break;case"collapsed":h=l.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:g.sibling=null}}function Xn(l){var c=l.alternate!==null&&l.alternate.child===l.child,h=0,g=0;if(c)for(var y=l.child;y!==null;)h|=y.lanes|y.childLanes,g|=y.subtreeFlags&14680064,g|=y.flags&14680064,y.return=l,y=y.sibling;else for(y=l.child;y!==null;)h|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=l,y=y.sibling;return l.subtreeFlags|=g,l.childLanes=h,c}function MP(l,c,h){var g=c.pendingProps;switch(qg(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xn(c),null;case 1:return vr(c.type)&&Qf(),Xn(c),null;case 3:return g=c.stateNode,ol(),Kt(mr),Kt(Wn),am(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(l===null||l.child===null)&&(nd(c)?c.flags|=4:l===null||l.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,cs!==null&&(Fm(cs),cs=null))),Am(l,c),Xn(c),null;case 5:im(c);var y=Ho(Bc.current);if(h=c.type,l!==null&&c.stateNode!=null)V2(l,c,h,g,y),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!g){if(c.stateNode===null)throw Error(t(166));return Xn(c),null}if(l=Ho(Is.current),nd(c)){g=c.stateNode,h=c.type;var _=c.memoizedProps;switch(g[Ps]=c,g[Oc]=_,l=(c.mode&1)!==0,h){case"dialog":qt("cancel",g),qt("close",g);break;case"iframe":case"object":case"embed":qt("load",g);break;case"video":case"audio":for(y=0;y<Ic.length;y++)qt(Ic[y],g);break;case"source":qt("error",g);break;case"img":case"image":case"link":qt("error",g),qt("load",g);break;case"details":qt("toggle",g);break;case"input":He(g,_),qt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!_.multiple},qt("invalid",g);break;case"textarea":Mt(g,_),qt("invalid",g)}Ks(h,_),y=null;for(var A in _)if(_.hasOwnProperty(A)){var z=_[A];A==="children"?typeof z=="string"?g.textContent!==z&&(_.suppressHydrationWarning!==!0&&qf(g.textContent,z,l),y=["children",z]):typeof z=="number"&&g.textContent!==""+z&&(_.suppressHydrationWarning!==!0&&qf(g.textContent,z,l),y=["children",""+z]):s.hasOwnProperty(A)&&z!=null&&A==="onScroll"&&qt("scroll",g)}switch(h){case"input":Ue(g),xn(g,_,!0);break;case"textarea":Ue(g),In(g);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(g.onclick=Kf)}g=y,c.updateQueue=g,g!==null&&(c.flags|=4)}else{A=y.nodeType===9?y:y.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=bn(h)),l==="http://www.w3.org/1999/xhtml"?h==="script"?(l=A.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof g.is=="string"?l=A.createElement(h,{is:g.is}):(l=A.createElement(h),h==="select"&&(A=l,g.multiple?A.multiple=!0:g.size&&(A.size=g.size))):l=A.createElementNS(l,h),l[Ps]=c,l[Oc]=g,U2(l,c,!1,!1),c.stateNode=l;e:{switch(A=Qe(h,g),h){case"dialog":qt("cancel",l),qt("close",l),y=g;break;case"iframe":case"object":case"embed":qt("load",l),y=g;break;case"video":case"audio":for(y=0;y<Ic.length;y++)qt(Ic[y],l);y=g;break;case"source":qt("error",l),y=g;break;case"img":case"image":case"link":qt("error",l),qt("load",l),y=g;break;case"details":qt("toggle",l),y=g;break;case"input":He(l,g),y=Ge(l,g),qt("invalid",l);break;case"option":y=g;break;case"select":l._wrapperState={wasMultiple:!!g.multiple},y=M({},g,{value:void 0}),qt("invalid",l);break;case"textarea":Mt(l,g),y=at(l,g),qt("invalid",l);break;default:y=g}Ks(h,y),z=y;for(_ in z)if(z.hasOwnProperty(_)){var X=z[_];_==="style"?Ai(l,X):_==="dangerouslySetInnerHTML"?(X=X?X.__html:void 0,X!=null&&mt(l,X)):_==="children"?typeof X=="string"?(h!=="textarea"||X!=="")&&Ln(l,X):typeof X=="number"&&Ln(l,""+X):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(s.hasOwnProperty(_)?X!=null&&_==="onScroll"&&qt("scroll",l):X!=null&&C(l,_,X,A))}switch(h){case"input":Ue(l),xn(l,g,!1);break;case"textarea":Ue(l),In(l);break;case"option":g.value!=null&&l.setAttribute("value",""+ve(g.value));break;case"select":l.multiple=!!g.multiple,_=g.value,_!=null?ht(l,!!g.multiple,_,!1):g.defaultValue!=null&&ht(l,!!g.multiple,g.defaultValue,!0);break;default:typeof y.onClick=="function"&&(l.onclick=Kf)}switch(h){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Xn(c),null;case 6:if(l&&c.stateNode!=null)z2(l,c,l.memoizedProps,g);else{if(typeof g!="string"&&c.stateNode===null)throw Error(t(166));if(h=Ho(Bc.current),Ho(Is.current),nd(c)){if(g=c.stateNode,h=c.memoizedProps,g[Ps]=c,(_=g.nodeValue!==h)&&(l=Pr,l!==null))switch(l.tag){case 3:qf(g.nodeValue,h,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&qf(g.nodeValue,h,(l.mode&1)!==0)}_&&(c.flags|=4)}else g=(h.nodeType===9?h:h.ownerDocument).createTextNode(g),g[Ps]=c,c.stateNode=g}return Xn(c),null;case 13:if(Kt(nn),g=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Gt&&Ir!==null&&(c.mode&1)!==0&&(c.flags&128)===0)Wx(),nl(),c.flags|=98560,_=!1;else if(_=nd(c),g!==null&&g.dehydrated!==null){if(l===null){if(!_)throw Error(t(318));if(_=c.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[Ps]=c}else nl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Xn(c),_=!1}else cs!==null&&(Fm(cs),cs=null),_=!0;if(!_)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(g=g!==null,g!==(l!==null&&l.memoizedState!==null)&&g&&(c.child.flags|=8192,(c.mode&1)!==0&&(l===null||(nn.current&1)!==0?An===0&&(An=3):Vm())),c.updateQueue!==null&&(c.flags|=4),Xn(c),null);case 4:return ol(),Am(l,c),l===null&&kc(c.stateNode.containerInfo),Xn(c),null;case 10:return em(c.type._context),Xn(c),null;case 17:return vr(c.type)&&Qf(),Xn(c),null;case 19:if(Kt(nn),_=c.memoizedState,_===null)return Xn(c),null;if(g=(c.flags&128)!==0,A=_.rendering,A===null)if(g)jc(_,!1);else{if(An!==0||l!==null&&(l.flags&128)!==0)for(l=c.child;l!==null;){if(A=ld(l),A!==null){for(c.flags|=128,jc(_,!1),g=A.updateQueue,g!==null&&(c.updateQueue=g,c.flags|=4),c.subtreeFlags=0,g=h,h=c.child;h!==null;)_=h,l=g,_.flags&=14680066,A=_.alternate,A===null?(_.childLanes=0,_.lanes=l,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=A.childLanes,_.lanes=A.lanes,_.child=A.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=A.memoizedProps,_.memoizedState=A.memoizedState,_.updateQueue=A.updateQueue,_.type=A.type,l=A.dependencies,_.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),h=h.sibling;return Wt(nn,nn.current&1|2),c.child}l=l.sibling}_.tail!==null&&jt()>ul&&(c.flags|=128,g=!0,jc(_,!1),c.lanes=4194304)}else{if(!g)if(l=ld(A),l!==null){if(c.flags|=128,g=!0,h=l.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),jc(_,!0),_.tail===null&&_.tailMode==="hidden"&&!A.alternate&&!Gt)return Xn(c),null}else 2*jt()-_.renderingStartTime>ul&&h!==1073741824&&(c.flags|=128,g=!0,jc(_,!1),c.lanes=4194304);_.isBackwards?(A.sibling=c.child,c.child=A):(h=_.last,h!==null?h.sibling=A:c.child=A,_.last=A)}return _.tail!==null?(c=_.tail,_.rendering=c,_.tail=c.sibling,_.renderingStartTime=jt(),c.sibling=null,h=nn.current,Wt(nn,g?h&1|2:h&1),c):(Xn(c),null);case 22:case 23:return Um(),g=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==g&&(c.flags|=8192),g&&(c.mode&1)!==0?(kr&1073741824)!==0&&(Xn(c),c.subtreeFlags&6&&(c.flags|=8192)):Xn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function OP(l,c){switch(qg(c),c.tag){case 1:return vr(c.type)&&Qf(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return ol(),Kt(mr),Kt(Wn),am(),l=c.flags,(l&65536)!==0&&(l&128)===0?(c.flags=l&-65537|128,c):null;case 5:return im(c),null;case 13:if(Kt(nn),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(t(340));nl()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return Kt(nn),null;case 4:return ol(),null;case 10:return em(c.type._context),null;case 22:case 23:return Um(),null;case 24:return null;default:return null}}var vd=!1,Yn=!1,NP=typeof WeakSet=="function"?WeakSet:Set,Be=null;function ll(l,c){var h=l.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(g){sn(l,c,g)}else h.current=null}function Cm(l,c,h){try{h()}catch(g){sn(l,c,g)}}var $2=!1;function DP(l,c){if(Ug=Ff,l=xx(),kg(l)){if("selectionStart"in l)var h={start:l.selectionStart,end:l.selectionEnd};else e:{h=(h=l.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var y=g.anchorOffset,_=g.focusNode;g=g.focusOffset;try{h.nodeType,_.nodeType}catch{h=null;break e}var A=0,z=-1,X=-1,de=0,we=0,Se=l,_e=null;t:for(;;){for(var De;Se!==h||y!==0&&Se.nodeType!==3||(z=A+y),Se!==_||g!==0&&Se.nodeType!==3||(X=A+g),Se.nodeType===3&&(A+=Se.nodeValue.length),(De=Se.firstChild)!==null;)_e=Se,Se=De;for(;;){if(Se===l)break t;if(_e===h&&++de===y&&(z=A),_e===_&&++we===g&&(X=A),(De=Se.nextSibling)!==null)break;Se=_e,_e=Se.parentNode}Se=De}h=z===-1||X===-1?null:{start:z,end:X}}else h=null}h=h||{start:0,end:0}}else h=null;for(Vg={focusedElem:l,selectionRange:h},Ff=!1,Be=c;Be!==null;)if(c=Be,l=c.child,(c.subtreeFlags&1028)!==0&&l!==null)l.return=c,Be=l;else for(;Be!==null;){c=Be;try{var Ve=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Ve!==null){var $e=Ve.memoizedProps,pn=Ve.memoizedState,oe=c.stateNode,Q=oe.getSnapshotBeforeUpdate(c.elementType===c.type?$e:us(c.type,$e),pn);oe.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var ce=c.stateNode.containerInfo;ce.nodeType===1?ce.textContent="":ce.nodeType===9&&ce.documentElement&&ce.removeChild(ce.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ce){sn(c,c.return,Ce)}if(l=c.sibling,l!==null){l.return=c.return,Be=l;break}Be=c.return}return Ve=$2,$2=!1,Ve}function Wc(l,c,h){var g=c.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var y=g=g.next;do{if((y.tag&l)===l){var _=y.destroy;y.destroy=void 0,_!==void 0&&Cm(c,h,_)}y=y.next}while(y!==g)}}function yd(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&l)===l){var g=h.create;h.destroy=g()}h=h.next}while(h!==c)}}function Rm(l){var c=l.ref;if(c!==null){var h=l.stateNode;switch(l.tag){case 5:l=h;break;default:l=h}typeof c=="function"?c(l):c.current=l}}function j2(l){var c=l.alternate;c!==null&&(l.alternate=null,j2(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&(delete c[Ps],delete c[Oc],delete c[Wg],delete c[vP],delete c[yP])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function W2(l){return l.tag===5||l.tag===3||l.tag===4}function H2(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||W2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Pm(l,c,h){var g=l.tag;if(g===5||g===6)l=l.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(l,c):h.insertBefore(l,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(l,h)):(c=h,c.appendChild(l)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Kf));else if(g!==4&&(l=l.child,l!==null))for(Pm(l,c,h),l=l.sibling;l!==null;)Pm(l,c,h),l=l.sibling}function Im(l,c,h){var g=l.tag;if(g===5||g===6)l=l.stateNode,c?h.insertBefore(l,c):h.appendChild(l);else if(g!==4&&(l=l.child,l!==null))for(Im(l,c,h),l=l.sibling;l!==null;)Im(l,c,h),l=l.sibling}var Fn=null,fs=!1;function Hi(l,c,h){for(h=h.child;h!==null;)X2(l,c,h),h=h.sibling}function X2(l,c,h){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(gr,h)}catch{}switch(h.tag){case 5:Yn||ll(h,c);case 6:var g=Fn,y=fs;Fn=null,Hi(l,c,h),Fn=g,fs=y,Fn!==null&&(fs?(l=Fn,h=h.stateNode,l.nodeType===8?l.parentNode.removeChild(h):l.removeChild(h)):Fn.removeChild(h.stateNode));break;case 18:Fn!==null&&(fs?(l=Fn,h=h.stateNode,l.nodeType===8?jg(l.parentNode,h):l.nodeType===1&&jg(l,h),wc(l)):jg(Fn,h.stateNode));break;case 4:g=Fn,y=fs,Fn=h.stateNode.containerInfo,fs=!0,Hi(l,c,h),Fn=g,fs=y;break;case 0:case 11:case 14:case 15:if(!Yn&&(g=h.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){y=g=g.next;do{var _=y,A=_.destroy;_=_.tag,A!==void 0&&((_&2)!==0||(_&4)!==0)&&Cm(h,c,A),y=y.next}while(y!==g)}Hi(l,c,h);break;case 1:if(!Yn&&(ll(h,c),g=h.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=h.memoizedProps,g.state=h.memoizedState,g.componentWillUnmount()}catch(z){sn(h,c,z)}Hi(l,c,h);break;case 21:Hi(l,c,h);break;case 22:h.mode&1?(Yn=(g=Yn)||h.memoizedState!==null,Hi(l,c,h),Yn=g):Hi(l,c,h);break;default:Hi(l,c,h)}}function Y2(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var h=l.stateNode;h===null&&(h=l.stateNode=new NP),c.forEach(function(g){var y=WP.bind(null,l,g);h.has(g)||(h.add(g),g.then(y,y))})}}function ds(l,c){var h=c.deletions;if(h!==null)for(var g=0;g<h.length;g++){var y=h[g];try{var _=l,A=c,z=A;e:for(;z!==null;){switch(z.tag){case 5:Fn=z.stateNode,fs=!1;break e;case 3:Fn=z.stateNode.containerInfo,fs=!0;break e;case 4:Fn=z.stateNode.containerInfo,fs=!0;break e}z=z.return}if(Fn===null)throw Error(t(160));X2(_,A,y),Fn=null,fs=!1;var X=y.alternate;X!==null&&(X.return=null),y.return=null}catch(de){sn(y,c,de)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)q2(c,l),c=c.sibling}function q2(l,c){var h=l.alternate,g=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(ds(c,l),Ms(l),g&4){try{Wc(3,l,l.return),yd(3,l)}catch($e){sn(l,l.return,$e)}try{Wc(5,l,l.return)}catch($e){sn(l,l.return,$e)}}break;case 1:ds(c,l),Ms(l),g&512&&h!==null&&ll(h,h.return);break;case 5:if(ds(c,l),Ms(l),g&512&&h!==null&&ll(h,h.return),l.flags&32){var y=l.stateNode;try{Ln(y,"")}catch($e){sn(l,l.return,$e)}}if(g&4&&(y=l.stateNode,y!=null)){var _=l.memoizedProps,A=h!==null?h.memoizedProps:_,z=l.type,X=l.updateQueue;if(l.updateQueue=null,X!==null)try{z==="input"&&_.type==="radio"&&_.name!=null&&Ie(y,_),Qe(z,A);var de=Qe(z,_);for(A=0;A<X.length;A+=2){var we=X[A],Se=X[A+1];we==="style"?Ai(y,Se):we==="dangerouslySetInnerHTML"?mt(y,Se):we==="children"?Ln(y,Se):C(y,we,Se,de)}switch(z){case"input":ct(y,_);break;case"textarea":Ut(y,_);break;case"select":var _e=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!_.multiple;var De=_.value;De!=null?ht(y,!!_.multiple,De,!1):_e!==!!_.multiple&&(_.defaultValue!=null?ht(y,!!_.multiple,_.defaultValue,!0):ht(y,!!_.multiple,_.multiple?[]:"",!1))}y[Oc]=_}catch($e){sn(l,l.return,$e)}}break;case 6:if(ds(c,l),Ms(l),g&4){if(l.stateNode===null)throw Error(t(162));y=l.stateNode,_=l.memoizedProps;try{y.nodeValue=_}catch($e){sn(l,l.return,$e)}}break;case 3:if(ds(c,l),Ms(l),g&4&&h!==null&&h.memoizedState.isDehydrated)try{wc(c.containerInfo)}catch($e){sn(l,l.return,$e)}break;case 4:ds(c,l),Ms(l);break;case 13:ds(c,l),Ms(l),y=l.child,y.flags&8192&&(_=y.memoizedState!==null,y.stateNode.isHidden=_,!_||y.alternate!==null&&y.alternate.memoizedState!==null||(Om=jt())),g&4&&Y2(l);break;case 22:if(we=h!==null&&h.memoizedState!==null,l.mode&1?(Yn=(de=Yn)||we,ds(c,l),Yn=de):ds(c,l),Ms(l),g&8192){if(de=l.memoizedState!==null,(l.stateNode.isHidden=de)&&!we&&(l.mode&1)!==0)for(Be=l,we=l.child;we!==null;){for(Se=Be=we;Be!==null;){switch(_e=Be,De=_e.child,_e.tag){case 0:case 11:case 14:case 15:Wc(4,_e,_e.return);break;case 1:ll(_e,_e.return);var Ve=_e.stateNode;if(typeof Ve.componentWillUnmount=="function"){g=_e,h=_e.return;try{c=g,Ve.props=c.memoizedProps,Ve.state=c.memoizedState,Ve.componentWillUnmount()}catch($e){sn(g,h,$e)}}break;case 5:ll(_e,_e.return);break;case 22:if(_e.memoizedState!==null){Q2(Se);continue}}De!==null?(De.return=_e,Be=De):Q2(Se)}we=we.sibling}e:for(we=null,Se=l;;){if(Se.tag===5){if(we===null){we=Se;try{y=Se.stateNode,de?(_=y.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(z=Se.stateNode,X=Se.memoizedProps.style,A=X!=null&&X.hasOwnProperty("display")?X.display:null,z.style.display=cr("display",A))}catch($e){sn(l,l.return,$e)}}}else if(Se.tag===6){if(we===null)try{Se.stateNode.nodeValue=de?"":Se.memoizedProps}catch($e){sn(l,l.return,$e)}}else if((Se.tag!==22&&Se.tag!==23||Se.memoizedState===null||Se===l)&&Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===l)break e;for(;Se.sibling===null;){if(Se.return===null||Se.return===l)break e;we===Se&&(we=null),Se=Se.return}we===Se&&(we=null),Se.sibling.return=Se.return,Se=Se.sibling}}break;case 19:ds(c,l),Ms(l),g&4&&Y2(l);break;case 21:break;default:ds(c,l),Ms(l)}}function Ms(l){var c=l.flags;if(c&2){try{e:{for(var h=l.return;h!==null;){if(W2(h)){var g=h;break e}h=h.return}throw Error(t(160))}switch(g.tag){case 5:var y=g.stateNode;g.flags&32&&(Ln(y,""),g.flags&=-33);var _=H2(l);Im(l,_,y);break;case 3:case 4:var A=g.stateNode.containerInfo,z=H2(l);Pm(l,z,A);break;default:throw Error(t(161))}}catch(X){sn(l,l.return,X)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function LP(l,c,h){Be=l,K2(l)}function K2(l,c,h){for(var g=(l.mode&1)!==0;Be!==null;){var y=Be,_=y.child;if(y.tag===22&&g){var A=y.memoizedState!==null||vd;if(!A){var z=y.alternate,X=z!==null&&z.memoizedState!==null||Yn;z=vd;var de=Yn;if(vd=A,(Yn=X)&&!de)for(Be=y;Be!==null;)A=Be,X=A.child,A.tag===22&&A.memoizedState!==null?G2(y):X!==null?(X.return=A,Be=X):G2(y);for(;_!==null;)Be=_,K2(_),_=_.sibling;Be=y,vd=z,Yn=de}Z2(l)}else(y.subtreeFlags&8772)!==0&&_!==null?(_.return=y,Be=_):Z2(l)}}function Z2(l){for(;Be!==null;){var c=Be;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Yn||yd(5,c);break;case 1:var g=c.stateNode;if(c.flags&4&&!Yn)if(h===null)g.componentDidMount();else{var y=c.elementType===c.type?h.memoizedProps:us(c.type,h.memoizedProps);g.componentDidUpdate(y,h.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var _=c.updateQueue;_!==null&&Qx(c,_,g);break;case 3:var A=c.updateQueue;if(A!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}Qx(c,A,h)}break;case 5:var z=c.stateNode;if(h===null&&c.flags&4){h=z;var X=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":X.autoFocus&&h.focus();break;case"img":X.src&&(h.src=X.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var de=c.alternate;if(de!==null){var we=de.memoizedState;if(we!==null){var Se=we.dehydrated;Se!==null&&wc(Se)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Yn||c.flags&512&&Rm(c)}catch(_e){sn(c,c.return,_e)}}if(c===l){Be=null;break}if(h=c.sibling,h!==null){h.return=c.return,Be=h;break}Be=c.return}}function Q2(l){for(;Be!==null;){var c=Be;if(c===l){Be=null;break}var h=c.sibling;if(h!==null){h.return=c.return,Be=h;break}Be=c.return}}function G2(l){for(;Be!==null;){var c=Be;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{yd(4,c)}catch(X){sn(c,h,X)}break;case 1:var g=c.stateNode;if(typeof g.componentDidMount=="function"){var y=c.return;try{g.componentDidMount()}catch(X){sn(c,y,X)}}var _=c.return;try{Rm(c)}catch(X){sn(c,_,X)}break;case 5:var A=c.return;try{Rm(c)}catch(X){sn(c,A,X)}}}catch(X){sn(c,c.return,X)}if(c===l){Be=null;break}var z=c.sibling;if(z!==null){z.return=c.return,Be=z;break}Be=c.return}}var FP=Math.ceil,_d=O.ReactCurrentDispatcher,km=O.ReactCurrentOwner,Yr=O.ReactCurrentBatchConfig,vt=0,On=null,mn=null,Bn=0,kr=0,cl=Vi(0),An=0,Hc=null,Yo=0,xd=0,Mm=0,Xc=null,_r=null,Om=0,ul=1/0,oi=null,bd=!1,Nm=null,Xi=null,wd=!1,Yi=null,Td=0,Yc=0,Dm=null,Sd=-1,Ed=0;function ir(){return(vt&6)!==0?jt():Sd!==-1?Sd:Sd=jt()}function qi(l){return(l.mode&1)===0?1:(vt&2)!==0&&Bn!==0?Bn&-Bn:xP.transition!==null?(Ed===0&&(Ed=$a()),Ed):(l=k,l!==0||(l=window.event,l=l===void 0?16:ex(l.type)),l)}function hs(l,c,h,g){if(50<Yc)throw Yc=0,Dm=null,Error(t(185));Uo(l,h,g),((vt&2)===0||l!==On)&&(l===On&&((vt&2)===0&&(xd|=h),An===4&&Ki(l,Bn)),xr(l,g),h===1&&vt===0&&(c.mode&1)===0&&(ul=jt()+500,Jf&&$i()))}function xr(l,c){var h=l.callbackNode;yg(l,c);var g=Gs(l,l===On?Bn:0);if(g===0)h!==null&&ki(h),l.callbackNode=null,l.callbackPriority=0;else if(c=g&-g,l.callbackPriority!==c){if(h!=null&&ki(h),c===1)l.tag===0?_P(eb.bind(null,l)):Ux(eb.bind(null,l)),gP(function(){(vt&6)===0&&$i()}),h=null;else{switch(j(g)){case 1:h=Cs;break;case 4:h=as;break;case 16:h=pr;break;case 536870912:h=Er;break;default:h=pr}h=lb(h,J2.bind(null,l))}l.callbackPriority=c,l.callbackNode=h}}function J2(l,c){if(Sd=-1,Ed=0,(vt&6)!==0)throw Error(t(327));var h=l.callbackNode;if(fl()&&l.callbackNode!==h)return null;var g=Gs(l,l===On?Bn:0);if(g===0)return null;if((g&30)!==0||(g&l.expiredLanes)!==0||c)c=Ad(l,g);else{c=g;var y=vt;vt|=2;var _=nb();(On!==l||Bn!==c)&&(oi=null,ul=jt()+500,Ko(l,c));do try{VP();break}catch(z){tb(l,z)}while(!0);Jg(),_d.current=_,vt=y,mn!==null?c=0:(On=null,Bn=0,c=An)}if(c!==0){if(c===2&&(y=za(l),y!==0&&(g=y,c=Lm(l,y))),c===1)throw h=Hc,Ko(l,0),Ki(l,g),xr(l,jt()),h;if(c===6)Ki(l,g);else{if(y=l.current.alternate,(g&30)===0&&!BP(y)&&(c=Ad(l,g),c===2&&(_=za(l),_!==0&&(g=_,c=Lm(l,_))),c===1))throw h=Hc,Ko(l,0),Ki(l,g),xr(l,jt()),h;switch(l.finishedWork=y,l.finishedLanes=g,c){case 0:case 1:throw Error(t(345));case 2:Zo(l,_r,oi);break;case 3:if(Ki(l,g),(g&130023424)===g&&(c=Om+500-jt(),10<c)){if(Gs(l,0)!==0)break;if(y=l.suspendedLanes,(y&g)!==g){ir(),l.pingedLanes|=l.suspendedLanes&y;break}l.timeoutHandle=$g(Zo.bind(null,l,_r,oi),c);break}Zo(l,_r,oi);break;case 4:if(Ki(l,g),(g&4194240)===g)break;for(c=l.eventTimes,y=-1;0<g;){var A=31-jn(g);_=1<<A,A=c[A],A>y&&(y=A),g&=~_}if(g=y,g=jt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*FP(g/1960))-g,10<g){l.timeoutHandle=$g(Zo.bind(null,l,_r,oi),g);break}Zo(l,_r,oi);break;case 5:Zo(l,_r,oi);break;default:throw Error(t(329))}}}return xr(l,jt()),l.callbackNode===h?J2.bind(null,l):null}function Lm(l,c){var h=Xc;return l.current.memoizedState.isDehydrated&&(Ko(l,c).flags|=256),l=Ad(l,c),l!==2&&(c=_r,_r=h,c!==null&&Fm(c)),l}function Fm(l){_r===null?_r=l:_r.push.apply(_r,l)}function BP(l){for(var c=l;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var g=0;g<h.length;g++){var y=h[g],_=y.getSnapshot;y=y.value;try{if(!ls(_(),y))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ki(l,c){for(c&=~Mm,c&=~xd,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var h=31-jn(c),g=1<<h;l[h]=-1,c&=~g}}function eb(l){if((vt&6)!==0)throw Error(t(327));fl();var c=Gs(l,0);if((c&1)===0)return xr(l,jt()),null;var h=Ad(l,c);if(l.tag!==0&&h===2){var g=za(l);g!==0&&(c=g,h=Lm(l,g))}if(h===1)throw h=Hc,Ko(l,0),Ki(l,c),xr(l,jt()),h;if(h===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,Zo(l,_r,oi),xr(l,jt()),null}function Bm(l,c){var h=vt;vt|=1;try{return l(c)}finally{vt=h,vt===0&&(ul=jt()+500,Jf&&$i())}}function qo(l){Yi!==null&&Yi.tag===0&&(vt&6)===0&&fl();var c=vt;vt|=1;var h=Yr.transition,g=k;try{if(Yr.transition=null,k=1,l)return l()}finally{k=g,Yr.transition=h,vt=c,(vt&6)===0&&$i()}}function Um(){kr=cl.current,Kt(cl)}function Ko(l,c){l.finishedWork=null,l.finishedLanes=0;var h=l.timeoutHandle;if(h!==-1&&(l.timeoutHandle=-1,pP(h)),mn!==null)for(h=mn.return;h!==null;){var g=h;switch(qg(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Qf();break;case 3:ol(),Kt(mr),Kt(Wn),am();break;case 5:im(g);break;case 4:ol();break;case 13:Kt(nn);break;case 19:Kt(nn);break;case 10:em(g.type._context);break;case 22:case 23:Um()}h=h.return}if(On=l,mn=l=Zi(l.current,null),Bn=kr=c,An=0,Hc=null,Mm=xd=Yo=0,_r=Xc=null,Wo!==null){for(c=0;c<Wo.length;c++)if(h=Wo[c],g=h.interleaved,g!==null){h.interleaved=null;var y=g.next,_=h.pending;if(_!==null){var A=_.next;_.next=y,g.next=A}h.pending=g}Wo=null}return l}function tb(l,c){do{var h=mn;try{if(Jg(),cd.current=hd,ud){for(var g=rn.memoizedState;g!==null;){var y=g.queue;y!==null&&(y.pending=null),g=g.next}ud=!1}if(Xo=0,Mn=En=rn=null,Uc=!1,Vc=0,km.current=null,h===null||h.return===null){An=1,Hc=c,mn=null;break}e:{var _=l,A=h.return,z=h,X=c;if(c=Bn,z.flags|=32768,X!==null&&typeof X=="object"&&typeof X.then=="function"){var de=X,we=z,Se=we.tag;if((we.mode&1)===0&&(Se===0||Se===11||Se===15)){var _e=we.alternate;_e?(we.updateQueue=_e.updateQueue,we.memoizedState=_e.memoizedState,we.lanes=_e.lanes):(we.updateQueue=null,we.memoizedState=null)}var De=A2(A);if(De!==null){De.flags&=-257,C2(De,A,z,_,c),De.mode&1&&E2(_,de,c),c=De,X=de;var Ve=c.updateQueue;if(Ve===null){var $e=new Set;$e.add(X),c.updateQueue=$e}else Ve.add(X);break e}else{if((c&1)===0){E2(_,de,c),Vm();break e}X=Error(t(426))}}else if(Gt&&z.mode&1){var pn=A2(A);if(pn!==null){(pn.flags&65536)===0&&(pn.flags|=256),C2(pn,A,z,_,c),Qg(al(X,z));break e}}_=X=al(X,z),An!==4&&(An=2),Xc===null?Xc=[_]:Xc.push(_),_=A;do{switch(_.tag){case 3:_.flags|=65536,c&=-c,_.lanes|=c;var oe=T2(_,X,c);Zx(_,oe);break e;case 1:z=X;var Q=_.type,ce=_.stateNode;if((_.flags&128)===0&&(typeof Q.getDerivedStateFromError=="function"||ce!==null&&typeof ce.componentDidCatch=="function"&&(Xi===null||!Xi.has(ce)))){_.flags|=65536,c&=-c,_.lanes|=c;var Ce=S2(_,z,c);Zx(_,Ce);break e}}_=_.return}while(_!==null)}sb(h)}catch(je){c=je,mn===h&&h!==null&&(mn=h=h.return);continue}break}while(!0)}function nb(){var l=_d.current;return _d.current=hd,l===null?hd:l}function Vm(){(An===0||An===3||An===2)&&(An=4),On===null||(Yo&268435455)===0&&(xd&268435455)===0||Ki(On,Bn)}function Ad(l,c){var h=vt;vt|=2;var g=nb();(On!==l||Bn!==c)&&(oi=null,Ko(l,c));do try{UP();break}catch(y){tb(l,y)}while(!0);if(Jg(),vt=h,_d.current=g,mn!==null)throw Error(t(261));return On=null,Bn=0,An}function UP(){for(;mn!==null;)rb(mn)}function VP(){for(;mn!==null&&!mc();)rb(mn)}function rb(l){var c=ab(l.alternate,l,kr);l.memoizedProps=l.pendingProps,c===null?sb(l):mn=c,km.current=null}function sb(l){var c=l;do{var h=c.alternate;if(l=c.return,(c.flags&32768)===0){if(h=MP(h,c,kr),h!==null){mn=h;return}}else{if(h=OP(h,c),h!==null){h.flags&=32767,mn=h;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{An=6,mn=null;return}}if(c=c.sibling,c!==null){mn=c;return}mn=c=l}while(c!==null);An===0&&(An=5)}function Zo(l,c,h){var g=k,y=Yr.transition;try{Yr.transition=null,k=1,zP(l,c,h,g)}finally{Yr.transition=y,k=g}return null}function zP(l,c,h,g){do fl();while(Yi!==null);if((vt&6)!==0)throw Error(t(327));h=l.finishedWork;var y=l.finishedLanes;if(h===null)return null;if(l.finishedWork=null,l.finishedLanes=0,h===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var _=h.lanes|h.childLanes;if(_g(l,_),l===On&&(mn=On=null,Bn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||wd||(wd=!0,lb(pr,function(){return fl(),null})),_=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||_){_=Yr.transition,Yr.transition=null;var A=k;k=1;var z=vt;vt|=4,km.current=null,DP(l,h),q2(h,l),aP(Vg),Ff=!!Ug,Vg=Ug=null,l.current=h,LP(h),vg(),vt=z,k=A,Yr.transition=_}else l.current=h;if(wd&&(wd=!1,Yi=l,Td=y),_=l.pendingLanes,_===0&&(Xi=null),Df(h.stateNode),xr(l,jt()),c!==null)for(g=l.onRecoverableError,h=0;h<c.length;h++)y=c[h],g(y.value,{componentStack:y.stack,digest:y.digest});if(bd)throw bd=!1,l=Nm,Nm=null,l;return(Td&1)!==0&&l.tag!==0&&fl(),_=l.pendingLanes,(_&1)!==0?l===Dm?Yc++:(Yc=0,Dm=l):Yc=0,$i(),null}function fl(){if(Yi!==null){var l=j(Td),c=Yr.transition,h=k;try{if(Yr.transition=null,k=16>l?16:l,Yi===null)var g=!1;else{if(l=Yi,Yi=null,Td=0,(vt&6)!==0)throw Error(t(331));var y=vt;for(vt|=4,Be=l.current;Be!==null;){var _=Be,A=_.child;if((Be.flags&16)!==0){var z=_.deletions;if(z!==null){for(var X=0;X<z.length;X++){var de=z[X];for(Be=de;Be!==null;){var we=Be;switch(we.tag){case 0:case 11:case 15:Wc(8,we,_)}var Se=we.child;if(Se!==null)Se.return=we,Be=Se;else for(;Be!==null;){we=Be;var _e=we.sibling,De=we.return;if(j2(we),we===de){Be=null;break}if(_e!==null){_e.return=De,Be=_e;break}Be=De}}}var Ve=_.alternate;if(Ve!==null){var $e=Ve.child;if($e!==null){Ve.child=null;do{var pn=$e.sibling;$e.sibling=null,$e=pn}while($e!==null)}}Be=_}}if((_.subtreeFlags&2064)!==0&&A!==null)A.return=_,Be=A;else e:for(;Be!==null;){if(_=Be,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:Wc(9,_,_.return)}var oe=_.sibling;if(oe!==null){oe.return=_.return,Be=oe;break e}Be=_.return}}var Q=l.current;for(Be=Q;Be!==null;){A=Be;var ce=A.child;if((A.subtreeFlags&2064)!==0&&ce!==null)ce.return=A,Be=ce;else e:for(A=Q;Be!==null;){if(z=Be,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:yd(9,z)}}catch(je){sn(z,z.return,je)}if(z===A){Be=null;break e}var Ce=z.sibling;if(Ce!==null){Ce.return=z.return,Be=Ce;break e}Be=z.return}}if(vt=y,$i(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(gr,l)}catch{}g=!0}return g}finally{k=h,Yr.transition=c}}return!1}function ib(l,c,h){c=al(h,c),c=T2(l,c,1),l=Wi(l,c,1),c=ir(),l!==null&&(Uo(l,1,c),xr(l,c))}function sn(l,c,h){if(l.tag===3)ib(l,l,h);else for(;c!==null;){if(c.tag===3){ib(c,l,h);break}else if(c.tag===1){var g=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Xi===null||!Xi.has(g))){l=al(h,l),l=S2(c,l,1),c=Wi(c,l,1),l=ir(),c!==null&&(Uo(c,1,l),xr(c,l));break}}c=c.return}}function $P(l,c,h){var g=l.pingCache;g!==null&&g.delete(c),c=ir(),l.pingedLanes|=l.suspendedLanes&h,On===l&&(Bn&h)===h&&(An===4||An===3&&(Bn&130023424)===Bn&&500>jt()-Om?Ko(l,0):Mm|=h),xr(l,c)}function ob(l,c){c===0&&((l.mode&1)===0?c=1:(c=Oi,Oi<<=1,(Oi&130023424)===0&&(Oi=4194304)));var h=ir();l=ri(l,c),l!==null&&(Uo(l,c,h),xr(l,h))}function jP(l){var c=l.memoizedState,h=0;c!==null&&(h=c.retryLane),ob(l,h)}function WP(l,c){var h=0;switch(l.tag){case 13:var g=l.stateNode,y=l.memoizedState;y!==null&&(h=y.retryLane);break;case 19:g=l.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(c),ob(l,h)}var ab;ab=function(l,c,h){if(l!==null)if(l.memoizedProps!==c.pendingProps||mr.current)yr=!0;else{if((l.lanes&h)===0&&(c.flags&128)===0)return yr=!1,kP(l,c,h);yr=(l.flags&131072)!==0}else yr=!1,Gt&&(c.flags&1048576)!==0&&Vx(c,td,c.index);switch(c.lanes=0,c.tag){case 2:var g=c.type;md(l,c),l=c.pendingProps;var y=Ja(c,Wn.current);il(c,h),y=um(null,c,g,l,y,h);var _=fm();return c.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,vr(g)?(_=!0,Gf(c)):_=!1,c.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,rm(c),y.updater=pd,c.stateNode=y,y._reactInternals=c,vm(c,g,l,h),c=bm(null,c,g,!0,_,h)):(c.tag=0,Gt&&_&&Yg(c),sr(null,c,y,h),c=c.child),c;case 16:g=c.elementType;e:{switch(md(l,c),l=c.pendingProps,y=g._init,g=y(g._payload),c.type=g,y=c.tag=XP(g),l=us(g,l),y){case 0:c=xm(null,c,g,l,h);break e;case 1:c=O2(null,c,g,l,h);break e;case 11:c=R2(null,c,g,l,h);break e;case 14:c=P2(null,c,g,us(g.type,l),h);break e}throw Error(t(306,g,""))}return c;case 0:return g=c.type,y=c.pendingProps,y=c.elementType===g?y:us(g,y),xm(l,c,g,y,h);case 1:return g=c.type,y=c.pendingProps,y=c.elementType===g?y:us(g,y),O2(l,c,g,y,h);case 3:e:{if(N2(c),l===null)throw Error(t(387));g=c.pendingProps,_=c.memoizedState,y=_.element,Kx(l,c),ad(c,g,null,h);var A=c.memoizedState;if(g=A.element,_.isDehydrated)if(_={element:g,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},c.updateQueue.baseState=_,c.memoizedState=_,c.flags&256){y=al(Error(t(423)),c),c=D2(l,c,g,h,y);break e}else if(g!==y){y=al(Error(t(424)),c),c=D2(l,c,g,h,y);break e}else for(Ir=Ui(c.stateNode.containerInfo.firstChild),Pr=c,Gt=!0,cs=null,h=Yx(c,null,g,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(nl(),g===y){c=ii(l,c,h);break e}sr(l,c,g,h)}c=c.child}return c;case 5:return Gx(c),l===null&&Zg(c),g=c.type,y=c.pendingProps,_=l!==null?l.memoizedProps:null,A=y.children,zg(g,y)?A=null:_!==null&&zg(g,_)&&(c.flags|=32),M2(l,c),sr(l,c,A,h),c.child;case 6:return l===null&&Zg(c),null;case 13:return L2(l,c,h);case 4:return sm(c,c.stateNode.containerInfo),g=c.pendingProps,l===null?c.child=rl(c,null,g,h):sr(l,c,g,h),c.child;case 11:return g=c.type,y=c.pendingProps,y=c.elementType===g?y:us(g,y),R2(l,c,g,y,h);case 7:return sr(l,c,c.pendingProps,h),c.child;case 8:return sr(l,c,c.pendingProps.children,h),c.child;case 12:return sr(l,c,c.pendingProps.children,h),c.child;case 10:e:{if(g=c.type._context,y=c.pendingProps,_=c.memoizedProps,A=y.value,Wt(sd,g._currentValue),g._currentValue=A,_!==null)if(ls(_.value,A)){if(_.children===y.children&&!mr.current){c=ii(l,c,h);break e}}else for(_=c.child,_!==null&&(_.return=c);_!==null;){var z=_.dependencies;if(z!==null){A=_.child;for(var X=z.firstContext;X!==null;){if(X.context===g){if(_.tag===1){X=si(-1,h&-h),X.tag=2;var de=_.updateQueue;if(de!==null){de=de.shared;var we=de.pending;we===null?X.next=X:(X.next=we.next,we.next=X),de.pending=X}}_.lanes|=h,X=_.alternate,X!==null&&(X.lanes|=h),tm(_.return,h,c),z.lanes|=h;break}X=X.next}}else if(_.tag===10)A=_.type===c.type?null:_.child;else if(_.tag===18){if(A=_.return,A===null)throw Error(t(341));A.lanes|=h,z=A.alternate,z!==null&&(z.lanes|=h),tm(A,h,c),A=_.sibling}else A=_.child;if(A!==null)A.return=_;else for(A=_;A!==null;){if(A===c){A=null;break}if(_=A.sibling,_!==null){_.return=A.return,A=_;break}A=A.return}_=A}sr(l,c,y.children,h),c=c.child}return c;case 9:return y=c.type,g=c.pendingProps.children,il(c,h),y=Hr(y),g=g(y),c.flags|=1,sr(l,c,g,h),c.child;case 14:return g=c.type,y=us(g,c.pendingProps),y=us(g.type,y),P2(l,c,g,y,h);case 15:return I2(l,c,c.type,c.pendingProps,h);case 17:return g=c.type,y=c.pendingProps,y=c.elementType===g?y:us(g,y),md(l,c),c.tag=1,vr(g)?(l=!0,Gf(c)):l=!1,il(c,h),b2(c,g,y),vm(c,g,y,h),bm(null,c,g,!0,l,h);case 19:return B2(l,c,h);case 22:return k2(l,c,h)}throw Error(t(156,c.tag))};function lb(l,c){return dr(l,c)}function HP(l,c,h,g){this.tag=l,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qr(l,c,h,g){return new HP(l,c,h,g)}function zm(l){return l=l.prototype,!(!l||!l.isReactComponent)}function XP(l){if(typeof l=="function")return zm(l)?1:0;if(l!=null){if(l=l.$$typeof,l===pe)return 11;if(l===Me)return 14}return 2}function Zi(l,c){var h=l.alternate;return h===null?(h=qr(l.tag,c,l.key,l.mode),h.elementType=l.elementType,h.type=l.type,h.stateNode=l.stateNode,h.alternate=l,l.alternate=h):(h.pendingProps=c,h.type=l.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=l.flags&14680064,h.childLanes=l.childLanes,h.lanes=l.lanes,h.child=l.child,h.memoizedProps=l.memoizedProps,h.memoizedState=l.memoizedState,h.updateQueue=l.updateQueue,c=l.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=l.sibling,h.index=l.index,h.ref=l.ref,h}function Cd(l,c,h,g,y,_){var A=2;if(g=l,typeof l=="function")zm(l)&&(A=1);else if(typeof l=="string")A=5;else e:switch(l){case $:return Qo(h.children,y,_,c);case q:A=8,y|=8;break;case K:return l=qr(12,h,c,y|2),l.elementType=K,l.lanes=_,l;case se:return l=qr(13,h,c,y),l.elementType=se,l.lanes=_,l;case ye:return l=qr(19,h,c,y),l.elementType=ye,l.lanes=_,l;case H:return Rd(h,y,_,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case le:A=10;break e;case he:A=9;break e;case pe:A=11;break e;case Me:A=14;break e;case U:A=16,g=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return c=qr(A,h,c,y),c.elementType=l,c.type=g,c.lanes=_,c}function Qo(l,c,h,g){return l=qr(7,l,g,c),l.lanes=h,l}function Rd(l,c,h,g){return l=qr(22,l,g,c),l.elementType=H,l.lanes=h,l.stateNode={isHidden:!1},l}function $m(l,c,h){return l=qr(6,l,null,c),l.lanes=h,l}function jm(l,c,h){return c=qr(4,l.children!==null?l.children:[],l.key,c),c.lanes=h,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function YP(l,c,h,g,y){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ja(0),this.expirationTimes=ja(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ja(0),this.identifierPrefix=g,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Wm(l,c,h,g,y,_,A,z,X){return l=new YP(l,c,h,z,X),c===1?(c=1,_===!0&&(c|=8)):c=0,_=qr(3,null,null,c),l.current=_,_.stateNode=l,_.memoizedState={element:g,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},rm(_),l}function qP(l,c,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:g==null?null:""+g,children:l,containerInfo:c,implementation:h}}function cb(l){if(!l)return zi;l=l._reactInternals;e:{if(zr(l)!==l||l.tag!==1)throw Error(t(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(vr(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(l.tag===1){var h=l.type;if(vr(h))return Fx(l,h,c)}return c}function ub(l,c,h,g,y,_,A,z,X){return l=Wm(h,g,!0,l,y,_,A,z,X),l.context=cb(null),h=l.current,g=ir(),y=qi(h),_=si(g,y),_.callback=c??null,Wi(h,_,y),l.current.lanes=y,Uo(l,y,g),xr(l,g),l}function Pd(l,c,h,g){var y=c.current,_=ir(),A=qi(y);return h=cb(h),c.context===null?c.context=h:c.pendingContext=h,c=si(_,A),c.payload={element:l},g=g===void 0?null:g,g!==null&&(c.callback=g),l=Wi(y,c,A),l!==null&&(hs(l,y,A,_),od(l,y,A)),A}function Id(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function fb(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var h=l.retryLane;l.retryLane=h!==0&&h<c?h:c}}function Hm(l,c){fb(l,c),(l=l.alternate)&&fb(l,c)}function KP(){return null}var db=typeof reportError=="function"?reportError:function(l){console.error(l)};function Xm(l){this._internalRoot=l}kd.prototype.render=Xm.prototype.render=function(l){var c=this._internalRoot;if(c===null)throw Error(t(409));Pd(l,c,null,null)},kd.prototype.unmount=Xm.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var c=l.containerInfo;qo(function(){Pd(null,l,null,null)}),c[Js]=null}};function kd(l){this._internalRoot=l}kd.prototype.unstable_scheduleHydration=function(l){if(l){var c=lt();l={blockedOn:null,target:l,priority:c};for(var h=0;h<Li.length&&c!==0&&c<Li[h].priority;h++);Li.splice(h,0,l),h===0&&G1(l)}};function Ym(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Md(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function hb(){}function ZP(l,c,h,g,y){if(y){if(typeof g=="function"){var _=g;g=function(){var de=Id(A);_.call(de)}}var A=ub(c,g,l,0,null,!1,!1,"",hb);return l._reactRootContainer=A,l[Js]=A.current,kc(l.nodeType===8?l.parentNode:l),qo(),A}for(;y=l.lastChild;)l.removeChild(y);if(typeof g=="function"){var z=g;g=function(){var de=Id(X);z.call(de)}}var X=Wm(l,0,!1,null,null,!1,!1,"",hb);return l._reactRootContainer=X,l[Js]=X.current,kc(l.nodeType===8?l.parentNode:l),qo(function(){Pd(c,X,h,g)}),X}function Od(l,c,h,g,y){var _=h._reactRootContainer;if(_){var A=_;if(typeof y=="function"){var z=y;y=function(){var X=Id(A);z.call(X)}}Pd(c,A,l,y)}else A=ZP(h,c,l,y,g);return Id(A)}fe=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var h=Qs(c.pendingLanes);h!==0&&(P(c,h|1),xr(c,jt()),(vt&6)===0&&(ul=jt()+500,$i()))}break;case 13:qo(function(){var g=ri(l,1);if(g!==null){var y=ir();hs(g,l,1,y)}}),Hm(l,1)}},xe=function(l){if(l.tag===13){var c=ri(l,134217728);if(c!==null){var h=ir();hs(c,l,134217728,h)}Hm(l,134217728)}},Ne=function(l){if(l.tag===13){var c=qi(l),h=ri(l,c);if(h!==null){var g=ir();hs(h,l,c,g)}Hm(l,c)}},lt=function(){return k},dn=function(l,c){var h=k;try{return k=l,c()}finally{k=h}},is=function(l,c,h){switch(c){case"input":if(ct(l,h),c=h.name,h.type==="radio"&&c!=null){for(h=l;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var g=h[c];if(g!==l&&g.form===l.form){var y=Zf(g);if(!y)throw Error(t(90));Ke(g),ct(g,y)}}}break;case"textarea":Ut(l,h);break;case"select":c=h.value,c!=null&&ht(l,!!h.multiple,c,!1)}},Ba=Bm,Ri=qo;var QP={usingClientEntryPoint:!1,Events:[Nc,Qa,Zf,Vr,Ci,Bm]},qc={findFiberByHostInstance:Vo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GP={bundleType:qc.bundleType,version:qc.version,rendererPackageName:qc.rendererPackageName,rendererConfig:qc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=os(l),l===null?null:l.stateNode},findFiberByHostInstance:qc.findFiberByHostInstance||KP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nd.isDisabled&&Nd.supportsFiber)try{gr=Nd.inject(GP),Ar=Nd}catch{}}return br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QP,br.createPortal=function(l,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ym(c))throw Error(t(200));return qP(l,c,null,h)},br.createRoot=function(l,c){if(!Ym(l))throw Error(t(299));var h=!1,g="",y=db;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onRecoverableError!==void 0&&(y=c.onRecoverableError)),c=Wm(l,1,!1,null,null,h,!1,g,y),l[Js]=c.current,kc(l.nodeType===8?l.parentNode:l),new Xm(c)},br.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=os(c),l=l===null?null:l.stateNode,l},br.flushSync=function(l){return qo(l)},br.hydrate=function(l,c,h){if(!Md(c))throw Error(t(200));return Od(null,l,c,!0,h)},br.hydrateRoot=function(l,c,h){if(!Ym(l))throw Error(t(405));var g=h!=null&&h.hydratedSources||null,y=!1,_="",A=db;if(h!=null&&(h.unstable_strictMode===!0&&(y=!0),h.identifierPrefix!==void 0&&(_=h.identifierPrefix),h.onRecoverableError!==void 0&&(A=h.onRecoverableError)),c=ub(c,null,l,1,h??null,y,!1,_,A),l[Js]=c.current,kc(l),g)for(l=0;l<g.length;l++)h=g[l],y=h._getVersion,y=y(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,y]:c.mutableSourceEagerHydrationData.push(h,y);return new kd(c)},br.render=function(l,c,h){if(!Md(c))throw Error(t(200));return Od(null,l,c,!1,h)},br.unmountComponentAtNode=function(l){if(!Md(l))throw Error(t(40));return l._reactRootContainer?(qo(function(){Od(null,null,l,!1,function(){l._reactRootContainer=null,l[Js]=null})}),!0):!1},br.unstable_batchedUpdates=Bm,br.unstable_renderSubtreeIntoContainer=function(l,c,h,g){if(!Md(h))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return Od(l,c,h,!1,g)},br.version="18.3.1-next-f1338f8080-20240426",br}var Kb;function mE(){if(Kb)return x0.exports;Kb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),x0.exports=Lk(),x0.exports}var Io=mE();const Ld=ka(Io);var Zp=!0,Fv=!1,Zb=null,Fk={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Bk(n){var e=n.type,t=n.tagName;return!!(t==="INPUT"&&Fk[e]&&!n.readOnly||t==="TEXTAREA"&&!n.readOnly||n.isContentEditable)}function Uk(n){n.metaKey||n.altKey||n.ctrlKey||(Zp=!0)}function T0(){Zp=!1}function Vk(){this.visibilityState==="hidden"&&Fv&&(Zp=!0)}function zk(n){n.addEventListener("keydown",Uk,!0),n.addEventListener("mousedown",T0,!0),n.addEventListener("pointerdown",T0,!0),n.addEventListener("touchstart",T0,!0),n.addEventListener("visibilitychange",Vk,!0)}function $k(n){var e=n.target;try{return e.matches(":focus-visible")}catch{}return Zp||Bk(e)}function jk(){Fv=!0,window.clearTimeout(Zb),Zb=window.setTimeout(function(){Fv=!1},100)}function w_(){var n=B.useCallback(function(e){var t=Io.findDOMNode(e);t!=null&&zk(t.ownerDocument)},[]);return{isFocusVisible:$k,onBlurVisible:jk,ref:n}}function Wk(n){return $S(n)||zS(n)||g_(n)||jS()}const Qb={disabled:!1},Nh=Xt.createContext(null);var Hk=function(e){return e.scrollTop},uu="unmounted",Jo="exited",ea="entering",Tl="entered",Bv="exiting",Ys=function(n){Yp(e,n);function e(r,s){var i;i=n.call(this,r,s)||this;var o=s,a=o&&!o.isMounting?r.enter:r.appear,u;return i.appearStatus=null,r.in?a?(u=Jo,i.appearStatus=ea):u=Tl:r.unmountOnExit||r.mountOnEnter?u=uu:u=Jo,i.state={status:u},i.nextCallback=null,i}e.getDerivedStateFromProps=function(s,i){var o=s.in;return o&&i.status===uu?{status:Jo}:null};var t=e.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(s){var i=null;if(s!==this.props){var o=this.state.status;this.props.in?o!==ea&&o!==Tl&&(i=ea):(o===ea||o===Tl)&&(i=Bv)}this.updateStatus(!1,i)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var s=this.props.timeout,i,o,a;return i=o=a=s,s!=null&&typeof s!="number"&&(i=s.exit,o=s.enter,a=s.appear!==void 0?s.appear:o),{exit:i,enter:o,appear:a}},t.updateStatus=function(s,i){if(s===void 0&&(s=!1),i!==null)if(this.cancelNextCallback(),i===ea){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:Ld.findDOMNode(this);o&&Hk(o)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Jo&&this.setState({status:uu})},t.performEnter=function(s){var i=this,o=this.props.enter,a=this.context?this.context.isMounting:s,u=this.props.nodeRef?[a]:[Ld.findDOMNode(this),a],f=u[0],d=u[1],p=this.getTimeouts(),m=a?p.appear:p.enter;if(!s&&!o||Qb.disabled){this.safeSetState({status:Tl},function(){i.props.onEntered(f)});return}this.props.onEnter(f,d),this.safeSetState({status:ea},function(){i.props.onEntering(f,d),i.onTransitionEnd(m,function(){i.safeSetState({status:Tl},function(){i.props.onEntered(f,d)})})})},t.performExit=function(){var s=this,i=this.props.exit,o=this.getTimeouts(),a=this.props.nodeRef?void 0:Ld.findDOMNode(this);if(!i||Qb.disabled){this.safeSetState({status:Jo},function(){s.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:Bv},function(){s.props.onExiting(a),s.onTransitionEnd(o.exit,function(){s.safeSetState({status:Jo},function(){s.props.onExited(a)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(s,i){i=this.setNextCallback(i),this.setState(s,i)},t.setNextCallback=function(s){var i=this,o=!0;return this.nextCallback=function(a){o&&(o=!1,i.nextCallback=null,s(a))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},t.onTransitionEnd=function(s,i){this.setNextCallback(i);var o=this.props.nodeRef?this.props.nodeRef.current:Ld.findDOMNode(this),a=s==null&&!this.props.addEndListener;if(!o||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var u=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],f=u[0],d=u[1];this.props.addEndListener(f,d)}s!=null&&setTimeout(this.nextCallback,s)},t.render=function(){var s=this.state.status;if(s===uu)return null;var i=this.props,o=i.children;i.in,i.mountOnEnter,i.unmountOnExit,i.appear,i.enter,i.exit,i.timeout,i.addEndListener,i.onEnter,i.onEntering,i.onEntered,i.onExit,i.onExiting,i.onExited,i.nodeRef;var a=Wp(i,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Xt.createElement(Nh.Provider,{value:null},typeof o=="function"?o(s,a):Xt.cloneElement(Xt.Children.only(o),a))},e}(Xt.Component);Ys.contextType=Nh;Ys.propTypes={};function pl(){}Ys.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:pl,onEntering:pl,onEntered:pl,onExit:pl,onExiting:pl,onExited:pl};Ys.UNMOUNTED=uu;Ys.EXITED=Jo;Ys.ENTERING=ea;Ys.ENTERED=Tl;Ys.EXITING=Bv;function T_(n,e){var t=function(i){return e&&B.isValidElement(i)?e(i):i},r=Object.create(null);return n&&B.Children.map(n,function(s){return s}).forEach(function(s){r[s.key]=t(s)}),r}function Xk(n,e){n=n||{},e=e||{};function t(d){return d in e?e[d]:n[d]}var r=Object.create(null),s=[];for(var i in n)i in e?s.length&&(r[i]=s,s=[]):s.push(i);var o,a={};for(var u in e){if(r[u])for(o=0;o<r[u].length;o++){var f=r[u][o];a[r[u][o]]=t(f)}a[u]=t(u)}for(o=0;o<s.length;o++)a[s[o]]=t(s[o]);return a}function sa(n,e,t){return t[e]!=null?t[e]:n.props[e]}function Yk(n,e){return T_(n.children,function(t){return B.cloneElement(t,{onExited:e.bind(null,t),in:!0,appear:sa(t,"appear",n),enter:sa(t,"enter",n),exit:sa(t,"exit",n)})})}function qk(n,e,t){var r=T_(n.children),s=Xk(e,r);return Object.keys(s).forEach(function(i){var o=s[i];if(B.isValidElement(o)){var a=i in e,u=i in r,f=e[i],d=B.isValidElement(f)&&!f.props.in;u&&(!a||d)?s[i]=B.cloneElement(o,{onExited:t.bind(null,o),in:!0,exit:sa(o,"exit",n),enter:sa(o,"enter",n)}):!u&&a&&!d?s[i]=B.cloneElement(o,{in:!1}):u&&a&&B.isValidElement(f)&&(s[i]=B.cloneElement(o,{onExited:t.bind(null,o),in:f.props.in,exit:sa(o,"exit",n),enter:sa(o,"enter",n)}))}}),s}var Kk=Object.values||function(n){return Object.keys(n).map(function(e){return n[e]})},Zk={component:"div",childFactory:function(e){return e}},S_=function(n){Yp(e,n);function e(r,s){var i;i=n.call(this,r,s)||this;var o=i.handleExited.bind(Av(i));return i.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},i}var t=e.prototype;return t.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},t.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(s,i){var o=i.children,a=i.handleExited,u=i.firstRender;return{children:u?Yk(s,a):qk(s,o,a),firstRender:!1}},t.handleExited=function(s,i){var o=T_(this.props.children);s.key in o||(s.props.onExited&&s.props.onExited(i),this.mounted&&this.setState(function(a){var u=Ee({},a.children);return delete u[s.key],{children:u}}))},t.render=function(){var s=this.props,i=s.component,o=s.childFactory,a=Wp(s,["component","childFactory"]),u=this.state.contextValue,f=Kk(this.state.children).map(o);return delete a.appear,delete a.enter,delete a.exit,i===null?Xt.createElement(Nh.Provider,{value:u},f):Xt.createElement(Nh.Provider,{value:u},Xt.createElement(i,a,f))},e}(Xt.Component);S_.propTypes={};S_.defaultProps=Zk;var Qk=function(e){return e.scrollTop};function Dh(n,e){var t=n.timeout,r=n.style,s=r===void 0?{}:r;return{duration:s.transitionDuration||typeof t=="number"?t:t[e.mode]||0,delay:s.transitionDelay}}var Gk=function(e){return{root:{height:0,overflow:"hidden",transition:e.transitions.create("height")},entered:{height:"auto",overflow:"visible"},hidden:{visibility:"hidden"},wrapper:{display:"flex"},wrapperInner:{width:"100%"}}},vE=B.forwardRef(function(e,t){var r=e.children,s=e.classes,i=e.className,o=e.collapsedHeight,a=e.collapsedSize,u=a===void 0?"0px":a,f=e.component,d=f===void 0?"div":f,p=e.disableStrictModeCompat,m=p===void 0?!1:p,v=e.in,x=e.onEnter,b=e.onEntered,w=e.onEntering,S=e.onExit,R=e.onExited,C=e.onExiting,O=e.style,I=e.timeout,F=I===void 0?Sv.standard:I,$=e.TransitionComponent,q=$===void 0?Ys:$,K=Ct(e,["children","classes","className","collapsedHeight","collapsedSize","component","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),le=b_(),he=B.useRef(),pe=B.useRef(null),se=B.useRef(),ye=typeof(o||u)=="number"?"".concat(o||u,"px"):o||u;B.useEffect(function(){return function(){clearTimeout(he.current)}},[]);var Me=le.unstable_strictMode&&!m,U=B.useRef(null),H=nr(t,Me?U:void 0),D=function(ue){return function(ve,be){if(ue){var Pe=Me?[U.current,ve]:[ve,be],Ue=Xp(Pe,2),Ke=Ue[0],nt=Ue[1];nt===void 0?ue(Ke):ue(Ke,nt)}}},Y=D(function(re,ue){re.style.height=ye,x&&x(re,ue)}),M=D(function(re,ue){var ve=pe.current?pe.current.clientHeight:0,be=Dh({style:O,timeout:F},{mode:"enter"}),Pe=be.duration;if(F==="auto"){var Ue=le.transitions.getAutoHeightDuration(ve);re.style.transitionDuration="".concat(Ue,"ms"),se.current=Ue}else re.style.transitionDuration=typeof Pe=="string"?Pe:"".concat(Pe,"ms");re.style.height="".concat(ve,"px"),w&&w(re,ue)}),T=D(function(re,ue){re.style.height="auto",b&&b(re,ue)}),N=D(function(re){var ue=pe.current?pe.current.clientHeight:0;re.style.height="".concat(ue,"px"),S&&S(re)}),W=D(R),Z=D(function(re){var ue=pe.current?pe.current.clientHeight:0,ve=Dh({style:O,timeout:F},{mode:"exit"}),be=ve.duration;if(F==="auto"){var Pe=le.transitions.getAutoHeightDuration(ue);re.style.transitionDuration="".concat(Pe,"ms"),se.current=Pe}else re.style.transitionDuration=typeof be=="string"?be:"".concat(be,"ms");re.style.height=ye,C&&C(re)}),te=function(ue,ve){var be=Me?ue:ve;F==="auto"&&(he.current=setTimeout(be,se.current||0))};return B.createElement(q,Ee({in:v,onEnter:Y,onEntered:T,onEntering:M,onExit:N,onExited:W,onExiting:Z,addEndListener:te,nodeRef:Me?U:void 0,timeout:F==="auto"?null:F},K),function(re,ue){return B.createElement(d,Ee({className:Et(s.root,s.container,i,{entered:s.entered,exited:!v&&ye==="0px"&&s.hidden}[re]),style:Ee({minHeight:ye},O),ref:H},ue),B.createElement("div",{className:s.wrapper,ref:pe},B.createElement("div",{className:s.wrapperInner},r)))})});vE.muiSupportAuto=!0;const Jk=Pn(Gk,{name:"MuiCollapse"})(vE);var eM=function(e){var t={};return e.shadows.forEach(function(r,s){t["elevation".concat(s)]={boxShadow:r}}),Ee({root:{backgroundColor:e.palette.background.paper,color:e.palette.text.primary,transition:e.transitions.create("box-shadow")},rounded:{borderRadius:e.shape.borderRadius},outlined:{border:"1px solid ".concat(e.palette.divider)}},t)},tM=B.forwardRef(function(e,t){var r=e.classes,s=e.className,i=e.component,o=i===void 0?"div":i,a=e.square,u=a===void 0?!1:a,f=e.elevation,d=f===void 0?1:f,p=e.variant,m=p===void 0?"elevation":p,v=Ct(e,["classes","className","component","square","elevation","variant"]);return B.createElement(o,Ee({className:Et(r.root,s,m==="outlined"?r.outlined:r["elevation".concat(d)],!u&&r.rounded),ref:t},v))});const mf=Pn(eM,{name:"MuiPaper"})(tM);var yE=B.createContext({}),nM=function(e){var t={duration:e.transitions.duration.shortest};return{root:{position:"relative",transition:e.transitions.create(["margin"],t),"&:before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:e.palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-child":{"&:before":{display:"none"}},"&$expanded":{margin:"16px 0","&:first-child":{marginTop:0},"&:last-child":{marginBottom:0},"&:before":{opacity:0}},"&$expanded + &":{"&:before":{display:"none"}},"&$disabled":{backgroundColor:e.palette.action.disabledBackground}},rounded:{borderRadius:0,"&:first-child":{borderTopLeftRadius:e.shape.borderRadius,borderTopRightRadius:e.shape.borderRadius},"&:last-child":{borderBottomLeftRadius:e.shape.borderRadius,borderBottomRightRadius:e.shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}},expanded:{},disabled:{}}},rM=B.forwardRef(function(e,t){var r=e.children,s=e.classes,i=e.className,o=e.defaultExpanded,a=o===void 0?!1:o,u=e.disabled,f=u===void 0?!1:u,d=e.expanded,p=e.onChange,m=e.square,v=m===void 0?!1:m,x=e.TransitionComponent,b=x===void 0?Jk:x,w=e.TransitionProps,S=Ct(e,["children","classes","className","defaultExpanded","disabled","expanded","onChange","square","TransitionComponent","TransitionProps"]),R=gE({controlled:d,default:a,name:"Accordion",state:"expanded"}),C=Xp(R,2),O=C[0],I=C[1],F=B.useCallback(function(pe){I(!O),p&&p(pe,!O)},[O,p,I]),$=B.Children.toArray(r),q=Wk($),K=q[0],le=q.slice(1),he=B.useMemo(function(){return{expanded:O,disabled:f,toggle:F}},[O,f,F]);return B.createElement(mf,Ee({className:Et(s.root,i,O&&s.expanded,f&&s.disabled,!v&&s.rounded),ref:t,square:v},S),B.createElement(yE.Provider,{value:he},K),B.createElement(b,Ee({in:O,timeout:"auto"},w),B.createElement("div",{"aria-labelledby":K.props.id,id:K.props["aria-controls"],role:"region"},le)))});const sM=Pn(nM,{name:"MuiAccordion"})(rM);var iM=function(e){return{root:{display:"flex",padding:e.spacing(1,2,2)}}},oM=B.forwardRef(function(e,t){var r=e.classes,s=e.className,i=Ct(e,["classes","className"]);return B.createElement("div",Ee({className:Et(r.root,s),ref:t},i))});const aM=Pn(iM,{name:"MuiAccordionDetails"})(oM);var lM=typeof window>"u"?B.useEffect:B.useLayoutEffect;function cM(n){var e=n.classes,t=n.pulsate,r=t===void 0?!1:t,s=n.rippleX,i=n.rippleY,o=n.rippleSize,a=n.in,u=n.onExited,f=u===void 0?function(){}:u,d=n.timeout,p=B.useState(!1),m=p[0],v=p[1],x=Et(e.ripple,e.rippleVisible,r&&e.ripplePulsate),b={width:o,height:o,top:-(o/2)+i,left:-(o/2)+s},w=Et(e.child,m&&e.childLeaving,r&&e.childPulsate),S=Gn(f);return lM(function(){if(!a){v(!0);var R=setTimeout(S,d);return function(){clearTimeout(R)}}},[S,a,d]),B.createElement("span",{className:x,style:b},B.createElement("span",{className:w}))}var Uv=550,uM=80,fM=function(e){return{root:{overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"},ripple:{opacity:0,position:"absolute"},rippleVisible:{opacity:.3,transform:"scale(1)",animation:"$enter ".concat(Uv,"ms ").concat(e.transitions.easing.easeInOut)},ripplePulsate:{animationDuration:"".concat(e.transitions.duration.shorter,"ms")},child:{opacity:1,display:"block",width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"currentColor"},childLeaving:{opacity:0,animation:"$exit ".concat(Uv,"ms ").concat(e.transitions.easing.easeInOut)},childPulsate:{position:"absolute",left:0,top:0,animation:"$pulsate 2500ms ".concat(e.transitions.easing.easeInOut," 200ms infinite")},"@keyframes enter":{"0%":{transform:"scale(0)",opacity:.1},"100%":{transform:"scale(1)",opacity:.3}},"@keyframes exit":{"0%":{opacity:1},"100%":{opacity:0}},"@keyframes pulsate":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(0.92)"},"100%":{transform:"scale(1)"}}}},dM=B.forwardRef(function(e,t){var r=e.center,s=r===void 0?!1:r,i=e.classes,o=e.className,a=Ct(e,["center","classes","className"]),u=B.useState([]),f=u[0],d=u[1],p=B.useRef(0),m=B.useRef(null);B.useEffect(function(){m.current&&(m.current(),m.current=null)},[f]);var v=B.useRef(!1),x=B.useRef(null),b=B.useRef(null),w=B.useRef(null);B.useEffect(function(){return function(){clearTimeout(x.current)}},[]);var S=B.useCallback(function(I){var F=I.pulsate,$=I.rippleX,q=I.rippleY,K=I.rippleSize,le=I.cb;d(function(he){return[].concat(Hp(he),[B.createElement(cM,{key:p.current,classes:i,timeout:Uv,pulsate:F,rippleX:$,rippleY:q,rippleSize:K})])}),p.current+=1,m.current=le},[i]),R=B.useCallback(function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$=arguments.length>2?arguments[2]:void 0,q=F.pulsate,K=q===void 0?!1:q,le=F.center,he=le===void 0?s||F.pulsate:le,pe=F.fakeElement,se=pe===void 0?!1:pe;if(I.type==="mousedown"&&v.current){v.current=!1;return}I.type==="touchstart"&&(v.current=!0);var ye=se?null:w.current,Me=ye?ye.getBoundingClientRect():{width:0,height:0,left:0,top:0},U,H,D;if(he||I.clientX===0&&I.clientY===0||!I.clientX&&!I.touches)U=Math.round(Me.width/2),H=Math.round(Me.height/2);else{var Y=I.touches?I.touches[0]:I,M=Y.clientX,T=Y.clientY;U=Math.round(M-Me.left),H=Math.round(T-Me.top)}if(he)D=Math.sqrt((2*Math.pow(Me.width,2)+Math.pow(Me.height,2))/3),D%2===0&&(D+=1);else{var N=Math.max(Math.abs((ye?ye.clientWidth:0)-U),U)*2+2,W=Math.max(Math.abs((ye?ye.clientHeight:0)-H),H)*2+2;D=Math.sqrt(Math.pow(N,2)+Math.pow(W,2))}I.touches?b.current===null&&(b.current=function(){S({pulsate:K,rippleX:U,rippleY:H,rippleSize:D,cb:$})},x.current=setTimeout(function(){b.current&&(b.current(),b.current=null)},uM)):S({pulsate:K,rippleX:U,rippleY:H,rippleSize:D,cb:$})},[s,S]),C=B.useCallback(function(){R({},{pulsate:!0})},[R]),O=B.useCallback(function(I,F){if(clearTimeout(x.current),I.type==="touchend"&&b.current){I.persist(),b.current(),b.current=null,x.current=setTimeout(function(){O(I,F)});return}b.current=null,d(function($){return $.length>0?$.slice(1):$}),m.current=F},[]);return B.useImperativeHandle(t,function(){return{pulsate:C,start:R,stop:O}},[C,R,O]),B.createElement("span",Ee({className:Et(i.root,o),ref:w},a),B.createElement(S_,{component:null,exit:!0},f))});const hM=Pn(fM,{flip:!1,name:"MuiTouchRipple"})(B.memo(dM));var pM={root:{display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},"&$disabled":{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}},disabled:{},focusVisible:{}},gM=B.forwardRef(function(e,t){var r=e.action,s=e.buttonRef,i=e.centerRipple,o=i===void 0?!1:i,a=e.children,u=e.classes,f=e.className,d=e.component,p=d===void 0?"button":d,m=e.disabled,v=m===void 0?!1:m,x=e.disableRipple,b=x===void 0?!1:x,w=e.disableTouchRipple,S=w===void 0?!1:w,R=e.focusRipple,C=R===void 0?!1:R,O=e.focusVisibleClassName,I=e.onBlur,F=e.onClick,$=e.onFocus,q=e.onFocusVisible,K=e.onKeyDown,le=e.onKeyUp,he=e.onMouseDown,pe=e.onMouseLeave,se=e.onMouseUp,ye=e.onTouchEnd,Me=e.onTouchMove,U=e.onTouchStart,H=e.onDragLeave,D=e.tabIndex,Y=D===void 0?0:D,M=e.TouchRippleProps,T=e.type,N=T===void 0?"button":T,W=Ct(e,["action","buttonRef","centerRipple","children","classes","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","onBlur","onClick","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","onDragLeave","tabIndex","TouchRippleProps","type"]),Z=B.useRef(null);function te(){return Io.findDOMNode(Z.current)}var re=B.useRef(null),ue=B.useState(!1),ve=ue[0],be=ue[1];v&&ve&&be(!1);var Pe=w_(),Ue=Pe.isFocusVisible,Ke=Pe.onBlurVisible,nt=Pe.ref;B.useImperativeHandle(r,function(){return{focusVisible:function(){be(!0),Z.current.focus()}}},[]),B.useEffect(function(){ve&&C&&!b&&re.current.pulsate()},[b,C,ve]);function Ge(Qe,kn){var Zs=arguments.length>2&&arguments[2]!==void 0?arguments[2]:S;return Gn(function(is){kn&&kn(is);var wn=Zs;return!wn&&re.current&&re.current[Qe](is),!0})}var He=Ge("start",he),Ie=Ge("stop",H),ct=Ge("stop",se),xn=Ge("stop",function(Qe){ve&&Qe.preventDefault(),pe&&pe(Qe)}),$t=Ge("start",U),Ot=Ge("stop",ye),ht=Ge("stop",Me),at=Ge("stop",function(Qe){ve&&(Ke(Qe),be(!1)),I&&I(Qe)},!1),Mt=Gn(function(Qe){Z.current||(Z.current=Qe.currentTarget),Ue(Qe)&&(be(!0),q&&q(Qe)),$&&$(Qe)}),Ut=function(){var kn=te();return p&&p!=="button"&&!(kn.tagName==="A"&&kn.href)},In=B.useRef(!1),bn=Gn(function(Qe){C&&!In.current&&ve&&re.current&&Qe.key===" "&&(In.current=!0,Qe.persist(),re.current.stop(Qe,function(){re.current.start(Qe)})),Qe.target===Qe.currentTarget&&Ut()&&Qe.key===" "&&Qe.preventDefault(),K&&K(Qe),Qe.target===Qe.currentTarget&&Ut()&&Qe.key==="Enter"&&!v&&(Qe.preventDefault(),F&&F(Qe))}),Ur=Gn(function(Qe){C&&Qe.key===" "&&re.current&&ve&&!Qe.defaultPrevented&&(In.current=!1,Qe.persist(),re.current.stop(Qe,function(){re.current.pulsate(Qe)})),le&&le(Qe),F&&Qe.target===Qe.currentTarget&&Ut()&&Qe.key===" "&&!Qe.defaultPrevented&&F(Qe)}),Qt=p;Qt==="button"&&W.href&&(Qt="a");var mt={};Qt==="button"?(mt.type=N,mt.disabled=v):((Qt!=="a"||!W.href)&&(mt.role="button"),mt["aria-disabled"]=v);var Ln=nr(s,t),Vt=nr(nt,Z),Sr=nr(Ln,Vt),cr=B.useState(!1),Ai=cr[0],Do=cr[1];B.useEffect(function(){Do(!0)},[]);var Ks=Ai&&!b&&!v;return B.createElement(Qt,Ee({className:Et(u.root,f,ve&&[u.focusVisible,O],v&&u.disabled),onBlur:at,onClick:F,onFocus:Mt,onKeyDown:bn,onKeyUp:Ur,onMouseDown:He,onMouseLeave:xn,onMouseUp:ct,onDragLeave:Ie,onTouchEnd:Ot,onTouchMove:ht,onTouchStart:$t,ref:Sr,tabIndex:v?-1:Y},mt,W),a,Ks?B.createElement(hM,Ee({ref:re,center:o},M)):null)});const _E=Pn(pM,{name:"MuiButtonBase"})(gM);var mM=function(e){return{root:{textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:12,borderRadius:"50%",overflow:"visible",color:e.palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{backgroundColor:fo(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{backgroundColor:"transparent",color:e.palette.action.disabled}},edgeStart:{marginLeft:-12,"$sizeSmall&":{marginLeft:-3}},edgeEnd:{marginRight:-12,"$sizeSmall&":{marginRight:-3}},colorInherit:{color:"inherit"},colorPrimary:{color:e.palette.primary.main,"&:hover":{backgroundColor:fo(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},colorSecondary:{color:e.palette.secondary.main,"&:hover":{backgroundColor:fo(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},disabled:{},sizeSmall:{padding:3,fontSize:e.typography.pxToRem(18)},label:{width:"100%",display:"flex",alignItems:"inherit",justifyContent:"inherit"}}},vM=B.forwardRef(function(e,t){var r=e.edge,s=r===void 0?!1:r,i=e.children,o=e.classes,a=e.className,u=e.color,f=u===void 0?"default":u,d=e.disabled,p=d===void 0?!1:d,m=e.disableFocusRipple,v=m===void 0?!1:m,x=e.size,b=x===void 0?"medium":x,w=Ct(e,["edge","children","classes","className","color","disabled","disableFocusRipple","size"]);return B.createElement(_E,Ee({className:Et(o.root,a,f!=="default"&&o["color".concat(Gr(f))],p&&o.disabled,b==="small"&&o["size".concat(Gr(b))],{start:o.edgeStart,end:o.edgeEnd}[s]),centerRipple:!0,focusRipple:!v,disabled:p,ref:t},w),B.createElement("span",{className:o.label},i))});const Hs=Pn(mM,{name:"MuiIconButton"})(vM);var yM=function(e){var t={duration:e.transitions.duration.shortest};return{root:{display:"flex",minHeight:8*6,transition:e.transitions.create(["min-height","background-color"],t),padding:e.spacing(0,2),"&:hover:not($disabled)":{cursor:"pointer"},"&$expanded":{minHeight:64},"&$focused, &$focusVisible":{backgroundColor:e.palette.action.focus},"&$disabled":{opacity:e.palette.action.disabledOpacity}},expanded:{},focused:{},focusVisible:{},disabled:{},content:{display:"flex",flexGrow:1,transition:e.transitions.create(["margin"],t),margin:"12px 0","&$expanded":{margin:"20px 0"}},expandIcon:{transform:"rotate(0deg)",transition:e.transitions.create("transform",t),"&:hover":{backgroundColor:"transparent"},"&$expanded":{transform:"rotate(180deg)"}}}},_M=B.forwardRef(function(e,t){var r=e.children,s=e.classes,i=e.className,o=e.expandIcon,a=e.focusVisibleClassName,u=e.IconButtonProps,f=u===void 0?{}:u,d=e.onClick,p=Ct(e,["children","classes","className","expandIcon","focusVisibleClassName","IconButtonProps","onClick"]),m=B.useContext(yE),v=m.disabled,x=v===void 0?!1:v,b=m.expanded,w=m.toggle,S=function(C){w&&w(C),d&&d(C)};return B.createElement(_E,Ee({focusRipple:!1,disableRipple:!0,disabled:x,component:"div","aria-expanded":b,className:Et(s.root,i,x&&s.disabled,b&&s.expanded),focusVisibleClassName:Et(s.focusVisible,s.focused,a),onClick:S,ref:t},p),B.createElement("div",{className:Et(s.content,b&&s.expanded)},r),o&&B.createElement(Hs,Ee({className:Et(s.expandIcon,b&&s.expanded),edge:"end",component:"div",tabIndex:null,role:null,"aria-hidden":!0},f),o))});const xM=Pn(yM,{name:"MuiAccordionSummary"})(_M);var bM=function(e){return{root:{margin:0},body2:e.typography.body2,body1:e.typography.body1,caption:e.typography.caption,button:e.typography.button,h1:e.typography.h1,h2:e.typography.h2,h3:e.typography.h3,h4:e.typography.h4,h5:e.typography.h5,h6:e.typography.h6,subtitle1:e.typography.subtitle1,subtitle2:e.typography.subtitle2,overline:e.typography.overline,srOnly:{position:"absolute",height:1,width:1,overflow:"hidden"},alignLeft:{textAlign:"left"},alignCenter:{textAlign:"center"},alignRight:{textAlign:"right"},alignJustify:{textAlign:"justify"},noWrap:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},gutterBottom:{marginBottom:"0.35em"},paragraph:{marginBottom:16},colorInherit:{color:"inherit"},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorTextPrimary:{color:e.palette.text.primary},colorTextSecondary:{color:e.palette.text.secondary},colorError:{color:e.palette.error.main},displayInline:{display:"inline"},displayBlock:{display:"block"}}},Gb={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p"},wM=B.forwardRef(function(e,t){var r=e.align,s=r===void 0?"inherit":r,i=e.classes,o=e.className,a=e.color,u=a===void 0?"initial":a,f=e.component,d=e.display,p=d===void 0?"initial":d,m=e.gutterBottom,v=m===void 0?!1:m,x=e.noWrap,b=x===void 0?!1:x,w=e.paragraph,S=w===void 0?!1:w,R=e.variant,C=R===void 0?"body1":R,O=e.variantMapping,I=O===void 0?Gb:O,F=Ct(e,["align","classes","className","color","component","display","gutterBottom","noWrap","paragraph","variant","variantMapping"]),$=f||(S?"p":I[C]||Gb[C])||"span";return B.createElement($,Ee({className:Et(i.root,o,C!=="inherit"&&i[C],u!=="initial"&&i["color".concat(Gr(u))],b&&i.noWrap,v&&i.gutterBottom,S&&i.paragraph,s!=="inherit"&&i["align".concat(Gr(s))],p!=="initial"&&i["display".concat(Gr(p))]),ref:t},F))});const ar=Pn(bM,{name:"MuiTypography"})(wM);var E_=B.createContext();function TM(){return B.useContext(E_)}function SM(){return B.useContext(E_)}function EM(n){return n=typeof n=="function"?n():n,Io.findDOMNode(n)}var S0=typeof window<"u"?B.useLayoutEffect:B.useEffect,AM=B.forwardRef(function(e,t){var r=e.children,s=e.container,i=e.disablePortal,o=i===void 0?!1:i,a=e.onRendered,u=B.useState(null),f=u[0],d=u[1],p=nr(B.isValidElement(r)?r.ref:null,t);return S0(function(){o||d(EM(s)||document.body)},[s,o]),S0(function(){if(f&&!o)return Oh(t,f),function(){Oh(t,null)}},[t,f,o]),S0(function(){a&&(f||o)&&a()},[a,f,o]),o?B.isValidElement(r)?B.cloneElement(r,{ref:p}):r:f&&Io.createPortal(r,f)});function CM(){var n=document.createElement("div");n.style.width="99px",n.style.height="99px",n.style.position="absolute",n.style.top="-9999px",n.style.overflow="scroll",document.body.appendChild(n);var e=n.offsetWidth-n.clientWidth;return document.body.removeChild(n),e}function RM(n){var e=ms(n);return e.body===n?pE(e).innerWidth>e.documentElement.clientWidth:n.scrollHeight>n.clientHeight}function Tu(n,e){e?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden")}function Jb(n){return parseInt(window.getComputedStyle(n)["padding-right"],10)||0}function e3(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],s=arguments.length>4?arguments[4]:void 0,i=[e,t].concat(Hp(r)),o=["TEMPLATE","SCRIPT","STYLE"];[].forEach.call(n.children,function(a){a.nodeType===1&&i.indexOf(a)===-1&&o.indexOf(a.tagName)===-1&&Tu(a,s)})}function E0(n,e){var t=-1;return n.some(function(r,s){return e(r)?(t=s,!0):!1}),t}function PM(n,e){var t=[],r=[],s=n.container,i;if(!e.disableScrollLock){if(RM(s)){var o=CM();t.push({value:s.style.paddingRight,key:"padding-right",el:s}),s.style["padding-right"]="".concat(Jb(s)+o,"px"),i=ms(s).querySelectorAll(".mui-fixed"),[].forEach.call(i,function(d){r.push(d.style.paddingRight),d.style.paddingRight="".concat(Jb(d)+o,"px")})}var a=s.parentElement,u=a.nodeName==="HTML"&&window.getComputedStyle(a)["overflow-y"]==="scroll"?a:s;t.push({value:u.style.overflow,key:"overflow",el:u}),u.style.overflow="hidden"}var f=function(){i&&[].forEach.call(i,function(p,m){r[m]?p.style.paddingRight=r[m]:p.style.removeProperty("padding-right")}),t.forEach(function(p){var m=p.value,v=p.el,x=p.key;m?v.style.setProperty(x,m):v.style.removeProperty(x)})};return f}function IM(n){var e=[];return[].forEach.call(n.children,function(t){t.getAttribute&&t.getAttribute("aria-hidden")==="true"&&e.push(t)}),e}var kM=function(){function n(){Sk(this,n),this.modals=[],this.containers=[]}return m_(n,[{key:"add",value:function(t,r){var s=this.modals.indexOf(t);if(s!==-1)return s;s=this.modals.length,this.modals.push(t),t.modalRef&&Tu(t.modalRef,!1);var i=IM(r);e3(r,t.mountNode,t.modalRef,i,!0);var o=E0(this.containers,function(a){return a.container===r});return o!==-1?(this.containers[o].modals.push(t),s):(this.containers.push({modals:[t],container:r,restore:null,hiddenSiblingNodes:i}),s)}},{key:"mount",value:function(t,r){var s=E0(this.containers,function(o){return o.modals.indexOf(t)!==-1}),i=this.containers[s];i.restore||(i.restore=PM(i,r))}},{key:"remove",value:function(t){var r=this.modals.indexOf(t);if(r===-1)return r;var s=E0(this.containers,function(a){return a.modals.indexOf(t)!==-1}),i=this.containers[s];if(i.modals.splice(i.modals.indexOf(t),1),this.modals.splice(r,1),i.modals.length===0)i.restore&&i.restore(),t.modalRef&&Tu(t.modalRef,!0),e3(i.container,t.mountNode,t.modalRef,i.hiddenSiblingNodes,!1),this.containers.splice(s,1);else{var o=i.modals[i.modals.length-1];o.modalRef&&Tu(o.modalRef,!1)}return r}},{key:"isTopModal",value:function(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}}]),n}();function MM(n){var e=n.children,t=n.disableAutoFocus,r=t===void 0?!1:t,s=n.disableEnforceFocus,i=s===void 0?!1:s,o=n.disableRestoreFocus,a=o===void 0?!1:o,u=n.getDoc,f=n.isEnabled,d=n.open,p=B.useRef(),m=B.useRef(null),v=B.useRef(null),x=B.useRef(),b=B.useRef(null),w=B.useCallback(function(C){b.current=Io.findDOMNode(C)},[]),S=nr(e.ref,w),R=B.useRef();return B.useEffect(function(){R.current=d},[d]),!R.current&&d&&typeof window<"u"&&(x.current=u().activeElement),B.useEffect(function(){if(d){var C=ms(b.current);!r&&b.current&&!b.current.contains(C.activeElement)&&(b.current.hasAttribute("tabIndex")||b.current.setAttribute("tabIndex",-1),b.current.focus());var O=function(){var q=b.current;if(q!==null){if(!C.hasFocus()||i||!f()||p.current){p.current=!1;return}b.current&&!b.current.contains(C.activeElement)&&b.current.focus()}},I=function(q){i||!f()||q.keyCode!==9||C.activeElement===b.current&&(p.current=!0,q.shiftKey?v.current.focus():m.current.focus())};C.addEventListener("focus",O,!0),C.addEventListener("keydown",I,!0);var F=setInterval(function(){O()},50);return function(){clearInterval(F),C.removeEventListener("focus",O,!0),C.removeEventListener("keydown",I,!0),a||(x.current&&x.current.focus&&x.current.focus(),x.current=null)}}},[r,i,a,f,d]),B.createElement(B.Fragment,null,B.createElement("div",{tabIndex:0,ref:m,"data-test":"sentinelStart"}),B.cloneElement(e,{ref:S}),B.createElement("div",{tabIndex:0,ref:v,"data-test":"sentinelEnd"}))}var t3={root:{zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},invisible:{backgroundColor:"transparent"}},OM=B.forwardRef(function(e,t){var r=e.invisible,s=r===void 0?!1:r,i=e.open,o=Ct(e,["invisible","open"]);return i?B.createElement("div",Ee({"aria-hidden":!0,ref:t},o,{style:Ee({},t3.root,s?t3.invisible:{},o.style)})):null});function NM(n){return n=typeof n=="function"?n():n,Io.findDOMNode(n)}function DM(n){return n.children?n.children.props.hasOwnProperty("in"):!1}var LM=new kM,FM=function(e){return{root:{position:"fixed",zIndex:e.zIndex.modal,right:0,bottom:0,top:0,left:0},hidden:{visibility:"hidden"}}},BM=B.forwardRef(function(e,t){var r=gf(),s=YS({name:"MuiModal",props:Ee({},e),theme:r}),i=s.BackdropComponent,o=i===void 0?OM:i,a=s.BackdropProps,u=s.children,f=s.closeAfterTransition,d=f===void 0?!1:f,p=s.container,m=s.disableAutoFocus,v=m===void 0?!1:m,x=s.disableBackdropClick,b=x===void 0?!1:x,w=s.disableEnforceFocus,S=w===void 0?!1:w,R=s.disableEscapeKeyDown,C=R===void 0?!1:R,O=s.disablePortal,I=O===void 0?!1:O,F=s.disableRestoreFocus,$=F===void 0?!1:F,q=s.disableScrollLock,K=q===void 0?!1:q,le=s.hideBackdrop,he=le===void 0?!1:le,pe=s.keepMounted,se=pe===void 0?!1:pe,ye=s.manager,Me=ye===void 0?LM:ye,U=s.onBackdropClick,H=s.onClose,D=s.onEscapeKeyDown,Y=s.onRendered,M=s.open,T=Ct(s,["BackdropComponent","BackdropProps","children","closeAfterTransition","container","disableAutoFocus","disableBackdropClick","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onEscapeKeyDown","onRendered","open"]),N=B.useState(!0),W=N[0],Z=N[1],te=B.useRef({}),re=B.useRef(null),ue=B.useRef(null),ve=nr(ue,t),be=DM(s),Pe=function(){return ms(re.current)},Ue=function(){return te.current.modalRef=ue.current,te.current.mountNode=re.current,te.current},Ke=function(){Me.mount(Ue(),{disableScrollLock:K}),ue.current.scrollTop=0},nt=Gn(function(){var Mt=NM(p)||Pe().body;Me.add(Ue(),Mt),ue.current&&Ke()}),Ge=B.useCallback(function(){return Me.isTopModal(Ue())},[Me]),He=Gn(function(Mt){re.current=Mt,Mt&&(Y&&Y(),M&&Ge()?Ke():Tu(ue.current,!0))}),Ie=B.useCallback(function(){Me.remove(Ue())},[Me]);if(B.useEffect(function(){return function(){Ie()}},[Ie]),B.useEffect(function(){M?nt():(!be||!d)&&Ie()},[M,Ie,be,d,nt]),!se&&!M&&(!be||W))return null;var ct=function(){Z(!1)},xn=function(){Z(!0),d&&Ie()},$t=function(Ut){Ut.target===Ut.currentTarget&&(U&&U(Ut),!b&&H&&H(Ut,"backdropClick"))},Ot=function(Ut){Ut.key!=="Escape"||!Ge()||(D&&D(Ut),C||(Ut.stopPropagation(),H&&H(Ut,"escapeKeyDown")))},ht=FM(r||{zIndex:WS}),at={};return u.props.tabIndex===void 0&&(at.tabIndex=u.props.tabIndex||"-1"),be&&(at.onEnter=Lv(ct,u.props.onEnter),at.onExited=Lv(xn,u.props.onExited)),B.createElement(AM,{ref:He,container:p,disablePortal:I},B.createElement("div",Ee({ref:ve,onKeyDown:Ot,role:"presentation"},T,{style:Ee({},ht.root,!M&&W?ht.hidden:{},T.style)}),he?null:B.createElement(o,Ee({open:M,onClick:$t},a)),B.createElement(MM,{disableEnforceFocus:S,disableAutoFocus:v,disableRestoreFocus:$,getDoc:Pe,isEnabled:Ge,open:M},B.cloneElement(u,at))))}),UM=function(e){return{root:{height:1,margin:0,border:"none",flexShrink:0,backgroundColor:e.palette.divider},absolute:{position:"absolute",bottom:0,left:0,width:"100%"},inset:{marginLeft:72},light:{backgroundColor:fo(e.palette.divider,.08)},middle:{marginLeft:e.spacing(2),marginRight:e.spacing(2)},vertical:{height:"100%",width:1},flexItem:{alignSelf:"stretch",height:"auto"}}},VM=B.forwardRef(function(e,t){var r=e.absolute,s=r===void 0?!1:r,i=e.classes,o=e.className,a=e.component,u=a===void 0?"hr":a,f=e.flexItem,d=f===void 0?!1:f,p=e.light,m=p===void 0?!1:p,v=e.orientation,x=v===void 0?"horizontal":v,b=e.role,w=b===void 0?u!=="hr"?"separator":void 0:b,S=e.variant,R=S===void 0?"fullWidth":S,C=Ct(e,["absolute","classes","className","component","flexItem","light","orientation","role","variant"]);return B.createElement(u,Ee({className:Et(i.root,o,R!=="fullWidth"&&i[R],s&&i.absolute,d&&i.flexItem,m&&i.light,x==="vertical"&&i.vertical),role:w,ref:t},C))});const Dr=Pn(UM,{name:"MuiDivider"})(VM);function xE(n){var e=n.props,t=n.states,r=n.muiFormControl;return t.reduce(function(s,i){return s[i]=e[i],r&&typeof e[i]>"u"&&(s[i]=r[i]),s},{})}function Fd(n,e){return parseInt(n[e],10)||0}var zM=typeof window<"u"?B.useLayoutEffect:B.useEffect,$M={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}},jM=B.forwardRef(function(e,t){var r=e.onChange,s=e.rows,i=e.rowsMax,o=e.rowsMin,a=e.maxRows,u=e.minRows,f=u===void 0?1:u,d=e.style,p=e.value,m=Ct(e,["onChange","rows","rowsMax","rowsMin","maxRows","minRows","style","value"]),v=a||i,x=s||o||f,b=B.useRef(p!=null),w=b.current,S=B.useRef(null),R=nr(t,S),C=B.useRef(null),O=B.useRef(0),I=B.useState({}),F=I[0],$=I[1],q=B.useCallback(function(){var le=S.current,he=window.getComputedStyle(le),pe=C.current;pe.style.width=he.width,pe.value=le.value||e.placeholder||"x",pe.value.slice(-1)===`
`&&(pe.value+=" ");var se=he["box-sizing"],ye=Fd(he,"padding-bottom")+Fd(he,"padding-top"),Me=Fd(he,"border-bottom-width")+Fd(he,"border-top-width"),U=pe.scrollHeight-ye;pe.value="x";var H=pe.scrollHeight-ye,D=U;x&&(D=Math.max(Number(x)*H,D)),v&&(D=Math.min(Number(v)*H,D)),D=Math.max(D,H);var Y=D+(se==="border-box"?ye+Me:0),M=Math.abs(D-U)<=1;$(function(T){return O.current<20&&(Y>0&&Math.abs((T.outerHeightStyle||0)-Y)>1||T.overflow!==M)?(O.current+=1,{overflow:M,outerHeightStyle:Y}):T})},[v,x,e.placeholder]);B.useEffect(function(){var le=hE(function(){O.current=0,q()});return window.addEventListener("resize",le),function(){le.clear(),window.removeEventListener("resize",le)}},[q]),zM(function(){q()}),B.useEffect(function(){O.current=0},[p]);var K=function(he){O.current=0,w||q(),r&&r(he)};return B.createElement(B.Fragment,null,B.createElement("textarea",Ee({value:p,onChange:K,ref:R,rows:x,style:Ee({height:F.outerHeightStyle,overflow:F.overflow?"hidden":null},d)},m)),B.createElement("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:C,tabIndex:-1,style:Ee({},$M.shadow,d)}))});function n3(n){return n!=null&&!(Array.isArray(n)&&n.length===0)}function WM(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return n&&(n3(n.value)&&n.value!==""||e&&n3(n.defaultValue)&&n.defaultValue!=="")}var HM=function(e){var t=e.palette.type==="light",r={color:"currentColor",opacity:t?.42:.5,transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})},s={opacity:"0 !important"},i={opacity:t?.42:.5};return{"@global":{"@keyframes mui-auto-fill":{},"@keyframes mui-auto-fill-cancel":{}},root:Ee({},e.typography.body1,{color:e.palette.text.primary,lineHeight:"1.1876em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center","&$disabled":{color:e.palette.text.disabled,cursor:"default"}}),formControl:{},focused:{},disabled:{},adornedStart:{},adornedEnd:{},error:{},marginDense:{},multiline:{padding:"".concat(6,"px 0 ").concat(7,"px"),"&$marginDense":{paddingTop:3}},colorSecondary:{},fullWidth:{width:"100%"},input:{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"".concat(6,"px 0 ").concat(7,"px"),border:0,boxSizing:"content-box",background:"none",height:"1.1876em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{"-webkit-appearance":"none"},"label[data-shrink=false] + $formControl &":{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":i,"&:focus::-moz-placeholder":i,"&:focus:-ms-input-placeholder":i,"&:focus::-ms-input-placeholder":i},"&$disabled":{opacity:1},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},inputMarginDense:{paddingTop:3},inputMultiline:{height:"auto",resize:"none",padding:0},inputTypeSearch:{"-moz-appearance":"textfield","-webkit-appearance":"textfield"},inputAdornedStart:{},inputAdornedEnd:{},inputHiddenLabel:{}}},XM=typeof window>"u"?B.useEffect:B.useLayoutEffect,YM=B.forwardRef(function(e,t){var r=e["aria-describedby"],s=e.autoComplete,i=e.autoFocus,o=e.classes,a=e.className;e.color;var u=e.defaultValue,f=e.disabled,d=e.endAdornment;e.error;var p=e.fullWidth,m=p===void 0?!1:p,v=e.id,x=e.inputComponent,b=x===void 0?"input":x,w=e.inputProps,S=w===void 0?{}:w,R=e.inputRef;e.margin;var C=e.multiline,O=C===void 0?!1:C,I=e.name,F=e.onBlur,$=e.onChange,q=e.onClick,K=e.onFocus,le=e.onKeyDown,he=e.onKeyUp,pe=e.placeholder,se=e.readOnly,ye=e.renderSuffix,Me=e.rows,U=e.rowsMax,H=e.rowsMin,D=e.maxRows,Y=e.minRows,M=e.startAdornment,T=e.type,N=T===void 0?"text":T,W=e.value,Z=Ct(e,["aria-describedby","autoComplete","autoFocus","classes","className","color","defaultValue","disabled","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","rowsMax","rowsMin","maxRows","minRows","startAdornment","type","value"]),te=S.value!=null?S.value:W,re=B.useRef(te!=null),ue=re.current,ve=B.useRef(),be=B.useCallback(function(Qt){},[]),Pe=nr(S.ref,be),Ue=nr(R,Pe),Ke=nr(ve,Ue),nt=B.useState(!1),Ge=nt[0],He=nt[1],Ie=TM(),ct=xE({props:e,muiFormControl:Ie,states:["color","disabled","error","hiddenLabel","margin","required","filled"]});ct.focused=Ie?Ie.focused:Ge,B.useEffect(function(){!Ie&&f&&Ge&&(He(!1),F&&F())},[Ie,f,Ge,F]);var xn=Ie&&Ie.onFilled,$t=Ie&&Ie.onEmpty,Ot=B.useCallback(function(Qt){WM(Qt)?xn&&xn():$t&&$t()},[xn,$t]);XM(function(){ue&&Ot({value:te})},[te,Ot,ue]);var ht=function(mt){if(ct.disabled){mt.stopPropagation();return}K&&K(mt),S.onFocus&&S.onFocus(mt),Ie&&Ie.onFocus?Ie.onFocus(mt):He(!0)},at=function(mt){F&&F(mt),S.onBlur&&S.onBlur(mt),Ie&&Ie.onBlur?Ie.onBlur(mt):He(!1)},Mt=function(mt){if(!ue){var Ln=mt.target||ve.current;if(Ln==null)throw new Error(Fu(1));Ot({value:Ln.value})}for(var Vt=arguments.length,Sr=new Array(Vt>1?Vt-1:0),cr=1;cr<Vt;cr++)Sr[cr-1]=arguments[cr];S.onChange&&S.onChange.apply(S,[mt].concat(Sr)),$&&$.apply(void 0,[mt].concat(Sr))};B.useEffect(function(){Ot(ve.current)},[]);var Ut=function(mt){ve.current&&mt.currentTarget===mt.target&&ve.current.focus(),q&&q(mt)},In=b,bn=Ee({},S,{ref:Ke});typeof In!="string"?bn=Ee({inputRef:Ke,type:N},bn,{ref:null}):O?Me&&!D&&!Y&&!U&&!H?In="textarea":(bn=Ee({minRows:Me||Y,rowsMax:U,maxRows:D},bn),In=jM):bn=Ee({type:N},bn);var Ur=function(mt){Ot(mt.animationName==="mui-auto-fill-cancel"?ve.current:{value:"x"})};return B.useEffect(function(){Ie&&Ie.setAdornedStart(!!M)},[Ie,M]),B.createElement("div",Ee({className:Et(o.root,o["color".concat(Gr(ct.color||"primary"))],a,ct.disabled&&o.disabled,ct.error&&o.error,m&&o.fullWidth,ct.focused&&o.focused,Ie&&o.formControl,O&&o.multiline,M&&o.adornedStart,d&&o.adornedEnd,ct.margin==="dense"&&o.marginDense),onClick:Ut,ref:t},Z),M,B.createElement(E_.Provider,{value:null},B.createElement(In,Ee({"aria-invalid":ct.error,"aria-describedby":r,autoComplete:s,autoFocus:i,defaultValue:u,disabled:ct.disabled,id:v,onAnimationStart:Ur,name:I,placeholder:pe,readOnly:se,required:ct.required,rows:Me,value:te,onKeyDown:le,onKeyUp:he},bn,{className:Et(o.input,S.className,ct.disabled&&o.disabled,O&&o.inputMultiline,ct.hiddenLabel&&o.inputHiddenLabel,M&&o.inputAdornedStart,d&&o.inputAdornedEnd,N==="search"&&o.inputTypeSearch,ct.margin==="dense"&&o.inputMarginDense),onBlur:at,onChange:Mt,onFocus:ht}))),d,ye?ye(Ee({},ct,{startAdornment:M})):null)});const qM=Pn(HM,{name:"MuiInputBase"})(YM);var KM=[0,1,2,3,4,5,6,7,8,9,10],ZM=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12];function QM(n,e,t){var r={};ZM.forEach(function(s){var i="grid-".concat(t,"-").concat(s);if(s===!0){r[i]={flexBasis:0,flexGrow:1,maxWidth:"100%"};return}if(s==="auto"){r[i]={flexBasis:"auto",flexGrow:0,maxWidth:"none"};return}var o="".concat(Math.round(s/12*1e8)/1e6,"%");r[i]={flexBasis:o,flexGrow:0,maxWidth:o}}),t==="xs"?Ee(n,r):n[e.breakpoints.up(t)]=r}function A0(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=parseFloat(n);return"".concat(t/e).concat(String(n).replace(String(t),"")||"px")}function GM(n,e){var t={};return KM.forEach(function(r){var s=n.spacing(r);s!==0&&(t["spacing-".concat(e,"-").concat(r)]={margin:"-".concat(A0(s,2)),width:"calc(100% + ".concat(A0(s),")"),"& > $item":{padding:A0(s,2)}})}),t}var JM=function(e){return Ee({root:{},container:{boxSizing:"border-box",display:"flex",flexWrap:"wrap",width:"100%"},item:{boxSizing:"border-box",margin:"0"},zeroMinWidth:{minWidth:0},"direction-xs-column":{flexDirection:"column"},"direction-xs-column-reverse":{flexDirection:"column-reverse"},"direction-xs-row-reverse":{flexDirection:"row-reverse"},"wrap-xs-nowrap":{flexWrap:"nowrap"},"wrap-xs-wrap-reverse":{flexWrap:"wrap-reverse"},"align-items-xs-center":{alignItems:"center"},"align-items-xs-flex-start":{alignItems:"flex-start"},"align-items-xs-flex-end":{alignItems:"flex-end"},"align-items-xs-baseline":{alignItems:"baseline"},"align-content-xs-center":{alignContent:"center"},"align-content-xs-flex-start":{alignContent:"flex-start"},"align-content-xs-flex-end":{alignContent:"flex-end"},"align-content-xs-space-between":{alignContent:"space-between"},"align-content-xs-space-around":{alignContent:"space-around"},"justify-content-xs-center":{justifyContent:"center"},"justify-content-xs-flex-end":{justifyContent:"flex-end"},"justify-content-xs-space-between":{justifyContent:"space-between"},"justify-content-xs-space-around":{justifyContent:"space-around"},"justify-content-xs-space-evenly":{justifyContent:"space-evenly"}},GM(e,"xs"),e.breakpoints.keys.reduce(function(t,r){return QM(t,e,r),t},{}))},e5=B.forwardRef(function(e,t){var r=e.alignContent,s=r===void 0?"stretch":r,i=e.alignItems,o=i===void 0?"stretch":i,a=e.classes,u=e.className,f=e.component,d=f===void 0?"div":f,p=e.container,m=p===void 0?!1:p,v=e.direction,x=v===void 0?"row":v,b=e.item,w=b===void 0?!1:b,S=e.justify,R=e.justifyContent,C=R===void 0?"flex-start":R,O=e.lg,I=O===void 0?!1:O,F=e.md,$=F===void 0?!1:F,q=e.sm,K=q===void 0?!1:q,le=e.spacing,he=le===void 0?0:le,pe=e.wrap,se=pe===void 0?"wrap":pe,ye=e.xl,Me=ye===void 0?!1:ye,U=e.xs,H=U===void 0?!1:U,D=e.zeroMinWidth,Y=D===void 0?!1:D,M=Ct(e,["alignContent","alignItems","classes","className","component","container","direction","item","justify","justifyContent","lg","md","sm","spacing","wrap","xl","xs","zeroMinWidth"]),T=Et(a.root,u,m&&[a.container,he!==0&&a["spacing-xs-".concat(String(he))]],w&&a.item,Y&&a.zeroMinWidth,x!=="row"&&a["direction-xs-".concat(String(x))],se!=="wrap"&&a["wrap-xs-".concat(String(se))],o!=="stretch"&&a["align-items-xs-".concat(String(o))],s!=="stretch"&&a["align-content-xs-".concat(String(s))],(S||C)!=="flex-start"&&a["justify-content-xs-".concat(String(S||C))],H!==!1&&a["grid-xs-".concat(String(H))],K!==!1&&a["grid-sm-".concat(String(K))],$!==!1&&a["grid-md-".concat(String($))],I!==!1&&a["grid-lg-".concat(String(I))],Me!==!1&&a["grid-xl-".concat(String(Me))]);return B.createElement(d,Ee({className:T,ref:t},M))}),kt=Pn(JM,{name:"MuiGrid"})(e5);function Vv(n){return"scale(".concat(n,", ").concat(Math.pow(n,2),")")}var t5={entering:{opacity:1,transform:Vv(1)},entered:{opacity:1,transform:"none"}},bE=B.forwardRef(function(e,t){var r=e.children,s=e.disableStrictModeCompat,i=s===void 0?!1:s,o=e.in,a=e.onEnter,u=e.onEntered,f=e.onEntering,d=e.onExit,p=e.onExited,m=e.onExiting,v=e.style,x=e.timeout,b=x===void 0?"auto":x,w=e.TransitionComponent,S=w===void 0?Ys:w,R=Ct(e,["children","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),C=B.useRef(),O=B.useRef(),I=b_(),F=I.unstable_strictMode&&!i,$=B.useRef(null),q=nr(r.ref,t),K=nr(F?$:void 0,q),le=function(Y){return function(M,T){if(Y){var N=F?[$.current,M]:[M,T],W=Xp(N,2),Z=W[0],te=W[1];te===void 0?Y(Z):Y(Z,te)}}},he=le(f),pe=le(function(D,Y){Qk(D);var M=Dh({style:v,timeout:b},{mode:"enter"}),T=M.duration,N=M.delay,W;b==="auto"?(W=I.transitions.getAutoHeightDuration(D.clientHeight),O.current=W):W=T,D.style.transition=[I.transitions.create("opacity",{duration:W,delay:N}),I.transitions.create("transform",{duration:W*.666,delay:N})].join(","),a&&a(D,Y)}),se=le(u),ye=le(m),Me=le(function(D){var Y=Dh({style:v,timeout:b},{mode:"exit"}),M=Y.duration,T=Y.delay,N;b==="auto"?(N=I.transitions.getAutoHeightDuration(D.clientHeight),O.current=N):N=M,D.style.transition=[I.transitions.create("opacity",{duration:N,delay:T}),I.transitions.create("transform",{duration:N*.666,delay:T||N*.333})].join(","),D.style.opacity="0",D.style.transform=Vv(.75),d&&d(D)}),U=le(p),H=function(Y,M){var T=F?Y:M;b==="auto"&&(C.current=setTimeout(T,O.current||0))};return B.useEffect(function(){return function(){clearTimeout(C.current)}},[]),B.createElement(S,Ee({appear:!0,in:o,nodeRef:F?$:void 0,onEnter:pe,onEntered:se,onEntering:he,onExit:Me,onExited:U,onExiting:ye,addEndListener:H,timeout:b==="auto"?null:b},R),function(D,Y){return B.cloneElement(r,Ee({style:Ee({opacity:0,transform:Vv(.75),visibility:D==="exited"&&!o?"hidden":void 0},t5[D],v,r.props.style),ref:K},Y))})});bE.muiSupportAuto=!0;var n5=function(e){var t=e.palette.type==="light",r=t?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return{root:{position:"relative"},formControl:{"label + &":{marginTop:16}},focused:{},disabled:{},colorSecondary:{"&$underline:after":{borderBottomColor:e.palette.secondary.main}},underline:{"&:after":{borderBottom:"2px solid ".concat(e.palette.primary.main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},"&$focused:after":{transform:"scaleX(1)"},"&$error:after":{borderBottomColor:e.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:"1px solid ".concat(r),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},"&:hover:not($disabled):before":{borderBottom:"2px solid ".concat(e.palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(r)}},"&$disabled:before":{borderBottomStyle:"dotted"}},error:{},marginDense:{},multiline:{},fullWidth:{},input:{},inputMarginDense:{},inputMultiline:{},inputTypeSearch:{}}},wE=B.forwardRef(function(e,t){var r=e.disableUnderline,s=e.classes,i=e.fullWidth,o=i===void 0?!1:i,a=e.inputComponent,u=a===void 0?"input":a,f=e.multiline,d=f===void 0?!1:f,p=e.type,m=p===void 0?"text":p,v=Ct(e,["disableUnderline","classes","fullWidth","inputComponent","multiline","type"]);return B.createElement(qM,Ee({classes:Ee({},s,{root:Et(s.root,!r&&s.underline),underline:null}),fullWidth:o,inputComponent:u,multiline:d,ref:t,type:m},v))});wE.muiName="Input";const A_=Pn(n5,{name:"MuiInput"})(wE);var r5={root:{},underlineNone:{textDecoration:"none"},underlineHover:{textDecoration:"none","&:hover":{textDecoration:"underline"}},underlineAlways:{textDecoration:"underline"},button:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none","&::-moz-focus-inner":{borderStyle:"none"},"&$focusVisible":{outline:"auto"}},focusVisible:{}},s5=B.forwardRef(function(e,t){var r=e.classes,s=e.className,i=e.color,o=i===void 0?"primary":i,a=e.component,u=a===void 0?"a":a,f=e.onBlur,d=e.onFocus,p=e.TypographyClasses,m=e.underline,v=m===void 0?"hover":m,x=e.variant,b=x===void 0?"inherit":x,w=Ct(e,["classes","className","color","component","onBlur","onFocus","TypographyClasses","underline","variant"]),S=w_(),R=S.isFocusVisible,C=S.onBlurVisible,O=S.ref,I=B.useState(!1),F=I[0],$=I[1],q=nr(t,O),K=function(pe){F&&(C(),$(!1)),f&&f(pe)},le=function(pe){R(pe)&&$(!0),d&&d(pe)};return B.createElement(ar,Ee({className:Et(r.root,r["underline".concat(Gr(v))],s,F&&r.focusVisible,u==="button"&&r.button),classes:p,color:o,component:u,onBlur:K,onFocus:le,ref:q,variant:b},w))});const i5=Pn(r5,{name:"MuiLink"})(s5);function r3(n,e){var t=0;return typeof e=="number"?t=e:e==="center"?t=n.height/2:e==="bottom"&&(t=n.height),t}function s3(n,e){var t=0;return typeof e=="number"?t=e:e==="center"?t=n.width/2:e==="right"&&(t=n.width),t}function i3(n){return[n.horizontal,n.vertical].map(function(e){return typeof e=="number"?"".concat(e,"px"):e}).join(" ")}function o5(n,e){for(var t=e,r=0;t&&t!==n;)t=t.parentElement,r+=t.scrollTop;return r}function C0(n){return typeof n=="function"?n():n}var a5={root:{},paper:{position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}},l5=B.forwardRef(function(e,t){var r=e.action,s=e.anchorEl,i=e.anchorOrigin,o=i===void 0?{vertical:"top",horizontal:"left"}:i,a=e.anchorPosition,u=e.anchorReference,f=u===void 0?"anchorEl":u,d=e.children,p=e.classes,m=e.className,v=e.container,x=e.elevation,b=x===void 0?8:x,w=e.getContentAnchorEl,S=e.marginThreshold,R=S===void 0?16:S,C=e.onEnter,O=e.onEntered,I=e.onEntering,F=e.onExit,$=e.onExited,q=e.onExiting,K=e.open,le=e.PaperProps,he=le===void 0?{}:le,pe=e.transformOrigin,se=pe===void 0?{vertical:"top",horizontal:"left"}:pe,ye=e.TransitionComponent,Me=ye===void 0?bE:ye,U=e.transitionDuration,H=U===void 0?"auto":U,D=e.TransitionProps,Y=D===void 0?{}:D,M=Ct(e,["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","classes","className","container","elevation","getContentAnchorEl","marginThreshold","onEnter","onEntered","onEntering","onExit","onExited","onExiting","open","PaperProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"]),T=B.useRef(),N=B.useCallback(function(Ue){if(f==="anchorPosition")return a;var Ke=C0(s),nt=Ke&&Ke.nodeType===1?Ke:ms(T.current).body,Ge=nt.getBoundingClientRect(),He=Ue===0?o.vertical:"center";return{top:Ge.top+r3(Ge,He),left:Ge.left+s3(Ge,o.horizontal)}},[s,o.horizontal,o.vertical,a,f]),W=B.useCallback(function(Ue){var Ke=0;if(w&&f==="anchorEl"){var nt=w(Ue);if(nt&&Ue.contains(nt)){var Ge=o5(Ue,nt);Ke=nt.offsetTop+nt.clientHeight/2-Ge||0}}return Ke},[o.vertical,f,w]),Z=B.useCallback(function(Ue){var Ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return{vertical:r3(Ue,se.vertical)+Ke,horizontal:s3(Ue,se.horizontal)}},[se.horizontal,se.vertical]),te=B.useCallback(function(Ue){var Ke=W(Ue),nt={width:Ue.offsetWidth,height:Ue.offsetHeight},Ge=Z(nt,Ke);if(f==="none")return{top:null,left:null,transformOrigin:i3(Ge)};var He=N(Ke),Ie=He.top-Ge.vertical,ct=He.left-Ge.horizontal,xn=Ie+nt.height,$t=ct+nt.width,Ot=pE(C0(s)),ht=Ot.innerHeight-R,at=Ot.innerWidth-R;if(Ie<R){var Mt=Ie-R;Ie-=Mt,Ge.vertical+=Mt}else if(xn>ht){var Ut=xn-ht;Ie-=Ut,Ge.vertical+=Ut}if(ct<R){var In=ct-R;ct-=In,Ge.horizontal+=In}else if($t>at){var bn=$t-at;ct-=bn,Ge.horizontal+=bn}return{top:"".concat(Math.round(Ie),"px"),left:"".concat(Math.round(ct),"px"),transformOrigin:i3(Ge)}},[s,f,N,W,Z,R]),re=B.useCallback(function(){var Ue=T.current;if(Ue){var Ke=te(Ue);Ke.top!==null&&(Ue.style.top=Ke.top),Ke.left!==null&&(Ue.style.left=Ke.left),Ue.style.transformOrigin=Ke.transformOrigin}},[te]),ue=function(Ke,nt){I&&I(Ke,nt),re()},ve=B.useCallback(function(Ue){T.current=Io.findDOMNode(Ue)},[]);B.useEffect(function(){K&&re()}),B.useImperativeHandle(r,function(){return K?{updatePosition:function(){re()}}:null},[K,re]),B.useEffect(function(){if(K){var Ue=hE(function(){re()});return window.addEventListener("resize",Ue),function(){Ue.clear(),window.removeEventListener("resize",Ue)}}},[K,re]);var be=H;H==="auto"&&!Me.muiSupportAuto&&(be=void 0);var Pe=v||(s?ms(C0(s)).body:void 0);return B.createElement(BM,Ee({container:Pe,open:K,ref:t,BackdropProps:{invisible:!0},className:Et(p.root,m)},M),B.createElement(Me,Ee({appear:!0,in:K,onEnter:C,onEntered:O,onExit:F,onExited:$,onExiting:q,timeout:be},Y,{onEntering:Lv(ue,Y.onEntering)}),B.createElement(mf,Ee({elevation:b,ref:ve},he,{className:Et(p.paper,he.className)}),d)))});const C_=Pn(a5,{name:"MuiPopover"})(l5);var c5=B.forwardRef(function(e,t){var r=e.classes,s=e.className,i=e.disabled,o=e.IconComponent,a=e.inputRef,u=e.variant,f=u===void 0?"standard":u,d=Ct(e,["classes","className","disabled","IconComponent","inputRef","variant"]);return B.createElement(B.Fragment,null,B.createElement("select",Ee({className:Et(r.root,r.select,r[f],s,i&&r.disabled),disabled:i,ref:a||t},d)),e.multiple?null:B.createElement(o,{className:Et(r.icon,r["icon".concat(Gr(f))],i&&r.disabled)}))});const u5=Ti(B.createElement("path",{d:"M7 10l5 5 5-5z"}));var f5=function(e){return{root:{},select:{"-moz-appearance":"none","-webkit-appearance":"none",userSelect:"none",borderRadius:0,minWidth:16,cursor:"pointer","&:focus":{backgroundColor:e.palette.type==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)",borderRadius:0},"&::-ms-expand":{display:"none"},"&$disabled":{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:e.palette.background.paper},"&&":{paddingRight:24}},filled:{"&&":{paddingRight:32}},outlined:{borderRadius:e.shape.borderRadius,"&&":{paddingRight:32}},selectMenu:{height:"auto",minHeight:"1.1876em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},disabled:{},icon:{position:"absolute",right:0,top:"calc(50% - 12px)",pointerEvents:"none",color:e.palette.action.active,"&$disabled":{color:e.palette.action.disabled}},iconOpen:{transform:"rotate(180deg)"},iconFilled:{right:7},iconOutlined:{right:7},nativeInput:{bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%"}}},d5=B.createElement(A_,null),TE=B.forwardRef(function(e,t){var r=e.children,s=e.classes,i=e.IconComponent,o=i===void 0?u5:i,a=e.input,u=a===void 0?d5:a,f=e.inputProps;e.variant;var d=Ct(e,["children","classes","IconComponent","input","inputProps","variant"]),p=SM(),m=xE({props:e,muiFormControl:p,states:["variant"]});return B.cloneElement(u,Ee({inputComponent:c5,inputProps:Ee({children:r,classes:s,IconComponent:o,variant:m.variant,type:void 0},f,u?u.props.inputProps:{}),ref:t},d))});TE.muiName="Select";const R_=Pn(f5,{name:"MuiNativeSelect"})(TE);var h5=function(e){return{thumb:{"&$open":{"& $offset":{transform:"scale(1) translateY(-10px)"}}},open:{},offset:Ee({zIndex:1},e.typography.body2,{fontSize:e.typography.pxToRem(12),lineHeight:1.2,transition:e.transitions.create(["transform"],{duration:e.transitions.duration.shortest}),top:-34,transformOrigin:"bottom center",transform:"scale(0)",position:"absolute"}),circle:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:"50% 50% 50% 0",backgroundColor:"currentColor",transform:"rotate(-45deg)"},label:{color:e.palette.primary.contrastText,transform:"rotate(45deg)"}}};function p5(n){var e=n.children,t=n.classes,r=n.className,s=n.open,i=n.value,o=n.valueLabelDisplay;return o==="off"?e:B.cloneElement(e,{className:Et(e.props.className,(s||o==="on")&&t.open,t.thumb)},B.createElement("span",{className:Et(t.offset,r)},B.createElement("span",{className:t.circle},B.createElement("span",{className:t.label},i))))}const g5=Pn(h5,{name:"PrivateValueLabel"})(p5);function R0(n,e){return n-e}function P0(n,e,t){return Math.min(Math.max(e,n),t)}function o3(n,e){var t=n.reduce(function(s,i,o){var a=Math.abs(e-i);return s===null||a<s.distance||a===s.distance?{distance:a,index:o}:s},null),r=t.index;return r}function Bd(n,e){if(e.current!==void 0&&n.changedTouches){for(var t=0;t<n.changedTouches.length;t+=1){var r=n.changedTouches[t];if(r.identifier===e.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:n.clientX,y:n.clientY}}function Ud(n,e,t){return(n-e)*100/(t-e)}function m5(n,e,t){return(t-e)*n+e}function v5(n){if(Math.abs(n)<1){var e=n.toExponential().split("e-"),t=e[0].split(".")[1];return(t?t.length:0)+parseInt(e[1],10)}var r=n.toString().split(".")[1];return r?r.length:0}function a3(n,e,t){var r=Math.round((n-t)/e)*e+t;return Number(r.toFixed(v5(e)))}function l3(n){var e=n.values,t=n.source,r=n.newValue,s=n.index;if(e[s]===r)return t;var i=e.slice();return i[s]=r,i}function Vd(n){var e=n.sliderRef,t=n.activeIndex,r=n.setActive;(!e.current.contains(document.activeElement)||Number(document.activeElement.getAttribute("data-index"))!==t)&&e.current.querySelector('[role="slider"][data-index="'.concat(t,'"]')).focus(),r&&r(t)}var zd={horizontal:{offset:function(e){return{left:"".concat(e,"%")}},leap:function(e){return{width:"".concat(e,"%")}}},"horizontal-reverse":{offset:function(e){return{right:"".concat(e,"%")}},leap:function(e){return{width:"".concat(e,"%")}}},vertical:{offset:function(e){return{bottom:"".concat(e,"%")}},leap:function(e){return{height:"".concat(e,"%")}}}},c3=function(e){return e},y5=function(e){return{root:{height:2,width:"100%",boxSizing:"content-box",padding:"13px 0",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:e.palette.primary.main,WebkitTapHighlightColor:"transparent","&$disabled":{pointerEvents:"none",cursor:"default",color:e.palette.grey[400]},"&$vertical":{width:2,height:"100%",padding:"0 13px"},"@media (pointer: coarse)":{padding:"20px 0","&$vertical":{padding:"0 20px"}},"@media print":{colorAdjust:"exact"}},colorPrimary:{},colorSecondary:{color:e.palette.secondary.main},marked:{marginBottom:20,"&$vertical":{marginBottom:"auto",marginRight:20}},vertical:{},disabled:{},rail:{display:"block",position:"absolute",width:"100%",height:2,borderRadius:1,backgroundColor:"currentColor",opacity:.38,"$vertical &":{height:"100%",width:2}},track:{display:"block",position:"absolute",height:2,borderRadius:1,backgroundColor:"currentColor","$vertical &":{width:2}},trackFalse:{"& $track":{display:"none"}},trackInverted:{"& $track":{backgroundColor:e.palette.type==="light"?US(e.palette.primary.main,.62):BS(e.palette.primary.main,.5)},"& $rail":{opacity:1}},thumb:{position:"absolute",width:12,height:12,marginLeft:-6,marginTop:-5,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:e.transitions.create(["box-shadow"],{duration:e.transitions.duration.shortest}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",left:-15,top:-15,right:-15,bottom:-15},"&$focusVisible,&:hover":{boxShadow:"0px 0px 0px 8px ".concat(fo(e.palette.primary.main,.16)),"@media (hover: none)":{boxShadow:"none"}},"&$active":{boxShadow:"0px 0px 0px 14px ".concat(fo(e.palette.primary.main,.16))},"&$disabled":{width:8,height:8,marginLeft:-4,marginTop:-3,"&:hover":{boxShadow:"none"}},"$vertical &":{marginLeft:-5,marginBottom:-6},"$vertical &$disabled":{marginLeft:-3,marginBottom:-4}},thumbColorPrimary:{},thumbColorSecondary:{"&$focusVisible,&:hover":{boxShadow:"0px 0px 0px 8px ".concat(fo(e.palette.secondary.main,.16))},"&$active":{boxShadow:"0px 0px 0px 14px ".concat(fo(e.palette.secondary.main,.16))}},active:{},focusVisible:{},valueLabel:{left:"calc(-50% - 4px)"},mark:{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},markActive:{backgroundColor:e.palette.background.paper,opacity:.8},markLabel:Ee({},e.typography.body2,{color:e.palette.text.secondary,position:"absolute",top:26,transform:"translateX(-50%)",whiteSpace:"nowrap","$vertical &":{top:"auto",left:26,transform:"translateY(50%)"},"@media (pointer: coarse)":{top:40,"$vertical &":{left:31}}}),markLabelActive:{color:e.palette.text.primary}}},_5=B.forwardRef(function(e,t){var r=e["aria-label"],s=e["aria-labelledby"],i=e["aria-valuetext"],o=e.classes,a=e.className,u=e.color,f=u===void 0?"primary":u,d=e.component,p=d===void 0?"span":d,m=e.defaultValue,v=e.disabled,x=v===void 0?!1:v,b=e.getAriaLabel,w=e.getAriaValueText,S=e.marks,R=S===void 0?!1:S,C=e.max,O=C===void 0?100:C,I=e.min,F=I===void 0?0:I,$=e.name,q=e.onChange,K=e.onChangeCommitted,le=e.onMouseDown,he=e.orientation,pe=he===void 0?"horizontal":he,se=e.scale,ye=se===void 0?c3:se,Me=e.step,U=Me===void 0?1:Me,H=e.ThumbComponent,D=H===void 0?"span":H,Y=e.track,M=Y===void 0?"normal":Y,T=e.value,N=e.ValueLabelComponent,W=N===void 0?g5:N,Z=e.valueLabelDisplay,te=Z===void 0?"off":Z,re=e.valueLabelFormat,ue=re===void 0?c3:re,ve=Ct(e,["aria-label","aria-labelledby","aria-valuetext","classes","className","color","component","defaultValue","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","onMouseDown","orientation","scale","step","ThumbComponent","track","value","ValueLabelComponent","valueLabelDisplay","valueLabelFormat"]),be=b_(),Pe=B.useRef(),Ue=B.useState(-1),Ke=Ue[0],nt=Ue[1],Ge=B.useState(-1),He=Ge[0],Ie=Ge[1],ct=gE({controlled:T,default:m,name:"Slider"}),xn=Xp(ct,2),$t=xn[0],Ot=xn[1],ht=Array.isArray($t),at=ht?$t.slice().sort(R0):[$t];at=at.map(function(ze){return P0(ze,F,O)});var Mt=R===!0&&U!==null?Hp(Array(Math.floor((O-F)/U)+1)).map(function(ze,Xe){return{value:F+U*Xe}}):R||[],Ut=w_(),In=Ut.isFocusVisible,bn=Ut.onBlurVisible,Ur=Ut.ref,Qt=B.useState(-1),mt=Qt[0],Ln=Qt[1],Vt=B.useRef(),Sr=nr(Ur,Vt),cr=nr(t,Sr),Ai=Gn(function(ze){var Xe=Number(ze.currentTarget.getAttribute("data-index"));In(ze)&&Ln(Xe),Ie(Xe)}),Do=Gn(function(){mt!==-1&&(Ln(-1),bn()),Ie(-1)}),Ks=Gn(function(ze){var Xe=Number(ze.currentTarget.getAttribute("data-index"));Ie(Xe)}),Qe=Gn(function(){Ie(-1)}),kn=be.direction==="rtl",Zs=Gn(function(ze){var Xe=Number(ze.currentTarget.getAttribute("data-index")),Rt=at[Xe],Yt=(O-F)/10,pt=Mt.map(function(Ii){return Ii.value}),Tn=pt.indexOf(Rt),wt,Ss=kn?"ArrowLeft":"ArrowRight",Es=kn?"ArrowRight":"ArrowLeft";switch(ze.key){case"Home":wt=F;break;case"End":wt=O;break;case"PageUp":U&&(wt=Rt+Yt);break;case"PageDown":U&&(wt=Rt-Yt);break;case Ss:case"ArrowUp":U?wt=Rt+U:wt=pt[Tn+1]||pt[pt.length-1];break;case Es:case"ArrowDown":U?wt=Rt-U:wt=pt[Tn-1]||pt[0];break;default:return}if(ze.preventDefault(),U&&(wt=a3(wt,U,F)),wt=P0(wt,F,O),ht){var Pi=wt;wt=l3({values:at,source:$t,newValue:wt,index:Xe}).sort(R0),Vd({sliderRef:Vt,activeIndex:wt.indexOf(Pi)})}Ot(wt),Ln(Xe),q&&q(ze,wt),K&&K(ze,wt)}),is=B.useRef(),wn=pe;kn&&pe!=="vertical"&&(wn+="-reverse");var ur=function(Xe){var Rt=Xe.finger,Yt=Xe.move,pt=Yt===void 0?!1:Yt,Tn=Xe.values,wt=Xe.source,Ss=Vt.current,Es=Ss.getBoundingClientRect(),Pi=Es.width,Ii=Es.height,zr=Es.bottom,Fo=Es.left,$r;wn.indexOf("vertical")===0?$r=(zr-Rt.y)/Ii:$r=(Rt.x-Fo)/Pi,wn.indexOf("-reverse")!==-1&&($r=1-$r);var tn;if(tn=m5($r,F,O),U)tn=a3(tn,U,F);else{var os=Mt.map(function(mc){return mc.value}),As=o3(os,tn);tn=os[As]}tn=P0(tn,F,O);var dr=0;if(ht){pt?dr=is.current:dr=o3(Tn,tn);var ki=tn;tn=l3({values:Tn,source:wt,newValue:tn,index:dr}).sort(R0),dr=tn.indexOf(ki),is.current=dr}return{newValue:tn,activeIndex:dr}},fr=Gn(function(ze){var Xe=Bd(ze,Pe);if(Xe){var Rt=ur({finger:Xe,move:!0,values:at,source:$t}),Yt=Rt.newValue,pt=Rt.activeIndex;Vd({sliderRef:Vt,activeIndex:pt,setActive:nt}),Ot(Yt),q&&q(ze,Yt)}}),Vr=Gn(function(ze){var Xe=Bd(ze,Pe);if(Xe){var Rt=ur({finger:Xe,values:at,source:$t}),Yt=Rt.newValue;nt(-1),ze.type==="touchend"&&Ie(-1),K&&K(ze,Yt),Pe.current=void 0;var pt=ms(Vt.current);pt.removeEventListener("mousemove",fr),pt.removeEventListener("mouseup",Vr),pt.removeEventListener("touchmove",fr),pt.removeEventListener("touchend",Vr)}}),Ci=Gn(function(ze){ze.preventDefault();var Xe=ze.changedTouches[0];Xe!=null&&(Pe.current=Xe.identifier);var Rt=Bd(ze,Pe),Yt=ur({finger:Rt,values:at,source:$t}),pt=Yt.newValue,Tn=Yt.activeIndex;Vd({sliderRef:Vt,activeIndex:Tn,setActive:nt}),Ot(pt),q&&q(ze,pt);var wt=ms(Vt.current);wt.addEventListener("touchmove",fr),wt.addEventListener("touchend",Vr)});B.useEffect(function(){var ze=Vt.current;ze.addEventListener("touchstart",Ci);var Xe=ms(ze);return function(){ze.removeEventListener("touchstart",Ci),Xe.removeEventListener("mousemove",fr),Xe.removeEventListener("mouseup",Vr),Xe.removeEventListener("touchmove",fr),Xe.removeEventListener("touchend",Vr)}},[Vr,fr,Ci]);var Ba=Gn(function(ze){le&&le(ze),ze.preventDefault();var Xe=Bd(ze,Pe),Rt=ur({finger:Xe,values:at,source:$t}),Yt=Rt.newValue,pt=Rt.activeIndex;Vd({sliderRef:Vt,activeIndex:pt,setActive:nt}),Ot(Yt),q&&q(ze,Yt);var Tn=ms(Vt.current);Tn.addEventListener("mousemove",fr),Tn.addEventListener("mouseup",Vr)}),Ri=Ud(ht?at[0]:F,F,O),Lo=Ud(at[at.length-1],F,O)-Ri,Ua=Ee({},zd[wn].offset(Ri),zd[wn].leap(Lo));return B.createElement(p,Ee({ref:cr,className:Et(o.root,o["color".concat(Gr(f))],a,x&&o.disabled,Mt.length>0&&Mt.some(function(ze){return ze.label})&&o.marked,M===!1&&o.trackFalse,pe==="vertical"&&o.vertical,M==="inverted"&&o.trackInverted),onMouseDown:Ba},ve),B.createElement("span",{className:o.rail}),B.createElement("span",{className:o.track,style:Ua}),B.createElement("input",{value:at.join(","),name:$,type:"hidden"}),Mt.map(function(ze,Xe){var Rt=Ud(ze.value,F,O),Yt=zd[wn].offset(Rt),pt;return M===!1?pt=at.indexOf(ze.value)!==-1:pt=M==="normal"&&(ht?ze.value>=at[0]&&ze.value<=at[at.length-1]:ze.value<=at[0])||M==="inverted"&&(ht?ze.value<=at[0]||ze.value>=at[at.length-1]:ze.value>=at[0]),B.createElement(B.Fragment,{key:ze.value},B.createElement("span",{style:Yt,"data-index":Xe,className:Et(o.mark,pt&&o.markActive)}),ze.label!=null?B.createElement("span",{"aria-hidden":!0,"data-index":Xe,style:Yt,className:Et(o.markLabel,pt&&o.markLabelActive)},ze.label):null)}),at.map(function(ze,Xe){var Rt=Ud(ze,F,O),Yt=zd[wn].offset(Rt);return B.createElement(W,{key:Xe,valueLabelFormat:ue,valueLabelDisplay:te,className:o.valueLabel,value:typeof ue=="function"?ue(ye(ze),Xe):ue,index:Xe,open:He===Xe||Ke===Xe||te==="on",disabled:x},B.createElement(D,{className:Et(o.thumb,o["thumbColor".concat(Gr(f))],Ke===Xe&&o.active,x&&o.disabled,mt===Xe&&o.focusVisible),tabIndex:x?null:0,role:"slider",style:Yt,"data-index":Xe,"aria-label":b?b(Xe):r,"aria-labelledby":s,"aria-orientation":pe,"aria-valuemax":ye(O),"aria-valuemin":ye(F),"aria-valuenow":ye(ze),"aria-valuetext":w?w(ye(ze),Xe):i,onKeyDown:Zs,onFocus:Ai,onBlur:Do,onMouseOver:Ks,onMouseLeave:Qe}))}))});const Qp=Pn(y5,{name:"MuiSlider"})(_5);let x5=0;function b5(n,e){const t=`atom${++x5}`,r={toString:()=>t};return typeof n=="function"?r.read=n:(r.init=n,r.read=s=>s(r),r.write=(s,i,o)=>i(r,typeof o=="function"?o(s(r)):o)),e&&(r.write=e),r}const Or={},wo=Symbol(),zv=n=>!!n[wo],$d=n=>!n[wo].c,Qc=n=>{var e;const{b:t,c:r}=n[wo];r&&(r(),(e=T5.get(t))==null||e())},mh=(n,e)=>{const t=n[wo].o,r=e[wo].o;return t===r||n===r||zv(t)&&mh(t,e)},$v=(n,e)=>{const t={b:n,o:e,c:null},r=new Promise(s=>{t.c=()=>{t.c=null,s()},e.finally(t.c)});return r[wo]=t,r},w5=n=>$v(n[wo].b,n[wo].o),T5=new WeakMap,jd=n=>"init"in n,jv="r",Wv="w",Uu="c",Hv="s",u3="h",S5="n",E5="l",A5="a",C5="m",R5=n=>{const e=new WeakMap,t=new WeakMap,r=new Map;let s,i;if((Or&&"production")!=="production"&&(s=new Set,i=new Set),n)for(const[M,T]of n){const N={v:T,r:0,y:!0,d:new Map};(Or&&"production")!=="production"&&(Object.freeze(N),jd(M)||console.warn("Found initial value for derived atom which can cause unexpected behavior",M)),e.set(M,N)}const o=new WeakMap,a=(M,T,N)=>{let W=o.get(T);W||(W=new Map,o.set(T,W)),N.then(()=>{W.get(M)===N&&(W.delete(M),W.size||o.delete(T))}),W.set(M,N)},u=M=>{const T=new Set,N=o.get(M);return N&&(o.delete(M),N.forEach((W,Z)=>{Qc(W),T.add(Z)})),T},f=new WeakMap,d=M=>{let T=f.get(M);return T||(T=new Map,f.set(M,T)),T},p=(M,T)=>{if(M){const N=d(M);let W=N.get(T);return W||(W=p(M.p,T),W&&"p"in W&&$d(W.p)&&(W=void 0),W&&N.set(T,W)),W}return e.get(T)},m=(M,T,N)=>{if((Or&&"production")!=="production"&&Object.freeze(N),M)d(M).set(T,N);else{const W=e.get(T);e.set(T,N),r.has(T)||r.set(T,W)}},v=(M,T=new Map,N)=>{if(!N)return T;const W=new Map;let Z=!1;return N.forEach(te=>{var re;const ue=((re=p(M,te))==null?void 0:re.r)||0;W.set(te,ue),T.get(te)!==ue&&(Z=!0)}),T.size===W.size&&!Z?T:W},x=(M,T,N,W,Z)=>{const te=p(M,T);if(te){if(Z&&(!("p"in te)||!mh(te.p,Z)))return te;"p"in te&&Qc(te.p)}const re={v:N,r:(te==null?void 0:te.r)||0,y:!0,d:v(M,te==null?void 0:te.d,W)};let ue=!(te!=null&&te.y);return!te||!("v"in te)||!Object.is(te.v,N)?(ue=!0,++re.r,re.d.has(T)&&(re.d=new Map(re.d).set(T,re.r))):re.d!==te.d&&(re.d.size!==te.d.size||!Array.from(re.d.keys()).every(ve=>te.d.has(ve)))&&(ue=!0,Promise.resolve().then(()=>{Me(M)})),te&&!ue?te:(m(M,T,re),re)},b=(M,T,N,W,Z)=>{const te=p(M,T);if(te){if(Z&&(!("p"in te)||!mh(te.p,Z)))return te;"p"in te&&Qc(te.p)}const re={e:N,r:((te==null?void 0:te.r)||0)+1,y:!0,d:v(M,te==null?void 0:te.d,W)};return m(M,T,re),re},w=(M,T,N,W)=>{const Z=p(M,T);if(Z&&"p"in Z){if(mh(Z.p,N)&&!$d(Z.p))return Z.y?Z:{...Z,y:!0};Qc(Z.p)}a(M,T,N);const te={p:N,r:((Z==null?void 0:Z.r)||0)+1,y:!0,d:v(M,Z==null?void 0:Z.d,W)};return m(M,T,te),te},S=(M,T,N,W)=>{if(N instanceof Promise){const Z=$v(N,N.then(te=>{x(M,T,te,W,Z)}).catch(te=>{if(te instanceof Promise)return zv(te)?te.then(()=>{C(M,T,!0)}):te;b(M,T,te,W,Z)}));return w(M,T,Z,W)}return x(M,T,N,W)},R=(M,T)=>{const N=p(M,T);if(N){const W={...N,y:!1};m(M,T,W)}else(Or&&"production")!=="production"&&console.warn("[Bug] could not invalidate non existing atom",T)},C=(M,T,N)=>{if(!N){const Z=p(M,T);if(Z){if(Z.y&&"p"in Z&&!$d(Z.p))return Z;if(Z.d.forEach((te,re)=>{if(re!==T)if(!t.has(re))C(M,re);else{const ue=p(M,re);ue&&!ue.y&&C(M,re)}}),Array.from(Z.d).every(([te,re])=>{const ue=p(M,te);return ue&&!("p"in ue)&&ue.r===re}))return Z.y?Z:{...Z,y:!0}}}const W=new Set;try{const Z=T.read(te=>{W.add(te);const re=te===T?p(M,te):C(M,te);if(re){if("e"in re)throw re.e;if("p"in re)throw re.p;return re.v}if(jd(te))return te.init;throw new Error("no atom init")});return S(M,T,Z,W)}catch(Z){if(Z instanceof Promise){const te=zv(Z)&&$d(Z)?w5(Z):$v(Z,Z);return w(M,T,te,W)}return b(M,T,Z,W)}},O=(M,T)=>C(T,M),I=(M,T)=>{let N=t.get(T);return N||(N=pe(M,T)),N},F=(M,T)=>!T.l.size&&(!T.t.size||T.t.size===1&&T.t.has(M)),$=(M,T)=>{const N=t.get(T);N&&F(T,N)&&se(M,T)},q=(M,T)=>{const N=t.get(T);N==null||N.t.forEach(W=>{W!==T&&(R(M,W),q(M,W))})},K=(M,T,N)=>{let W=!0;const Z=(ue,ve)=>{const be=C(M,ue);if("e"in be)throw be.e;if("p"in be){if(ve!=null&&ve.unstable_promise)return be.p.then(()=>{const Pe=p(M,ue);return Pe&&"p"in Pe&&Pe.p===be.p?new Promise(Ue=>setTimeout(Ue)).then(()=>Z(ue,ve)):Z(ue,ve)});throw(Or&&"production")!=="production"&&console.info("Reading pending atom state in write operation. We throw a promise for now.",ue),be.p}if("v"in be)return be.v;throw(Or&&"production")!=="production"&&console.warn("[Bug] no value found while reading atom in write operation. This is probably a bug.",ue),new Error("no value found")},te=(ue,ve)=>{let be;if(ue===T){if(!jd(ue))throw new Error("atom not writable");u(ue).forEach(nt=>{nt!==M&&S(nt,ue,ve)});const Ue=p(M,ue),Ke=S(M,ue,ve);Ue!==Ke&&q(M,ue)}else be=K(M,ue,ve);return W||Me(M),be},re=T.write(Z,te,N);return W=!1,re},le=(M,T,N)=>{const W=K(N,M,T);return Me(N),W},he=M=>!!M.write,pe=(M,T,N)=>{const W={t:new Set(N&&[N]),l:new Set};if(t.set(T,W),(Or&&"production")!=="production"&&i.add(T),C(void 0,T).d.forEach((te,re)=>{const ue=t.get(re);ue?ue.t.add(T):re!==T&&pe(M,re,T)}),he(T)&&T.onMount){const te=ue=>le(T,ue,M),re=T.onMount(te);M=void 0,re&&(W.u=re)}return W},se=(M,T)=>{var N;const W=(N=t.get(T))==null?void 0:N.u;W&&W(),t.delete(T),(Or&&"production")!=="production"&&i.delete(T);const Z=p(M,T);Z?("p"in Z&&Qc(Z.p),Z.d.forEach((te,re)=>{if(re!==T){const ue=t.get(re);ue&&(ue.t.delete(T),F(re,ue)&&se(M,re))}})):(Or&&"production")!=="production"&&console.warn("[Bug] could not find atom state to unmount",T)},ye=(M,T,N,W)=>{const Z=new Set(N.d.keys());W==null||W.forEach((te,re)=>{if(Z.has(re)){Z.delete(re);return}const ue=t.get(re);ue&&(ue.t.delete(T),F(re,ue)&&se(M,re))}),Z.forEach(te=>{const re=t.get(te);re?re.t.add(T):t.has(T)&&pe(M,te,T)})},Me=M=>{if(M){d(M).forEach((N,W)=>{const Z=e.get(W);if(N!==Z){const te=t.get(W);te==null||te.l.forEach(re=>re(M))}});return}for(;r.size;){const T=Array.from(r);r.clear(),T.forEach(([N,W])=>{const Z=p(void 0,N);if(Z&&Z.d!==(W==null?void 0:W.d)&&ye(void 0,N,Z,W==null?void 0:W.d),W&&!W.y&&(Z!=null&&Z.y))return;const te=t.get(N);te==null||te.l.forEach(re=>re())})}(Or&&"production")!=="production"&&s.forEach(T=>T())},U=M=>{d(M).forEach((N,W)=>{const Z=e.get(W);(!Z||N.r>Z.r||N.y!==Z.y||N.r===Z.r&&N.d!==Z.d)&&(e.set(W,N),N.d!==(Z==null?void 0:Z.d)&&ye(M,W,N,Z==null?void 0:Z.d))})},H=(M,T)=>{T&&U(T),Me(void 0)},D=(M,T,N)=>{const Z=I(N,M).l;return Z.add(T),()=>{Z.delete(T),$(N,M)}},Y=(M,T)=>{for(const[N,W]of M)jd(N)&&(S(T,N,W),q(T,N));Me(T)};return(Or&&"production")!=="production"?{[jv]:O,[Wv]:le,[Uu]:H,[Hv]:D,[u3]:Y,[S5]:M=>(s.add(M),()=>{s.delete(M)}),[E5]:()=>i.values(),[A5]:M=>e.get(M),[C5]:M=>t.get(M)}:{[jv]:O,[Wv]:le,[Uu]:H,[Hv]:D,[u3]:Y}},SE=(n,e)=>({s:e?e(n).SECRET_INTERNAL_store:R5(n)}),I0=new Map,P_=n=>(I0.has(n)||I0.set(n,B.createContext(SE())),I0.get(n)),P5=({children:n,initialValues:e,scope:t,unstable_createStore:r,unstable_enableVersionedWrite:s})=>{const[i,o]=B.useState({});B.useEffect(()=>{const f=a.current;f.w&&(f.s[Uu](null,i),delete i.p,f.v=i)},[i]);const a=B.useRef();if(!a.current){const f=SE(e,r);if(s){let d=0;f.w=p=>{o(m=>{const v=d?m:{p:m};return p(v),v})},f.v=i,f.r=p=>{++d,p(),--d}}a.current=f}const u=P_(t);return B.createElement(u.Provider,{value:a.current},n)};function Vn(n,e){return b5(n,e)}function Vu(n,e){const t=P_(e),r=B.useContext(t),{s,v:i}=r,o=m=>{const v=s[jv](n,m);if((Or&&"production")!=="production"&&!v.y)throw new Error("should not be invalidated");if("e"in v)throw v.e;if("p"in v)throw v.p;if("v"in v)return v.v;throw new Error("no atom value")},[[a,u,f],d]=B.useReducer((m,v)=>{const x=o(v);return Object.is(m[1],x)&&m[2]===n?m:[v,x,n]},i,m=>{const v=o(m);return[m,v,n]});let p=u;return f!==n&&(d(a),p=o(a)),B.useEffect(()=>{const{v:m}=r;m&&s[Uu](n,m);const v=s[Hv](n,d,m);return d(m),v},[s,n,r]),B.useEffect(()=>{s[Uu](n,a)}),B.useDebugValue(p),p}function Xv(n,e){const t=P_(e),{s:r,w:s}=B.useContext(t);return B.useCallback(o=>{if((Or&&"production")!=="production"&&!("write"in n))throw new Error("not writable atom");const a=u=>r[Wv](n,o,u);return s?s(a):a()},[r,s,n])}function I_(n,e){return"scope"in n&&(console.warn("atom.scope is deprecated. Please do useAtom(atom, scope) instead."),e=n.scope),[Vu(n,e),Xv(n,e)]}var Wd={},f3;function I5(){if(f3)return Wd;f3=1;var n=mE();return Wd.createRoot=n.createRoot,Wd.hydrateRoot=n.hydrateRoot,Wd}var k5=I5();const M5=ka(k5),EE=Ti(B.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})),O5=Ti(B.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"})),AE=Ti(B.createElement("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})),CE=Ti(B.createElement("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),RE=Ti(B.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),PE=Ti(B.createElement("path",{d:"M19 13H5v-2h14v2z"})),N5=Ti(B.createElement("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})),D5=Ti(B.createElement("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"})),L5="modulepreload",F5=function(n,e){return new URL(n,e).href},d3={},Fr=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(t.map(f=>{if(f=F5(f,r),f in d3)return;d3[f]=!0;const d=f.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(!!r)for(let x=o.length-1;x>=0;x--){const b=o[x];if(b.href===f&&(!d||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${p}`))return;const v=document.createElement("link");if(v.rel=d?"stylesheet":L5,d||(v.as="script"),v.crossOrigin="",v.href=f,u&&v.setAttribute("nonce",u),document.head.appendChild(v),d)return new Promise((x,b)=>{v.addEventListener("load",x),v.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},B5={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...B5}};const wr=globalThis.mathgl.config;function U5(n,{precision:e=wr.precision}={}){return n=V5(n),`${parseFloat(n.toPrecision(e))}`}function _a(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function un(n,e,t){return $5(n,r=>Math.max(e,Math.min(t,r)))}function da(n,e,t){return _a(n)?n.map((r,s)=>da(r,e[s],t)):t*e+(1-t)*n}function gi(n,e,t){const r=wr.EPSILON;try{if(n===e)return!0;if(_a(n)&&_a(e)){if(n.length!==e.length)return!1;for(let s=0;s<n.length;++s)if(!gi(n[s],e[s]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):typeof n=="number"&&typeof e=="number"?Math.abs(n-e)<=wr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e)):!1}finally{wr.EPSILON=r}}function V5(n){return Math.round(n/wr.EPSILON)*wr.EPSILON}function z5(n){return n.clone?n.clone():new Array(n.length)}function $5(n,e,t){if(_a(n)){const r=n;t=t||z5(r);for(let s=0;s<t.length&&s<r.length;++s){const i=typeof n=="number"?n:n[s];t[s]=e(i,s,t)}return t}return e(n)}class k_ extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,t=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+t];return this.check()}toArray(e=[],t=0){for(let r=0;r<this.ELEMENTS;++r)e[t+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:_a(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(wr)}formatString(e){let t="";for(let r=0;r<this.ELEMENTS;++r)t+=(r>0?", ":"")+U5(this[r],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!gi(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,r){if(r===void 0)return this.lerp(this,e,t);for(let s=0;s<this.ELEMENTS;++s){const i=e[s],o=typeof t=="number"?t:t[s];this[s]=i+r*(o-i)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),t[r]);return this.check()}add(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=t[r];return this.check()}subtract(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=t[r];return this.check()}scale(e){if(typeof e=="number")for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(wr.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),t);return this.check()}get elements(){return this}}function j5(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}function zt(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${JSON.stringify(n)}`);return n}function Su(n,e,t=""){if(wr.debug&&!j5(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}function zu(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}class IE extends k_{get x(){return this[0]}set x(e){this[0]=zt(e)}get y(){return this[1]}set y(e){this[1]=zt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let r=0;r<this.ELEMENTS;++r){const s=this[r]-e[r];t+=s*s}return zt(t)}dot(e){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*e[r];return zt(t)}normalize(){const e=this.magnitude();if(e!==0)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=t[r];return this.check()}divide(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return zu(e>=0&&e<this.ELEMENTS,"index is out of range"),zt(this[e])}setComponent(e,t){return zu(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const Eu=1e-6;let xs=typeof Float32Array<"u"?Float32Array:Array;function W5(){const n=new xs(2);return xs!=Float32Array&&(n[0]=0,n[1]=0),n}function Lh(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function kE(n,e){return n[0]=-e[0],n[1]=-e[1],n}function ME(n,e,t,r){const s=e[0],i=e[1];return n[0]=s+r*(t[0]-s),n[1]=i+r*(t[1]-i),n}function H5(n,e,t){const r=e[0],s=e[1];return n[0]=t[0]*r+t[3]*s+t[6],n[1]=t[1]*r+t[4]*s+t[7],n}function X5(n,e,t){const r=e[0],s=e[1];return n[0]=t[0]*r+t[4]*s+t[12],n[1]=t[1]*r+t[5]*s+t[13],n}(function(){const n=W5();return function(e,t,r,s,i,o){let a,u;for(t||(t=2),r||(r=0),s?u=Math.min(s*t+r,e.length):u=e.length,a=r;a<u;a+=t)n[0]=e[a],n[1]=e[a+1],i(n,n,o),e[a]=n[0],e[a+1]=n[1];return e}})();function Y5(n,e,t){const r=e[0],s=e[1],i=t[3]*r+t[7]*s||1;return n[0]=(t[0]*r+t[4]*s)/i,n[1]=(t[1]*r+t[5]*s)/i,n}function OE(n,e,t){const r=e[0],s=e[1],i=e[2],o=t[3]*r+t[7]*s+t[11]*i||1;return n[0]=(t[0]*r+t[4]*s+t[8]*i)/o,n[1]=(t[1]*r+t[5]*s+t[9]*i)/o,n[2]=(t[2]*r+t[6]*s+t[10]*i)/o,n}function q5(n,e,t){const r=e[0],s=e[1];return n[0]=t[0]*r+t[2]*s,n[1]=t[1]*r+t[3]*s,n[2]=e[2],n}function K5(n,e,t){const r=e[0],s=e[1];return n[0]=t[0]*r+t[2]*s,n[1]=t[1]*r+t[3]*s,n[2]=e[2],n[3]=e[3],n}function NE(n,e,t){const r=e[0],s=e[1],i=e[2];return n[0]=t[0]*r+t[3]*s+t[6]*i,n[1]=t[1]*r+t[4]*s+t[7]*i,n[2]=t[2]*r+t[5]*s+t[8]*i,n[3]=e[3],n}function DE(){const n=new xs(3);return xs!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Z5(n){const e=n[0],t=n[1],r=n[2];return Math.sqrt(e*e+t*t+r*r)}function h3(n,e,t){const r=new xs(3);return r[0]=n,r[1]=e,r[2]=t,r}function Q5(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function G5(n){const e=n[0],t=n[1],r=n[2];return e*e+t*t+r*r}function J5(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function eO(n,e){const t=e[0],r=e[1],s=e[2];let i=t*t+r*r+s*s;return i>0&&(i=1/Math.sqrt(i)),n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function LE(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function vh(n,e,t){const r=e[0],s=e[1],i=e[2],o=t[0],a=t[1],u=t[2];return n[0]=s*u-i*a,n[1]=i*o-r*u,n[2]=r*a-s*o,n}function tO(n,e,t,r){const s=e[0],i=e[1],o=e[2];return n[0]=s+r*(t[0]-s),n[1]=i+r*(t[1]-i),n[2]=o+r*(t[2]-o),n}function M_(n,e,t){const r=e[0],s=e[1],i=e[2];let o=t[3]*r+t[7]*s+t[11]*i+t[15];return o=o||1,n[0]=(t[0]*r+t[4]*s+t[8]*i+t[12])/o,n[1]=(t[1]*r+t[5]*s+t[9]*i+t[13])/o,n[2]=(t[2]*r+t[6]*s+t[10]*i+t[14])/o,n}function FE(n,e,t){const r=e[0],s=e[1],i=e[2];return n[0]=r*t[0]+s*t[3]+i*t[6],n[1]=r*t[1]+s*t[4]+i*t[7],n[2]=r*t[2]+s*t[5]+i*t[8],n}function BE(n,e,t){const r=t[0],s=t[1],i=t[2],o=t[3],a=e[0],u=e[1],f=e[2];let d=s*f-i*u,p=i*a-r*f,m=r*u-s*a,v=s*m-i*p,x=i*d-r*m,b=r*p-s*d;const w=o*2;return d*=w,p*=w,m*=w,v*=2,x*=2,b*=2,n[0]=a+d+v,n[1]=u+p+x,n[2]=f+m+b,n}function nO(n,e,t,r){const s=[],i=[];return s[0]=e[0]-t[0],s[1]=e[1]-t[1],s[2]=e[2]-t[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),n[0]=i[0]+t[0],n[1]=i[1]+t[1],n[2]=i[2]+t[2],n}function rO(n,e,t,r){const s=[],i=[];return s[0]=e[0]-t[0],s[1]=e[1]-t[1],s[2]=e[2]-t[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),n[0]=i[0]+t[0],n[1]=i[1]+t[1],n[2]=i[2]+t[2],n}function sO(n,e,t,r){const s=[],i=[];return s[0]=e[0]-t[0],s[1]=e[1]-t[1],s[2]=e[2]-t[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],n[0]=i[0]+t[0],n[1]=i[1]+t[1],n[2]=i[2]+t[2],n}function iO(n,e){const t=n[0],r=n[1],s=n[2],i=e[0],o=e[1],a=e[2],u=Math.sqrt((t*t+r*r+s*s)*(i*i+o*o+a*a)),f=u&&LE(n,e)/u;return Math.acos(Math.min(Math.max(f,-1),1))}const UE=Q5,VE=Z5,k0=G5;(function(){const n=DE();return function(e,t,r,s,i,o){let a,u;for(t||(t=3),r||(r=0),s?u=Math.min(s*t+r,e.length):u=e.length,a=r;a<u;a+=t)n[0]=e[a],n[1]=e[a+1],n[2]=e[a+2],i(n,n,o),e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2];return e}})();const M0=[0,0,0];let Hd;class Fe extends IE{static get ZERO(){return Hd||(Hd=new Fe(0,0,0),Object.freeze(Hd)),Hd}constructor(e=0,t=0,r=0){super(-0,-0,-0),arguments.length===1&&_a(e)?this.copy(e):(wr.debug&&(zt(e),zt(t),zt(r)),this[0]=e,this[1]=t,this[2]=r)}set(e,t,r){return this[0]=e,this[1]=t,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return wr.debug&&(zt(e.x),zt(e.y),zt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=zt(e)}angle(e){return iO(this,e)}cross(e){return vh(this,this,e),this.check()}rotateX({radians:e,origin:t=M0}){return nO(this,this,t,e),this.check()}rotateY({radians:e,origin:t=M0}){return rO(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=M0}){return sO(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return M_(this,this,e),this.check()}transformAsVector(e){return OE(this,this,e),this.check()}transformByMatrix3(e){return FE(this,this,e),this.check()}transformByMatrix2(e){return q5(this,this,e),this.check()}transformByQuaternion(e){return BE(this,this,e),this.check()}}let Xd;class O_ extends IE{static get ZERO(){return Xd||(Xd=new O_(0,0,0,0),Object.freeze(Xd)),Xd}constructor(e=0,t=0,r=0,s=0){super(-0,-0,-0,-0),_a(e)&&arguments.length===1?this.copy(e):(wr.debug&&(zt(e),zt(t),zt(r),zt(s)),this[0]=e,this[1]=t,this[2]=r,this[3]=s)}set(e,t,r,s){return this[0]=e,this[1]=t,this[2]=r,this[3]=s,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return wr.debug&&(zt(e.x),zt(e.y),zt(e.z),zt(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=zt(e)}get w(){return this[3]}set w(e){this[3]=zt(e)}transform(e){return M_(this,this,e),this.check()}transformByMatrix3(e){return NE(this,this,e),this.check()}transformByMatrix2(e){return K5(this,this,e),this.check()}transformByQuaternion(e){return BE(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class zE extends k_{toString(){let e="[";if(wr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,r){return this[t*this.RANK+e]=zt(r),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)t[s]=this[r+s];return t}setColumn(e,t){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=t[s];return this}}function oO(){const n=new xs(9);return xs!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function aO(n,e){if(n===e){const t=e[1],r=e[2],s=e[5];n[1]=e[3],n[2]=e[6],n[3]=t,n[5]=e[7],n[6]=r,n[7]=s}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n}function lO(n,e){const t=e[0],r=e[1],s=e[2],i=e[3],o=e[4],a=e[5],u=e[6],f=e[7],d=e[8],p=d*o-a*f,m=-d*i+a*u,v=f*i-o*u;let x=t*p+r*m+s*v;return x?(x=1/x,n[0]=p*x,n[1]=(-d*r+s*f)*x,n[2]=(a*r-s*o)*x,n[3]=m*x,n[4]=(d*t-s*u)*x,n[5]=(-a*t+s*i)*x,n[6]=v*x,n[7]=(-f*t+r*u)*x,n[8]=(o*t-r*i)*x,n):null}function cO(n){const e=n[0],t=n[1],r=n[2],s=n[3],i=n[4],o=n[5],a=n[6],u=n[7],f=n[8];return e*(f*i-o*u)+t*(-f*s+o*a)+r*(u*s-i*a)}function p3(n,e,t){const r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],u=e[5],f=e[6],d=e[7],p=e[8],m=t[0],v=t[1],x=t[2],b=t[3],w=t[4],S=t[5],R=t[6],C=t[7],O=t[8];return n[0]=m*r+v*o+x*f,n[1]=m*s+v*a+x*d,n[2]=m*i+v*u+x*p,n[3]=b*r+w*o+S*f,n[4]=b*s+w*a+S*d,n[5]=b*i+w*u+S*p,n[6]=R*r+C*o+O*f,n[7]=R*s+C*a+O*d,n[8]=R*i+C*u+O*p,n}function uO(n,e,t){const r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],u=e[5],f=e[6],d=e[7],p=e[8],m=t[0],v=t[1];return n[0]=r,n[1]=s,n[2]=i,n[3]=o,n[4]=a,n[5]=u,n[6]=m*r+v*o+f,n[7]=m*s+v*a+d,n[8]=m*i+v*u+p,n}function fO(n,e,t){const r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],u=e[5],f=e[6],d=e[7],p=e[8],m=Math.sin(t),v=Math.cos(t);return n[0]=v*r+m*o,n[1]=v*s+m*a,n[2]=v*i+m*u,n[3]=v*o-m*r,n[4]=v*a-m*s,n[5]=v*u-m*i,n[6]=f,n[7]=d,n[8]=p,n}function g3(n,e,t){const r=t[0],s=t[1];return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=s*e[3],n[4]=s*e[4],n[5]=s*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function dO(n,e){const t=e[0],r=e[1],s=e[2],i=e[3],o=t+t,a=r+r,u=s+s,f=t*o,d=r*o,p=r*a,m=s*o,v=s*a,x=s*u,b=i*o,w=i*a,S=i*u;return n[0]=1-p-x,n[3]=d-S,n[6]=m+w,n[1]=d+S,n[4]=1-f-x,n[7]=v-b,n[2]=m-w,n[5]=v+b,n[8]=1-f-p,n}var Yv;(function(n){n[n.COL0ROW0=0]="COL0ROW0",n[n.COL0ROW1=1]="COL0ROW1",n[n.COL0ROW2=2]="COL0ROW2",n[n.COL1ROW0=3]="COL1ROW0",n[n.COL1ROW1=4]="COL1ROW1",n[n.COL1ROW2=5]="COL1ROW2",n[n.COL2ROW0=6]="COL2ROW0",n[n.COL2ROW1=7]="COL2ROW1",n[n.COL2ROW2=8]="COL2ROW2"})(Yv||(Yv={}));const hO=Object.freeze([1,0,0,0,1,0,0,0,1]);class zn extends zE{static get IDENTITY(){return gO()}static get ZERO(){return pO()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Yv}constructor(e,...t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):t.length>0?this.copy([e,...t]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(hO)}fromObject(e){return this.check()}fromQuaternion(e){return dO(this,e),this.check()}set(e,t,r,s,i,o,a,u,f){return this[0]=e,this[1]=t,this[2]=r,this[3]=s,this[4]=i,this[5]=o,this[6]=a,this[7]=u,this[8]=f,this.check()}setRowMajor(e,t,r,s,i,o,a,u,f){return this[0]=e,this[1]=s,this[2]=a,this[3]=t,this[4]=i,this[5]=u,this[6]=r,this[7]=o,this[8]=f,this.check()}determinant(){return cO(this)}transpose(){return aO(this,this),this.check()}invert(){return lO(this,this),this.check()}multiplyLeft(e){return p3(this,e,this),this.check()}multiplyRight(e){return p3(this,this,e),this.check()}rotate(e){return fO(this,this,e),this.check()}scale(e){return Array.isArray(e)?g3(this,this,e):g3(this,this,[e,e]),this.check()}translate(e){return uO(this,this,e),this.check()}transform(e,t){let r;switch(e.length){case 2:r=H5(t||[-0,-0],e,this);break;case 3:r=FE(t||[-0,-0,-0],e,this);break;case 4:r=NE(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Su(r,e.length),r}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}let Yd,qd=null;function pO(){return Yd||(Yd=new zn([0,0,0,0,0,0,0,0,0]),Object.freeze(Yd)),Yd}function gO(){return qd||(qd=new zn,Object.freeze(qd)),qd}function mO(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function vO(n,e){if(n===e){const t=e[1],r=e[2],s=e[3],i=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=r,n[9]=i,n[11]=e[14],n[12]=s,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15];return n}function qv(n,e){const t=e[0],r=e[1],s=e[2],i=e[3],o=e[4],a=e[5],u=e[6],f=e[7],d=e[8],p=e[9],m=e[10],v=e[11],x=e[12],b=e[13],w=e[14],S=e[15],R=t*a-r*o,C=t*u-s*o,O=t*f-i*o,I=r*u-s*a,F=r*f-i*a,$=s*f-i*u,q=d*b-p*x,K=d*w-m*x,le=d*S-v*x,he=p*w-m*b,pe=p*S-v*b,se=m*S-v*w;let ye=R*se-C*pe+O*he+I*le-F*K+$*q;return ye?(ye=1/ye,n[0]=(a*se-u*pe+f*he)*ye,n[1]=(s*pe-r*se-i*he)*ye,n[2]=(b*$-w*F+S*I)*ye,n[3]=(m*F-p*$-v*I)*ye,n[4]=(u*le-o*se-f*K)*ye,n[5]=(t*se-s*le+i*K)*ye,n[6]=(w*O-x*$-S*C)*ye,n[7]=(d*$-m*O+v*C)*ye,n[8]=(o*pe-a*le+f*q)*ye,n[9]=(r*le-t*pe-i*q)*ye,n[10]=(x*F-b*O+S*R)*ye,n[11]=(p*O-d*F-v*R)*ye,n[12]=(a*K-o*he-u*q)*ye,n[13]=(t*he-r*K+s*q)*ye,n[14]=(b*C-x*I-w*R)*ye,n[15]=(d*I-p*C+m*R)*ye,n):null}function yO(n){const e=n[0],t=n[1],r=n[2],s=n[3],i=n[4],o=n[5],a=n[6],u=n[7],f=n[8],d=n[9],p=n[10],m=n[11],v=n[12],x=n[13],b=n[14],w=n[15],S=e*o-t*i,R=e*a-r*i,C=t*a-r*o,O=f*x-d*v,I=f*b-p*v,F=d*b-p*x,$=e*F-t*I+r*O,q=i*F-o*I+a*O,K=f*C-d*R+p*S,le=v*C-x*R+b*S;return u*$-s*q+w*K-m*le}function ha(n,e,t){const r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],u=e[5],f=e[6],d=e[7],p=e[8],m=e[9],v=e[10],x=e[11],b=e[12],w=e[13],S=e[14],R=e[15];let C=t[0],O=t[1],I=t[2],F=t[3];return n[0]=C*r+O*a+I*p+F*b,n[1]=C*s+O*u+I*m+F*w,n[2]=C*i+O*f+I*v+F*S,n[3]=C*o+O*d+I*x+F*R,C=t[4],O=t[5],I=t[6],F=t[7],n[4]=C*r+O*a+I*p+F*b,n[5]=C*s+O*u+I*m+F*w,n[6]=C*i+O*f+I*v+F*S,n[7]=C*o+O*d+I*x+F*R,C=t[8],O=t[9],I=t[10],F=t[11],n[8]=C*r+O*a+I*p+F*b,n[9]=C*s+O*u+I*m+F*w,n[10]=C*i+O*f+I*v+F*S,n[11]=C*o+O*d+I*x+F*R,C=t[12],O=t[13],I=t[14],F=t[15],n[12]=C*r+O*a+I*p+F*b,n[13]=C*s+O*u+I*m+F*w,n[14]=C*i+O*f+I*v+F*S,n[15]=C*o+O*d+I*x+F*R,n}function Fh(n,e,t){const r=t[0],s=t[1],i=t[2];let o,a,u,f,d,p,m,v,x,b,w,S;return e===n?(n[12]=e[0]*r+e[4]*s+e[8]*i+e[12],n[13]=e[1]*r+e[5]*s+e[9]*i+e[13],n[14]=e[2]*r+e[6]*s+e[10]*i+e[14],n[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(o=e[0],a=e[1],u=e[2],f=e[3],d=e[4],p=e[5],m=e[6],v=e[7],x=e[8],b=e[9],w=e[10],S=e[11],n[0]=o,n[1]=a,n[2]=u,n[3]=f,n[4]=d,n[5]=p,n[6]=m,n[7]=v,n[8]=x,n[9]=b,n[10]=w,n[11]=S,n[12]=o*r+d*s+x*i+e[12],n[13]=a*r+p*s+b*i+e[13],n[14]=u*r+m*s+w*i+e[14],n[15]=f*r+v*s+S*i+e[15]),n}function N_(n,e,t){const r=t[0],s=t[1],i=t[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*s,n[5]=e[5]*s,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*i,n[9]=e[9]*i,n[10]=e[10]*i,n[11]=e[11]*i,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function _O(n,e,t,r){let s=r[0],i=r[1],o=r[2],a=Math.sqrt(s*s+i*i+o*o),u,f,d,p,m,v,x,b,w,S,R,C,O,I,F,$,q,K,le,he,pe,se,ye,Me;return a<Eu?null:(a=1/a,s*=a,i*=a,o*=a,f=Math.sin(t),u=Math.cos(t),d=1-u,p=e[0],m=e[1],v=e[2],x=e[3],b=e[4],w=e[5],S=e[6],R=e[7],C=e[8],O=e[9],I=e[10],F=e[11],$=s*s*d+u,q=i*s*d+o*f,K=o*s*d-i*f,le=s*i*d-o*f,he=i*i*d+u,pe=o*i*d+s*f,se=s*o*d+i*f,ye=i*o*d-s*f,Me=o*o*d+u,n[0]=p*$+b*q+C*K,n[1]=m*$+w*q+O*K,n[2]=v*$+S*q+I*K,n[3]=x*$+R*q+F*K,n[4]=p*le+b*he+C*pe,n[5]=m*le+w*he+O*pe,n[6]=v*le+S*he+I*pe,n[7]=x*le+R*he+F*pe,n[8]=p*se+b*ye+C*Me,n[9]=m*se+w*ye+O*Me,n[10]=v*se+S*ye+I*Me,n[11]=x*se+R*ye+F*Me,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function $E(n,e,t){const r=Math.sin(t),s=Math.cos(t),i=e[4],o=e[5],a=e[6],u=e[7],f=e[8],d=e[9],p=e[10],m=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=i*s+f*r,n[5]=o*s+d*r,n[6]=a*s+p*r,n[7]=u*s+m*r,n[8]=f*s-i*r,n[9]=d*s-o*r,n[10]=p*s-a*r,n[11]=m*s-u*r,n}function xO(n,e,t){const r=Math.sin(t),s=Math.cos(t),i=e[0],o=e[1],a=e[2],u=e[3],f=e[8],d=e[9],p=e[10],m=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=i*s-f*r,n[1]=o*s-d*r,n[2]=a*s-p*r,n[3]=u*s-m*r,n[8]=i*r+f*s,n[9]=o*r+d*s,n[10]=a*r+p*s,n[11]=u*r+m*s,n}function jE(n,e,t){const r=Math.sin(t),s=Math.cos(t),i=e[0],o=e[1],a=e[2],u=e[3],f=e[4],d=e[5],p=e[6],m=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=i*s+f*r,n[1]=o*s+d*r,n[2]=a*s+p*r,n[3]=u*s+m*r,n[4]=f*s-i*r,n[5]=d*s-o*r,n[6]=p*s-a*r,n[7]=m*s-u*r,n}function bO(n,e){const t=e[0],r=e[1],s=e[2],i=e[4],o=e[5],a=e[6],u=e[8],f=e[9],d=e[10];return n[0]=Math.sqrt(t*t+r*r+s*s),n[1]=Math.sqrt(i*i+o*o+a*a),n[2]=Math.sqrt(u*u+f*f+d*d),n}function wO(n,e){const t=e[0],r=e[1],s=e[2],i=e[3],o=t+t,a=r+r,u=s+s,f=t*o,d=r*o,p=r*a,m=s*o,v=s*a,x=s*u,b=i*o,w=i*a,S=i*u;return n[0]=1-p-x,n[1]=d+S,n[2]=m-w,n[3]=0,n[4]=d-S,n[5]=1-f-x,n[6]=v+b,n[7]=0,n[8]=m+w,n[9]=v-b,n[10]=1-f-p,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function TO(n,e,t,r,s,i,o){const a=1/(t-e),u=1/(s-r),f=1/(i-o);return n[0]=i*2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=i*2*u,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(s+r)*u,n[10]=(o+i)*f,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*i*2*f,n[15]=0,n}function SO(n,e,t,r,s){const i=1/Math.tan(e/2);if(n[0]=i/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=i,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,s!=null&&s!==1/0){const o=1/(r-s);n[10]=(s+r)*o,n[14]=2*s*r*o}else n[10]=-1,n[14]=-2*r;return n}const EO=SO;function AO(n,e,t,r,s,i,o){const a=1/(e-t),u=1/(r-s),f=1/(i-o);return n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*u,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*f,n[11]=0,n[12]=(e+t)*a,n[13]=(s+r)*u,n[14]=(o+i)*f,n[15]=1,n}const CO=AO;function RO(n,e,t,r){let s,i,o,a,u,f,d,p,m,v;const x=e[0],b=e[1],w=e[2],S=r[0],R=r[1],C=r[2],O=t[0],I=t[1],F=t[2];return Math.abs(x-O)<Eu&&Math.abs(b-I)<Eu&&Math.abs(w-F)<Eu?mO(n):(p=x-O,m=b-I,v=w-F,s=1/Math.sqrt(p*p+m*m+v*v),p*=s,m*=s,v*=s,i=R*v-C*m,o=C*p-S*v,a=S*m-R*p,s=Math.sqrt(i*i+o*o+a*a),s?(s=1/s,i*=s,o*=s,a*=s):(i=0,o=0,a=0),u=m*a-v*o,f=v*i-p*a,d=p*o-m*i,s=Math.sqrt(u*u+f*f+d*d),s?(s=1/s,u*=s,f*=s,d*=s):(u=0,f=0,d=0),n[0]=i,n[1]=u,n[2]=p,n[3]=0,n[4]=o,n[5]=f,n[6]=m,n[7]=0,n[8]=a,n[9]=d,n[10]=v,n[11]=0,n[12]=-(i*x+o*b+a*w),n[13]=-(u*x+f*b+d*w),n[14]=-(p*x+m*b+v*w),n[15]=1,n)}function PO(){const n=new xs(4);return xs!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function IO(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n}function D_(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function kO(n){const e=n[0],t=n[1],r=n[2],s=n[3];return Math.sqrt(e*e+t*t+r*r+s*s)}function MO(n){const e=n[0],t=n[1],r=n[2],s=n[3];return e*e+t*t+r*r+s*s}function OO(n,e){const t=e[0],r=e[1],s=e[2],i=e[3];let o=t*t+r*r+s*s+i*i;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=r*o,n[2]=s*o,n[3]=i*o,n}function NO(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}function DO(n,e,t,r){const s=e[0],i=e[1],o=e[2],a=e[3];return n[0]=s+r*(t[0]-s),n[1]=i+r*(t[1]-i),n[2]=o+r*(t[2]-o),n[3]=a+r*(t[3]-a),n}function fc(n,e,t){const r=e[0],s=e[1],i=e[2],o=e[3];return n[0]=t[0]*r+t[4]*s+t[8]*i+t[12]*o,n[1]=t[1]*r+t[5]*s+t[9]*i+t[13]*o,n[2]=t[2]*r+t[6]*s+t[10]*i+t[14]*o,n[3]=t[3]*r+t[7]*s+t[11]*i+t[15]*o,n}function LO(n,e,t){const r=e[0],s=e[1],i=e[2],o=t[0],a=t[1],u=t[2],f=t[3],d=f*r+a*i-u*s,p=f*s+u*r-o*i,m=f*i+o*s-a*r,v=-o*r-a*s-u*i;return n[0]=d*f+v*-o+p*-u-m*-a,n[1]=p*f+v*-a+m*-o-d*-u,n[2]=m*f+v*-u+d*-a-p*-o,n[3]=e[3],n}(function(){const n=PO();return function(e,t,r,s,i,o){let a,u;for(t||(t=4),r||(r=0),s?u=Math.min(s*t+r,e.length):u=e.length,a=r;a<u;a+=t)n[0]=e[a],n[1]=e[a+1],n[2]=e[a+2],n[3]=e[a+3],i(n,n,o),e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2],e[a+3]=n[3];return e}})();var Kv;(function(n){n[n.COL0ROW0=0]="COL0ROW0",n[n.COL0ROW1=1]="COL0ROW1",n[n.COL0ROW2=2]="COL0ROW2",n[n.COL0ROW3=3]="COL0ROW3",n[n.COL1ROW0=4]="COL1ROW0",n[n.COL1ROW1=5]="COL1ROW1",n[n.COL1ROW2=6]="COL1ROW2",n[n.COL1ROW3=7]="COL1ROW3",n[n.COL2ROW0=8]="COL2ROW0",n[n.COL2ROW1=9]="COL2ROW1",n[n.COL2ROW2=10]="COL2ROW2",n[n.COL2ROW3=11]="COL2ROW3",n[n.COL3ROW0=12]="COL3ROW0",n[n.COL3ROW1=13]="COL3ROW1",n[n.COL3ROW2=14]="COL3ROW2",n[n.COL3ROW3=15]="COL3ROW3"})(Kv||(Kv={}));const FO=45*Math.PI/180,BO=1,O0=.1,N0=500,UO=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class At extends zE{static get IDENTITY(){return zO()}static get ZERO(){return VO()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Kv}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,r,s,i,o,a,u,f,d,p,m,v,x,b,w){return this[0]=e,this[1]=t,this[2]=r,this[3]=s,this[4]=i,this[5]=o,this[6]=a,this[7]=u,this[8]=f,this[9]=d,this[10]=p,this[11]=m,this[12]=v,this[13]=x,this[14]=b,this[15]=w,this.check()}setRowMajor(e,t,r,s,i,o,a,u,f,d,p,m,v,x,b,w){return this[0]=e,this[1]=i,this[2]=f,this[3]=v,this[4]=t,this[5]=o,this[6]=d,this[7]=x,this[8]=r,this[9]=a,this[10]=p,this[11]=b,this[12]=s,this[13]=u,this[14]=m,this[15]=w,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(UO)}fromObject(e){return this.check()}fromQuaternion(e){return wO(this,e),this.check()}frustum(e){const{left:t,right:r,bottom:s,top:i,near:o=O0,far:a=N0}=e;return a===1/0?$O(this,t,r,s,i,o):TO(this,t,r,s,i,o,a),this.check()}lookAt(e){const{eye:t,center:r=[0,0,0],up:s=[0,1,0]}=e;return RO(this,t,r,s),this.check()}ortho(e){const{left:t,right:r,bottom:s,top:i,near:o=O0,far:a=N0}=e;return CO(this,t,r,s,i,o,a),this.check()}orthographic(e){const{fovy:t=FO,aspect:r=BO,focalDistance:s=1,near:i=O0,far:o=N0}=e;m3(t);const a=t/2,u=s*Math.tan(a),f=u*r;return this.ortho({left:-f,right:f,bottom:-u,top:u,near:i,far:o})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:r=1,near:s=.1,far:i=500}=e;return m3(t),EO(this,t,r,s,i),this.check()}determinant(){return yO(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const r=this.getScale(t),s=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*i,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*i,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const r=this.getScale(t),s=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=this[4]*s,e[4]=this[5]*i,e[5]=this[6]*o,e[6]=this[8]*s,e[7]=this[9]*i,e[8]=this[10]*o,e}transpose(){return vO(this,this),this.check()}invert(){return qv(this,this),this.check()}multiplyLeft(e){return ha(this,e,this),this.check()}multiplyRight(e){return ha(this,this,e),this.check()}rotateX(e){return $E(this,this,e),this.check()}rotateY(e){return xO(this,this,e),this.check()}rotateZ(e){return jE(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return _O(this,this,e,t),this.check()}scale(e){return N_(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Fh(this,this,e),this.check()}transform(e,t){return e.length===4?(t=fc(t||[-0,-0,-0,-0],e,this),Su(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:r}=e;let s;switch(r){case 2:s=X5(t||[-0,-0],e,this);break;case 3:s=M_(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Su(s,e.length),s}transformAsVector(e,t){let r;switch(e.length){case 2:r=Y5(t||[-0,-0],e,this);break;case 3:r=OE(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Su(r,e.length),r}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,r){return this.identity().translate([e,t,r])}}let Kd,Zd;function VO(){return Kd||(Kd=new At([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Kd)),Kd}function zO(){return Zd||(Zd=new At,Object.freeze(Zd)),Zd}function m3(n){if(n>Math.PI*2)throw Error("expected radians")}function $O(n,e,t,r,s,i){const o=2*i/(t-e),a=2*i/(s-r),u=(t+e)/(t-e),f=(s+r)/(s-r),d=-1,p=-1,m=-2*i;return n[0]=o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=u,n[9]=f,n[10]=d,n[11]=p,n[12]=0,n[13]=0,n[14]=m,n[15]=0,n}function v3(){const n=new xs(4);return xs!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function jO(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function WE(n,e,t){t=t*.5;const r=Math.sin(t);return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=Math.cos(t),n}function y3(n,e,t){const r=e[0],s=e[1],i=e[2],o=e[3],a=t[0],u=t[1],f=t[2],d=t[3];return n[0]=r*d+o*a+s*f-i*u,n[1]=s*d+o*u+i*a-r*f,n[2]=i*d+o*f+r*u-s*a,n[3]=o*d-r*a-s*u-i*f,n}function WO(n,e,t){t*=.5;const r=e[0],s=e[1],i=e[2],o=e[3],a=Math.sin(t),u=Math.cos(t);return n[0]=r*u+o*a,n[1]=s*u+i*a,n[2]=i*u-s*a,n[3]=o*u-r*a,n}function HO(n,e,t){t*=.5;const r=e[0],s=e[1],i=e[2],o=e[3],a=Math.sin(t),u=Math.cos(t);return n[0]=r*u-i*a,n[1]=s*u+o*a,n[2]=i*u+r*a,n[3]=o*u-s*a,n}function XO(n,e,t){t*=.5;const r=e[0],s=e[1],i=e[2],o=e[3],a=Math.sin(t),u=Math.cos(t);return n[0]=r*u+s*a,n[1]=s*u-r*a,n[2]=i*u+o*a,n[3]=o*u-i*a,n}function YO(n,e){const t=e[0],r=e[1],s=e[2];return n[0]=t,n[1]=r,n[2]=s,n[3]=Math.sqrt(Math.abs(1-t*t-r*r-s*s)),n}function yh(n,e,t,r){const s=e[0],i=e[1],o=e[2],a=e[3];let u=t[0],f=t[1],d=t[2],p=t[3],m,v,x,b,w;return m=s*u+i*f+o*d+a*p,m<0&&(m=-m,u=-u,f=-f,d=-d,p=-p),1-m>Eu?(v=Math.acos(m),w=Math.sin(v),x=Math.sin((1-r)*v)/w,b=Math.sin(r*v)/w):(x=1-r,b=r),n[0]=x*s+b*u,n[1]=x*i+b*f,n[2]=x*o+b*d,n[3]=x*a+b*p,n}function qO(n,e){const t=e[0],r=e[1],s=e[2],i=e[3],o=t*t+r*r+s*s+i*i,a=o?1/o:0;return n[0]=-t*a,n[1]=-r*a,n[2]=-s*a,n[3]=i*a,n}function KO(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function HE(n,e){const t=e[0]+e[4]+e[8];let r;if(t>0)r=Math.sqrt(t+1),n[3]=.5*r,r=.5/r,n[0]=(e[5]-e[7])*r,n[1]=(e[6]-e[2])*r,n[2]=(e[1]-e[3])*r;else{let s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);const i=(s+1)%3,o=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[i*3+i]-e[o*3+o]+1),n[s]=.5*r,r=.5/r,n[3]=(e[i*3+o]-e[o*3+i])*r,n[i]=(e[i*3+s]+e[s*3+i])*r,n[o]=(e[o*3+s]+e[s*3+o])*r}return n}const ZO=IO,QO=D_,GO=NO,JO=DO,eN=kO,tN=MO,XE=OO,nN=function(){const n=DE(),e=h3(1,0,0),t=h3(0,1,0);return function(r,s,i){const o=LE(s,i);return o<-.999999?(vh(n,e,s),VE(n)<1e-6&&vh(n,t,s),eO(n,n),WE(r,n,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(vh(n,s,i),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=1+o,XE(r,r))}}();(function(){const n=v3(),e=v3();return function(t,r,s,i,o,a){return yh(n,r,o,a),yh(e,s,i,a),yh(t,n,e,2*a*(1-a)),t}})();(function(){const n=oO();return function(e,t,r,s){return n[0]=r[0],n[3]=r[1],n[6]=r[2],n[1]=s[0],n[4]=s[1],n[7]=s[2],n[2]=-t[0],n[5]=-t[1],n[8]=-t[2],XE(e,HE(e,n))}})();const rN=[0,0,0,1];class _3 extends k_{constructor(e=0,t=0,r=0,s=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,t,r,s)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,r,s){return this[0]=e,this[1]=t,this[2]=r,this[3]=s,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return HE(this,e),this.check()}fromAxisRotation(e,t){return WE(this,e,t),this.check()}identity(){return jO(this),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=zt(e)}get y(){return this[1]}set y(e){this[1]=zt(e)}get z(){return this[2]}set z(e){this[2]=zt(e)}get w(){return this[3]}set w(e){this[3]=zt(e)}len(){return eN(this)}lengthSquared(){return tN(this)}dot(e){return GO(this,e)}rotationTo(e,t){return nN(this,e,t),this.check()}add(e){return ZO(this,this,e),this.check()}calculateW(){return YO(this,this),this.check()}conjugate(){return KO(this,this),this.check()}invert(){return qO(this,this),this.check()}lerp(e,t,r){return r===void 0?this.lerp(this,e,t):(JO(this,e,t,r),this.check())}multiplyRight(e){return y3(this,this,e),this.check()}multiplyLeft(e){return y3(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,e===0&&(this[3]=1),this.check()}rotateX(e){return WO(this,this,e),this.check()}rotateY(e){return HO(this,this,e),this.check()}rotateZ(e){return XO(this,this,e),this.check()}scale(e){return QO(this,this,e),this.check()}slerp(e,t,r){let s,i,o;switch(arguments.length){case 1:({start:s=rN,target:i,ratio:o}=e);break;case 2:s=this,i=e,o=t;break;default:s=e,i=t,o=r}return yh(this,s,i,o),this.check()}transformVector4(e,t=new O_){return LO(t,e,this),Su(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const sN=1e-15,iN=1e-20;class Ma extends Error{constructor(e,t={}){super(`Node not found: ${e}`,t),this.name="NodeNotFoundError"}}class L_ extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}var Nr;class YE{constructor(e,t,r){yt(this,Nr);typeof e=="number"?rt(this,Nr,new Uint8Array(e)):e instanceof ArrayBuffer?rt(this,Nr,new Uint8Array(e,t,r)):rt(this,Nr,new Uint8Array(Array.from(e,s=>s?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return Te(this,Nr).byteOffset}get byteLength(){return Te(this,Nr).byteLength}get buffer(){return Te(this,Nr).buffer}get length(){return Te(this,Nr).length}get(e){let t=Te(this,Nr)[e];return typeof t=="number"?t!==0:t}set(e,t){Te(this,Nr)[e]=t?1:0}fill(e){Te(this,Nr).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}Nr=new WeakMap;var jl;class F_{constructor(e,t,r,s){E(this,"_data");E(this,"chars");yt(this,jl);if(this.chars=e,rt(this,jl,new TextEncoder),typeof t=="number")this._data=new Uint8Array(t*e);else if(t instanceof ArrayBuffer)s&&(s=s*e),this._data=new Uint8Array(t,r,s);else{let i=Array.from(t);this._data=new Uint8Array(i.length*e);for(let o=0;o<i.length;o++)this.set(o,i[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const t=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(t).replace(/\x00/g,"")}set(e,t){const r=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);r.fill(0),r.set(Te(this,jl).encode(t))}fill(e){const t=Te(this,jl).encode(e);for(let r=0;r<this.length;r++)this._data.set(t,r*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}jl=new WeakMap;var Zn;const X1=class X1{constructor(e,t,r,s){yt(this,Zn);E(this,"chars");if(this.chars=e,typeof t=="number")rt(this,Zn,new Int32Array(t*e));else if(t instanceof ArrayBuffer)s&&(s*=e),rt(this,Zn,new Int32Array(t,r,s));else{const i=t,o=new X1(e,1);rt(this,Zn,new Int32Array(function*(){for(let a of i)o.set(0,a),yield*Te(o,Zn)}()))}}get BYTES_PER_ELEMENT(){return Te(this,Zn).BYTES_PER_ELEMENT*this.chars}get byteLength(){return Te(this,Zn).byteLength}get byteOffset(){return Te(this,Zn).byteOffset}get buffer(){return Te(this,Zn).buffer}get length(){return Te(this,Zn).length/this.chars}get(e){const t=this.chars*e;let r="";for(let s=0;s<this.chars;s++)r+=String.fromCodePoint(Te(this,Zn)[t+s]);return r.replace(/\u0000/g,"")}set(e,t){const r=this.chars*e,s=Te(this,Zn).subarray(r,r+this.chars);s.fill(0);for(let i=0;i<this.chars;i++)s[i]=t.codePointAt(i)??0}fill(e){this.set(0,e);let t=Te(this,Zn).subarray(0,this.chars);for(let r=1;r<this.length;r++)Te(this,Zn).set(t,r*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};Zn=new WeakMap;let $u=X1;function vf(n){const e=new TextDecoder().decode(n);return JSON.parse(e)}function x3(n,e){const t=e/2,r=e-1;let s=0;for(let i=0;i<n.length;i+=e)for(let o=0;o<t;o+=1)s=n[i+o],n[i+o]=n[i+r-o],n[i+r-o]=s}function qE(n){if(n==="v2:object")return globalThis.Array;let e=n.match(/v2:([US])(\d+)/);if(e){let[,r,s]=e;return(r==="U"?$u:F_).bind(null,Number(s))}let t={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:YE}[n];return Rn(t,`Unknown or unsupported data_type: ${n}`),t}function xa(n,e){const t=n.length;typeof e=="string"&&(e=e==="C"?Array.from({length:t},(i,o)=>o):Array.from({length:t},(i,o)=>t-1-o)),Rn(t===e.length,"Order length must match the number of dimensions.");let r=1,s=new Array(t);for(let i=e.length-1;i>=0;i--)s[e[i]]=r,r*=n[e[i]];return s}function oN({name:n,configuration:e}){if(n==="default"){const t=(e==null?void 0:e.separator)??"/";return r=>["c",...r].join(t)}if(n==="v2"){const t=(e==null?void 0:e.separator)??".";return r=>r.join(t)||"0"}throw new Error(`Unknown chunk key encoding: ${n}`)}function aN(n){if(n==="|O")return{data_type:"v2:object"};let e=n.match(/^([<|>])(.*)$/);Rn(e,`Invalid dtype: ${n}`);let[,t,r]=e,s={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[r]??(r.startsWith("S")||r.startsWith("U")?`v2:${r}`:void 0);return Rn(s,`Unsupported or unknown dtype: ${n}`),t==="|"?{data_type:s}:{data_type:s,endian:t==="<"?"little":"big"}}function lN(n,e={}){let t=[],r=aN(n.dtype);n.order==="F"&&t.push({name:"transpose",configuration:{order:"F"}}),"endian"in r&&r.endian==="big"&&t.push({name:"bytes",configuration:{endian:"big"}});for(let{id:s,...i}of n.filters??[])t.push({name:s,configuration:i});if(n.compressor){let{id:s,...i}=n.compressor;t.push({name:s,configuration:i})}return{zarr_format:3,node_type:"array",shape:n.shape,data_type:r.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:n.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:n.dimension_separator??"."}},codecs:t,fill_value:n.fill_value,attributes:e}}function cN(n,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function uN(n,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return n===e;let t=n==="bool";if(e==="boolean")return t;let r=n.startsWith("v2:U")||n.startsWith("v2:S");if(e==="string")return r;let s=n==="int64"||n==="uint64";if(e==="bigint")return s;let i=n==="v2:object";return e==="object"?i:!r&&!s&&!t&&!i}function fN(n){return(n==null?void 0:n.name)==="sharding_indexed"}function KE(n){return(n.data_type==="uint64"||n.data_type==="int64")&&n.fill_value!=null?BigInt(n.fill_value):n.fill_value}function ZE(n,...e){if(!e.some(t=>n instanceof t))throw n}function Rn(n,e=""){if(!n)throw new Error(e)}async function QE(n,{format:e,signal:t}){const r=n instanceof Response?n:new Response(n);Rn(r.body,"Response does not contain body.");try{return await new Response(r.body.pipeThrough(new DecompressionStream(e),{signal:t})).arrayBuffer()}catch{throw t==null||t.throwIfAborted(),new Error(`Failed to decode ${e}`)}}class B_{constructor(e,t){E(this,"kind","array_to_array");Rn(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,t){return new B_(e,t)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const b3=dN();function dN(){const n=new Uint32Array([305419896]);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)[0]!==18}function w3(n){return"BYTES_PER_ELEMENT"in n?n.BYTES_PER_ELEMENT:4}var ef,lo,tf,nf,Wl;const Y1=class Y1{constructor(e,t){E(this,"kind","array_to_bytes");yt(this,ef);yt(this,lo);yt(this,tf);yt(this,nf);yt(this,Wl);rt(this,Wl,e==null?void 0:e.endian),rt(this,lo,qE(t.data_type)),rt(this,nf,t.shape),rt(this,ef,xa(t.shape,"C"));const r=new(Te(this,lo))(0);rt(this,tf,r.BYTES_PER_ELEMENT)}static fromConfig(e,t){return new Y1(e,t)}encode(e){let t=new Uint8Array(e.data.buffer);return b3&&Te(this,Wl)==="big"&&x3(t,w3(Te(this,lo))),t}decode(e){return b3&&Te(this,Wl)==="big"&&x3(e,w3(Te(this,lo))),{data:new(Te(this,lo))(e.buffer,e.byteOffset,e.byteLength/Te(this,tf)),shape:Te(this,nf),stride:Te(this,ef)}}};ef=new WeakMap,lo=new WeakMap,tf=new WeakMap,nf=new WeakMap,Wl=new WeakMap;let Bh=Y1;class U_{constructor(){E(this,"kind","bytes_to_bytes")}static fromConfig(){return new U_}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}class V_{constructor(){E(this,"kind","bytes_to_bytes")}static fromConfig(e){return new V_}encode(e){throw new Error("Gzip encoding is not enabled by default. Please register a custom codec with `numcodecs/gzip`.")}async decode(e){const t=await QE(e,{format:"gzip"});return new Uint8Array(t)}}function hN(n,e){return Rn(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),Rn(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),Rn(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function pN(n,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((t,r)=>(t[r]=e[r],t),{}):e}var rf,sf;const q1=class q1{constructor(e={}){E(this,"configuration");E(this,"kind","array_to_bytes");yt(this,rf);yt(this,sf);this.configuration=e;const{encoding:t="utf-8",skipkeys:r=!1,ensure_ascii:s=!0,check_circular:i=!0,allow_nan:o=!0,sort_keys:a=!0,indent:u,strict:f=!0}=e;let d=e.separators;d||(u?d=[", ",": "]:d=[",",":"]),rt(this,rf,{encoding:t,skipkeys:r,ensure_ascii:s,check_circular:i,allow_nan:o,indent:u,separators:d,sort_keys:a}),rt(this,sf,{strict:f})}static fromConfig(e){return new q1(e)}encode(e){const{indent:t,encoding:r,ensure_ascii:s,check_circular:i,allow_nan:o,sort_keys:a}=Te(this,rf);Rn(r==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const u=[];Rn(i,"JsonCodec does not yet support skipping the check for circular references during encoding."),o||u.push(hN),a&&u.push(pN);const f=Array.from(e.data);f.push("|O"),f.push(e.shape);let d;u.length&&(d=(m,v)=>{let x=v;for(let b of u)x=b(m,x);return x});let p=JSON.stringify(f,d,t);return s&&(p=p.replace(/[\u007F-\uFFFF]/g,m=>{const v=`0000${m.charCodeAt(0).toString(16)}`;return`\\u${v.substring(v.length-4)}`})),new TextEncoder().encode(p)}decode(e){const{strict:t}=Te(this,sf);Rn(t,"JsonCodec does not yet support non-strict decoding.");const r=vf(e),s=r.pop();r.pop(),Rn(s,"0D not implemented for JsonCodec.");const i=xa(s,"C");return{data:r,shape:s,stride:i}}};rf=new WeakMap,sf=new WeakMap;let Zv=q1;function T3(n){return n instanceof YE||n instanceof F_||n instanceof $u?new Proxy(n,{get(t,r){return t.get(Number(r))},set(t,r,s){return t.set(Number(r),s),!0}}):n}function gN(n,e){let t;return n.data instanceof F_||n.data instanceof $u?t=new n.constructor(n.data.length,n.data.chars):t=new n.constructor(n.data.length),{data:t,shape:n.shape,stride:xa(n.shape,e)}}function mN(n,e){let t=gN(n,e),r=n.shape.length,s=n.data.length,i=Array(r).fill(0),o=T3(n.data),a=T3(t.data);for(let u=0;u<s;u++){let f=0;for(let d=0;d<r;d++)f+=i[d]*t.stride[d];a[f]=o[u],i[0]+=1;for(let d=0;d<r;d++)if(i[d]===n.shape[d]){if(d+1===r)break;i[d]=0,i[d+1]+=1}}return t}function vN(n){let e=n.shape.length;return Rn(e===n.stride.length,"Shape and stride must have the same length."),n.stride.map((t,r)=>({stride:t,index:r})).sort((t,r)=>r.stride-t.stride).map(t=>t.index)}function yN(n,e){let t=vN(n);return Rn(t.length===e.length,"Orders must match"),t.every((r,s)=>r===e[s])}var of,Hl;const K1=class K1{constructor(e,t){E(this,"kind","array_to_array");yt(this,of);yt(this,Hl);let r=e.order??"C",s=t.shape.length,i=new Array(s),o=new Array(s);if(r==="C")for(let a=0;a<s;++a)i[a]=a,o[a]=a;else if(r==="F")for(let a=0;a<s;++a)i[a]=s-a-1,o[a]=s-a-1;else i=r,i.forEach((a,u)=>{Rn(o[a]===void 0,`Invalid permutation: ${JSON.stringify(r)}`),o[a]=u});rt(this,of,i),rt(this,Hl,o)}static fromConfig(e,t){return new K1(e,t)}encode(e){return yN(e,Te(this,Hl))?e:mN(e,Te(this,Hl))}decode(e){return{data:e.data,shape:e.shape,stride:xa(e.shape,Te(this,of))}}};of=new WeakMap,Hl=new WeakMap;let Qv=K1;var af,lf;const Z1=class Z1{constructor(e){E(this,"kind","array_to_bytes");yt(this,af);yt(this,lf);rt(this,af,e),rt(this,lf,xa(e,"C"))}static fromConfig(e,t){return new Z1(t.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let t=new TextDecoder,r=new DataView(e.buffer),s=Array(r.getUint32(0,!0)),i=4;for(let o=0;o<s.length;o++){let a=r.getUint32(i,!0);i+=4,s[o]=t.decode(e.buffer.slice(i,i+a)),i+=a}return{data:s,shape:Te(this,af),stride:Te(this,lf)}}};af=new WeakMap,lf=new WeakMap;let Gv=Z1;class z_{constructor(){E(this,"kind","bytes_to_bytes")}static fromConfig(e){return new z_}encode(e){throw new Error("Zlib encoding is not enabled by default. Please register a codec with `numcodecs/zlib`.")}async decode(e){const t=await QE(e,{format:"deflate"});return new Uint8Array(t)}}function _N(){return new Map().set("blosc",()=>Fr(()=>import("./blosc-CAH7LpMT.js"),__vite__mapDeps([0,1]),import.meta.url).then(n=>n.default)).set("lz4",()=>Fr(()=>import("./lz4-CQc_tcCf.js"),__vite__mapDeps([2,1]),import.meta.url).then(n=>n.default)).set("zstd",()=>Fr(()=>import("./zstd-CIO_1wnt.js"),__vite__mapDeps([3,1]),import.meta.url).then(n=>n.default)).set("gzip",()=>V_).set("zlib",()=>z_).set("transpose",()=>Qv).set("bytes",()=>Bh).set("crc32c",()=>U_).set("vlen-utf8",()=>Gv).set("json2",()=>Zv).set("bitround",()=>B_)}const GE=_N();function Jv(n){let e;return{async encode(t){e||(e=await S3(n));for(const s of e.array_to_array)t=await s.encode(t);let r=await e.array_to_bytes.encode(t);for(const s of e.bytes_to_bytes)r=await s.encode(r);return r},async decode(t){e||(e=await S3(n));for(let s=e.bytes_to_bytes.length-1;s>=0;s--)t=await e.bytes_to_bytes[s].decode(t);let r=await e.array_to_bytes.decode(t);for(let s=e.array_to_array.length-1;s>=0;s--)r=await e.array_to_array[s].decode(r);return r}}}async function S3(n){let e=n.codecs.map(async i=>{var a;let o=await((a=GE.get(i.name))==null?void 0:a());return Rn(o,`Unknown codec: ${i.name}`),{Codec:o,meta:i}}),t=[],r,s=[];for await(let{Codec:i,meta:o}of e){let a=i.fromConfig(o.configuration,n);switch(a.kind){case"array_to_array":t.push(a);break;case"array_to_bytes":r=a;break;default:s.push(a)}}return r||(Rn(xN(n),`Cannot encode ${n.data_type} to bytes without a codec`),r=Bh.fromConfig({endian:"little"},n)),{array_to_array:t,array_to_bytes:r,bytes_to_bytes:s}}function xN(n){return n.data_type!=="v2:object"}const E3=18446744073709551615n;function bN(n,e,t,r){Rn(n.store.getRange,"Store does not support range requests");let s=n.store.getRange.bind(n.store),i=e.map((u,f)=>u/r.chunk_shape[f]),o=Jv({data_type:"uint64",shape:[...i,2],codecs:r.index_codecs}),a={};return async u=>{let f=u.map((R,C)=>Math.floor(R/i[C])),d=n.resolve(t(f)).path,p;if(d in a)p=a[d];else{let R=4,C=16*i.reduce((I,F)=>I*F,1),O=await s(d,{suffixLength:C+R});p=a[d]=O?await o.decode(O):null}if(p===null)return;let{data:m,shape:v,stride:x}=p,b=u.map((R,C)=>R%v[C]).reduce((R,C,O)=>R+C*x[O],0),w=m[b],S=m[b+1];if(!(w===E3&&S===E3))return s(d,{offset:Number(w),length:Number(S)})}}class ko{constructor(e,t="/"){E(this,"store");E(this,"path");this.store=e,this.path=t}resolve(e){let t=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new ko(this.store,new URL(e,t).pathname)}}function wN(n){return new ko(n??new Map)}var cf;class Gp extends ko{constructor(t,r,s){super(t,r);E(this,"kind","group");yt(this,cf);rt(this,cf,s)}get attrs(){return Te(this,cf).attributes}}cf=new WeakMap;function A3(n){var t;const e=n.find(r=>r.name==="transpose");return((t=e==null?void 0:e.configuration)==null?void 0:t.order)??"C"}const fu=Symbol("zarrita.context");function TN(n){return n[fu]}function SN(n,e){let{configuration:t}=e.codecs.find(fN)??{},r={encode_chunk_key:oN(e.chunk_key_encoding),TypedArray:qE(e.data_type),fill_value:e.fill_value};if(t){let i=A3(t.codecs);return{...r,kind:"sharded",chunk_shape:t.chunk_shape,codec:Jv({data_type:e.data_type,shape:t.chunk_shape,codecs:t.codecs}),get_strides(o){return xa(o,i)},get_chunk_bytes:bN(n,e.chunk_grid.configuration.chunk_shape,r.encode_chunk_key,t)}}let s=A3(e.codecs);return{...r,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:Jv({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(i){return xa(i,s)},async get_chunk_bytes(i,o){let a=r.encode_chunk_key(i),u=n.resolve(a).path;return n.store.get(u,o)}}}var OS,NS,ca,DS;let Uh=(DS=class extends(NS=ko,OS=fu,NS){constructor(t,r,s){super(t,r);E(this,"kind","array");yt(this,ca);E(this,OS);rt(this,ca,{...s,fill_value:KE(s)}),this[fu]=SN(this,s)}get attrs(){return Te(this,ca).attributes}get shape(){return Te(this,ca).shape}get chunks(){return this[fu].chunk_shape}get dtype(){return Te(this,ca).data_type}async getChunk(t,r){let s=this[fu],i=await s.get_chunk_bytes(t,r);if(!i){let o=s.chunk_shape.reduce((u,f)=>u*f,1),a=new s.TypedArray(o);return a.fill(s.fill_value),{data:a,shape:s.chunk_shape,stride:s.get_strides(s.chunk_shape)}}return s.codec.decode(i)}is(t){return uN(this.dtype,t)}},ca=new WeakMap,DS),Jp=EN();function EN(){let n=new WeakMap;function e(t){let r=n.get(t)??{v2:0,v3:0};return n.set(t,r),r}return{increment(t,r){e(t)[r]+=1},version_max(t){let r=e(t);return r.v3>r.v2?"v3":"v2"}}}async function AN(n){let e=await n.store.get(n.resolve(".zattrs").path);return e?vf(e):{}}async function CN(n,e={}){let t="store"in n?n:new ko(n),r={};return(e.attrs??!0)&&(r=await AN(t)),e.kind==="array"?C3(t,r):e.kind==="group"?R3(t,r):C3(t,r).catch(s=>(ZE(s,Ma),R3(t,r)))}async function C3(n,e){let{path:t}=n.resolve(".zarray"),r=await n.store.get(t);if(!r)throw new Ma("v2 array",{cause:new L_(t)});return Jp.increment(n.store,"v2"),new Uh(n.store,n.path,lN(vf(r),e))}async function R3(n,e){let{path:t}=n.resolve(".zgroup"),r=await n.store.get(t);if(!r)throw new Ma("v2 group",{cause:new L_(t)});return Jp.increment(n.store,"v2"),new Gp(n.store,n.path,cN(vf(r),e))}async function RN(n){let{store:e,path:t}=n.resolve("zarr.json"),r=await n.store.get(t);if(!r)throw new Ma("v3 array or group",{cause:new L_(t)});let s=vf(r);return s.node_type==="array"&&(s.fill_value=KE(s)),s.node_type==="array"?new Uh(e,n.path,s):new Gp(e,n.path,s)}async function PN(n,e={}){let t="store"in n?n:new ko(n),r=await RN(t);if(Jp.increment(t.store,"v3"),e.kind===void 0||e.kind==="array"&&r instanceof Uh||e.kind==="group"&&r instanceof Gp)return r;let s=r instanceof Uh?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${s}.`)}async function $n(n,e={}){let t="store"in n?n.store:n,r=Jp.version_max(t),s=r==="v2"?$n.v2:$n.v3,i=r==="v2"?$n.v3:$n.v2;return s(n,e).catch(o=>(ZE(o,Ma),i(n,e)))}$n.v2=CN;$n.v3=PN;function*IN(n,e,t=1){e===void 0&&(e=n,n=0);for(let r=n;r<e;r+=t)yield r}function*kN(...n){if(n.length===0)return;const e=n.map(r=>r[Symbol.iterator]()),t=e.map(r=>r.next());if(t.some(r=>r.done))throw new Error("Input contains an empty iterator.");for(let r=0;;){if(t[r].done){if(e[r]=n[r][Symbol.iterator](),t[r]=e[r].next(),++r>=e.length)return}else yield t.map(({value:s})=>s),r=0;t[r]=e[r].next()}}function MN({start:n,stop:e,step:t},r){if(t===0)throw new Error("slice step cannot be zero");t=t??1;const s=t<0,[i,o]=s?[-1,r-1]:[0,r];return n===null?n=s?o:i:n<0?(n+=r,n<i&&(n=i)):n>o&&(n=o),e===null?e=s?i:o:e<0?(e+=r,e<i&&(e=i)):e>o&&(e=o),[n,e,t]}function ia(n,e,t=null){return e===void 0&&(e=n,n=null),{start:n,stop:e,step:t}}function ON(){const n=[];return{add:e=>n.push(e()),onIdle:()=>Promise.all(n)}}class $_ extends Error{constructor(e){super(e),this.name="IndexError"}}function NN(n,e){throw new $_(`too many indicies for array; expected ${e.length}, got ${n.length}`)}function DN(n){throw new $_(`index out of bounds for dimension with length ${n}`)}function LN(){throw new $_("only slices with step >= 1 are supported")}function FN(n,e){n.length>e.length&&NN(n,e)}function BN(n,e){return n=Math.trunc(n),n<0&&(n=e+n),(n>=e||n<0)&&DN(e),n}class UN{constructor({dim_sel:e,dim_len:t,dim_chunk_len:r}){E(this,"dim_sel");E(this,"dim_len");E(this,"dim_chunk_len");E(this,"nitems");e=BN(e,t),this.dim_sel=e,this.dim_len=t,this.dim_chunk_len=r,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),t=e*this.dim_chunk_len,r=this.dim_sel-t;yield{dim_chunk_ix:e,dim_chunk_sel:r}}}class P3{constructor({dim_sel:e,dim_len:t,dim_chunk_len:r}){E(this,"start");E(this,"stop");E(this,"step");E(this,"dim_len");E(this,"dim_chunk_len");E(this,"nitems");E(this,"nchunks");const[s,i,o]=MN(e,t);this.start=s,this.stop=i,this.step=o,this.step<1&&LN(),this.dim_len=t,this.dim_chunk_len=r,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),t=Math.ceil(this.stop/this.dim_chunk_len);for(const r of IN(e,t)){const s=r*this.dim_chunk_len,i=Math.min(this.dim_len,(r+1)*this.dim_chunk_len),o=i-s;let a=0,u=0;if(this.start<s){const v=(s-this.start)%this.step;v&&(u+=this.step-v),a=Math.ceil((s-this.start)/this.step)}else u=this.start-s;const f=this.stop>i?o:this.stop-s,d=[u,f,this.step],p=Math.ceil((f-u)/this.step),m=[a,a+p,1];yield{dim_chunk_ix:r,dim_chunk_sel:d,dim_out_sel:m}}}}function VN(n,e){let t=[];return n===null?t=e.map(r=>ia(null)):Array.isArray(n)&&(t=n.map(r=>r??ia(null))),FN(t,e),t}class zN{constructor({selection:e,shape:t,chunk_shape:r}){E(this,"dim_indexers");E(this,"shape");this.dim_indexers=VN(e,t).map((s,i)=>new(typeof s=="number"?UN:P3)({dim_sel:s,dim_len:t[i],dim_chunk_len:r[i]})),this.shape=this.dim_indexers.filter(s=>s instanceof P3).map(s=>s.nitems)}*[Symbol.iterator](){for(const e of kN(...this.dim_indexers)){const t=e.map(s=>s.dim_chunk_ix),r=e.map(s=>"dim_out_sel"in s?{from:s.dim_chunk_sel,to:s.dim_out_sel}:{from:s.dim_chunk_sel,to:null});yield{chunk_coords:t,mapping:r}}}}function $N(n,e){return"get"in n?n.get(e):n[e]}async function jN(n,e,t,r){var u;let s=TN(n),i=new zN({selection:e,shape:n.shape,chunk_shape:n.chunks}),o=r.prepare(new s.TypedArray(i.shape.reduce((f,d)=>f*d,1)),i.shape,s.get_strides(i.shape)),a=((u=t.create_queue)==null?void 0:u.call(t))??ON();for(const{chunk_coords:f,mapping:d}of i)a.add(async()=>{let{data:p,shape:m,stride:v}=await n.getChunk(f,t.opts),x=r.prepare(p,m,v);r.set_from_chunk(o,x,d)});return await a.onIdle(),i.shape.length===0?$N(o.data,0):o}function j_(n,e=0,t){let r=t??n.length-e;return{length:r,subarray(s,i=r){return j_(n,e+s,i-s)},set(s,i=0){for(let o=0;o<s.length;o++)n[e+i+o]=s.get(o)},get(s){return n[e+s]}}}function D0(n){return globalThis.Array.isArray(n.data)?{data:j_(n.data),stride:n.stride,bytes_per_element:1}:{data:new Uint8Array(n.data.buffer,n.data.byteOffset,n.data.byteLength),stride:n.stride,bytes_per_element:n.data.BYTES_PER_ELEMENT}}function WN(n){return"chars"in n?n.constructor.bind(null,n.chars):n.constructor}function HN(n,e){if(globalThis.Array.isArray(n.data))return j_([e]);let t=WN(n.data),r=new t([e]);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}const XN={prepare(n,e,t){return{data:n,shape:e,stride:t}},set_scalar(n,e,t){let r=D0(n);ey(r,e,HN(n,t),r.bytes_per_element)},set_from_chunk(n,e,t){let r=D0(n);_h(r,D0(e),r.bytes_per_element,t)}};async function YN(n,e=null,t={}){return jN(n,e,t,XN)}function JE(n,e,t){return t<0&&e<n?Math.floor((n-e-1)/-t)+1:n<e?Math.floor((e-n-1)/t)+1:0}function ey(n,e,t,r){if(e.length===0){n.data.set(t,0);return}const[s,...i]=e,[o,...a]=n.stride;if(typeof s=="number"){const m=n.data.subarray(o*s*r);ey({data:m,stride:a},i,t,r);return}const[u,f,d]=s,p=JE(u,f,d);if(i.length===0){for(let m=0;m<p;m++)n.data.set(t,o*(u+d*m)*r);return}for(let m=0;m<p;m++){const v=n.data.subarray(o*(u+d*m)*r);ey({data:v,stride:a},i,t,r)}}function _h(n,e,t,r){const[s,...i]=r,[o,...a]=n.stride,[u,...f]=e.stride;if(s.from===null){if(i.length===0){n.data.set(e.data.subarray(0,t),s.to*t);return}_h({data:n.data.subarray(o*s.to*t),stride:a},e,t,i);return}if(s.to===null){if(i.length===0){let S=s.from*t;n.data.set(e.data.subarray(S,S+t),0);return}_h(n,{data:e.data.subarray(u*s.from*t),stride:f},t,i);return}const[d,p,m]=s.to,[v,x,b]=s.from,w=JE(d,p,m);if(i.length===0){if(m===1&&b===1&&o===1&&u===1){let S=v*t,R=w*t;n.data.set(e.data.subarray(S,S+R),d*t);return}for(let S=0;S<w;S++){let R=u*(v+b*S)*t;n.data.set(e.data.subarray(R,R+t),o*(d+m*S)*t)}return}for(let S=0;S<w;S++)_h({data:n.data.subarray(o*(d+S*m)*t),stride:a},{data:e.data.subarray(u*(v+S*b)*t),stride:f},t,i)}function RZ(n){return n.slice(1)}function PZ(n){let[e,t]=(typeof n=="string"?n:n.href).split("://");if(e==="https"||e==="http")return n;if(e==="gc")return`https://storage.googleapis.com/${t}`;if(e==="s3")return`https://s3.amazonaws.com/${t}`;throw Error(`Protocol not supported, got: ${JSON.stringify(e)}`)}function e4(n,e,t,r={}){return e!==void 0&&t!==void 0&&(r={...r,headers:{...r.headers,Range:`bytes=${e}-${e+t-1}`}}),fetch(n,r)}function qN(n,e){return{...n,...e,headers:{...n.headers,...e.headers}}}function I3(n,e){const t=typeof n=="string"?new URL(n):n;t.pathname.endsWith("/")||(t.pathname+="/");const r=new URL(e.slice(1),t);return r.search=t.search,r}async function k3(n){if(n.status!==404){if(n.status===200||n.status===206)return new Uint8Array(await n.arrayBuffer());throw new Error(`Unexpected response status ${n.status} ${n.statusText}`)}}async function KN(n,e,t,r){if(r)return fetch(n,{...t,headers:{...t.headers,Range:`bytes=-${e}`}});let s=await fetch(n,{...t,method:"HEAD"});if(!s.ok)return s;let i=s.headers.get("Content-Length"),o=Number(i);return e4(n,o-e,o,t)}var uf,ff,df,ty;class ZN{constructor(e,t={}){yt(this,df);E(this,"url");yt(this,uf);yt(this,ff);this.url=e,rt(this,uf,t.overrides??{}),rt(this,ff,t.useSuffixRequest??!1)}async get(e,t={}){let r=I3(this.url,e).href,s=await fetch(r,Nt(this,df,ty).call(this,t));return k3(s)}async getRange(e,t,r={}){let s=I3(this.url,e),i=Nt(this,df,ty).call(this,r),o;return"suffixLength"in t?o=await KN(s,t.suffixLength,i,Te(this,ff)):o=await e4(s,t.offset,t.length,i),k3(o)}}uf=new WeakMap,ff=new WeakMap,df=new WeakSet,ty=function(e){return qN(Te(this,uf),e)};var Kr,Zt,an,co,hf,uo,bt,ny,ps,t4,ry,sy,iy,n4,oy;class QN extends Map{constructor(t={}){super();yt(this,bt);yt(this,Kr,0);yt(this,Zt,new Map);yt(this,an,new Map);yt(this,co);yt(this,hf);yt(this,uo);if(!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof t.maxAge=="number"&&t.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");rt(this,co,t.maxSize),rt(this,hf,t.maxAge||Number.POSITIVE_INFINITY),rt(this,uo,t.onEviction)}get __oldCache(){return Te(this,an)}get(t){if(Te(this,Zt).has(t)){const r=Te(this,Zt).get(t);return Nt(this,bt,ry).call(this,t,r)}if(Te(this,an).has(t)){const r=Te(this,an).get(t);if(Nt(this,bt,ps).call(this,t,r)===!1)return Nt(this,bt,n4).call(this,t,r),r.value}}set(t,r,{maxAge:s=Te(this,hf)}={}){const i=typeof s=="number"&&s!==Number.POSITIVE_INFINITY?Date.now()+s:void 0;return Te(this,Zt).has(t)?Te(this,Zt).set(t,{value:r,expiry:i}):Nt(this,bt,iy).call(this,t,{value:r,expiry:i}),this}has(t){return Te(this,Zt).has(t)?!Nt(this,bt,ps).call(this,t,Te(this,Zt).get(t)):Te(this,an).has(t)?!Nt(this,bt,ps).call(this,t,Te(this,an).get(t)):!1}peek(t){if(Te(this,Zt).has(t))return Nt(this,bt,sy).call(this,t,Te(this,Zt));if(Te(this,an).has(t))return Nt(this,bt,sy).call(this,t,Te(this,an))}delete(t){const r=Te(this,Zt).delete(t);return r&&Km(this,Kr)._--,Te(this,an).delete(t)||r}clear(){Te(this,Zt).clear(),Te(this,an).clear(),rt(this,Kr,0)}resize(t){if(!(t&&t>0))throw new TypeError("`maxSize` must be a number greater than 0");const r=[...Nt(this,bt,oy).call(this)],s=r.length-t;s<0?(rt(this,Zt,new Map(r)),rt(this,an,new Map),rt(this,Kr,r.length)):(s>0&&Nt(this,bt,ny).call(this,r.slice(0,s)),rt(this,an,new Map(r.slice(s))),rt(this,Zt,new Map),rt(this,Kr,0)),rt(this,co,t)}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of Te(this,Zt)){const[r,s]=t;Nt(this,bt,ps).call(this,r,s)===!1&&(yield[r,s.value])}for(const t of Te(this,an)){const[r,s]=t;Te(this,Zt).has(r)||Nt(this,bt,ps).call(this,r,s)===!1&&(yield[r,s.value])}}*entriesDescending(){let t=[...Te(this,Zt)];for(let r=t.length-1;r>=0;--r){const s=t[r],[i,o]=s;Nt(this,bt,ps).call(this,i,o)===!1&&(yield[i,o.value])}t=[...Te(this,an)];for(let r=t.length-1;r>=0;--r){const s=t[r],[i,o]=s;Te(this,Zt).has(i)||Nt(this,bt,ps).call(this,i,o)===!1&&(yield[i,o.value])}}*entriesAscending(){for(const[t,r]of Nt(this,bt,oy).call(this))yield[t,r.value]}get size(){if(!Te(this,Kr))return Te(this,an).size;let t=0;for(const r of Te(this,an).keys())Te(this,Zt).has(r)||t++;return Math.min(Te(this,Kr)+t,Te(this,co))}get maxSize(){return Te(this,co)}entries(){return this.entriesAscending()}forEach(t,r=this){for(const[s,i]of this.entriesAscending())t.call(r,i,s,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}Kr=new WeakMap,Zt=new WeakMap,an=new WeakMap,co=new WeakMap,hf=new WeakMap,uo=new WeakMap,bt=new WeakSet,ny=function(t){if(typeof Te(this,uo)=="function")for(const[r,s]of t)Te(this,uo).call(this,r,s.value)},ps=function(t,r){return typeof r.expiry=="number"&&r.expiry<=Date.now()?(typeof Te(this,uo)=="function"&&Te(this,uo).call(this,t,r.value),this.delete(t)):!1},t4=function(t,r){if(Nt(this,bt,ps).call(this,t,r)===!1)return r.value},ry=function(t,r){return r.expiry?Nt(this,bt,t4).call(this,t,r):r.value},sy=function(t,r){const s=r.get(t);return Nt(this,bt,ry).call(this,t,s)},iy=function(t,r){Te(this,Zt).set(t,r),Km(this,Kr)._++,Te(this,Kr)>=Te(this,co)&&(rt(this,Kr,0),Nt(this,bt,ny).call(this,Te(this,an)),rt(this,an,Te(this,Zt)),rt(this,Zt,new Map))},n4=function(t,r){Te(this,an).delete(t),Nt(this,bt,iy).call(this,t,r)},oy=function*(){for(const t of Te(this,an)){const[r,s]=t;Te(this,Zt).has(r)||Nt(this,bt,ps).call(this,r,s)===!1&&(yield t)}for(const t of Te(this,Zt)){const[r,s]=t;Nt(this,bt,ps).call(this,r,s)===!1&&(yield t)}};function M3(n,e){return e?"suffixLength"in e?`${n}:-${e.suffixLength}`:`${n}:${e.offset}:${e.offset+e.length-1}`:n}function GN(n,e=100){const t=new QN({maxSize:e});let r=n.getRange?n.getRange.bind(n):void 0;function s(...i){const[o,a]=i,u=M3(o),f=t.get(u);if(f)return f;const d=Promise.resolve(n.get(o,a)).catch(p=>{throw t.delete(u),p});return t.set(u,d),d}if(r){const i=r;r=(...o)=>{const[a,u,f]=o,d=M3(a,u),p=t.get(d);if(p)return p;const m=Promise.resolve(i==null?void 0:i(a,u,f)).catch(v=>{throw t.delete(d),v});return t.set(d,m),m}}return new Proxy(n,{get(i,o,a){return o==="get"?s:o==="getRange"&&r?r:Reflect.get(i,o,a)}})}const pa=6,js={cyan:"#00FFFF",yellow:"#FFFF00",magenta:"#FF00FF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",white:"#FFFFFF"},JN=[js.magenta,js.green],e8=[js.red,js.green,js.blue],O3=Object.values(js).slice(0,pa),t8="https://ome.github.io/ome-ngff-validator/";async function n8(n){if(typeof n=="string"){let e,t="/";if(n.endsWith(".json")){const[{default:r},s]=await Promise.all([Fr(()=>import("./ref-DxdElHnu.js"),[],import.meta.url),fetch(n).then(i=>i.json())]);e=r.fromSpec(s)}else{const r=new URL(n);t=r8(r.pathname),r.pathname="/",e=new ZN(r.href)}return new ko(GN(e),t)}return wN(n)}function r8(n){return n==="/"||n.startsWith("/")?n:`/${n}`}async function s8(n){const e=await n8(n);return $n(e)}async function L0(n,e){const t=new TextDecoder;if(e.path&&(n=n.resolve(e.path)),e.zarrVersion===3){const o=await $n.v3(n).then(a=>a.attrs);return ba(o)}const r=n.resolve(".zattrs"),s=await n.store.get(r.path),i=s?JSON.parse(t.decode(s)):{};return ba(i)}async function W_(n,e){const{datasets:t}=e[0]||[{path:"0"}];return Promise.all(t.map(({path:r})=>$n(n.resolve(r),{kind:"array",attrs:!1})))}function H_(n){n.startsWith("#")&&(n=n.slice(1));const e=Number.parseInt(n.slice(0,2),16),t=Number.parseInt(n.slice(2,4),16),r=Number.parseInt(n.slice(4,6),16);return[e,t,r]}function ju(n){return Array.from({length:n},(e,t)=>t)}function i8(n,e=" "){for(;n.length>0&&e.includes(n.charAt(n.length-1));)n=n.substr(0,n.length-1);return n}function Rl(...n){return n.filter(e=>e!==void 0).map(e=>i8(e,"/")).join("/")}function o8(n,e){return(!e||e.length!==n.shape.length)&&(e=n.shape.slice(0,-2).map((r,s)=>`${s}`).concat(["y","x"])),e}function dc(n){const e=[{type:"time",name:"t"},{type:"channel",name:"c"},{type:"space",name:"z"},{type:"space",name:"y"},{type:"space",name:"x"}];function t(s){return s==="t"?"time":s==="c"?"channel":"space"}let r=e;return n[0].axes&&(r=n[0].axes.map(s=>{if(typeof s=="string")return{name:s,type:t(s)};const{name:i,type:o}=s;return{name:i,type:o??t(i)}})),r}function yf(n){return n.map(t=>t.name)}function r4(n,e){return e||(n<=pa?e=Array(n).fill(!0):e=[...Array(pa).fill(!0),...Array(n-pa).fill(!1)]),e}function s4(n,e){let t=[];if(n===1)t=[js.white];else if(n===2)t=JN;else if(n===3)t=e8;else if(n<=pa)t=O3.slice(0,n);else{t=Array(n).fill(js.white);const r=e.flatMap((s,i)=>s?i:[]);for(const[s,i]of r.entries())t[i]=O3[s]}return t}function i4(n){const e=n[n.length-1];return e===3||e===4}function _f(n){const e=i4(n.shape),[t,r]=n.chunks.slice(e?-3:-2),s=Math.min(t,r);return 2**Math.floor(Math.log2(s))}function a8(n){const{image:e,viewport:t,padding:r,matrix:s=new At().identity()}=n,i=[[0,0,0],[e.width,0,0],[e.width,e.height,0],[0,e.height,0]].map(m=>s.transformAsPoint(m)),o=Math.min(...i.map(m=>m[0])),a=Math.max(...i.map(m=>m[0])),u=Math.min(...i.map(m=>m[1])),f=Math.max(...i.map(m=>m[1])),d=t.width-2*r,p=t.height-2*r;return{zoom:Math.log2(Math.min(d/(a-o),p/(f-u))),target:[(o+a)/2,(u+f)/2]}}function l8(n){return Array.isArray(n)?n.length===16&&n.every(e=>typeof e=="number"):!1}function xf(n){if(!n)return At.IDENTITY;const e=new At;try{const t=typeof n=="string"?JSON.parse(n):n;St(l8(t),"Invalid modelMatrix size. Must be 16."),e.setRowMajor(...t)}catch{const t=`Failed to parse modelMatrix. Got ${JSON.stringify(n)}, using identity.`;console.warn(t)}return e}async function X_(n,e){if(n.dtype==="Uint8")return[0,255];const{data:t}=await n.getRaster({selection:e});let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(let i=0;i<t.length;i++)t[i]>s&&(s=t[i]),t[i]<r&&(r=t[i]);return r===s&&(r=0,s=1),[r,s]}async function o4(n,e,t,r){const s=n.shape.map(()=>0),i=n.shape[e];return e!==-1&&St(i===t.length,"visibilities do not match number of channels"),Promise.all(t.map(async(o,a)=>{if(!o)return;const u=[...s];return e>-1&&(u[e]=a),X_(n,u)}))}function c8(){let n,e;return{promise:new Promise((r,s)=>{n=r,e=s}),resolve:n,reject:e}}function u8(){let n=new EventTarget;return{on:(e,t)=>{n.addEventListener(e,r=>t(r.detail))},emit:(e,t)=>{n.dispatchEvent(new CustomEvent(e,{detail:t}))}}}function ba(n){return"ome"in n?n.ome:n}class f8 extends Error{constructor(e){super(e),this.name="AssertionError"}}class a4 extends Error{constructor(t,r){super(t);E(this,"url");this.name="RedirectError",this.url=r}}function St(n,e=""){if(!n)throw new f8(e)}async function d8(n){try{return await $n.v3(n),3}catch(e){if(!(e instanceof Ma))throw e;return 2}}function N3(n){return"plate"in n}function h8(n){return"well"in n}function p8(n){return"image-label"in n&&Wu(n)}function l4(n){return"omero"in n&&Wu(n)}function Wu(n){return"multiscales"in n}function g8(n){return"bioformats2raw.layout"in n}/**
 * Ensures an error matches expected type(s), otherwise rethrows.
 *
 * Unmatched errors bubble up, like Python's `except`. Narrows error types for
 * type-safe property access.
 *
 * Usage
 * @example
 * ```ts
 * class DatabaseError extends Error {}
 * class NetworkError extends Error {}
 *
 * try {
 *   await db.query();
 * } catch (error) {
 *   rethrowUnless(error, DatabaseError, NetworkError);
 *   error; // DatabaseError | NetworkError
 * }
 * ```
 *
 * @param error - The error to check
 * @param ErrorClasses - Expected error type(s)
 * @throws The original error if it doesn't match expected type(s)
 *
 * @copyright Trevor Manz 2025
 * @license MIT
 * @see {@link https://github.com/manzt/manzt/blob/4b04f2/utils/rethrow-unless.js}
 */function c4(n,...e){if(!e.some(t=>n instanceof t))throw n}function u4(n){return"loaders"in n&&"rows"in n&&"columns"in n}function f4(n){return u4(n)?n.loaders[0].loader:n.loader}function d4(n){var i;let e=new At().identity();const t=dc(n),r=(i=n[0].datasets[0])==null?void 0:i.coordinateTransformations,s=["x","y","z"].map(o=>t.findIndex(a=>a.type==="space"&&a.name===o));for(const o of r??[]){if(o.type==="translation"){const{translation:a}=o;if(a.length!==t.length)throw new Error("Length of translation array was expected to match length of axes.");const u=0,f=s.map(p=>p>=0?a[p]:u),d=new At().translate(f);e=e.multiplyLeft(d)}if(o.type==="scale"){const{scale:a}=o;if(a.length!==t.length)throw new Error("Length of scale array was expected to match length of axes.");const u=1,f=s.map(p=>p>=0?a[p]:u),d=new At().scale(f);e=e.multiplyLeft(d)}}return e}function m8(...n){const e=n.reduce((r,s)=>Math.min(s.length,r),Number.POSITIVE_INFINITY),t=new Array(e);for(let r=0;r<e;r+=1){const s=n.map(i=>i[r]);t[r]=s}return t}const h4=B.createContext(null);function Ts(){const n=B.useContext(h4);return St(n,"useSourceData hook must be used within SourceDataContext."),I_(n)}const p4=B.createContext(null);function Si(){const n=B.useContext(p4);return St(n,"useLayerState hook must be used within LayerStateContext."),I_(n)}const ay=B.createContext(null);function v8(){const n=B.useContext(ay);return St(n,"useViewState hook must be used within ViewStateContext."),I_(n)}function Y_(n,e){let t=null;const r=new Map,s=i=>{let o;if(e===void 0)o=r.get(i);else for(const[u,f]of r)if(e(u,i)){o=f;break}if(o!==void 0)if(t!=null&&t(o[1],i))s.remove(i);else return o[0];const a=n(i);return r.set(i,[a,Date.now()]),a};return s.remove=i=>{if(e===void 0)r.delete(i);else for(const[o]of r)if(e(o,i)){r.delete(o);break}},s.setShouldRemove=i=>{if(t=i,!!t)for(const[o,a]of r)t(a[1],o)&&r.delete(o)},s}const y8=(n,e)=>{do{const[t,...r]=e,s=n.get(t);if(!s)return;if(!r.length)return s[1];n=s[0],e=r}while(e.length)},_8=(n,e,t)=>{do{const[r,...s]=e;let i=n.get(r);if(i||(i=[new WeakMap],n.set(r,i)),!s.length){i[1]=t;return}n=i[0],e=s}while(e.length)},g4=()=>{const n=new WeakMap;return(t,r)=>{const s=y8(n,r);if(s)return s;const i=t();return _8(n,r,i),i}},x8=g4(),D3=n=>!!n.write,b8=n=>typeof n=="function";function w8(n,e){return x8(()=>{const t=new WeakMap,r=(u,f)=>{let d=t.get(u);if(d)return d;const p=f&&t.get(f),m=[],v=[];return u.forEach((x,b)=>{const w=b;v[b]=w;const S=p&&p.atomList[p.keyList.indexOf(w)];if(S){m[b]=S;return}const R=O=>{const I=O(s),F=O(n),q=r(F,I.prev).keyList.indexOf(w);if(q<0||q>=F.length){const K=u[r(u).keyList.indexOf(w)];if(K)return K;throw new Error("splitAtom: index out of bounds for read")}return F[q]},C=(O,I,F)=>{const $=O(s),q=O(n),le=r(q,$.prev).keyList.indexOf(w);if(le<0||le>=q.length)throw new Error("splitAtom: index out of bounds for write");const he=b8(F)?F(q[le]):F;I(n,[...q.slice(0,le),he,...q.slice(le+1)])};m[b]=D3(n)?Vn(R,C):Vn(R)}),p&&p.keyList.length===v.length&&p.keyList.every((x,b)=>x===v[b])?d=p:d={atomList:m,keyList:v},t.set(u,d),d},s=Vn(()=>({})),i=u=>{const f=u(s),d=u(n),p=r(d,f.prev);return f.prev=d,p.atomList},o=(u,f,d)=>{switch("read"in d&&(console.warn("atomToRemove is deprecated. use action with type"),d={type:"remove",atom:d}),d.type){case"remove":{const p=u(a).indexOf(d.atom);if(p>=0){const m=u(n);f(n,[...m.slice(0,p),...m.slice(p+1)])}break}case"insert":{const p=d.before?u(a).indexOf(d.before):u(a).length;if(p>=0){const m=u(n);f(n,[...m.slice(0,p),d.value,...m.slice(p)])}break}case"move":{const p=u(a).indexOf(d.atom),m=d.before?u(a).indexOf(d.before):u(a).length;if(p>=0&&m>=0){const v=u(n);p<m?f(n,[...v.slice(0,p),...v.slice(p+1,m),v[p],...v.slice(m)]):f(n,[...v.slice(0,m),v[p],...v.slice(m,p),...v.slice(p+1)])}break}}},a=D3(n)?Vn(i,o):Vn(i);return a},[n])}const T8=g4(),S8=Vn(()=>[]);function E8(n){const e=()=>{const t=A8(n);return Vn(s=>{const i=[],o=t.map((a,u)=>{try{return s(a)}catch(f){if(f instanceof Promise)i[u]=f;else throw f}});if(i.length)throw Promise.all(i);return C8(n,o)})};return Array.isArray(n)?n.length?T8(e,n):S8:e()}const A8=n=>Array.isArray(n)?n:Object.getOwnPropertyNames(n).map(e=>n[e]),C8=(n,e)=>Array.isArray(n)?e:Object.getOwnPropertyNames(n).reduce((t,r,s)=>({...t,[r]:e[s]}),{}),R8="x",P8="y",L3="_c";var Xl,ua,Yl,ql,ws,m4,v4,ly,y4;class Ql{constructor(e,t){yt(this,ws);E(this,"labels");E(this,"tileSize");E(this,"dtype");yt(this,Xl);yt(this,ua);yt(this,Yl);yt(this,ql,[]);St(e.is("number")||e.is("bigint"),`Unsupported viv dtype: ${e.dtype}`),rt(this,Xl,e),this.labels=t.labels,this.tileSize=t.tileSize,e.dtype==="uint64"||e.dtype==="int64"?(this.dtype="Uint32",rt(this,ua,r=>Uint32Array.from(r,s=>Number(s)))):e.dtype==="float16"?(this.dtype="Float32",rt(this,ua,r=>new Float32Array(r))):(this.dtype=I8(e.dtype),rt(this,ua,r=>r))}get shape(){return Te(this,Xl).shape}async getRaster(e){const{selection:t,signal:r}=e;return Nt(this,ws,ly).call(this,{selection:F3(t,{labels:this.labels,slices:{x:ia(null),y:ia(null)}}),signal:r})}onTileError(e){}async getTile(e){const{x:t,y:r,selection:s,signal:i}=e;return Nt(this,ws,ly).call(this,{selection:F3(s,{labels:this.labels,slices:{x:ia(t*this.tileSize,Math.min((t+1)*this.tileSize,Te(this,ws,m4))),y:ia(r*this.tileSize,Math.min((r+1)*this.tileSize,Te(this,ws,v4)))}}),signal:i})}}Xl=new WeakMap,ua=new WeakMap,Yl=new WeakMap,ql=new WeakMap,ws=new WeakSet,m4=function(){const e=this.shape.length-1;return this.shape[this.labels.indexOf("c")===e?e-1:e]},v4=function(){const e=this.shape.length-1;return this.shape[this.labels.indexOf("c")===e?e-2:e-1]},ly=async function(e){const{promise:t,resolve:r,reject:s}=Promise.withResolvers();return Te(this,ql).push({request:e,resolve:r,reject:s}),rt(this,Yl,Te(this,Yl)??requestAnimationFrame(()=>Nt(this,ws,y4).call(this))),t},y4=async function(){for(const{request:e,resolve:t,reject:r}of Te(this,ql))YN(Te(this,Xl),e.selection,{opts:{signal:e.signal}}).then(({data:s,shape:i})=>{t({data:Te(this,ua).call(this,s),width:i[1],height:i[0]})}).catch(s=>r(s));rt(this,Yl,void 0),rt(this,ql,[])};function F3(n,e){const{labels:t,slices:r}=e;let s;if(Array.isArray(n))s=[...n];else{s=Array.from({length:t.length},()=>0);for(const[i,o]of Object.entries(n))s[t.indexOf(i)]=o}return s[t.indexOf(R8)]=r.x,s[t.indexOf(P8)]=r.y,L3 in t&&(s[t.indexOf(L3)]=ia(null)),s}function I8(n){return n[0].toUpperCase()+n.slice(1)}async function _4(n,e,{concurrency:t=Number.POSITIVE_INFINITY,stopOnError:r=!0,signal:s}={}){return new Promise((i,o)=>{if(n[Symbol.iterator]===void 0&&n[Symbol.asyncIterator]===void 0)throw new TypeError(`Expected \`input\` to be either an \`Iterable\` or \`AsyncIterable\`, got (${typeof n})`);if(typeof e!="function")throw new TypeError("Mapper function is required");if(!(Number.isSafeInteger(t)&&t>=1||t===Number.POSITIVE_INFINITY))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${t}\` (${typeof t})`);const a=[],u=[],f=new Map;let d=!1,p=!1,m=!1,v=0,x=0;const b=n[Symbol.iterator]===void 0?n[Symbol.asyncIterator]():n[Symbol.iterator](),w=()=>{C(s.reason)},S=()=>{s==null||s.removeEventListener("abort",w)},R=I=>{i(I),S()},C=I=>{d=!0,p=!0,o(I),S()};s&&(s.aborted&&C(s.reason),s.addEventListener("abort",w,{once:!0}));const O=async()=>{if(p)return;const I=await b.next(),F=x;if(x++,I.done){if(m=!0,v===0&&!p){if(!r&&u.length>0){C(new AggregateError(u));return}if(p=!0,f.size===0){R(a);return}const $=[];for(const[q,K]of a.entries())f.get(q)!==B3&&$.push(K);R($)}return}v++,(async()=>{try{const $=await I.value;if(p)return;const q=await e($,F);q===B3&&f.set(F,q),a[F]=q,v--,await O()}catch($){if(r)C($);else{u.push($),v--;try{await O()}catch(q){C(q)}}}})()};(async()=>{for(let I=0;I<t;I++){try{await O()}catch(F){C(F);break}if(m||d)break}})()})}const B3=Symbol("skip");async function k8(n,e,t){const r=n.acquisition?Number.parseInt(n.acquisition):void 0;let s=[];St(t==null?void 0:t.images,"Well .zattrs missing images"),St(e.path,"Cannot inspect zarr path to open well.");const[i,o]=e.path.split("/").filter(Boolean).slice(-2);let{images:a}=t;const u=a.flatMap($=>$.acquisition?[$.acquisition]:[]);if(u.length>1){const $=e.path.replace(`${i}/${o}`,""),q=await $n(e.resolve($));s=ba(q.attrs).plate.acquisitions??[],r&&u.includes(r)&&(a=a.filter(le=>le.acquisition===r))}const f=a.map($=>$.path),d=Math.ceil(Math.sqrt(f.length)),p=Math.ceil(f.length/d),m=await $n(e.resolve(f[0]),{kind:"group"}),v=ba(m.attrs);St(Wu(v),"Path for image is not valid.");let x=v.multiscales[0].datasets[0].path;const b=f.map($=>{const q=e.resolve(Rl($,x));return $n(q,{kind:"array",attrs:!1})}),w=await Promise.all(b),S=dc(v.multiscales),R=yf(S),C=_f(w[0]),O=ju(p).flatMap($=>ju(d).filter(q=>q+$*d<w.length).map(q=>{const K=q+$*d;return{name:String(K),row:$,col:q,loader:new Ql(w[K],{labels:R,tileSize:C})}}));let I;if(l4(v))I=K_(v.omero,S);else{const $=O.at(-1);St($,"Expected at least one resolution, found none."),I=await q_($.loader,R)}const F={loaders:O,...I,axis_labels:R,loader:[O[0].loader],model_matrix:xf(n.model_matrix),defaults:{selection:I.defaultSelection,colormap:n.colormap??"",opacity:n.opacity??1},name:`Well ${i}${o}`};return s.length>0&&(F.acquisitions=s,F.acquisitionId=r||-1),F.rows=p,F.columns=d,F.onClick=$=>{let q=$.gridCoord;if(!q)return;const{row:K,column:le}=q;let he;if(typeof n.source=="string"&&e.path&&!Number.isNaN(K)&&!Number.isNaN(le)){const pe=K*d+le;he=Rl(n.source,f[pe])}n.onClick?($.layer=void 0,$.imageSource=he,n.onClick($)):he&&window.open(`${window.location.origin+window.location.pathname}?source=${he}`)},F}async function U3(n,e,t){St((t==null?void 0:t.rows)||(t==null?void 0:t.columns),"Plate .zattrs missing rows, columns or wells");const r=t.rows.map($=>$.name),s=t.columns.map($=>$.name),i=t.wells.map($=>$.path),o=await d8(e),a=await L0(e,{path:i[0],zarrVersion:o});St("well"in a,"Path for image is not valid, not a well.");const u=a.well.images[0].path,f=await L0(e,{path:Rl(i[0],u),zarrVersion:o});St("multiscales"in f,"Path for image is not valid.");const{datasets:d}=f.multiscales[0],p=d[d.length-1].path;async function m($){const q=await L0(e,{path:$,zarrVersion:o});return St("well"in q,"Path for image is not valid, not a well."),Rl($,q.well.images[0].path)}const v=await Promise.all(i.map(m)),x=async([$,q])=>{let K=await $n(e.resolve(q),{kind:"array",attrs:!1});return[$,K]},b=await _4(v.map($=>[$,Rl($,p)]),x,{concurrency:10}),w=await Promise.all(b),S=dc(f.multiscales),R=yf(S),C=_f(w[0][1]),O=w.map($=>{const[q,K]=$[0].split("/");return{name:`${q}${K}`,row:r.indexOf(q),col:s.indexOf(K),loader:new Ql($[1],{labels:R,tileSize:C})}});let I;if("omero"in f)I=K_(f.omero,S);else{const $=O.at(-1);St($,"Expected at least one resolution, found none."),I=await q_($.loader,R)}const F={loaders:O,...I,axis_labels:R,loader:[O[0].loader],model_matrix:xf(n.model_matrix),defaults:{selection:I.defaultSelection,colormap:n.colormap??"",opacity:n.opacity??1},name:t.name||"Plate",rows:r.length,columns:s.length};return F.onClick=$=>{let q=$.gridCoord;if(!q)return;const{row:K,column:le}=q;let he;typeof n.source=="string"&&e.path&&!Number.isNaN(K)&&!Number.isNaN(le)&&(he=Rl(n.source,r[K],s[le])),n.onClick?($.layer=void 0,$.imageSource=he,n.onClick($)):he&&window.open(`${window.location.origin+window.location.pathname}?source=${he}`)},F}async function M8(n,e,t){const{name:r,opacity:s=1,colormap:i=""}=n,o=await W_(e,t.multiscales),a=dc(t.multiscales),u=yf(a),f=_f(o[0]);let d;if(l4(t))d=K_(t.omero,a);else{const v=o.at(-1);St(v,"Expected at least one resolution in multiscales, found none.");const x=new Ql(v,{labels:u,tileSize:f});d=await q_(x,u)}const p=o.map(v=>new Ql(v,{labels:u,tileSize:f})),m=await N8(e);return{loader:p,axis_labels:u,model_matrix:n.model_matrix?xf(n.model_matrix):d4(t.multiscales),defaults:{selection:d.defaultSelection,colormap:i,opacity:s},...d,name:d.name??r,labels:await Promise.all(m.map(v=>O8(e.resolve("labels"),v)))}}async function O8(n,e){const t=await $n(n.resolve(e),{kind:"group"}),r=ba(t.attrs);St(p8(r),"No 'image-label' metadata.");const s=await W_(t,r.multiscales),i=s.at(0);St(i,"No base resolution found for multiscale labels.");const o=_f(i),a=dc(r.multiscales),u=yf(a),f=(r["image-label"].colors??[]).map(d=>({labelValue:d["label-value"],rgba:d.rgba}));return{name:e,modelMatrix:d4(r.multiscales),loader:s.map(d=>new Ql(d,{labels:u,tileSize:o})),colors:f.length>0?f:void 0}}async function N8(n){return $n(n.resolve("labels"),{kind:"group"}).then(({attrs:e})=>e.labels??[]).catch(e=>(c4(e,Ma),[]))}async function q_(n,e){const t=e.indexOf("c"),r=t===-1?1:n.shape[t],s=r4(r),i=await o4(n,t,s),o=s4(r,s);return{name:"Image",names:ju(r).map(a=>`channel_${a}`),colors:o,contrast_limits:i,visibilities:s,channel_axis:e.includes("c")?e.indexOf("c"):null,defaultSelection:e.map(()=>0)}}function K_({rdefs:n,channels:e,name:t},r){const s=(n==null?void 0:n.defaultT)??0,i=(n==null?void 0:n.defaultZ)??0,o=(n==null?void 0:n.model)==="greyscale",a=[],u=[],f=[],d=[];e.forEach((v,x)=>{a.push(v.color),u.push([v.window.start,v.window.end]),f.push(v.active),d.push(v.label||`${x}`)}),o&&a.length===1&&(a[0]="FFFFFF");const p=r.map(v=>v.type==="time"?s:v.name==="z"?i:0),m=r.findIndex(v=>v.type==="channel");return{name:t,names:d,colors:a,contrast_limits:u,visibilities:f,channel_axis:m,defaultSelection:p}}function Vh(n,e){if(!n)throw new Error(e||"loader assertion failed.")}const Z_=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),V3=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);V3&&parseFloat(V3[1]);const Qd=globalThis,gl=globalThis.process||{},D8=globalThis.navigator||{};function x4(n){var r,s;if(typeof window<"u"&&((r=window.process)==null?void 0:r.type)==="renderer"||typeof process<"u"&&((s=process.versions)!=null&&s.electron))return!0;const t=typeof navigator<"u"&&navigator.userAgent;return!!(t&&t.indexOf("Electron")>=0)}function Mo(){return!(typeof process=="object"&&String(process)==="[object process]"&&!(process!=null&&process.browser))||x4()}function L8(n){return Mo()?x4()?"Electron":(D8.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const b4="4.1.0";function F8(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}class B8{constructor(e,t,r="sessionStorage"){this.storage=F8(r),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function U8(n){let e;return n<10?e=`${n.toFixed(2)}ms`:n<100?e=`${n.toFixed(1)}ms`:n<1e3?e=`${n.toFixed(0)}ms`:e=`${(n/1e3).toFixed(2)}s`,e}function V8(n,e=8){const t=Math.max(e-n.length,0);return`${" ".repeat(t)}${n}`}var zh;(function(n){n[n.BLACK=30]="BLACK",n[n.RED=31]="RED",n[n.GREEN=32]="GREEN",n[n.YELLOW=33]="YELLOW",n[n.BLUE=34]="BLUE",n[n.MAGENTA=35]="MAGENTA",n[n.CYAN=36]="CYAN",n[n.WHITE=37]="WHITE",n[n.BRIGHT_BLACK=90]="BRIGHT_BLACK",n[n.BRIGHT_RED=91]="BRIGHT_RED",n[n.BRIGHT_GREEN=92]="BRIGHT_GREEN",n[n.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",n[n.BRIGHT_BLUE=94]="BRIGHT_BLUE",n[n.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",n[n.BRIGHT_CYAN=96]="BRIGHT_CYAN",n[n.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(zh||(zh={}));const z8=10;function z3(n){return typeof n!="string"?n:(n=n.toUpperCase(),zh[n]||zh.WHITE)}function $8(n,e,t){return!Mo&&typeof n=="string"&&(e&&(n=`\x1B[${z3(e)}m${n}\x1B[39m`),t&&(n=`\x1B[${z3(t)+z8}m${n}\x1B[49m`)),n}function j8(n,e=["constructor"]){const t=Object.getPrototypeOf(n),r=Object.getOwnPropertyNames(t),s=n;for(const i of r){const o=s[i];typeof o=="function"&&(e.find(a=>i===a)||(s[i]=o.bind(n)))}}function Q_(n,e){if(!n)throw new Error("Assertion failed")}function ml(){var e,t,r;let n;if(Mo()&&Qd.performance)n=(t=(e=Qd==null?void 0:Qd.performance)==null?void 0:e.now)==null?void 0:t.call(e);else if("hrtime"in gl){const s=(r=gl==null?void 0:gl.hrtime)==null?void 0:r.call(gl);n=s[0]*1e3+s[1]/1e6}else n=Date.now();return n}const vl={debug:Mo()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},W8={enabled:!0,level:0};function yl(){}const $3={},j3={once:!0};class bf{constructor({id:e}={id:""}){this.VERSION=b4,this._startTs=ml(),this._deltaTs=ml(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new B8(`__probe-${this.id}__`,W8),this.timeStamp(`${this.id} started`),j8(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ml()-this._startTs).toPrecision(10))}getDelta(){return Number((ml()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,vl.warn,arguments,j3)}error(e){return this._getLogFunction(0,e,vl.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,vl.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,vl.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,vl.debug||vl.info,arguments,j3)}table(e,t,r){return t?this._getLogFunction(e,t,console.table||yl,r&&[r],{tag:X8(t)}):yl}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||yl)}group(e,t,r={collapsed:!1}){const s=W3({logLevel:e,message:t,opts:r}),{collapsed:i}=r;return s.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(e,t,r={}){return this.group(e,t,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||yl)}withGroup(e,t,r){this.group(e,t)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=w4(e)}_getLogFunction(e,t,r,s,i){if(this._shouldLog(e)){i=W3({logLevel:e,message:t,args:s,opts:i}),r=r||i.method,Q_(r),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=ml();const o=i.tag||i.message;if(i.once&&o)if(!$3[o])$3[o]=ml();else return yl;return t=H8(this.id,i.message,i),r.bind(console,t,...i.args)}return yl}}bf.VERSION=b4;function w4(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return Q_(Number.isFinite(e)&&e>=0),e}function W3(n){const{logLevel:e,message:t}=n;n.logLevel=w4(e);const r=n.args?Array.from(n.args):[];for(;r.length&&r.shift()!==t;);switch(typeof e){case"string":case"function":t!==void 0&&r.unshift(t),n.message=e;break;case"object":Object.assign(n,e);break}typeof n.message=="function"&&(n.message=n.message());const s=typeof n.message;return Q_(s==="string"||s==="object"),Object.assign(n,{args:r},n.opts)}function H8(n,e,t){if(typeof e=="string"){const r=t.time?V8(U8(t.total)):"";e=t.time?`${n}: ${r}  ${e}`:`${n}: ${e}`,e=$8(e,t.color,t.background)}return e}function X8(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}const F0="4.3.2",Y8=F0[0]>="0"&&F0[0]<="9"?`v${F0}`:"";function q8(){const n=new bf({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=n,globalThis.loaders.version=Y8,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=n,n}const K8=q8();function Z8(n,e){return T4(n||{},e)}function T4(n,e,t=0){if(t>3)return e;const r={...n};for(const[s,i]of Object.entries(e))i&&typeof i=="object"&&!Array.isArray(i)?r[s]=T4(r[s]||{},e[s],t+1):r[s]=e[s];return r}const Q8="latest";function G8(){var n;return(n=globalThis._loadersgl_)!=null&&n.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.2"),globalThis._loadersgl_.version}const J8=G8();function To(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}const ga=typeof process!="object"||String(process)!=="[object process]"||process.browser,eD=typeof window<"u"&&typeof window.orientation<"u",H3=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);H3&&parseFloat(H3[1]);class tD{constructor(e,t){E(this,"name");E(this,"workerThread");E(this,"isRunning",!0);E(this,"result");E(this,"_resolve",()=>{});E(this,"_reject",()=>{});this.name=e,this.workerThread=t,this.result=new Promise((r,s)=>{this._resolve=r,this._reject=s})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){To(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){To(this.isRunning),this.isRunning=!1,this._reject(e)}}class B0{terminate(){}}const U0=new Map;function nD(n){To(n.source&&!n.url||!n.source&&n.url);let e=U0.get(n.source||n.url);return e||(n.url&&(e=rD(n.url),U0.set(n.url,e)),n.source&&(e=S4(n.source),U0.set(n.source,e))),To(e),e}function rD(n){if(!n.startsWith("http"))return n;const e=sD(n);return S4(e)}function S4(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function sD(n){return`try {
  importScripts('${n}');
} catch (error) {
  console.error(error);
  throw error;
}`}function E4(n,e=!0,t){const r=t||new Set;if(n){if(X3(n))r.add(n);else if(X3(n.buffer))r.add(n.buffer);else if(!ArrayBuffer.isView(n)){if(e&&typeof n=="object")for(const s in n)E4(n[s],e,r)}}return t===void 0?Array.from(r):[]}function X3(n){return n?n instanceof ArrayBuffer||typeof MessagePort<"u"&&n instanceof MessagePort||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas:!1}const V0=()=>{};class cy{constructor(e){E(this,"name");E(this,"source");E(this,"url");E(this,"terminated",!1);E(this,"worker");E(this,"onMessage");E(this,"onError");E(this,"_loadableURL","");const{name:t,source:r,url:s}=e;To(r||s),this.name=t,this.source=r,this.url=s,this.onMessage=V0,this.onError=i=>console.log(i),this.worker=ga?this._createBrowserWorker():this._createNodeWorker()}static isSupported(){return typeof Worker<"u"&&ga||typeof B0<"u"&&!ga}destroy(){this.onMessage=V0,this.onError=V0,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,t){t=t||E4(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=nD({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new B0(r,{eval:!1})}else if(this.source)e=new B0(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class iD{constructor(e){E(this,"name","unnamed");E(this,"source");E(this,"url");E(this,"maxConcurrency",1);E(this,"maxMobileConcurrency",1);E(this,"onDebug",()=>{});E(this,"reuseWorkers",!0);E(this,"props",{});E(this,"jobQueue",[]);E(this,"idleQueue",[]);E(this,"count",0);E(this,"isDestroyed",!1);this.source=e.source,this.url=e.url,this.setProps(e)}static isSupported(){return cy.isSupported()}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,t=(s,i,o)=>s.done(o),r=(s,i)=>s.error(i)){const s=new Promise(i=>(this.jobQueue.push({name:e,onMessage:t,onError:r,onStart:i}),this));return this._startQueuedJob(),await s}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new tD(t.name,e);e.onMessage=s=>t.onMessage(r,s.type,s.payload),e.onError=s=>t.onError(r,s),t.onStart(r);try{await r.result}catch(s){console.error(`Worker exception: ${s}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!ga||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new cy({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return eD?this.maxMobileConcurrency:this.maxConcurrency}}const oD={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},ao=class ao{constructor(e){E(this,"props");E(this,"workerPools",new Map);this.props={...oD},this.setProps(e),this.workerPools=new Map}static isSupported(){return cy.isSupported()}static getWorkerFarm(e={}){return ao._workerFarm=ao._workerFarm||new ao({}),ao._workerFarm.setProps(e),ao._workerFarm}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:r,url:s}=e;let i=this.workerPools.get(t);return i||(i=new iD({name:t,source:r,url:s}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};E(ao,"_workerFarm");let $h=ao;function aD(n,e={}){const t=e[n.id]||{},r=ga?`${n.id}-worker.js`:`${n.id}-worker-node.js`;let s=t.workerUrl;if(!s&&n.id==="compression"&&(s=e.workerUrl),e._workerType==="test"&&(ga?s=`modules/${n.module}/dist/${r}`:s=`modules/${n.module}/src/workers/${n.id}-worker-node.ts`),!s){let i=n.version;i==="latest"&&(i=Q8);const o=i?`@${i}`:"";s=`https://unpkg.com/@loaders.gl/${n.module}${o}/dist/${r}`}return To(s),s}function lD(n,e=J8){To(n,"no worker provided");const t=n.version;return!(!e||!t)}function cD(n,e){return!$h.isSupported()||!ga&&!(e!=null&&e._nodeWorkers)?!1:n.worker&&(e==null?void 0:e.worker)}async function uD(n,e,t,r,s){const i=n.id,o=aD(n,t),u=$h.getWorkerFarm(t).getWorkerPool({name:i,url:o});t=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(r||{}));const f=await u.startJob("process-on-worker",fD.bind(null,s));return f.postMessage("process",{input:e,options:t,context:r}),await(await f.result).result}async function fD(n,e,t,r){switch(t){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:s,input:i,options:o}=r;try{const a=await n(i,o);e.postMessage("done",{id:s,result:a})}catch(a){const u=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:s,error:u})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}}function dD(n,e,t){if(t=t||n.byteLength,n.byteLength<t||e.byteLength<t)return!1;const r=new Uint8Array(n),s=new Uint8Array(e);for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}function hD(...n){return pD(n)}function pD(n){const e=n.map(i=>i instanceof ArrayBuffer?new Uint8Array(i):i),t=e.reduce((i,o)=>i+o.byteLength,0),r=new Uint8Array(t);let s=0;for(const i of e)r.set(i,s),s+=i.byteLength;return r.buffer}async function gD(n){const e=[];for await(const t of n)e.push(t);return hD(...e)}function Y3(){let n;if(typeof window<"u"&&window.performance)n=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();n=e[0]*1e3+e[1]/1e6}else n=Date.now();return n}class q3{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Y3(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Y3()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class wf{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){const{name:t,type:r}=e;let s=this.stats[t];return s||(e instanceof q3?s=e:s=new q3(t,r),this.stats[t]=s),s}}const mD="Queued Requests",vD="Active Requests",yD="Cancelled Requests",_D="Queued Requests Ever",xD="Active Requests Ever",bD={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0};class wD{constructor(e={}){E(this,"props");E(this,"stats");E(this,"activeRequestCount",0);E(this,"requestQueue",[]);E(this,"requestMap",new Map);E(this,"updateTimer",null);this.props={...bD,...e},this.stats=new wf({id:this.props.id}),this.stats.get(mD),this.stats.get(vD),this.stats.get(yD),this.stats.get(_D),this.stats.get(xD)}scheduleRequest(e,t=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:t},s=new Promise(i=>(r.resolve=i,r));return this.requestQueue.push(r),this.requestMap.set(e,s),this._issueNewRequests(),s}_issueRequest(e){const{handle:t,resolve:r}=e;let s=!1;const i=()=>{s||(s=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let t=0;t<e;++t){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const r=e[t];this._updateRequest(r)||(e.splice(t,1),this.requestMap.delete(r.handle),t--)}e.sort((t,r)=>t.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let TD="";const K3={};function SD(n){for(const e in K3)if(n.startsWith(e)){const t=K3[e];n=n.replace(e,t)}return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${TD}${n}`),n}function ED(n){return n&&typeof n=="object"&&n.isBuffer}function A4(n){if(ED(n))return n;if(n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if(typeof n=="string"){const e=n;return new TextEncoder().encode(e).buffer}if(n&&typeof n=="object"&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function C4(n){const e=n?n.lastIndexOf("/"):-1;return e>=0?n.substr(e+1):""}function AD(n){const e=n?n.lastIndexOf("/"):-1;return e>=0?n.substr(0,e):""}const CD=n=>typeof n=="boolean",Au=n=>typeof n=="function",Tf=n=>n!==null&&typeof n=="object",Z3=n=>Tf(n)&&n.constructor==={}.constructor,RD=n=>!!n&&typeof n[Symbol.iterator]=="function",PD=n=>n&&typeof n[Symbol.asyncIterator]=="function",Oa=n=>typeof Response<"u"&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Na=n=>typeof Blob<"u"&&n instanceof Blob,ID=n=>n&&typeof n=="object"&&n.isBuffer,kD=n=>typeof ReadableStream<"u"&&n instanceof ReadableStream||Tf(n)&&Au(n.tee)&&Au(n.cancel)&&Au(n.getReader),MD=n=>Tf(n)&&Au(n.read)&&Au(n.pipe)&&CD(n.readable),R4=n=>kD(n)||MD(n);class OD extends Error{constructor(t,r){super(t);E(this,"reason");E(this,"url");E(this,"response");this.reason=r.reason,this.url=r.url,this.response=r.response}}const ND=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,DD=/^([-\w.]+\/[-\w.+]+)/;function Q3(n,e){return n.toLowerCase()===e.toLowerCase()}function LD(n){const e=DD.exec(n);return e?e[1]:n}function G3(n){const e=ND.exec(n);return e?e[1]:""}const P4=/\?.*/;function FD(n){const e=n.match(P4);return e&&e[0]}function G_(n){return n.replace(P4,"")}function BD(n){if(n.length<50)return n;const e=n.slice(n.length-15);return`${n.substr(0,32)}...${e}`}function eg(n){return Oa(n)?n.url:Na(n)?n.name||"":typeof n=="string"?n:""}function J_(n){if(Oa(n)){const e=n,t=e.headers.get("content-type")||"",r=G_(e.url);return LD(t)||G3(r)}return Na(n)?n.type||"":typeof n=="string"?G3(n):""}function UD(n){return Oa(n)?n.headers["content-length"]||-1:Na(n)?n.size:typeof n=="string"?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}async function I4(n){if(Oa(n))return n;const e={},t=UD(n);t>=0&&(e["content-length"]=String(t));const r=eg(n),s=J_(n);s&&(e["content-type"]=s);const i=await $D(n);i&&(e["x-first-bytes"]=i),typeof n=="string"&&(n=new TextEncoder().encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function VD(n){if(!n.ok)throw await zD(n)}async function zD(n){const e=BD(n.url);let t=`Failed to fetch resource (${n.status}) ${n.statusText}: ${e}`;t=t.length>100?`${t.slice(0,100)}...`:t;const r={reason:n.statusText,url:n.url,response:n};try{const s=n.headers.get("Content-Type");r.reason=!n.bodyUsed&&(s!=null&&s.includes("application/json"))?await n.json():await n.text()}catch{}return new OD(t,r)}async function $D(n){if(typeof n=="string")return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return await new Promise(r=>{const s=new FileReader;s.onload=i=>{var o;return r((o=i==null?void 0:i.target)==null?void 0:o.result)},s.readAsDataURL(t)})}if(n instanceof ArrayBuffer){const t=n.slice(0,5);return`data:base64,${jD(t)}`}return null}function jD(n){let e="";const t=new Uint8Array(n);for(let r=0;r<t.byteLength;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function WD(n){return!HD(n)&&!XD(n)}function HD(n){return n.startsWith("http:")||n.startsWith("https:")}function XD(n){return n.startsWith("data:")}async function J3(n,e){var t,r;if(typeof n=="string"){const s=SD(n);return WD(s)&&(t=globalThis.loaders)!=null&&t.fetchNode?(r=globalThis.loaders)==null?void 0:r.fetchNode(s,e):await fetch(s,e)}return await I4(n)}const ew=new bf({id:"loaders.gl"});class YD{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class qD{constructor(){E(this,"console");this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const k4={fetch:null,mimeType:void 0,nothrow:!1,log:new qD,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Z_,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},KD={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function M4(){globalThis.loaders=globalThis.loaders||{};const{loaders:n}=globalThis;return n._state||(n._state={}),n._state}function O4(){const n=M4();return n.globalOptions=n.globalOptions||{...k4},n.globalOptions}function ZD(n,e,t,r){return t=t||[],t=Array.isArray(t)?t:[t],QD(n,t),JD(e,n,r)}function QD(n,e){tw(n,null,k4,KD,e);for(const t of e){const r=n&&n[t.id]||{},s=t.options&&t.options[t.id]||{},i=t.deprecatedOptions&&t.deprecatedOptions[t.id]||{};tw(r,t.id,s,i,e)}}function tw(n,e,t,r,s){const i=e||"Top level",o=e?`${e}.`:"";for(const a in n){const u=!e&&Tf(n[a]),f=a==="baseUri"&&!e,d=a==="workerUrl"&&e;if(!(a in t)&&!f&&!d){if(a in r)ew.warn(`${i} loader option '${o}${a}' no longer supported, use '${r[a]}'`)();else if(!u){const p=GD(a,s);ew.warn(`${i} loader option '${o}${a}' not recognized. ${p}`)()}}}}function GD(n,e){const t=n.toLowerCase();let r="";for(const s of e)for(const i in s.options){if(n===i)return`Did you mean '${s.id}.${i}'?`;const o=i.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(r=r||`Did you mean '${s.id}.${i}'?`)}return r}function JD(n,e,t){const s={...n.options||{}};return eL(s,t),s.log===null&&(s.log=new YD),nw(s,O4()),nw(s,e),s}function nw(n,e){for(const t in e)if(t in e){const r=e[t];Z3(r)&&Z3(n[t])?n[t]={...n[t],...e[t]}:n[t]=e[t]}}function eL(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}function e1(n){return n?(Array.isArray(n)&&(n=n[0]),Array.isArray(n==null?void 0:n.extensions)):!1}function t1(n){Vh(n,"null loader"),Vh(e1(n),"invalid loader");let e;return Array.isArray(n)&&(e=n[1],n=n[0],n={...n,options:{...n.options,...e}}),(n!=null&&n.parseTextSync||n!=null&&n.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const N4=()=>{const n=M4();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function tL(n){const e=N4();n=Array.isArray(n)?n:[n];for(const t of n){const r=t1(t);e.find(s=>r===s)||e.unshift(r)}}function nL(){return N4()}const rL=/\.([^.]+)$/;async function sL(n,e=[],t,r){if(!D4(n))return null;let s=rw(n,e,{...t,nothrow:!0},r);if(s)return s;if(Na(n)&&(n=await n.slice(0,10).arrayBuffer(),s=rw(n,e,t,r)),!s&&!(t!=null&&t.nothrow))throw new Error(L4(n));return s}function rw(n,e=[],t,r){if(!D4(n))return null;if(e&&!Array.isArray(e))return t1(e);let s=[];e&&(s=s.concat(e)),t!=null&&t.ignoreRegisteredLoaders||s.push(...nL()),oL(s);const i=iL(n,s,t,r);if(!i&&!(t!=null&&t.nothrow))throw new Error(L4(n));return i}function iL(n,e,t,r){const s=eg(n),i=J_(n),o=G_(s)||(r==null?void 0:r.url);let a=null,u="";return t!=null&&t.mimeType&&(a=z0(e,t==null?void 0:t.mimeType),u=`match forced by supplied MIME type ${t==null?void 0:t.mimeType}`),a=a||aL(e,o),u=u||(a?`matched url ${o}`:""),a=a||z0(e,i),u=u||(a?`matched MIME type ${i}`:""),a=a||cL(e,n),u=u||(a?`matched initial data ${F4(n)}`:""),t!=null&&t.fallbackMimeType&&(a=a||z0(e,t==null?void 0:t.fallbackMimeType),u=u||(a?`matched fallback MIME type ${i}`:"")),u&&K8.log(1,`selectLoader selected ${a==null?void 0:a.name}: ${u}.`),a}function D4(n){return!(n instanceof Response&&n.status===204)}function L4(n){const e=eg(n),t=J_(n);let r="No valid loader found (";r+=e?`${C4(e)}, `:"no url provided, ",r+=`MIME type: ${t?`"${t}"`:"not provided"}, `;const s=n?F4(n):"";return r+=s?` first bytes: "${s}"`:"first bytes: not available",r+=")",r}function oL(n){for(const e of n)t1(e)}function aL(n,e){const t=e&&rL.exec(e),r=t&&t[1];return r?lL(n,r):null}function lL(n,e){e=e.toLowerCase();for(const t of n)for(const r of t.extensions)if(r.toLowerCase()===e)return t;return null}function z0(n,e){var t;for(const r of n)if((t=r.mimeTypes)!=null&&t.some(s=>Q3(e,s))||Q3(e,`application/x.${r.id}`))return r;return null}function cL(n,e){if(!e)return null;for(const t of n)if(typeof e=="string"){if(uL(e,t))return t}else if(ArrayBuffer.isView(e)){if(sw(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&sw(e,0,t))return t;return null}function uL(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>n.startsWith(r))}function sw(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(s=>fL(n,e,t,s))}function fL(n,e,t,r){if(r instanceof ArrayBuffer)return dD(r,n,r.byteLength);switch(typeof r){case"function":return r(n);case"string":const s=uy(n,e,r.length);return r===s;default:return!1}}function F4(n,e=5){return typeof n=="string"?n.slice(0,e):ArrayBuffer.isView(n)?uy(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?uy(n,0,e):""}function uy(n,e,t){if(n.byteLength<e+t)return"";const r=new DataView(n);let s="";for(let i=0;i<t;i++)s+=String.fromCharCode(r.getUint8(e+i));return s}const dL=256*1024;function*hL(n,e){const t=(e==null?void 0:e.chunkSize)||dL;let r=0;const s=new TextEncoder;for(;r<n.length;){const i=Math.min(n.length-r,t),o=n.slice(r,r+i);r+=i,yield s.encode(o)}}const pL=256*1024;function*gL(n,e={}){const{chunkSize:t=pL}=e;let r=0;for(;r<n.byteLength;){const s=Math.min(n.byteLength-r,t),i=new ArrayBuffer(s),o=new Uint8Array(n,r,s);new Uint8Array(i).set(o),r+=s,yield i}}const mL=1024*1024;async function*vL(n,e){const t=(e==null?void 0:e.chunkSize)||mL;let r=0;for(;r<n.size;){const s=r+t,i=await n.slice(r,s).arrayBuffer();r=s,yield i}}function iw(n,e){return Z_?yL(n,e):_L(n)}async function*yL(n,e){const t=n.getReader();let r;try{for(;;){const s=r||t.read();e!=null&&e._streamReadAhead&&(r=t.read());const{done:i,value:o}=await s;if(i)return;yield A4(o)}}catch{t.releaseLock()}}async function*_L(n,e){for await(const t of n)yield A4(t)}function xL(n,e){if(typeof n=="string")return hL(n,e);if(n instanceof ArrayBuffer)return gL(n,e);if(Na(n))return vL(n,e);if(R4(n))return iw(n,e);if(Oa(n))return iw(n.body,e);throw new Error("makeIterator")}const B4="Cannot convert supplied data type";function bL(n,e,t){if(e.text&&typeof n=="string")return n;if(ID(n)&&(n=n.buffer),n instanceof ArrayBuffer){const r=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let r=n.buffer;const s=n.byteLength||n.length;return(n.byteOffset!==0||s!==r.byteLength)&&(r=r.slice(n.byteOffset,n.byteOffset+s)),r}throw new Error(B4)}async function wL(n,e,t){const r=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if(typeof n=="string"||r)return bL(n,e);if(Na(n)&&(n=await I4(n)),Oa(n)){const s=n;return await VD(s),e.binary?await s.arrayBuffer():await s.text()}if(R4(n)&&(n=xL(n,t)),RD(n)||PD(n))return gD(n);throw new Error(B4)}function U4(n,e){const t=O4(),r=n||t;return typeof r.fetch=="function"?r.fetch:Tf(r.fetch)?s=>J3(s,r.fetch):e!=null&&e.fetch?e==null?void 0:e.fetch:J3}function TL(n,e,t){if(t)return t;const r={fetch:U4(e,n),...n};if(r.url){const s=G_(r.url);r.baseUrl=s,r.queryString=FD(r.url),r.filename=C4(s),r.baseUrl=AD(s)}return Array.isArray(r.loaders)||(r.loaders=null),r}function SL(n,e){if(n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...r]:r}return t&&t.length?t:void 0}async function jh(n,e,t,r){e&&!Array.isArray(e)&&!e1(e)&&(r=void 0,t=e,e=void 0),n=await n,t=t||{};const s=eg(n),o=SL(e,r),a=await sL(n,o,t);return a?(t=ZD(t,a,o,s),r=TL({url:s,_parse:jh,loaders:o},t,r||null),await EL(a,n,t,r)):null}async function EL(n,e,t,r){if(lD(n),t=Z8(n.options,t),Oa(e)){const i=e,{ok:o,redirected:a,status:u,statusText:f,type:d,url:p}=i,m=Object.fromEntries(i.headers.entries());r.response={headers:m,ok:o,redirected:a,status:u,statusText:f,type:d,url:p}}e=await wL(e,n,t);const s=n;if(s.parseTextSync&&typeof e=="string")return s.parseTextSync(e,t,r);if(cD(n,t))return await uD(n,e,t,r,jh);if(s.parseText&&typeof e=="string")return await s.parseText(e,t,r);if(s.parse)return await s.parse(e,t,r);throw To(!s.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)}async function Wh(n,e,t,r){let s,i;!Array.isArray(e)&&!e1(e)?(s=[],i=e):(s=e,i=t);const o=U4(i);let a=n;return typeof n=="string"&&(a=await o(n)),Na(n)&&(a=await o(n)),Array.isArray(s)?await jh(a,s,i):await jh(a,s,i)}const AL="4.3.2";var LS;const CL=(LS=globalThis.loaders)==null?void 0:LS.parseImageNode,fy=typeof Image<"u",dy=typeof ImageBitmap<"u",RL=!!CL,hy=Z_?!0:RL;function PL(n){switch(n){case"auto":return dy||fy||hy;case"imagebitmap":return dy;case"image":return fy;case"data":return hy;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}function IL(){if(dy)return"imagebitmap";if(fy)return"image";if(hy)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function kL(n){const e=OL(n);if(!e)throw new Error("Not an image");return e}function ML(n){switch(kL(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}function OL(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&n instanceof Image?"image":n&&typeof n=="object"&&n.data&&n.width&&n.height?"data":null}const NL=/^data:image\/svg\+xml/,DL=/\.svg((\?|#).*)?$/;function n1(n){return n&&(NL.test(n)||DL.test(n))}function LL(n,e){if(n1(e)){let r=new TextDecoder().decode(n);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(i){throw new Error(i.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return V4(n,e)}function V4(n,e){if(n1(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}async function z4(n,e,t){const r=LL(n,t),s=self.URL||self.webkitURL,i=typeof r!="string"&&s.createObjectURL(r);try{return await FL(i||r,e)}finally{i&&s.revokeObjectURL(i)}}async function FL(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(await t.decode(),t):await new Promise((r,s)=>{try{t.onload=()=>r(t),t.onerror=i=>{const o=i instanceof Error?i.message:"error";s(new Error(o))}}catch(i){s(i)}})}const BL={};let ow=!0;async function UL(n,e,t){let r;n1(t)?r=await z4(n,e,t):r=V4(n,t);const s=e&&e.imagebitmap;return await VL(r,s)}async function VL(n,e=null){if((zL(e)||!ow)&&(e=null),e)try{return await createImageBitmap(n,e)}catch(t){console.warn(t),ow=!1}return await createImageBitmap(n)}function zL(n){for(const e in n||BL)return!1;return!0}function $L(n){return!XL(n,"ftyp",4)||(n[8]&96)===0?null:jL(n)}function jL(n){switch(WL(n,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function WL(n,e,t){return String.fromCharCode(...n.slice(e,t))}function HL(n){return[...n].map(e=>e.charCodeAt(0))}function XL(n,e,t=0){const r=HL(e);for(let s=0;s<r.length;++s)if(r[s]!==n[s+t])return!1;return!0}const Us=!1,Cu=!0;function $4(n){const e=Sf(n);return qL(e)||QL(e)||KL(e)||ZL(e)||YL(e)}function YL(n){const e=new Uint8Array(n instanceof DataView?n.buffer:n),t=$L(e);return t?{mimeType:t.mimeType,width:0,height:0}:null}function qL(n){const e=Sf(n);return e.byteLength>=24&&e.getUint32(0,Us)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Us),height:e.getUint32(20,Us)}:null}function KL(n){const e=Sf(n);return e.byteLength>=10&&e.getUint32(0,Us)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Cu),height:e.getUint16(8,Cu)}:null}function ZL(n){const e=Sf(n);return e.byteLength>=14&&e.getUint16(0,Us)===16973&&e.getUint32(2,Cu)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Cu),height:e.getUint32(22,Cu)}:null}function QL(n){const e=Sf(n);if(!(e.byteLength>=3&&e.getUint16(0,Us)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:s}=GL();let i=2;for(;i+9<e.byteLength;){const o=e.getUint16(i,Us);if(s.has(o))return{mimeType:"image/jpeg",height:e.getUint16(i+5,Us),width:e.getUint16(i+7,Us)};if(!r.has(o))return null;i+=2,i+=e.getUint16(i,Us)}return null}function GL(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Sf(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}async function JL(n,e){var s;const{mimeType:t}=$4(n)||{},r=(s=globalThis.loaders)==null?void 0:s.parseImageNode;return Vh(r),await r(n,t)}async function eF(n,e,t){e=e||{};const s=(e.image||{}).type||"auto",{url:i}=t||{},o=tF(s);let a;switch(o){case"imagebitmap":a=await UL(n,e,i);break;case"image":a=await z4(n,e,i);break;case"data":a=await JL(n);break;default:Vh(!1)}return s==="data"&&(a=ML(a)),a}function tF(n){switch(n){case"auto":case"data":return IL();default:return PL(n),n}}const nF=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],rF=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],sF={image:{type:"auto",decode:!0}},iF={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:AL,mimeTypes:rF,extensions:nF,parse:eF,tests:[n=>!!$4(new DataView(n))],options:sF},ft=new bf({id:"deck"});let py={};function oF(n){py=n}function er(n,e,t,r){ft.level>0&&py[n]&&py[n].call(null,e,t,r)}function aF(n){const e=n[0],t=n[n.length-1];return e==="{"&&t==="}"||e==="["&&t==="]"}const lF={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:aF,parseTextSync:JSON.parse};function cF(){const n="9.0.41",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==n)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${n}`);return e||(ft.log(1,`deck.gl ${n}`)(),globalThis.deck={...globalThis.deck,VERSION:n,version:n,log:ft,_registerLoggers:oF},tL([lF,[iF,{imagebitmap:{premultiplyAlpha:"none"}}]])),n}const uF=cF();function oa(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const $0={number:{type:"number",validate(n,e){return Number.isFinite(n)&&typeof e=="object"&&(e.max===void 0||n<=e.max)&&(e.min===void 0||n>=e.min)}},array:{type:"array",validate(n,e){return Array.isArray(n)||ArrayBuffer.isView(n)}}};function fF(n){const e={};for(const[t,r]of Object.entries(n))e[t]=hF(r);return e}function dF(n,e,t){const r={};for(const[s,i]of Object.entries(e))n&&s in n&&!i.private?(i.validate&&oa(i.validate(n[s],i),`${t}: invalid ${s}`),r[s]=n[s]):r[s]=i.value;return r}function hF(n){let e=aw(n);if(e!=="object")return{value:n,...$0[e],type:e};if(typeof n=="object")return n?n.type!==void 0?{...n,...$0[n.type],type:n.type}:n.value===void 0?{type:"object",value:n}:(e=aw(n.value),{...n,...$0[e],type:e}):{type:"object",value:null};throw new Error("props")}function aw(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}const pF=`#ifdef MODULE_LOGDEPTH
logdepth_adjustPosition(gl_Position);
#endif
`,gF=`#ifdef MODULE_MATERIAL
gl_FragColor = material_filterColor(gl_FragColor);
#endif
#ifdef MODULE_LIGHTING
gl_FragColor = lighting_filterColor(gl_FragColor);
#endif
#ifdef MODULE_FOG
gl_FragColor = fog_filterColor(gl_FragColor);
#endif
#ifdef MODULE_PICKING
gl_FragColor = picking_filterHighlightColor(gl_FragColor);
gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif
#ifdef MODULE_LOGDEPTH
logdepth_setFragDepth();
#endif
`,mF={vertex:pF,fragment:gF},lw=/void\s+main\s*\([^)]*\)\s*\{\n?/,cw=/}\n?[^{}]*$/,j0=[],xh="__LUMA_INJECT_DECLARATIONS__";function vF(n){const e={vertex:{},fragment:{}};for(const t in n){let r=n[t];const s=yF(t);typeof r=="string"&&(r={order:0,injection:r}),e[s][t]=r}return e}function yF(n){const e=n.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function Hh(n,e,t,r=!1){const s=e==="vertex";for(const i in t){const o=t[i];o.sort((u,f)=>u.order-f.order),j0.length=o.length;for(let u=0,f=o.length;u<f;++u)j0[u]=o[u].injection;const a=`${j0.join(`
`)}
`;switch(i){case"vs:#decl":s&&(n=n.replace(xh,a));break;case"vs:#main-start":s&&(n=n.replace(lw,u=>u+a));break;case"vs:#main-end":s&&(n=n.replace(cw,u=>a+u));break;case"fs:#decl":s||(n=n.replace(xh,a));break;case"fs:#main-start":s||(n=n.replace(lw,u=>u+a));break;case"fs:#main-end":s||(n=n.replace(cw,u=>a+u));break;default:n=n.replace(i,u=>u+a)}}return n=n.replace(xh,""),r&&(n=n.replace(/\}\s*$/,i=>i+mF[e])),n}let _F=1;class aa{constructor(e){E(this,"name");E(this,"vs");E(this,"fs");E(this,"getModuleUniforms");E(this,"dependencies");E(this,"deprecations");E(this,"defines");E(this,"injections");E(this,"uniforms",{});E(this,"uniformTypes",{});const{name:t,vs:r,fs:s,dependencies:i=[],uniformTypes:o={},uniformPropTypes:a={},getUniforms:u,deprecations:f=[],defines:d={},inject:p={}}=e;oa(typeof t=="string"),this.name=t,this.vs=r,this.fs=s,this.getModuleUniforms=u,this.dependencies=aa.instantiateModules(i),this.deprecations=this._parseDeprecationDefinitions(f),this.defines=d,this.injections=vF(p),this.uniformTypes=o,a&&(this.uniforms=fF(a))}static instantiateModules(e){return e.map(t=>{if(t instanceof aa)return t;oa(typeof t!="string",`Shader module use by name is deprecated. Import shader module '${JSON.stringify(t)}' and use it directly.`),t.name||(console.warn("shader module has no name"),t.name=`shader-module-${_F++}`);const r=new aa(t);return r.dependencies=aa.instantiateModules(t.dependencies||[]),r})}getModuleSource(e){let t;switch(e){case"vertex":t=this.vs||"";break;case"fragment":t=this.fs||"";break;default:oa(!1)}const r=this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");return`// ----- MODULE ${this.name} ---------------

#define MODULE_${r}
${t}

`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):dF(e,this.uniforms,this.name)}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(r=>{var s;(s=r.regex)!=null&&s.test(e)&&(r.deprecated?t.deprecated(r.old,r.new)():t.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},r=this.uniforms;for(const s in r){const i=r[s];s in e&&!i.private?(i.validate&&oa(i.validate(e[s],i),`${this.name}: invalid ${s}`),t[s]=e[s]):t[s]=i.value}return t}}function uw(n){if(n.source&&n.platformInfo.type==="webgpu")return{...n,vs:void 0,fs:void 0};if(!n.vs)throw new Error("no vertex shader");const e=fw(n.platformInfo,n.vs);let t;return n.fs&&(t=fw(n.platformInfo,n.fs)),{...n,vs:e,fs:t}}function fw(n,e){if(typeof e=="string")return e;switch(n.type){case"webgpu":if(e!=null&&e.wgsl)return e.wgsl;throw new Error("WebGPU does not support GLSL shaders");default:if(e!=null&&e.glsl)return e.glsl;throw new Error("WebGL does not support WGSL shaders")}}function tg(n){const e=aa.instantiateModules(n);return xF(e)}function xF(n){const e={},t={};return j4({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((r,s)=>t[s]-t[r]).map(r=>e[r])}function j4(n){const{modules:e,level:t,moduleMap:r,moduleDepth:s}=n;if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const i of e)r[i.name]=i,(s[i.name]===void 0||s[i.name]<t)&&(s[i.name]=t);for(const i of e)i.dependencies&&j4({modules:i.dependencies,level:t+1,moduleMap:r,moduleDepth:s})}function bF(n){switch(n==null?void 0:n.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function wF(n,e){var r;if(Number(((r=n.match(/^#version[ \t]+(\d+)/m))==null?void 0:r[1])||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return n=dw(n,TF),n;case"fragment":return n=dw(n,SF),n;default:throw new Error(e)}}const W4=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],TF=[...W4,[gy("attribute"),"in $1"],[gy("varying"),"out $1"]],SF=[...W4,[gy("varying"),"in $1"]];function dw(n,e){for(const[t,r]of e)n=n.replace(t,r);return n}function gy(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function H4(n,e){let t="";for(const r in n){const s=n[r];if(t+=`void ${s.signature} {
`,s.header&&(t+=`  ${s.header}`),e[r]){const i=e[r];i.sort((o,a)=>o.order-a.order);for(const o of i)t+=`  ${o.injection}
`}s.footer&&(t+=`  ${s.footer}`),t+=`}
`}return t}function X4(n){const e={vertex:{},fragment:{}};for(const t of n){let r,s;typeof t!="string"?(r=t,s=r.hook):(r={},s=t),s=s.trim();const[i,o]=s.split(":"),a=s.replace(/\(.+/,""),u=Object.assign(r,{signature:o});switch(i){case"vs":e.vertex[a]=u;break;case"fs":e.fragment[a]=u;break;default:throw new Error(i)}}return e}function EF(n,e){return{name:AF(n,e),language:"glsl",version:CF(n)}}function AF(n,e="unnamed"){const r=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(n);return r?r[1]:e}function CF(n){let e=100;const t=n.match(/[^\s]+/g);if(t&&t.length>=2&&t[0]==="#version"){const r=parseInt(t[1],10);Number.isFinite(r)&&(e=r)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const Y4=`

${xh}
`,RF=`precision highp float;
`;function PF(n){const e=tg(n.modules||[]);return{source:my(n.platformInfo,{...n,source:n.source,stage:"vertex",modules:e}),getUniforms:r1(e)}}function IF(n){const e=tg(n.modules||[]);return{vs:my(n.platformInfo,{...n,source:n.vs,stage:"vertex",modules:e}),fs:my(n.platformInfo,{...n,source:n.fs,stage:"fragment",modules:e}),getUniforms:r1(e)}}function kF(n){const{vs:e,fs:t}=n,r=tg(n.modules||[]);return{vs:hw(n.platformInfo,{...n,source:e,stage:"vertex",modules:r}),fs:hw(n.platformInfo,{...n,source:t,stage:"fragment",modules:r}),getUniforms:r1(r)}}function my(n,e){const{source:t,stage:r,modules:s,hookFunctions:i=[],inject:o={},log:a}=e;oa(typeof t=="string","shader source must be a string");const u=t;let f="";const d=X4(i),p={},m={},v={};for(const b in o){const w=typeof o[b]=="string"?{injection:o[b],order:0}:o[b],S=/^(v|f)s:(#)?([\w-]+)$/.exec(b);if(S){const R=S[2],C=S[3];R?C==="decl"?m[b]=[w]:v[b]=[w]:p[b]=[w]}else v[b]=[w]}const x=n.type!=="webgpu"?s:[];for(const b of x){a&&b.checkDeprecations(u,a);const w=b.getModuleSource(r,"wgsl");f+=w;const S=b.injections[r];for(const R in S){const C=/^(v|f)s:#([\w-]+)$/.exec(R);if(C){const I=C[2]==="decl"?m:v;I[R]=I[R]||[],I[R].push(S[R])}else p[R]=p[R]||[],p[R].push(S[R])}}return f+=Y4,f=Hh(f,r,m),f+=H4(d[r],p),f+=u,f=Hh(f,r,v),f}function hw(n,e){const{id:t,source:r,stage:s,language:i="glsl",modules:o,defines:a={},hookFunctions:u=[],inject:f={},prologue:d=!0,log:p}=e;oa(typeof r=="string","shader source must be a string");const m=i==="glsl"?EF(r).version:-1,v=n.shaderLanguageVersion,x=m===100?"#version 100":"#version 300 es",w=r.split(`
`).slice(1).join(`
`),S={};o.forEach($=>{Object.assign(S,$.getDefines())}),Object.assign(S,a);let R="";switch(i){case"wgsl":break;case"glsl":R=d?`${x}

// ----- PROLOGUE -------------------------
${MF({id:t,source:r,stage:s})}
${`#define SHADER_TYPE_${s.toUpperCase()}`}
${bF(n)}
${s==="fragment"?RF:""}

// ----- APPLICATION DEFINES -------------------------

${OF(S)}

`:`${x}
`;break}const C=X4(u),O={},I={},F={};for(const $ in f){const q=typeof f[$]=="string"?{injection:f[$],order:0}:f[$],K=/^(v|f)s:(#)?([\w-]+)$/.exec($);if(K){const le=K[2],he=K[3];le?he==="decl"?I[$]=[q]:F[$]=[q]:O[$]=[q]}else F[$]=[q]}for(const $ of o){p&&$.checkDeprecations(w,p);const q=$.getModuleSource(s);R+=q;const K=$.injections[s];for(const le in K){const he=/^(v|f)s:#([\w-]+)$/.exec(le);if(he){const se=he[2]==="decl"?I:F;se[le]=se[le]||[],se[le].push(K[le])}else O[le]=O[le]||[],O[le].push(K[le])}}return R+="// ----- MAIN SHADER SOURCE -------------------------",R+=Y4,R=Hh(R,s,I),R+=H4(C[s],O),R+=w,R=Hh(R,s,F),i==="glsl"&&m!==v&&(R=wF(R,s)),R.trim()}function r1(n){return function(t){const r={};for(const s of n){const i=s.getUniforms(t,r);Object.assign(r,i)}return r}}function MF(n){const{id:e,source:t,stage:r}=n;return e&&t.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${r}

`:""}function OF(n={}){let e="";for(const t in n){const r=n[t];(r||Number.isFinite(r))&&(e+=`#define ${t.toUpperCase()} ${n[t]}
`)}return e}const na=class na{constructor(){E(this,"_hookFunctions",[]);E(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return na.defaultShaderAssembler=na.defaultShaderAssembler||new na,na.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleShader(e){const t=this._getModuleList(e.modules),r=this._hookFunctions,s=uw(e);return{...PF({platformInfo:e.platformInfo,...s,modules:t,hookFunctions:r}),modules:t}}assembleShaderPair(e){const t=uw(e),r=this._getModuleList(e.modules),s=this._hookFunctions,{platformInfo:i}=e;return{...e.platformInfo.shaderLanguage==="wgsl"?IF({platformInfo:i,...t,modules:r,hookFunctions:s}):kF({platformInfo:i,...t,modules:r,hookFunctions:s}),modules:r}}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),r={};let s=0;for(let i=0,o=this._defaultModules.length;i<o;++i){const a=this._defaultModules[i],u=a.name;t[s++]=a,r[u]=!0}for(let i=0,o=e.length;i<o;++i){const a=e[i],u=a.name;r[u]||(t[s++]=a,r[u]=!0)}return t.length=s,aa.instantiateModules(t)}};E(na,"defaultShaderAssembler");let Gl=na;const NF=`out vec4 transform_output;
void main() {
transform_output = vec4(0);
}`,DF=`#version 300 es
${NF}`;function LF(n){const{input:e,inputChannels:t,output:r}={};if(!e)return DF;if(!t)throw new Error("inputChannels");const s=FF(t),i=BF(e,t);return`#version 300 es
in ${s} ${e};
out vec4 ${r};
void main() {
  ${r} = ${i};
}`}function FF(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${n}`)}}function BF(n,e){switch(e){case 1:return`vec4(${n}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${n}, 0.0, 1.0)`;case 3:return`vec4(${n}, 1.0)`;case 4:return n;default:throw new Error(`invalid channels: ${e}`)}}const Re=new bf({id:"luma.gl"});class UF{constructor(){E(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new wf({id:e})),this.stats.get(e)}}const s1=new UF;function VF(){const n="9.0.28",e="set luma.log.level=1 (or higher) to trace rendering";if(globalThis.luma&&globalThis.luma.VERSION!==n)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${n}`);return globalThis.luma||(Mo()&&Re.log(1,`${n} - ${e}`)(),globalThis.luma=globalThis.luma||{VERSION:n,version:n,log:Re,stats:s1}),n}const zF=VF();function $F(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)?n:null}function Hu(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number"?n:null:$F(n)}const W0={};function Da(n="id"){W0[n]=W0[n]||1;const e=W0[n]++;return`${n}-${e}`}function Xh(n){let e=!0;for(const t in n){e=!1;break}return e}var wv;let Bt=(wv=class{constructor(e,t,r){E(this,"id");E(this,"props");E(this,"userData",{});E(this,"_device");E(this,"destroyed",!1);E(this,"allocatedBytes",0);E(this,"_attachedResources",new Set);if(!e)throw new Error("no device");this._device=e,this.props=jF(t,r);const s=this.props.id!=="undefined"?this.props.id:Da(this[Symbol.toStringTag]);this.props.id=s,this.id=s,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").addCount(e),r.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}},E(wv,"defaultProps",{id:"undefined",handle:void 0,userData:void 0}),wv);function jF(n,e){const t={...e};for(const r in n)n[r]!==void 0&&(t[r]=n[r]);return t}var yn;let fn=(yn=class extends Bt{constructor(t,r){const s={...r};(r.usage||0)&yn.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?s.indexType="uint32":r.data instanceof Uint16Array&&(s.indexType="uint16"));super(t,s,yn.defaultProps);E(this,"usage");E(this,"indexType");E(this,"updateTimestamp");E(this,"debugData",new ArrayBuffer(0));this.usage=r.usage||0,this.indexType=s.indexType,this.updateTimestamp=t.incrementTimestamp()}get[Symbol.toStringTag](){return"Buffer"}readSyncWebGL(t,r){throw new Error("not implemented")}_setDebugData(t,r,s){const i=ArrayBuffer.isView(t)?t.buffer:t,o=Math.min(t?t.byteLength:s,yn.DEBUG_DATA_MAX_LENGTH);t===null?this.debugData=new ArrayBuffer(o):r===0&&s===t.byteLength?this.debugData=i.slice(0,o):this.debugData=i.slice(r,r+o)}},E(yn,"defaultProps",{...Bt.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1}),E(yn,"MAP_READ",1),E(yn,"MAP_WRITE",2),E(yn,"COPY_SRC",4),E(yn,"COPY_DST",8),E(yn,"INDEX",16),E(yn,"VERTEX",32),E(yn,"UNIFORM",64),E(yn,"STORAGE",128),E(yn,"INDIRECT",256),E(yn,"QUERY_RESOLVE",512),E(yn,"DEBUG_DATA_MAX_LENGTH",32),yn);function q4(n){const e=pw[n],t=WF(e),r=n.includes("norm"),s=!r&&!n.startsWith("float"),i=n.startsWith("s");return{dataType:pw[n],byteLength:t,integer:s,signed:i,normalized:r}}function WF(n){return HF[n]}const pw={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},HF={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},XF=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],YF=/^(rg?b?a?)([0-9]*)([a-z]*)(-srgb)?(-webgl|-unsized)?$/;function qF(n){return XF.some(e=>n.startsWith(e))}function K4(n){const e=YF.exec(n);if(e){const[,t,r,s,i,o]=e;if(t){const a=`${s}${r}`,u=q4(a);return{format:t,components:t.length,srgb:i==="-srgb",unsized:o==="-unsized",webgl:o==="-webgl",...u}}}return ZF(n)}const KF={"rgba4unorm-webgl":{format:"rgba",bpp:2},"rgb565unorm-webgl":{format:"rgb",bpp:2},"rgb5a1unorm-webgl":{format:"rgba",bbp:2},rgb9e5ufloat:{format:"rgb",bbp:4},rg11b10ufloat:{format:"rgb",bbp:4},rgb10a2unorm:{format:"rgba",bbp:4},"rgb10a2uint-webgl":{format:"rgba",bbp:4},stencil8:{components:1,bpp:1,a:"stencil"},depth16unorm:{components:1,bpp:2,a:"depth"},depth24plus:{components:1,bpp:3,a:"depth"},depth32float:{components:1,bpp:4,a:"depth"},"depth24plus-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth24unorm-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth32float-stencil8":{components:2,bpp:4,a:"depth-stencil"}};function ZF(n){var t;const e=KF[n];if(!e)throw new Error(`Unknown format ${n}`);return{format:e.format||"",components:e.components||((t=e.format)==null?void 0:t.length)||1,byteLength:e.bpp||1,srgb:!1,unsized:!1}}class QF{}class GF{constructor(e=[],t){E(this,"features");E(this,"disabledFeatures");this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures[e]&&this.features.has(e)}}const Du=class Du{constructor(e){E(this,"id");E(this,"props");E(this,"userData",{});E(this,"statsManager",s1);E(this,"_lumaData",{});E(this,"timestamp",0);this.props={...Du.defaultProps,...e},this.id=this.props.id||Da(this[Symbol.toStringTag].toLowerCase())}get[Symbol.toStringTag](){return"Device"}isTextureFormatCompressed(e){return qF(e)}loseDevice(){return!1}getCanvasContext(){if(!this.canvasContext)throw new Error("Device has no CanvasContext");return this.canvasContext}createTexture(e){return(e instanceof Promise||typeof e=="string")&&(e={data:e}),this._createTexture(e)}createCommandEncoder(e={}){throw new Error("not implemented")}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}_getBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};return(e.usage||0)&fn.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array?t.indexType="uint16":Re.warn("indices buffer content must be of integer type")()),t}};E(Du,"defaultProps",{id:null,canvas:null,container:null,manageState:!0,width:800,height:600,requestMaxLimits:!0,debug:!!Re.get("debug"),spector:!!(Re.get("spector")||Re.get("spectorjs")),break:[],initalizeFeatures:!0,disabledFeatures:{"compilation-status-async-webgl":!0},gl:null,onError:e=>Re.error(e.message)}),E(Du,"VERSION",zF);let Jl=Du;function Ht(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}const Gc=new Map,Fl=class Fl{static registerDevices(e){for(const t of e)Ht(t.type&&t.isSupported&&t.create),Gc.set(t.type,t)}static getAvailableDevices(){return Array.from(Gc).map(e=>e.type)}static getSupportedDevices(){return Array.from(Gc).filter(e=>e.isSupported()).map(e=>e.type)}static setDefaultDeviceProps(e){Object.assign(Jl.defaultProps,e)}static async attachDevice(e){const t=gw(e.devices)||Gc;if(e.handle instanceof WebGL2RenderingContext){const r=t.get("webgl");if(r)return await r.attach(e.handle)}if(e.handle===null){const r=t.get("unknown");if(r)return await r.attach(null)}throw new Error("Failed to attach device. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static async createDevice(e={}){var i,o;e={...Fl.defaultProps,...e},e.gl&&(e.type="webgl");const t=gw(e.devices)||Gc;let r,s;switch(e.type){case"webgpu":if(r=t.get("webgpu"),r)return await r.create(e);break;case"webgl":if(s=t.get("webgl"),s)return await s.create(e);break;case"unknown":const a=t.get("unknown");if(a)return await a.create(e);break;case"best-available":if(r=t.get("webgpu"),(i=r==null?void 0:r.isSupported)!=null&&i.call(r))return await r.create(e);if(s=t.get("webgl"),(o=s==null?void 0:s.isSupported)!=null&&o.call(s))return await s.create(e);break}throw new Error("No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static enforceWebGL2(e=!0){const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext){t.getContext=t.originalGetContext,t.originalGetContext=void 0;return}t.originalGetContext=t.getContext,t.getContext=function(r,s){return r==="webgl"||r==="experimental-webgl"?this.originalGetContext("webgl2",s):this.originalGetContext(r,s)}}};E(Fl,"defaultProps",{...Jl.defaultProps,type:"best-available",devices:void 0}),E(Fl,"stats",s1),E(Fl,"log",Re);let Bl=Fl;function gw(n){if(!n||(n==null?void 0:n.length)===0)return null;const e=new Map;for(const t of n)e.set(t.type,t);return e}const JF=Mo()&&typeof document<"u",ng=()=>JF&&document.readyState==="complete",e7={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,colorSpace:"srgb",alphaMode:"opaque"};class i1{constructor(e){E(this,"id");E(this,"props");E(this,"canvas");E(this,"htmlCanvas");E(this,"offscreenCanvas");E(this,"type");E(this,"width",1);E(this,"height",1);E(this,"resizeObserver");E(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});if(this.props={...e7,...e},e=this.props,!Mo()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=r7(e.canvas):this.canvas=e.canvas;else{const t=s7(e),r=n7((e==null?void 0:e.container)||null);r.insertBefore(t,r.firstChild),this.canvas=t,e!=null&&e.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(t=>{for(const r of t)r.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}static get isPageLoaded(){return ng()}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),t=this.canvas;return t.parentElement?[t.clientWidth*e,t.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,t]=this.getPixelSize();return e/t}cssToDeviceRatio(){var e;try{const[t]=this.getDrawingBufferSize(),r=this._canvasSizeInfo.clientWidth||((e=this.htmlCanvas)==null?void 0:e.clientWidth);return r?t/r:1}catch{return 1}}cssToDevicePixels(e,t=!0){const r=this.cssToDeviceRatio(),[s,i]=this.getDrawingBufferSize();return i7(e,r,s,i,t)}setDevicePixelRatio(e,t={}){if(!this.htmlCanvas)return;let r="width"in t?t.width:this.htmlCanvas.clientWidth,s="height"in t?t.height:this.htmlCanvas.clientHeight;(!r||!s)&&(Re.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=this.htmlCanvas.width||1,s=this.htmlCanvas.height||1);const i=this._canvasSizeInfo;if(i.clientWidth!==r||i.clientHeight!==s||i.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),u=Math.floor(s*o);this.htmlCanvas.width=a,this.htmlCanvas.height=u;const[f,d]=this.getDrawingBufferSize();(f!==a||d!==u)&&(o=Math.min(f/r,d/s),this.htmlCanvas.width=Math.floor(r*o),this.htmlCanvas.height=Math.floor(s*o),Re.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=r,this._canvasSizeInfo.clientHeight=s,this._canvasSizeInfo.devicePixelRatio=e}}getDrawingBufferSize(){const e=this.device.gl;if(!e)throw new Error("canvas size");return[e.drawingBufferWidth,e.drawingBufferHeight]}_setAutoCreatedCanvasId(e){var t;((t=this.htmlCanvas)==null?void 0:t.id)==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}}E(i1,"pageLoaded",t7());function t7(){return ng()||typeof window>"u"?Promise.resolve():new Promise(n=>{window.addEventListener("load",()=>n())})}function n7(n){if(typeof n=="string"){const e=document.getElementById(n);if(!e&&!ng())throw new Error(`Accessing '${n}' before page was loaded`);if(!e)throw new Error(`${n} is not an HTML element`);return e}else if(n)return n;return document.body}function r7(n){const e=document.getElementById(n);if(!e&&!ng())throw new Error(`Accessing '${n}' before page was loaded`);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function s7(n){const{width:e,height:t}=n,r=document.createElement("canvas");return r.id="lumagl-auto-created-canvas",r.width=e||1,r.height=t||1,r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",r}function i7(n,e,t,r,s){const i=n,o=mw(i[0],e,t);let a=vw(i[1],e,r,s),u=mw(i[0]+1,e,t);const f=u===t-1?u:u-1;u=vw(i[1]+1,e,r,s);let d;return s?(u=u===0?u:u+1,d=a,a=u):d=u===r-1?u:u-1,{x:o,y:a,width:Math.max(f-o+1,1),height:Math.max(d-a+1,1)}}function mw(n,e,t){return Math.min(Math.round(n*e),t-1)}function vw(n,e,t,r){return r?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const ci=class ci extends Bt{constructor(t,r,s=ci.defaultProps){super(t,r,s);E(this,"dimension");E(this,"format");E(this,"width");E(this,"height");E(this,"depth");E(this,"updateTimestamp");this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.updateTimestamp=t.incrementTimestamp()}get[Symbol.toStringTag](){return"Texture"}};E(ci,"defaultProps",{...Bt.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!0,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,type:void 0,sampler:{},view:void 0}),E(ci,"COPY_SRC",1),E(ci,"COPY_DST",2),E(ci,"TEXTURE_BINDING",4),E(ci,"STORAGE_BINDING",8),E(ci,"RENDER_ATTACHMENT",16);let Zr=ci;const Rp=class Rp extends Bt{get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,Rp.defaultProps)}};E(Rp,"defaultProps",{...Bt.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});let Yh=Rp;function o7(n,e,t){let r="";const s=e.split(/\r?\n/),i=n.slice().sort((o,a)=>o.lineNum-a.lineNum);switch((t==null?void 0:t.showSourceCode)||"no"){case"all":let o=0;for(let a=1;a<=s.length;a++)for(r+=Z4(s[a-1],a,t);i.length>o&&i[o].lineNum===a;){const u=i[o++];r+=yw(u,s,u.lineNum,{...t,inlineSource:!1})}return r;case"issues":case"no":for(const a of n)r+=yw(a,s,a.lineNum,{inlineSource:(t==null?void 0:t.showSourceCode)!=="no"});return r}}function yw(n,e,t,r){if(r!=null&&r.inlineSource){const s=a7(e,t),i=n.linePos>0?`${" ".repeat(n.linePos+5)}^^^
`:"";return`
${s}${i}${n.type.toUpperCase()}: ${n.message}

`}return r!=null&&r.html?`<div class='luma-compiler-log-error' style="color:red;"><b> ${n.type.toUpperCase()}: ${n.message}</b></div>`:`${n.type.toUpperCase()}: ${n.message}`}function a7(n,e,t){let r="";for(let s=e-2;s<=e;s++){const i=n[s-1];i!==void 0&&(r+=Z4(i,e,t))}return r}function Z4(n,e,t){const r=t!=null&&t.html?c7(n):n;return`${l7(String(e),4)}: ${r}${t!=null&&t.html?"<br/>":`
`}`}function l7(n,e){let t="";for(let r=n.length;r<e;++r)t+=" ";return t+n}function c7(n){return n.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function Q4(n,e){return{name:u7(n,e),language:"glsl",version:f7(n)}}function u7(n,e="unnamed"){const r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(n);return r?r[1]:e}function f7(n){let e=100;const t=n.match(/[^\s]+/g);if(t&&t.length>=2&&t[0]==="#version"){const r=parseInt(t[1],10);Number.isFinite(r)&&(e=r)}return e}const Pp=class Pp extends Bt{constructor(t,r){super(t,{id:d7(r),...r},Pp.defaultProps);E(this,"stage");E(this,"source");E(this,"compilationStatus","pending");this.stage=this.props.stage,this.source=this.props.source}get[Symbol.toStringTag](){return"Shader"}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(t=this.props.debug){switch(t){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();this.props.debug==="warnings"&&(r==null?void 0:r.length)===0||this._displayShaderLog(r)}_displayShaderLog(t){var f;if(typeof document>"u"||!(document!=null&&document.createElement))return;const r=Q4(this.source).name,s=`${this.stage} ${r}`;let i=o7(t,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(i+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);const a=document.createElement("Button");a.innerHTML=`
<h1>Shader Compilation Error in ${s}</h1><br /><br />
<code style="user-select:text;"><pre>
${i}
</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a);const u=document.getElementsByClassName("luma-compiler-log-error");(f=u[0])!=null&&f.scrollIntoView&&u[0].scrollIntoView(),a.onclick=()=>{const d=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(d)}}};E(Pp,"defaultProps",{...Bt.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debug:"errors"});let qh=Pp;function d7(n){return Q4(n.source).name||n.id||Da(`unnamed ${n.stage}-shader`)}const Ip=class Ip extends Bt{get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){super(e,t,Ip.defaultProps)}};E(Ip,"defaultProps",{...Bt.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});let Kh=Ip;const kp=class kp extends Bt{constructor(t,r={}){super(t,r,kp.defaultProps);E(this,"width");E(this,"height");E(this,"colorAttachments",[]);E(this,"depthStencilAttachment",null);this.width=this.props.width,this.height=this.props.height}get[Symbol.toStringTag](){return"Framebuffer"}resize(t){let r=!t;if(t){const[s,i]=Array.isArray(t)?t:[t.width,t.height];r=r||i!==this.height||s!==this.width,this.width=s,this.height=i}r&&(Re.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(r=>{if(typeof r=="string"){const s=this.createColorTexture(r);return this.attachResource(s),s.view}return r instanceof Zr?r.view:r});const t=this.props.depthStencilAttachment;if(t)if(typeof t=="string"){const r=this.createDepthStencilTexture(t);this.attachResource(r),this.depthStencilAttachment=r.view}else t instanceof Zr?this.depthStencilAttachment=t.view:this.depthStencilAttachment=t}createColorTexture(t){return this.device.createTexture({id:"color-attachment",usage:Zr.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height})}createDepthStencilTexture(t){return this.device.createTexture({id:"depth-stencil-attachment",usage:Zr.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height})}resizeAttachments(t,r){for(let s=0;s<this.colorAttachments.length;++s)if(this.colorAttachments[s]){const i=this.device._createTexture({...this.colorAttachments[s].props,width:t,height:r});this.destroyAttachedResource(this.colorAttachments[s]),this.colorAttachments[s]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){const s=this.device._createTexture({...this.depthStencilAttachment.props,width:t,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=s.view,this.attachResource(s)}}};E(kp,"defaultProps",{...Bt.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null});let Zh=kp;const Mp=class Mp extends Bt{constructor(t,r){super(t,r,Mp.defaultProps);E(this,"shaderLayout");E(this,"bufferLayout");E(this,"linkStatus","pending");E(this,"hash","");this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}get[Symbol.toStringTag](){return"RenderPipeline"}setUniformsWebGL(t){throw new Error("Use uniform blocks")}};E(Mp,"defaultProps",{...Bt.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}});let ec=Mp;const Op=class Op extends Bt{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){super(e,t,Op.defaultProps)}};E(Op,"defaultProps",{...Bt.defaultProps,framebuffer:null,parameters:void 0,clearColor:[0,0,0,0],clearDepth:1,clearStencil:0,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});let vy=Op;const Np=class Np extends Bt{constructor(t,r){super(t,r,Np.defaultProps);E(this,"hash","")}get[Symbol.toStringTag](){return"ComputePipeline"}};E(Np,"defaultProps",{...Bt.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});let Qh=Np;const Dp=class Dp extends Bt{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,Dp.defaultProps)}};E(Dp,"defaultProps",{...Bt.defaultProps,measureExecutionTime:void 0});let yy=Dp;const Lp=class Lp extends Bt{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,Lp.defaultProps)}};E(Lp,"defaultProps",{...Bt.defaultProps});let _y=Lp;function h7(n){const[e,t]=g7[n],r=e==="i32"||e==="u32",s=e!=="u32",i=m7[e]*t,o=p7(e,t);return{dataType:e,components:t,defaultVertexFormat:o,byteLength:i,integer:r,signed:s}}function p7(n,e){let t;switch(n){case"f32":t="float32";break;case"i32":t="sint32";break;case"u32":t="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?t:`${t}x${e}`}const g7={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},m7={f32:4,f16:2,i32:4,u32:4};function G4(n){let e;n.endsWith("-webgl")&&(n.replace("-webgl",""),e=!0);const[t,r]=n.split("x"),s=t,i=r?parseInt(r):1,o=q4(s),a={type:s,components:i,byteLength:o.byteLength*i,integer:o.integer,signed:o.signed,normalized:o.normalized};return e&&(a.webglOnly=!0),a}function J4(n,e){const t={};for(const r of n.attributes)t[r.name]=y7(n,e,r.name);return t}function v7(n,e,t=16){const r=J4(n,e),s=new Array(t).fill(null);for(const i of Object.values(r))s[i.location]=i;return s}function y7(n,e,t){const r=_7(n,t),s=x7(e,t);if(!r)return null;const i=h7(r.type),o=(s==null?void 0:s.vertexFormat)||i.defaultVertexFormat,a=G4(o);return{attributeName:(s==null?void 0:s.attributeName)||r.name,bufferName:(s==null?void 0:s.bufferName)||r.name,location:r.location,shaderType:r.type,shaderDataType:i.dataType,shaderComponents:i.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:i.integer,stepMode:(s==null?void 0:s.stepMode)||r.stepMode,byteOffset:(s==null?void 0:s.byteOffset)||0,byteStride:(s==null?void 0:s.byteStride)||0}}function _7(n,e){const t=n.attributes.find(r=>r.name===e);return t||Re.warn(`shader layout attribute "${e}" not present in shader`),t||null}function x7(n,e){b7(n);let t=w7(n,e);return t||(t=T7(n,e),t)?t:(Re.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function b7(n){for(const e of n)(e.attributes&&e.format||!e.attributes&&!e.format)&&Re.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function w7(n,e){for(const t of n)if(t.format&&t.name===e)return{attributeName:t.name,bufferName:e,stepMode:t.stepMode,vertexFormat:t.format,byteOffset:0,byteStride:t.byteStride||0};return null}function T7(n,e){var t;for(const r of n){let s=r.byteStride;if(typeof r.byteStride!="number")for(const o of r.attributes||[]){const a=G4(o.format);s+=a.byteLength}const i=(t=r.attributes)==null?void 0:t.find(o=>o.attribute===e);if(i)return{attributeName:i.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:s}}return null}function S7(n,e){const t={...n,attributes:n.attributes.map(r=>({...r}))};for(const r of(e==null?void 0:e.attributes)||[]){const s=t.attributes.find(i=>i.name===r.name);s?(s.type=r.type||s.type,s.stepMode=r.stepMode||s.stepMode):Re.warn(`shader layout attribute ${r.name} not present in shader`)}return t}const Fp=class Fp extends Bt{constructor(t,r){super(t,r,Fp.defaultProps);E(this,"maxVertexAttributes");E(this,"attributeInfos");E(this,"indexBuffer",null);E(this,"attributes");this.maxVertexAttributes=t.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=v7(r.renderPipeline.shaderLayout,r.renderPipeline.bufferLayout,this.maxVertexAttributes)}get[Symbol.toStringTag](){return"VertexArray"}setConstantWebGL(t,r){throw new Error("constant attributes not supported")}};E(Fp,"defaultProps",{...Bt.defaultProps,renderPipeline:null});let xy=Fp;const Bp=class Bp extends Bt{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,Bp.defaultProps)}};E(Bp,"defaultProps",{...Bt.defaultProps,layout:void 0,buffers:{}});let by=Bp;const Up=class Up extends Bt{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,Up.defaultProps)}};E(Up,"defaultProps",{...Bt.defaultProps,type:void 0,count:void 0});let wy=Up;const E7={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function A7(n){const e=E7[n];return Ht(n),e}function C7(n,e){switch(e){case 1:return n;case 2:return n+n%2;default:return n+(4-n%4)%4}}let Gd;function eA(n){return(!Gd||Gd.byteLength<n)&&(Gd=new ArrayBuffer(n)),Gd}function R7(n,e){const t=eA(n.BYTES_PER_ELEMENT*e);return new n(t,0,e)}function P7(n){const{target:e,source:t,start:r=0,count:s=1}=n,i=t.length,o=s*i;let a=0;for(let u=r;a<i;a++)e[u++]=t[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return n.target}const _w=1024;class I7{constructor(e){E(this,"layout",{});E(this,"byteLength");let t=0;for(const[s,i]of Object.entries(e)){const o=A7(i),{type:a,components:u}=o;t=C7(t,u);const f=t;t+=u,this.layout[s]={type:a,size:u,offset:f}}t+=(4-t%4)%4;const r=t*4;this.byteLength=Math.max(r,_w)}getData(e){const t=Math.max(this.byteLength,_w),r=eA(t),s={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[i,o]of Object.entries(e)){const a=this.layout[i];if(!a){Re.warn(`Supplied uniform value ${i} not present in uniform block layout`)();continue}const{type:u,size:f,offset:d}=a,p=s[u];if(f===1){if(typeof o!="number"&&typeof o!="boolean"){Re.warn(`Supplied value for single component uniform ${i} is not a number: ${o}`)();continue}p[d]=Number(o)}else{const m=Hu(o);if(!m){Re.warn(`Supplied value for multi component / array uniform ${i} is not a numeric array: ${o}`)();continue}p.set(m,d)}}return new Uint8Array(r)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function k7(n,e,t=16){if(n!==e)return!1;const r=Hu(n);if(!r)return!1;const s=Hu(e);if(s&&r.length===s.length){for(let i=0;i<r.length;++i)if(s[i]!==r[i])return!1}return!0}function M7(n){const e=Hu(n);return e?e.slice():n}class O7{constructor(e){E(this,"name");E(this,"uniforms",{});E(this,"modifiedUniforms",{});E(this,"modified",!0);E(this,"bindingLayout",{});E(this,"needsRedraw","initialized");var t;if(this.name=e==null?void 0:e.name,e!=null&&e.name&&(e!=null&&e.shaderLayout)){const r=(t=e==null?void 0:e.shaderLayout.bindings)==null?void 0:t.find(i=>i.type==="uniform"&&i.name===(e==null?void 0:e.name));if(!r)throw new Error(e==null?void 0:e.name);const s=r;for(const i of s.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(e){for(const[t,r]of Object.entries(e))this._setUniform(t,r),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${r}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){k7(this.uniforms[e],t)||(this.uniforms[e]=M7(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}class N7{constructor(e){E(this,"uniformBlocks",new Map);E(this,"uniformBufferLayouts",new Map);E(this,"uniformBuffers",new Map);for(const[t,r]of Object.entries(e)){const s=t,i=new I7(r.uniformTypes||{});this.uniformBufferLayouts.set(s,i);const o=new O7({name:t});o.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(s,o)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[t,r]of Object.entries(e))this.uniformBlocks.get(t).setUniforms(r);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e).byteLength}getUniformBufferData(e){const t=this.uniformBlocks.get(e).getAllUniforms();return this.uniformBufferLayouts.get(e).getData(t)}createUniformBuffer(e,t,r){r&&this.setUniforms(r);const s=this.getUniformBufferByteLength(t),i=e.createBuffer({usage:fn.UNIFORM|fn.COPY_DST,byteLength:s}),o=this.getUniformBufferData(t);return i.write(o),i}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const r=this.getUniformBufferByteLength(t),s=e.createBuffer({usage:fn.UNIFORM|fn.COPY_DST,byteLength:r});this.uniformBuffers.set(t,s)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const r=this.updateUniformBuffer(t);e||(e=r)}return e&&Re.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e),r=this.uniformBuffers.get(e);let s=!1;if(r&&t.needsRedraw){s||(s=t.needsRedraw);const i=this.getUniformBufferData(e);this.uniformBuffers.get(e).write(i);const a=this.uniformBlocks.get(e).getAllUniforms();Re.log(4,`Writing to uniform buffer ${String(e)}`,i,a)()}return s}}function tA(n){const e=ArrayBuffer.isView(n)?n.constructor:n;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function nA(n){switch(n){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(n)}}function D7(n,e,t){if(!e||e>4)throw new Error(`size ${e}`);const r=e;let s=tA(n);if(s==="uint8"&&t&&r===1)return"unorm8-webgl";if(s==="uint8"&&t&&r===3)return"unorm8x3-webgl";if(s==="uint8"||s==="sint8"){if(r===1||r===3)throw new Error(`size: ${e}`);return t&&(s=s.replace("int","norm")),`${s}x${r}`}if(s==="uint16"||s==="sint16"){if(r===1||r===3)throw new Error(`size: ${e}`);return t&&(s=s.replace("int","norm")),`${s}x${r}`}return r===1?s:`${s}x${r}`}function L7(n){return Hu(n)!==null||typeof n=="number"||typeof n=="boolean"}function o1(n){const e={bindings:{},uniforms:{}};return Object.keys(n).forEach(t=>{const r=n[t];L7(r)?e.uniforms[t]=r:e.bindings[t]=r}),e}function F7(n,e,t){const{removedProps:r={},deprecatedProps:s={},replacedProps:i={}}=t;for(const a in r)if(a in e){const f=r[a]?`${n}.${r[a]}`:"N/A";Re.removed(`${n}.${a}`,f)()}for(const a in s)if(a in e){const u=s[a];Re.deprecated(`${n}.${a}`,`${n}.${u}`)()}let o=null;for(const[a,u]of Object.entries(i))a in e&&(Re.deprecated(`${n}.${a}`,`${n}.${u}`)(),o=o||Object.assign({},e),o[u]=e[a],delete o[a]);return o||e}let B7="";async function U7(n,e){return await new Promise((t,r)=>{try{const s=new Image;s.onload=()=>t(s),s.onerror=()=>r(new Error(`Could not load image ${n}.`)),s.crossOrigin=(e==null?void 0:e.crossOrigin)||"anonymous",s.src=n.startsWith("http")?n:B7+n}catch(s){r(s)}})}async function rA(n,e){const t=document.getElementsByTagName("head")[0];if(!t)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",n),new Promise((s,i)=>{r.onload=s,r.onerror=o=>i(new Error(`Unable to load script '${n}': ${o}`)),t.appendChild(r)})}function Ty(n,e,t){if(n===e)return!0;if(!t||!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!Ty(n[r],e[r],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const r=Object.keys(n),s=Object.keys(e);if(r.length!==s.length)return!1;for(const i of r)if(!e.hasOwnProperty(i)||!Ty(n[i],e[i],t-1))return!1;return!0}return!1}function V7(n){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}function z7(n){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}class Jr{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}getTypeName(){return this.name}}class xw{constructor(e,t,r){this.name=e,this.type=t,this.attributes=r,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class ho extends Jr{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class yo extends Jr{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}}class wa extends Jr{constructor(e,t,r,s){super(e,r),this.format=t,this.access=s}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var io;(n=>{n[n.Uniform=0]="Uniform",n[n.Storage=1]="Storage",n[n.Texture=2]="Texture",n[n.Sampler=3]="Sampler",n[n.StorageTexture=4]="StorageTexture"})(io||(io={}));class Jd{constructor(e,t,r,s,i,o,a){this.name=e,this.type=t,this.group=r,this.binding=s,this.attributes=i,this.resourceType=o,this.access=a}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class $7{constructor(e,t){this.name=e,this.type=t}}class j7{constructor(e,t,r,s){this.name=e,this.type=t,this.locationType=r,this.location=s,this.interpolation=null}}class bw{constructor(e,t,r,s){this.name=e,this.type=t,this.locationType=r,this.location=s}}class W7{constructor(e,t,r,s){this.name=e,this.type=t,this.attributes=r,this.id=s}}class H7{constructor(e,t,r){this.name=e,this.type=t,this.attributes=r}}class X7{constructor(e,t=null,r){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=r}}class Y7{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}const sA=new Float32Array(1),q7=new Int32Array(sA.buffer),qn=new Uint16Array(1);function K7(n){sA[0]=n;const e=q7[0],t=e>>31&1;let r=e>>23&255,s=8388607&e;if(r===255)return qn[0]=t<<15|31744|(s!==0?512:0),qn[0];if(r===0){if(s===0)return qn[0]=t<<15,qn[0];s|=8388608;let i=113;for(;!(8388608&s);)s<<=1,i--;return r=127-i,s&=8388607,r>0?(s=(s>>126-r)+(s>>127-r&1),qn[0]=t<<15|r<<10|s>>13,qn[0]):(qn[0]=t<<15,qn[0])}return r=r-127+15,r>=31?(qn[0]=t<<15|31744,qn[0]):r<=0?r<-10?(qn[0]=t<<15,qn[0]):(s=(8388608|s)>>1-r,qn[0]=t<<15|s>>13,qn[0]):(s>>=13,qn[0]=t<<15|r<<10|s,qn[0])}const a1=new Uint32Array(1),iA=new Float32Array(a1.buffer,0,1);function ww(n){const e=112+(n>>6&31)<<23|(63&n)<<17;return a1[0]=e,iA[0]}function Z7(n,e,t,r,s,i,o,a,u){const f=r*(o>>=s)*(i>>=s)+t*o+e*a;switch(u){case"r8unorm":return[Tt(n,f,"8unorm",1)[0]];case"r8snorm":return[Tt(n,f,"8snorm",1)[0]];case"r8uint":return[Tt(n,f,"8uint",1)[0]];case"r8sint":return[Tt(n,f,"8sint",1)[0]];case"rg8unorm":{const d=Tt(n,f,"8unorm",2);return[d[0],d[1]]}case"rg8snorm":{const d=Tt(n,f,"8snorm",2);return[d[0],d[1]]}case"rg8uint":{const d=Tt(n,f,"8uint",2);return[d[0],d[1]]}case"rg8sint":{const d=Tt(n,f,"8sint",2);return[d[0],d[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const d=Tt(n,f,"8unorm",4);return[d[0],d[1],d[2],d[3]]}case"rgba8snorm":{const d=Tt(n,f,"8snorm",4);return[d[0],d[1],d[2],d[3]]}case"rgba8uint":{const d=Tt(n,f,"8uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba8sint":{const d=Tt(n,f,"8sint",4);return[d[0],d[1],d[2],d[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const d=Tt(n,f,"8unorm",4);return[d[2],d[1],d[0],d[3]]}case"r16uint":return[Tt(n,f,"16uint",1)[0]];case"r16sint":return[Tt(n,f,"16sint",1)[0]];case"r16float":return[Tt(n,f,"16float",1)[0]];case"rg16uint":{const d=Tt(n,f,"16uint",2);return[d[0],d[1]]}case"rg16sint":{const d=Tt(n,f,"16sint",2);return[d[0],d[1]]}case"rg16float":{const d=Tt(n,f,"16float",2);return[d[0],d[1]]}case"rgba16uint":{const d=Tt(n,f,"16uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba16sint":{const d=Tt(n,f,"16sint",4);return[d[0],d[1],d[2],d[3]]}case"rgba16float":{const d=Tt(n,f,"16float",4);return[d[0],d[1],d[2],d[3]]}case"r32uint":return[Tt(n,f,"32uint",1)[0]];case"r32sint":return[Tt(n,f,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[Tt(n,f,"32float",1)[0]];case"rg32uint":{const d=Tt(n,f,"32uint",2);return[d[0],d[1]]}case"rg32sint":{const d=Tt(n,f,"32sint",2);return[d[0],d[1]]}case"rg32float":{const d=Tt(n,f,"32float",2);return[d[0],d[1]]}case"rgba32uint":{const d=Tt(n,f,"32uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba32sint":{const d=Tt(n,f,"32sint",4);return[d[0],d[1],d[2],d[3]]}case"rgba32float":{const d=Tt(n,f,"32float",4);return[d[0],d[1],d[2],d[3]]}case"rg11b10ufloat":{const d=new Uint32Array(n.buffer,f,1)[0],p=(4192256&d)>>11,m=(4290772992&d)>>22;return[ww(2047&d),ww(p),function(v){const x=112+(v>>5&31)<<23|(31&v)<<18;return a1[0]=x,iA[0]}(m),1]}}return null}function Tt(n,e,t,r){const s=[0,0,0,0];for(let f=0;f<r;++f)switch(t){case"8unorm":s[f]=n[e]/255,e++;break;case"8snorm":s[f]=n[e]/255*2-1,e++;break;case"8uint":s[f]=n[e],e++;break;case"8sint":s[f]=n[e]-127,e++;break;case"16uint":s[f]=n[e]|n[e+1]<<8,e+=2;break;case"16sint":s[f]=(n[e]|n[e+1]<<8)-32768,e+=2;break;case"16float":s[f]=(i=n[e]|n[e+1]<<8,o=void 0,a=void 0,u=void 0,o=(32768&i)>>15,u=1023&i,(a=(31744&i)>>10)==0?(o?-1:1)*Math.pow(2,-14)*(u/Math.pow(2,10)):a==31?u?NaN:1/0*(o?-1:1):(o?-1:1)*Math.pow(2,a-15)*(1+u/Math.pow(2,10))),e+=2;break;case"32uint":case"32sint":s[f]=n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24,e+=4;break;case"32float":s[f]=new Float32Array(n.buffer,e,1)[0],e+=4}var i,o,a,u;return s}function It(n,e,t,r,s){for(let i=0;i<r;++i)switch(t){case"8unorm":n[e]=255*s[i],e++;break;case"8snorm":n[e]=.5*(s[i]+1)*255,e++;break;case"8uint":n[e]=s[i],e++;break;case"8sint":n[e]=s[i]+127,e++;break;case"16uint":new Uint16Array(n.buffer,e,1)[0]=s[i],e+=2;break;case"16sint":new Int16Array(n.buffer,e,1)[0]=s[i],e+=2;break;case"16float":{const o=K7(s[i]);new Uint16Array(n.buffer,e,1)[0]=o,e+=2;break}case"32uint":new Uint32Array(n.buffer,e,1)[0]=s[i],e+=4;break;case"32sint":new Int32Array(n.buffer,e,1)[0]=s[i],e+=4;break;case"32float":new Float32Array(n.buffer,e,1)[0]=s[i],e+=4}return s}const H0={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class rs{constructor(){this.id=rs._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(Gh.instance);for(const r of e)r instanceof Array?this.searchBlock(r,t):r.search(t);t(Jh.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}rs._id=0;class Gh extends rs{}Gh.instance=new Gh;class Jh extends rs{}Jh.instance=new Jh;const oA=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class en extends rs{constructor(){super()}}class Xu extends en{constructor(e,t,r,s,i,o){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=r,this.body=s,this.startLine=i,this.endLine=o}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}}class Q7 extends en{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class aA extends en{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Sy extends en{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class lA extends en{constructor(e,t,r,s){super(),this.init=e,this.condition=t,this.increment=r,this.body=s}get astNodeType(){return"for"}search(e){var t,r,s;(t=this.init)===null||t===void 0||t.search(e),(r=this.condition)===null||r===void 0||r.search(e),(s=this.increment)===null||s===void 0||s.search(e),this.searchBlock(this.body,e)}}class di extends en{constructor(e,t,r,s,i){super(),this.attributes=null,this.name=e,this.type=t,this.storage=r,this.access=s,this.value=i}get astNodeType(){return"var"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}class l1 extends en{constructor(e,t,r){super(),this.attributes=null,this.name=e,this.type=t,this.value=r}get astNodeType(){return"override"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}}class Ru extends en{constructor(e,t,r,s,i){super(),this.attributes=null,this.name=e,this.type=t,this.storage=r,this.access=s,this.value=i}get astNodeType(){return"let"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}class bh extends en{constructor(e,t,r,s,i){super(),this.attributes=null,this.name=e,this.type=t,this.storage=r,this.access=s,this.value=i}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}var Pl,du,ie,J;(n=>{n.increment="++",n.decrement="--"})(Pl||(Pl={})),(n=>{n.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for IncrementOperator");return n[t]}})(Pl||(Pl={}));class cA extends en{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(n=>{n.assign="=",n.addAssign="+=",n.subtractAssin="-=",n.multiplyAssign="*=",n.divideAssign="/=",n.moduloAssign="%=",n.andAssign="&=",n.orAssign="|=",n.xorAssign="^=",n.shiftLeftAssign="<<=",n.shiftRightAssign=">>="})(du||(du={})),(n=>{n.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for AssignOperator");return t}})(du||(du={}));class uA extends en{constructor(e,t,r){super(),this.operator=e,this.variable=t,this.value=r}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class c1 extends en{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return oA.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}}class fA extends en{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}}class dA extends en{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}}class hA extends en{constructor(e,t,r,s){super(),this.condition=e,this.body=t,this.elseif=r,this.else=s}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class pA extends en{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}}class G7 extends en{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class J7 extends en{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class gA extends en{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class u1 extends en{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class eB extends en{constructor(){super()}get astNodeType(){return"discard"}}class mA extends en{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class vA extends en{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class me extends en{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let t=e[0];if(t.name==="f32")return t;for(let r=1;r<e.length;++r){const s=me._priority.get(t.name);me._priority.get(e[r].name)<s&&(t=e[r])}return t.name==="x32"?me.i32:t}getTypeName(){return this.name}}me.x32=new me("x32"),me.f32=new me("f32"),me.i32=new me("i32"),me.u32=new me("u32"),me.f16=new me("f16"),me.bool=new me("bool"),me.void=new me("void"),me._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Tw extends me{constructor(e){super(e)}}class ui extends me{constructor(e,t,r,s){super(e),this.members=t,this.startLine=r,this.endLine=s}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}}class ne extends me{constructor(e,t,r){super(e),this.format=t,this.access=r}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}ne.vec2f=new ne("vec2",me.f32,null),ne.vec3f=new ne("vec3",me.f32,null),ne.vec4f=new ne("vec4",me.f32,null),ne.vec2i=new ne("vec2",me.i32,null),ne.vec3i=new ne("vec3",me.i32,null),ne.vec4i=new ne("vec4",me.i32,null),ne.vec2u=new ne("vec2",me.u32,null),ne.vec3u=new ne("vec3",me.u32,null),ne.vec4u=new ne("vec4",me.u32,null),ne.vec2h=new ne("vec2",me.f16,null),ne.vec3h=new ne("vec3",me.f16,null),ne.vec4h=new ne("vec4",me.f16,null),ne.vec2b=new ne("vec2",me.bool,null),ne.vec3b=new ne("vec3",me.bool,null),ne.vec4b=new ne("vec4",me.bool,null),ne.mat2x2f=new ne("mat2x2",me.f32,null),ne.mat2x3f=new ne("mat2x3",me.f32,null),ne.mat2x4f=new ne("mat2x4",me.f32,null),ne.mat3x2f=new ne("mat3x2",me.f32,null),ne.mat3x3f=new ne("mat3x3",me.f32,null),ne.mat3x4f=new ne("mat3x4",me.f32,null),ne.mat4x2f=new ne("mat4x2",me.f32,null),ne.mat4x3f=new ne("mat4x3",me.f32,null),ne.mat4x4f=new ne("mat4x4",me.f32,null),ne.mat2x2h=new ne("mat2x2",me.f16,null),ne.mat2x3h=new ne("mat2x3",me.f16,null),ne.mat2x4h=new ne("mat2x4",me.f16,null),ne.mat3x2h=new ne("mat3x2",me.f16,null),ne.mat3x3h=new ne("mat3x3",me.f16,null),ne.mat3x4h=new ne("mat3x4",me.f16,null),ne.mat4x2h=new ne("mat4x2",me.f16,null),ne.mat4x3h=new ne("mat4x3",me.f16,null),ne.mat4x4h=new ne("mat4x4",me.f16,null),ne.mat2x2i=new ne("mat2x2",me.i32,null),ne.mat2x3i=new ne("mat2x3",me.i32,null),ne.mat2x4i=new ne("mat2x4",me.i32,null),ne.mat3x2i=new ne("mat3x2",me.i32,null),ne.mat3x3i=new ne("mat3x3",me.i32,null),ne.mat3x4i=new ne("mat3x4",me.i32,null),ne.mat4x2i=new ne("mat4x2",me.i32,null),ne.mat4x3i=new ne("mat4x3",me.i32,null),ne.mat4x4i=new ne("mat4x4",me.i32,null),ne.mat2x2u=new ne("mat2x2",me.u32,null),ne.mat2x3u=new ne("mat2x3",me.u32,null),ne.mat2x4u=new ne("mat2x4",me.u32,null),ne.mat3x2u=new ne("mat3x2",me.u32,null),ne.mat3x3u=new ne("mat3x3",me.u32,null),ne.mat3x4u=new ne("mat3x4",me.u32,null),ne.mat4x2u=new ne("mat4x2",me.u32,null),ne.mat4x3u=new ne("mat4x3",me.u32,null),ne.mat4x4u=new ne("mat4x4",me.u32,null);class X0 extends me{constructor(e,t,r,s){super(e),this.storage=t,this.type=r,this.access=s}get astNodeType(){return"pointer"}}class Pu extends me{constructor(e,t,r,s){super(e),this.attributes=t,this.format=r,this.count=s}get astNodeType(){return"array"}get isArray(){return!0}}class hu extends me{constructor(e,t,r){super(e),this.format=t,this.access=r}get astNodeType(){return"sampler"}}class qs extends rs{constructor(){super(),this.postfix=null}}class Ta extends qs{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class Bs extends qs{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}}class f1 extends qs{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return oA.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}}class Lr extends qs{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}}class yA extends qs{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const r=e.evalExpression(this.initializer,e.context);return r!==null&&this.postfix?r.getSubData(e,this.postfix,e.context):r}return null}search(e){this.initializer.search(e)}}class Cn extends qs{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return t!==void 0&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof G}get isVector(){return this.value instanceof V||this.value instanceof Ze}get scalarValue(){return this.value instanceof G?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof V||this.value instanceof Ze?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class _A extends qs{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class tc extends qs{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class xA extends qs{constructor(){super()}}class _n extends xA{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class gs extends xA{constructor(e,t,r){super(),this.operator=e,this.left=t,this.right=r}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:e.name==="f32"||t.name==="f32"?me.f32:e.name==="u32"||t.name==="u32"?me.u32:me.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class bA extends rs{constructor(e){super(),this.body=e}}class wh extends qs{constructor(){super()}get astNodeType(){return"default"}}class wA extends bA{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class TA extends bA{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class Sw extends rs{constructor(e,t,r){super(),this.name=e,this.type=t,this.attributes=r}get astNodeType(){return"argument"}}class tB extends rs{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Ew extends rs{constructor(e,t,r){super(),this.name=e,this.type=t,this.attributes=r}get astNodeType(){return"member"}}class SA extends rs{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}class ns{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=ns._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,t,r,s){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,t,r){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.name}>`}}ns._id=0;class Ey extends ns{constructor(){super(new Jr("void",null),null)}toString(){return"void"}}Ey.void=new Ey;class _l extends ns{constructor(e){super(new Jr("pointer",null),null),this.reference=e}clone(){return this}setDataValue(e,t,r,s){this.reference.setDataValue(e,t,r,s)}getSubData(e,t,r){return t?this.reference.getSubData(e,t,r):this}}class G extends ns{constructor(e,t,r=null){super(t,r),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!=0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",t)}clone(){if(this.data instanceof Float32Array)return new G(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new G(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new G(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,t,r,s){if(r)return void console.error("SetDataValue: Scalar data does not support postfix",r);if(!(t instanceof G))return void console.error("SetDataValue: Invalid value",t);let i=t.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?i=Math.floor(i):this.typeInfo.name==="bool"&&(i=i?1:0),this.data[0]=i}getSubData(e,t,r){return t?(console.error("getSubData: Scalar data does not support postfix",t),null):this}toString(){return`${this.value}`}}function nB(n,e,t){const r=e.length;return r===2?t==="f32"?new V(new Float32Array(e),n.getTypeInfo("vec2f")):t==="i32"||t==="bool"?new V(new Int32Array(e),n.getTypeInfo("vec2i")):t==="u32"?new V(new Uint32Array(e),n.getTypeInfo("vec2u")):t==="f16"?new V(new Float32Array(e),n.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${t}`),null):r===3?t==="f32"?new V(new Float32Array(e),n.getTypeInfo("vec3f")):t==="i32"||t==="bool"?new V(new Int32Array(e),n.getTypeInfo("vec3i")):t==="u32"?new V(new Uint32Array(e),n.getTypeInfo("vec3u")):t==="f16"?new V(new Float32Array(e),n.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${t}`),null):r===4?t==="f32"?new V(new Float32Array(e),n.getTypeInfo("vec4f")):t==="i32"||t==="bool"?new V(new Int32Array(e),n.getTypeInfo("vec4i")):t==="u32"?new V(new Uint32Array(e),n.getTypeInfo("vec4u")):t==="f16"?new V(new Float32Array(e),n.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${t}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class V extends ns{constructor(e,t,r=null){if(super(t,r),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const s=this.typeInfo.name;s==="vec2f"||s==="vec3f"||s==="vec4f"?this.data=new Float32Array(e):s==="vec2i"||s==="vec3i"||s==="vec4i"?this.data=new Int32Array(e):s==="vec2u"||s==="vec3u"||s==="vec4u"?this.data=new Uint32Array(e):s==="vec2h"||s==="vec3h"||s==="vec4h"?this.data=new Float32Array(e):s==="vec2b"||s==="vec3b"||s==="vec4b"?this.data=new Int32Array(e):s==="vec2"||s==="vec3"||s==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${s}`)}}clone(){if(this.data instanceof Float32Array)return new V(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new V(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new V(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,t,r,s){r instanceof Ta?console.error("TODO: Set vector postfix"):t instanceof V?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,r){if(t===null)return this;let s=e.getTypeInfo("f32");if(this.typeInfo instanceof wa)s=this.typeInfo.format||s;else{const o=this.typeInfo.name;o==="vec2f"||o==="vec3f"||o==="vec4f"?s=e.getTypeInfo("f32"):o==="vec2i"||o==="vec3i"||o==="vec4i"?s=e.getTypeInfo("i32"):o==="vec2b"||o==="vec3b"||o==="vec4b"?s=e.getTypeInfo("bool"):o==="vec2u"||o==="vec3u"||o==="vec4u"?s=e.getTypeInfo("u32"):o==="vec2h"||o==="vec3h"||o==="vec4h"?s=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${o}`)}let i=this;for(;t!==null&&i!==null;){if(t instanceof tc){const o=t.index;let a=-1;if(o instanceof Cn){if(!(o.value instanceof G))return console.error(`GetSubData: Invalid array index ${o.value}`),null;a=o.value.value}else{const u=e.evalExpression(o,r);if(!(u instanceof G))return console.error("GetSubData: Unknown index type",o),null;a=u.value}if(a<0||a>=i.data.length)return console.error("GetSubData: Index out of range",a),null;if(i.data instanceof Float32Array){const u=new Float32Array(i.data.buffer,i.data.byteOffset+4*a,1);return new G(u,s)}if(i.data instanceof Int32Array){const u=new Int32Array(i.data.buffer,i.data.byteOffset+4*a,1);return new G(u,s)}if(i.data instanceof Uint32Array){const u=new Uint32Array(i.data.buffer,i.data.byteOffset+4*a,1);return new G(u,s)}throw"GetSubData: Invalid data type"}if(!(t instanceof Ta))return console.error("GetSubData: Unknown postfix",t),null;{const o=t.value.toLowerCase();if(o.length===1){let u=0;if(o==="x"||o==="r")u=0;else if(o==="y"||o==="g")u=1;else if(o==="z"||o==="b")u=2;else{if(o!=="w"&&o!=="a")return console.error(`GetSubData: Unknown member ${o}`),null;u=3}if(this.data instanceof Float32Array){let f=new Float32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new G(f,s,this)}if(this.data instanceof Int32Array){let f=new Int32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new G(f,s,this)}if(this.data instanceof Uint32Array){let f=new Uint32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new G(f,s,this)}}const a=[];for(const u of o)u==="x"||u==="r"?a.push(this.data[0]):u==="y"||u==="g"?a.push(this.data[1]):u==="z"||u==="b"?a.push(this.data[2]):u==="w"||u==="a"?a.push(this.data[3]):console.error(`GetDataValue: Unknown member ${u}`);i=nB(e,a,s.name)}t=t.postfix}return i}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class Ze extends ns{constructor(e,t,r=null){super(t,r),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ze(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,t,r,s){r instanceof Ta?console.error("TODO: Set matrix postfix"):t instanceof Ze?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,r){if(t===null)return this;const s=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof wa)this.typeInfo.format;else if(s.endsWith("f"))e.getTypeInfo("f32");else if(s.endsWith("i"))e.getTypeInfo("i32");else if(s.endsWith("u"))e.getTypeInfo("u32");else{if(!s.endsWith("h"))return console.error(`GetDataValue: Unknown type ${s}`),null;e.getTypeInfo("f16")}if(t instanceof tc){const i=t.index;let o=-1;if(i instanceof Cn){if(!(i.value instanceof G))return console.error(`GetDataValue: Invalid array index ${i.value}`),null;o=i.value.value}else{const f=e.evalExpression(i,r);if(!(f instanceof G))return console.error("GetDataValue: Unknown index type",i),null;o=f.value}if(o<0||o>=this.data.length)return console.error("GetDataValue: Index out of range",o),null;const a=s.endsWith("h")?"h":"f";let u;if(s==="mat2x2"||s==="mat2x2f"||s==="mat2x2h"||s==="mat3x2"||s==="mat3x2f"||s==="mat3x2h"||s==="mat4x2"||s==="mat4x2f"||s==="mat4x2h")u=new V(new Float32Array(this.data.buffer,this.data.byteOffset+2*o*4,2),e.getTypeInfo(`vec2${a}`));else if(s==="mat2x3"||s==="mat2x3f"||s==="mat2x3h"||s==="mat3x3"||s==="mat3x3f"||s==="mat3x3h"||s==="mat4x3"||s==="mat4x3f"||s==="mat4x3h")u=new V(new Float32Array(this.data.buffer,this.data.byteOffset+3*o*4,3),e.getTypeInfo(`vec3${a}`));else{if(s!=="mat2x4"&&s!=="mat2x4f"&&s!=="mat2x4h"&&s!=="mat3x4"&&s!=="mat3x4f"&&s!=="mat3x4h"&&s!=="mat4x4"&&s!=="mat4x4f"&&s!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${s}`),null;u=new V(new Float32Array(this.data.buffer,this.data.byteOffset+4*o*4,4),e.getTypeInfo(`vec4${a}`))}return t.postfix?u.getSubData(e,t.postfix,r):u}return console.error("GetDataValue: Invalid postfix",t),null}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class ln extends ns{constructor(e,t,r=0,s=null){super(t,s),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=r}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new ln(e.buffer,this.typeInfo,0,null)}setDataValue(e,t,r,s){if(t===null)return void console.log("setDataValue: NULL data.");let i=this.offset,o=this.typeInfo;for(;r;){if(r instanceof tc)if(o instanceof yo){const a=r.index;if(a instanceof Cn){if(!(a.value instanceof G))return void console.error(`SetDataValue: Invalid index type ${a.value}`);i+=a.value.value*o.stride}else{const u=e.evalExpression(a,s);if(!(u instanceof G))return void console.error("SetDataValue: Unknown index type",a);i+=u.value*o.stride}o=o.format}else console.error(`SetDataValue: Type ${o.getTypeName()} is not an array`);else{if(!(r instanceof Ta))return void console.error("SetDataValue: Unknown postfix type",r);{const a=r.value;if(o instanceof ho){let u=!1;for(const f of o.members)if(f.name===a){i+=f.offset,o=f.type,u=!0;break}if(!u)return void console.error(`SetDataValue: Member ${a} not found`)}else if(o instanceof Jr){const u=o.getTypeName();let f=0;if(a==="x"||a==="r")f=0;else if(a==="y"||a==="g")f=1;else if(a==="z"||a==="b")f=2;else{if(a!=="w"&&a!=="a")return void console.error(`SetDataValue: Unknown member ${a}`);f=3}if(!(t instanceof G))return void console.error("SetDataValue: Invalid value",t);const d=t.value;return u==="vec2f"?void(new Float32Array(this.buffer,i,2)[f]=d):u==="vec3f"?void(new Float32Array(this.buffer,i,3)[f]=d):u==="vec4f"?void(new Float32Array(this.buffer,i,4)[f]=d):u==="vec2i"?void(new Int32Array(this.buffer,i,2)[f]=d):u==="vec3i"?void(new Int32Array(this.buffer,i,3)[f]=d):u==="vec4i"?void(new Int32Array(this.buffer,i,4)[f]=d):u==="vec2u"?void(new Uint32Array(this.buffer,i,2)[f]=d):u==="vec3u"?void(new Uint32Array(this.buffer,i,3)[f]=d):u==="vec4u"?void(new Uint32Array(this.buffer,i,4)[f]=d):void console.error(`SetDataValue: Type ${u} is not a struct`)}}}r=r.postfix}this.setData(e,t,o,i,s)}setData(e,t,r,s,i){const o=r.getTypeName();if(o!=="f32"&&o!=="f16")if(o!=="i32"&&o!=="atomic<i32>"&&o!=="x32")if(o!=="u32"&&o!=="atomic<u32>")if(o!=="bool")if(o!=="vec2f"&&o!=="vec2h")if(o!=="vec3f"&&o!=="vec3h")if(o!=="vec4f"&&o!=="vec4h")if(o!=="vec2i")if(o!=="vec3i")if(o!=="vec4i")if(o!=="vec2u")if(o!=="vec3u")if(o!=="vec4u")if(o!=="vec2b")if(o!=="vec3b")if(o!=="vec4b")if(o!=="mat2x2f"&&o!=="mat2x2h")if(o!=="mat2x3f"&&o!=="mat2x3h")if(o!=="mat2x4f"&&o!=="mat2x4h")if(o!=="mat3x2f"&&o!=="mat3x2h")if(o!=="mat3x3f"&&o!=="mat3x3h")if(o!=="mat3x4f"&&o!=="mat3x4h")if(o!=="mat4x2f"&&o!=="mat4x2h")if(o!=="mat4x3f"&&o!=="mat4x3h")if(o!=="mat4x4f"&&o!=="mat4x4h")if(t instanceof ln){if(r===t.typeInfo)return void new Uint8Array(this.buffer,s,t.buffer.byteLength).set(new Uint8Array(t.buffer));console.error("SetDataValue: Type mismatch",o,t.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${o}`);else{const a=new Float32Array(this.buffer,s,16);t instanceof Ze?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7],a[8]=t.data[8],a[9]=t.data[9],a[10]=t.data[10],a[11]=t.data[11],a[12]=t.data[12],a[13]=t.data[13],a[14]=t.data[14],a[15]=t.data[15]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15])}else{const a=new Float32Array(this.buffer,s,12);t instanceof Ze?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7],a[8]=t.data[8],a[9]=t.data[9],a[10]=t.data[10],a[11]=t.data[11]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11])}else{const a=new Float32Array(this.buffer,s,8);t instanceof Ze?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7])}else{const a=new Float32Array(this.buffer,s,12);t instanceof Ze?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7],a[8]=t.data[8],a[9]=t.data[9],a[10]=t.data[10],a[11]=t.data[11]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11])}else{const a=new Float32Array(this.buffer,s,9);t instanceof Ze?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7],a[8]=t.data[8]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8])}else{const a=new Float32Array(this.buffer,s,6);t instanceof Ze?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5])}else{const a=new Float32Array(this.buffer,s,8);t instanceof Ze?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7])}else{const a=new Float32Array(this.buffer,s,6);t instanceof Ze?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5])}else{const a=new Float32Array(this.buffer,s,4);t instanceof Ze?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3])}else{const a=new Uint32Array(this.buffer,s,4);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3])}else{const a=new Uint32Array(this.buffer,s,3);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2]):(a[0]=t[0],a[1]=t[1],a[2]=t[2])}else{const a=new Uint32Array(this.buffer,s,2);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1]):(a[0]=t[0],a[1]=t[1])}else{const a=new Uint32Array(this.buffer,s,4);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3])}else{const a=new Uint32Array(this.buffer,s,3);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2]):(a[0]=t[0],a[1]=t[1],a[2]=t[2])}else{const a=new Uint32Array(this.buffer,s,2);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1]):(a[0]=t[0],a[1]=t[1])}else{const a=new Int32Array(this.buffer,s,4);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3])}else{const a=new Int32Array(this.buffer,s,3);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2]):(a[0]=t[0],a[1]=t[1],a[2]=t[2])}else{const a=new Int32Array(this.buffer,s,2);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1]):(a[0]=t[0],a[1]=t[1])}else{const a=new Float32Array(this.buffer,s,4);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3])}else{const a=new Float32Array(this.buffer,s,3);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2]):(a[0]=t[0],a[1]=t[1],a[2]=t[2])}else{const a=new Float32Array(this.buffer,s,2);t instanceof V?(a[0]=t.data[0],a[1]=t.data[1]):(a[0]=t[0],a[1]=t[1])}else t instanceof G&&(new Int32Array(this.buffer,s,1)[0]=t.value);else t instanceof G&&(new Uint32Array(this.buffer,s,1)[0]=t.value);else t instanceof G&&(new Int32Array(this.buffer,s,1)[0]=t.value);else t instanceof G&&(new Float32Array(this.buffer,s,1)[0]=t.value)}getSubData(e,t,r){var s,i,o;if(t===null)return this;let a=this.offset,u=this.typeInfo;for(;t;){if(t instanceof tc){const d=t.index,p=e.evalExpression(d,r);let m=0;if(p instanceof G?m=p.value:console.error("GetDataValue: Invalid index type",d),u instanceof yo)a+=m*u.stride,u=u.format;else{const v=u.getTypeName();v==="mat4x4"||v==="mat4x4f"||v==="mat4x4h"?(a+=16*m,u=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${u.getTypeName()} is not an array`)}}else{if(!(t instanceof Ta))return console.error("GetDataValue: Unknown postfix type",t),null;{const d=t.value;if(u instanceof ho){let p=!1;for(const m of u.members)if(m.name===d){a+=m.offset,u=m.type,p=!0;break}if(!p)return console.error(`GetDataValue: Member ${d} not found`),null}else if(u instanceof Jr){const p=u.getTypeName();if(p==="vec2f"||p==="vec3f"||p==="vec4f"||p==="vec2i"||p==="vec3i"||p==="vec4i"||p==="vec2u"||p==="vec3u"||p==="vec4u"||p==="vec2b"||p==="vec3b"||p==="vec4b"||p==="vec2h"||p==="vec3h"||p==="vec4h"||p==="vec2"||p==="vec3"||p==="vec4"){if(d.length>0&&d.length<5){let m="f";const v=[];for(let x=0;x<d.length;++x){const b=d[x].toLowerCase();let w=0;if(b==="x"||b==="r")w=0;else if(b==="y"||b==="g")w=1;else if(b==="z"||b==="b")w=2;else{if(b!=="w"&&b!=="a")return console.error(`Unknown member ${d}`),null;w=3}if(d.length===1){if(p.endsWith("f"))return this.buffer.byteLength<a+4*w+4?(console.log("Insufficient buffer data"),null):new G(new Float32Array(this.buffer,a+4*w,1),e.getTypeInfo("f32"),this);if(p.endsWith("h"))return new G(new Float32Array(this.buffer,a+4*w,1),e.getTypeInfo("f16"),this);if(p.endsWith("i"))return new G(new Int32Array(this.buffer,a+4*w,1),e.getTypeInfo("i32"),this);if(p.endsWith("b"))return new G(new Int32Array(this.buffer,a+4*w,1),e.getTypeInfo("bool"),this);if(p.endsWith("u"))return new G(new Uint32Array(this.buffer,a+4*w,1),e.getTypeInfo("i32"),this)}if(p==="vec2f")v.push(new Float32Array(this.buffer,a,2)[w]);else if(p==="vec3f"){if(a+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const S=new Float32Array(this.buffer,a,3);v.push(S[w])}else if(p==="vec4f")v.push(new Float32Array(this.buffer,a,4)[w]);else if(p==="vec2i")m="i",v.push(new Int32Array(this.buffer,a,2)[w]);else if(p==="vec3i")m="i",v.push(new Int32Array(this.buffer,a,3)[w]);else if(p==="vec4i")m="i",v.push(new Int32Array(this.buffer,a,4)[w]);else if(p==="vec2u"){m="u";const S=new Uint32Array(this.buffer,a,2);v.push(S[w])}else p==="vec3u"?(m="u",v.push(new Uint32Array(this.buffer,a,3)[w])):p==="vec4u"&&(m="u",v.push(new Uint32Array(this.buffer,a,4)[w]))}return v.length===2?u=e.getTypeInfo(`vec2${m}`):v.length===3?u=e.getTypeInfo(`vec3${m}`):v.length===4?u=e.getTypeInfo(`vec4${m}`):console.error(`GetDataValue: Invalid vector length ${v.length}`),new V(v,u,null)}return console.error(`GetDataValue: Unknown member ${d}`),null}return console.error(`GetDataValue: Type ${p} is not a struct`),null}}}t=t.postfix}const f=u.getTypeName();return f==="f32"?new G(new Float32Array(this.buffer,a,1),u,this):f==="i32"?new G(new Int32Array(this.buffer,a,1),u,this):f==="u32"?new G(new Uint32Array(this.buffer,a,1),u,this):f==="vec2f"?new V(new Float32Array(this.buffer,a,2),u,this):f==="vec3f"?new V(new Float32Array(this.buffer,a,3),u,this):f==="vec4f"?new V(new Float32Array(this.buffer,a,4),u,this):f==="vec2i"?new V(new Int32Array(this.buffer,a,2),u,this):f==="vec3i"?new V(new Int32Array(this.buffer,a,3),u,this):f==="vec4i"?new V(new Int32Array(this.buffer,a,4),u,this):f==="vec2u"?new V(new Uint32Array(this.buffer,a,2),u,this):f==="vec3u"?new V(new Uint32Array(this.buffer,a,3),u,this):f==="vec4u"?new V(new Uint32Array(this.buffer,a,4),u,this):u instanceof wa&&u.name==="atomic"?((s=u.format)===null||s===void 0?void 0:s.name)==="u32"?new G(new Uint32Array(this.buffer,a,1)[0],u.format,this):((i=u.format)===null||i===void 0?void 0:i.name)==="i32"?new G(new Int32Array(this.buffer,a,1)[0],u.format,this):(console.error(`GetDataValue: Invalid atomic format ${(o=u.format)===null||o===void 0?void 0:o.name}`),null):new ln(this.buffer,u,a,this)}toString(){let e="";if(this.typeInfo instanceof yo)if(this.typeInfo.format.name==="f32"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let r=1;r<t.length;++r)e+=`, ${t[r]}`}else if(this.typeInfo.format.name==="i32"){const t=new Int32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let r=1;r<t.length;++r)e+=`, ${t[r]}`}else if(this.typeInfo.format.name==="u32"){const t=new Uint32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let r=1;r<t.length;++r)e+=`, ${t[r]}`}else if(this.typeInfo.format.name==="vec2f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}]`;for(let r=1;r<t.length/2;++r)e+=`, [${t[2*r]}, ${t[2*r+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}]`;for(let r=4;r<t.length;r+=4)e+=`, [${t[r]}, ${t[r+1]}, ${t[r+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}]`;for(let r=4;r<t.length;r+=4)e+=`, [${t[r]}, ${t[r+1]}, ${t[r+2]}, ${t[r+3]}]`}else e="[...]";else this.typeInfo instanceof ho?e+="{...}":e="[...]";return e}}class fi extends ns{constructor(e,t,r,s){super(t,null),this.data=e,this.descriptor=r,this.view=s}clone(){return new fi(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const r=this.descriptor.size;return r instanceof Array&&r.length>0?(e=r[0])!==null&&e!==void 0?e:0:r instanceof Object&&(t=r.width)!==null&&t!==void 0?t:0}get height(){var e,t;const r=this.descriptor.size;return r instanceof Array&&r.length>1?(e=r[1])!==null&&e!==void 0?e:0:r instanceof Object&&(t=r.height)!==null&&t!==void 0?t:0}get depthOrArrayLayers(){var e,t;const r=this.descriptor.size;return r instanceof Array&&r.length>2?(e=r[2])!==null&&e!==void 0?e:0:r instanceof Object&&(t=r.depthOrArrayLayers)!==null&&t!==void 0?t:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let r=0;r<t.length;++r)t[r]=Math.max(1,t[r]>>e);return t}get texelByteSize(){const e=this.format,t=H0[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=H0[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=H0[e],r=this.width;if(!e||r<=0||!t)return-1;const s=this.height,i=this.depthOrArrayLayers,o=this.dimension;return r/t.blockWidth*(o==="1d"?1:s/t.blockHeight)*t.bytesPerBlock*i}getPixel(e,t,r=0,s=0){const i=this.texelByteSize,o=this.bytesPerRow,a=this.height,u=this.data[s];return Z7(new Uint8Array(u),e,t,r,s,a,o,i,this.format)}setPixel(e,t,r,s,i){const o=this.texelByteSize,a=this.bytesPerRow,u=this.height,f=this.data[s];(function(d,p,m,v,x,b,w,S,R,C){const O=v*(w>>=x)*(b>>=x)+m*w+p*S;switch(R){case"r8unorm":return void It(d,O,"8unorm",1,C);case"r8snorm":return void It(d,O,"8snorm",1,C);case"r8uint":return void It(d,O,"8uint",1,C);case"r8sint":return void It(d,O,"8sint",1,C);case"rg8unorm":return void It(d,O,"8unorm",2,C);case"rg8snorm":return void It(d,O,"8snorm",2,C);case"rg8uint":return void It(d,O,"8uint",2,C);case"rg8sint":return void It(d,O,"8sint",2,C);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void It(d,O,"8unorm",4,C);case"rgba8snorm":return void It(d,O,"8snorm",4,C);case"rgba8uint":return void It(d,O,"8uint",4,C);case"rgba8sint":return void It(d,O,"8sint",4,C);case"r16uint":return void It(d,O,"16uint",1,C);case"r16sint":return void It(d,O,"16sint",1,C);case"r16float":return void It(d,O,"16float",1,C);case"rg16uint":return void It(d,O,"16uint",2,C);case"rg16sint":return void It(d,O,"16sint",2,C);case"rg16float":return void It(d,O,"16float",2,C);case"rgba16uint":return void It(d,O,"16uint",4,C);case"rgba16sint":return void It(d,O,"16sint",4,C);case"rgba16float":return void It(d,O,"16float",4,C);case"r32uint":return void It(d,O,"32uint",1,C);case"r32sint":return void It(d,O,"32sint",1,C);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void It(d,O,"32float",1,C);case"rg32uint":return void It(d,O,"32uint",2,C);case"rg32sint":return void It(d,O,"32sint",2,C);case"rg32float":return void It(d,O,"32float",2,C);case"rgba32uint":return void It(d,O,"32uint",4,C);case"rgba32sint":return void It(d,O,"32sint",4,C);case"rgba32float":return void It(d,O,"32float",4,C);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(f),e,t,r,s,u,a,o,this.format,i)}}(n=>{n[n.token=0]="token",n[n.keyword=1]="keyword",n[n.reserved=2]="reserved"})(J||(J={}));class ee{constructor(e,t,r){this.name=e,this.type=t,this.rule=r}toString(){return this.name}}class L{}ie=L,L.none=new ee("",J.reserved,""),L.eof=new ee("EOF",J.token,""),L.reserved={asm:new ee("asm",J.reserved,"asm"),bf16:new ee("bf16",J.reserved,"bf16"),do:new ee("do",J.reserved,"do"),enum:new ee("enum",J.reserved,"enum"),f16:new ee("f16",J.reserved,"f16"),f64:new ee("f64",J.reserved,"f64"),handle:new ee("handle",J.reserved,"handle"),i8:new ee("i8",J.reserved,"i8"),i16:new ee("i16",J.reserved,"i16"),i64:new ee("i64",J.reserved,"i64"),mat:new ee("mat",J.reserved,"mat"),premerge:new ee("premerge",J.reserved,"premerge"),regardless:new ee("regardless",J.reserved,"regardless"),typedef:new ee("typedef",J.reserved,"typedef"),u8:new ee("u8",J.reserved,"u8"),u16:new ee("u16",J.reserved,"u16"),u64:new ee("u64",J.reserved,"u64"),unless:new ee("unless",J.reserved,"unless"),using:new ee("using",J.reserved,"using"),vec:new ee("vec",J.reserved,"vec"),void:new ee("void",J.reserved,"void")},L.keywords={array:new ee("array",J.keyword,"array"),atomic:new ee("atomic",J.keyword,"atomic"),bool:new ee("bool",J.keyword,"bool"),f32:new ee("f32",J.keyword,"f32"),i32:new ee("i32",J.keyword,"i32"),mat2x2:new ee("mat2x2",J.keyword,"mat2x2"),mat2x3:new ee("mat2x3",J.keyword,"mat2x3"),mat2x4:new ee("mat2x4",J.keyword,"mat2x4"),mat3x2:new ee("mat3x2",J.keyword,"mat3x2"),mat3x3:new ee("mat3x3",J.keyword,"mat3x3"),mat3x4:new ee("mat3x4",J.keyword,"mat3x4"),mat4x2:new ee("mat4x2",J.keyword,"mat4x2"),mat4x3:new ee("mat4x3",J.keyword,"mat4x3"),mat4x4:new ee("mat4x4",J.keyword,"mat4x4"),ptr:new ee("ptr",J.keyword,"ptr"),sampler:new ee("sampler",J.keyword,"sampler"),sampler_comparison:new ee("sampler_comparison",J.keyword,"sampler_comparison"),struct:new ee("struct",J.keyword,"struct"),texture_1d:new ee("texture_1d",J.keyword,"texture_1d"),texture_2d:new ee("texture_2d",J.keyword,"texture_2d"),texture_2d_array:new ee("texture_2d_array",J.keyword,"texture_2d_array"),texture_3d:new ee("texture_3d",J.keyword,"texture_3d"),texture_cube:new ee("texture_cube",J.keyword,"texture_cube"),texture_cube_array:new ee("texture_cube_array",J.keyword,"texture_cube_array"),texture_multisampled_2d:new ee("texture_multisampled_2d",J.keyword,"texture_multisampled_2d"),texture_storage_1d:new ee("texture_storage_1d",J.keyword,"texture_storage_1d"),texture_storage_2d:new ee("texture_storage_2d",J.keyword,"texture_storage_2d"),texture_storage_2d_array:new ee("texture_storage_2d_array",J.keyword,"texture_storage_2d_array"),texture_storage_3d:new ee("texture_storage_3d",J.keyword,"texture_storage_3d"),texture_depth_2d:new ee("texture_depth_2d",J.keyword,"texture_depth_2d"),texture_depth_2d_array:new ee("texture_depth_2d_array",J.keyword,"texture_depth_2d_array"),texture_depth_cube:new ee("texture_depth_cube",J.keyword,"texture_depth_cube"),texture_depth_cube_array:new ee("texture_depth_cube_array",J.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new ee("texture_depth_multisampled_2d",J.keyword,"texture_depth_multisampled_2d"),texture_external:new ee("texture_external",J.keyword,"texture_external"),u32:new ee("u32",J.keyword,"u32"),vec2:new ee("vec2",J.keyword,"vec2"),vec3:new ee("vec3",J.keyword,"vec3"),vec4:new ee("vec4",J.keyword,"vec4"),bitcast:new ee("bitcast",J.keyword,"bitcast"),block:new ee("block",J.keyword,"block"),break:new ee("break",J.keyword,"break"),case:new ee("case",J.keyword,"case"),continue:new ee("continue",J.keyword,"continue"),continuing:new ee("continuing",J.keyword,"continuing"),default:new ee("default",J.keyword,"default"),diagnostic:new ee("diagnostic",J.keyword,"diagnostic"),discard:new ee("discard",J.keyword,"discard"),else:new ee("else",J.keyword,"else"),enable:new ee("enable",J.keyword,"enable"),fallthrough:new ee("fallthrough",J.keyword,"fallthrough"),false:new ee("false",J.keyword,"false"),fn:new ee("fn",J.keyword,"fn"),for:new ee("for",J.keyword,"for"),function:new ee("function",J.keyword,"function"),if:new ee("if",J.keyword,"if"),let:new ee("let",J.keyword,"let"),const:new ee("const",J.keyword,"const"),loop:new ee("loop",J.keyword,"loop"),while:new ee("while",J.keyword,"while"),private:new ee("private",J.keyword,"private"),read:new ee("read",J.keyword,"read"),read_write:new ee("read_write",J.keyword,"read_write"),return:new ee("return",J.keyword,"return"),requires:new ee("requires",J.keyword,"requires"),storage:new ee("storage",J.keyword,"storage"),switch:new ee("switch",J.keyword,"switch"),true:new ee("true",J.keyword,"true"),alias:new ee("alias",J.keyword,"alias"),type:new ee("type",J.keyword,"type"),uniform:new ee("uniform",J.keyword,"uniform"),var:new ee("var",J.keyword,"var"),override:new ee("override",J.keyword,"override"),workgroup:new ee("workgroup",J.keyword,"workgroup"),write:new ee("write",J.keyword,"write"),r8unorm:new ee("r8unorm",J.keyword,"r8unorm"),r8snorm:new ee("r8snorm",J.keyword,"r8snorm"),r8uint:new ee("r8uint",J.keyword,"r8uint"),r8sint:new ee("r8sint",J.keyword,"r8sint"),r16uint:new ee("r16uint",J.keyword,"r16uint"),r16sint:new ee("r16sint",J.keyword,"r16sint"),r16float:new ee("r16float",J.keyword,"r16float"),rg8unorm:new ee("rg8unorm",J.keyword,"rg8unorm"),rg8snorm:new ee("rg8snorm",J.keyword,"rg8snorm"),rg8uint:new ee("rg8uint",J.keyword,"rg8uint"),rg8sint:new ee("rg8sint",J.keyword,"rg8sint"),r32uint:new ee("r32uint",J.keyword,"r32uint"),r32sint:new ee("r32sint",J.keyword,"r32sint"),r32float:new ee("r32float",J.keyword,"r32float"),rg16uint:new ee("rg16uint",J.keyword,"rg16uint"),rg16sint:new ee("rg16sint",J.keyword,"rg16sint"),rg16float:new ee("rg16float",J.keyword,"rg16float"),rgba8unorm:new ee("rgba8unorm",J.keyword,"rgba8unorm"),rgba8unorm_srgb:new ee("rgba8unorm_srgb",J.keyword,"rgba8unorm_srgb"),rgba8snorm:new ee("rgba8snorm",J.keyword,"rgba8snorm"),rgba8uint:new ee("rgba8uint",J.keyword,"rgba8uint"),rgba8sint:new ee("rgba8sint",J.keyword,"rgba8sint"),bgra8unorm:new ee("bgra8unorm",J.keyword,"bgra8unorm"),bgra8unorm_srgb:new ee("bgra8unorm_srgb",J.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new ee("rgb10a2unorm",J.keyword,"rgb10a2unorm"),rg11b10float:new ee("rg11b10float",J.keyword,"rg11b10float"),rg32uint:new ee("rg32uint",J.keyword,"rg32uint"),rg32sint:new ee("rg32sint",J.keyword,"rg32sint"),rg32float:new ee("rg32float",J.keyword,"rg32float"),rgba16uint:new ee("rgba16uint",J.keyword,"rgba16uint"),rgba16sint:new ee("rgba16sint",J.keyword,"rgba16sint"),rgba16float:new ee("rgba16float",J.keyword,"rgba16float"),rgba32uint:new ee("rgba32uint",J.keyword,"rgba32uint"),rgba32sint:new ee("rgba32sint",J.keyword,"rgba32sint"),rgba32float:new ee("rgba32float",J.keyword,"rgba32float"),static_assert:new ee("static_assert",J.keyword,"static_assert")},L.tokens={decimal_float_literal:new ee("decimal_float_literal",J.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new ee("hex_float_literal",J.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new ee("int_literal",J.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new ee("uint_literal",J.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new ee("name",J.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new ee("ident",J.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new ee("and",J.token,"&"),and_and:new ee("and_and",J.token,"&&"),arrow:new ee("arrow ",J.token,"->"),attr:new ee("attr",J.token,"@"),forward_slash:new ee("forward_slash",J.token,"/"),bang:new ee("bang",J.token,"!"),bracket_left:new ee("bracket_left",J.token,"["),bracket_right:new ee("bracket_right",J.token,"]"),brace_left:new ee("brace_left",J.token,"{"),brace_right:new ee("brace_right",J.token,"}"),colon:new ee("colon",J.token,":"),comma:new ee("comma",J.token,","),equal:new ee("equal",J.token,"="),equal_equal:new ee("equal_equal",J.token,"=="),not_equal:new ee("not_equal",J.token,"!="),greater_than:new ee("greater_than",J.token,">"),greater_than_equal:new ee("greater_than_equal",J.token,">="),shift_right:new ee("shift_right",J.token,">>"),less_than:new ee("less_than",J.token,"<"),less_than_equal:new ee("less_than_equal",J.token,"<="),shift_left:new ee("shift_left",J.token,"<<"),modulo:new ee("modulo",J.token,"%"),minus:new ee("minus",J.token,"-"),minus_minus:new ee("minus_minus",J.token,"--"),period:new ee("period",J.token,"."),plus:new ee("plus",J.token,"+"),plus_plus:new ee("plus_plus",J.token,"++"),or:new ee("or",J.token,"|"),or_or:new ee("or_or",J.token,"||"),paren_left:new ee("paren_left",J.token,"("),paren_right:new ee("paren_right",J.token,")"),semicolon:new ee("semicolon",J.token,";"),star:new ee("star",J.token,"*"),tilde:new ee("tilde",J.token,"~"),underscore:new ee("underscore",J.token,"_"),xor:new ee("xor",J.token,"^"),plus_equal:new ee("plus_equal",J.token,"+="),minus_equal:new ee("minus_equal",J.token,"-="),times_equal:new ee("times_equal",J.token,"*="),division_equal:new ee("division_equal",J.token,"/="),modulo_equal:new ee("modulo_equal",J.token,"%="),and_equal:new ee("and_equal",J.token,"&="),or_equal:new ee("or_equal",J.token,"|="),xor_equal:new ee("xor_equal",J.token,"^="),shift_right_equal:new ee("shift_right_equal",J.token,">>="),shift_left_equal:new ee("shift_left_equal",J.token,"<<=")},L.simpleTokens={"@":ie.tokens.attr,"{":ie.tokens.brace_left,"}":ie.tokens.brace_right,":":ie.tokens.colon,",":ie.tokens.comma,"(":ie.tokens.paren_left,")":ie.tokens.paren_right,";":ie.tokens.semicolon},L.literalTokens={"&":ie.tokens.and,"&&":ie.tokens.and_and,"->":ie.tokens.arrow,"/":ie.tokens.forward_slash,"!":ie.tokens.bang,"[":ie.tokens.bracket_left,"]":ie.tokens.bracket_right,"=":ie.tokens.equal,"==":ie.tokens.equal_equal,"!=":ie.tokens.not_equal,">":ie.tokens.greater_than,">=":ie.tokens.greater_than_equal,">>":ie.tokens.shift_right,"<":ie.tokens.less_than,"<=":ie.tokens.less_than_equal,"<<":ie.tokens.shift_left,"%":ie.tokens.modulo,"-":ie.tokens.minus,"--":ie.tokens.minus_minus,".":ie.tokens.period,"+":ie.tokens.plus,"++":ie.tokens.plus_plus,"|":ie.tokens.or,"||":ie.tokens.or_or,"*":ie.tokens.star,"~":ie.tokens.tilde,_:ie.tokens.underscore,"^":ie.tokens.xor,"+=":ie.tokens.plus_equal,"-=":ie.tokens.minus_equal,"*=":ie.tokens.times_equal,"/=":ie.tokens.division_equal,"%=":ie.tokens.modulo_equal,"&=":ie.tokens.and_equal,"|=":ie.tokens.or_equal,"^=":ie.tokens.xor_equal,">>=":ie.tokens.shift_right_equal,"<<=":ie.tokens.shift_left_equal},L.regexTokens={decimal_float_literal:ie.tokens.decimal_float_literal,hex_float_literal:ie.tokens.hex_float_literal,int_literal:ie.tokens.int_literal,uint_literal:ie.tokens.uint_literal,ident:ie.tokens.ident},L.storage_class=[ie.keywords.function,ie.keywords.private,ie.keywords.workgroup,ie.keywords.uniform,ie.keywords.storage],L.access_mode=[ie.keywords.read,ie.keywords.write,ie.keywords.read_write],L.sampler_type=[ie.keywords.sampler,ie.keywords.sampler_comparison],L.sampled_texture_type=[ie.keywords.texture_1d,ie.keywords.texture_2d,ie.keywords.texture_2d_array,ie.keywords.texture_3d,ie.keywords.texture_cube,ie.keywords.texture_cube_array],L.multisampled_texture_type=[ie.keywords.texture_multisampled_2d],L.storage_texture_type=[ie.keywords.texture_storage_1d,ie.keywords.texture_storage_2d,ie.keywords.texture_storage_2d_array,ie.keywords.texture_storage_3d],L.depth_texture_type=[ie.keywords.texture_depth_2d,ie.keywords.texture_depth_2d_array,ie.keywords.texture_depth_cube,ie.keywords.texture_depth_cube_array,ie.keywords.texture_depth_multisampled_2d],L.texture_external_type=[ie.keywords.texture_external],L.any_texture_type=[...ie.sampled_texture_type,...ie.multisampled_texture_type,...ie.storage_texture_type,...ie.depth_texture_type,...ie.texture_external_type],L.texel_format=[ie.keywords.r8unorm,ie.keywords.r8snorm,ie.keywords.r8uint,ie.keywords.r8sint,ie.keywords.r16uint,ie.keywords.r16sint,ie.keywords.r16float,ie.keywords.rg8unorm,ie.keywords.rg8snorm,ie.keywords.rg8uint,ie.keywords.rg8sint,ie.keywords.r32uint,ie.keywords.r32sint,ie.keywords.r32float,ie.keywords.rg16uint,ie.keywords.rg16sint,ie.keywords.rg16float,ie.keywords.rgba8unorm,ie.keywords.rgba8unorm_srgb,ie.keywords.rgba8snorm,ie.keywords.rgba8uint,ie.keywords.rgba8sint,ie.keywords.bgra8unorm,ie.keywords.bgra8unorm_srgb,ie.keywords.rgb10a2unorm,ie.keywords.rg11b10float,ie.keywords.rg32uint,ie.keywords.rg32sint,ie.keywords.rg32float,ie.keywords.rgba16uint,ie.keywords.rgba16sint,ie.keywords.rgba16float,ie.keywords.rgba32uint,ie.keywords.rgba32sint,ie.keywords.rgba32float],L.const_literal=[ie.tokens.int_literal,ie.tokens.uint_literal,ie.tokens.decimal_float_literal,ie.tokens.hex_float_literal,ie.keywords.true,ie.keywords.false],L.literal_or_ident=[ie.tokens.ident,ie.tokens.int_literal,ie.tokens.uint_literal,ie.tokens.decimal_float_literal,ie.tokens.hex_float_literal,ie.tokens.name],L.element_count_expression=[ie.tokens.int_literal,ie.tokens.uint_literal,ie.tokens.ident],L.template_types=[ie.keywords.vec2,ie.keywords.vec3,ie.keywords.vec4,ie.keywords.mat2x2,ie.keywords.mat2x3,ie.keywords.mat2x4,ie.keywords.mat3x2,ie.keywords.mat3x3,ie.keywords.mat3x4,ie.keywords.mat4x2,ie.keywords.mat4x3,ie.keywords.mat4x4,ie.keywords.atomic,ie.keywords.bitcast,...ie.any_texture_type],L.attribute_name=[ie.tokens.ident,ie.keywords.block,ie.keywords.diagnostic],L.assignment_operators=[ie.tokens.equal,ie.tokens.plus_equal,ie.tokens.minus_equal,ie.tokens.times_equal,ie.tokens.division_equal,ie.tokens.modulo_equal,ie.tokens.and_equal,ie.tokens.or_equal,ie.tokens.xor_equal,ie.tokens.shift_right_equal,ie.tokens.shift_left_equal],L.increment_operators=[ie.tokens.plus_plus,ie.tokens.minus_minus];class Aw{constructor(e,t,r,s,i){this.type=e,this.lexeme=t,this.line=r,this.start=s,this.end=i}toString(){return this.lexeme}isTemplateType(){return L.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==L.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class rB{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new Aw(L.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let o=1;for(;o>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),o--,o==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),o++)}return!0}}const t=L.simpleTokens[e];if(t)return this._addToken(t),!0;let r=L.none;const s=this._isAlpha(e),i=e==="_";if(this._isAlphaNumeric(e)){let o=this._peekAhead();for(;this._isAlphaNumeric(o);)e+=this._advance(),o=this._peekAhead()}if(s){const o=L.keywords[e];if(o)return this._addToken(o),!0}if(s||i)return this._addToken(L.tokens.ident),!0;for(;;){let o=this._findType(e);const a=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(a=="=")return this._current++,e+=a,this._addToken(L.tokens.minus_equal),!0;if(a=="-")return this._current++,e+=a,this._addToken(L.tokens.minus_minus),!0;const u=this._tokens.length-1;if((L.literal_or_ident.indexOf(this._tokens[u].type)!=-1||this._tokens[u].type==L.tokens.paren_right)&&a!=">")return this._addToken(o),!0}if(e==">"&&(a==">"||a=="=")){let u=!1,f=this._tokens.length-1;for(let d=0;d<5&&f>=0&&L.assignment_operators.indexOf(this._tokens[f].type)===-1;++d,--f)if(this._tokens[f].type===L.tokens.less_than){f>0&&this._tokens[f-1].isArrayOrTemplateType()&&(u=!0);break}if(u)return this._addToken(o),!0}if(o===L.none){let u=e,f=0;const d=2;for(let p=0;p<d;++p)if(u+=this._peekAhead(p),o=this._findType(u),o!==L.none){f=p;break}if(o===L.none)return r!==L.none&&(this._current--,this._addToken(r),!0);e=u,this._current+=f+1}if(r=o,this._isAtEnd())break;e+=this._advance()}return r!==L.none&&(this._addToken(r),!0)}_findType(e){for(const r in L.regexTokens){const s=L.regexTokens[r];if(this._match(e,s.rule))return s}return L.literalTokens[e]||L.none}_match(e,t){const r=t.exec(e);return r&&r.index==0&&r[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new Aw(e,t,this._line,this._start,this._current))}}function ke(n){return Array.isArray(n)||(n==null?void 0:n.buffer)instanceof ArrayBuffer}const ep=new Float32Array(1),sB=new Uint32Array(ep.buffer),iB=new Uint32Array(ep.buffer),tp=new Int32Array(1),oB=new Float32Array(tp.buffer),aB=new Uint32Array(tp.buffer),np=new Uint32Array(1),lB=new Float32Array(np.buffer),cB=new Int32Array(np.buffer);function Cw(n,e,t){if(e===t)return n;if(e==="f32"){if(t==="i32"||t==="x32")return ep[0]=n,sB[0];if(t==="u32")return ep[0]=n,iB[0]}else if(e==="i32"||e==="x32"){if(t==="f32")return tp[0]=n,oB[0];if(t==="u32")return tp[0]=n,aB[0]}else if(e==="u32"){if(t==="f32")return np[0]=n,lB[0];if(t==="i32"||t==="x32")return np[0]=n,cB[0]}return console.error(`Unsupported cast from ${e} to ${t}`),n}class uB{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class eh{constructor(e,t){this.align=e,this.size=t}}class Vs{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new Y7,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const t of e)t instanceof Xu&&this._functions.set(t.name,new uB(t));for(const t of e)if(t instanceof ui){const r=this.getTypeInfo(t,null);r instanceof ho&&this.structs.push(r)}for(const t of e)if(t instanceof u1)this.aliases.push(this._getAliasInfo(t));else if(t instanceof l1){const r=t,s=this._getAttributeNum(r.attributes,"id",0),i=r.type!=null?this.getTypeInfo(r.type,r.attributes):null;this.overrides.push(new W7(r.name,i,r.attributes,s))}else if(this._isUniformVar(t)){const r=t,s=this._getAttributeNum(r.attributes,"group",0),i=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=new Jd(r.name,o,s,i,r.attributes,io.Uniform,r.access);a.access||(a.access="read"),this.uniforms.push(a)}else if(this._isStorageVar(t)){const r=t,s=this._getAttributeNum(r.attributes,"group",0),i=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=this._isStorageTexture(o),u=new Jd(r.name,o,s,i,r.attributes,a?io.StorageTexture:io.Storage,r.access);u.access||(u.access="read"),this.storage.push(u)}else if(this._isTextureVar(t)){const r=t,s=this._getAttributeNum(r.attributes,"group",0),i=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=this._isStorageTexture(o),u=new Jd(r.name,o,s,i,r.attributes,a?io.StorageTexture:io.Texture,r.access);u.access||(u.access="read"),a?this.storage.push(u):this.textures.push(u)}else if(this._isSamplerVar(t)){const r=t,s=this._getAttributeNum(r.attributes,"group",0),i=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=new Jd(r.name,o,s,i,r.attributes,io.Sampler,r.access);this.samplers.push(a)}else if(t instanceof Xu){const r=this._getAttribute(t,"vertex"),s=this._getAttribute(t,"fragment"),i=this._getAttribute(t,"compute"),o=r||s||i,a=new X7(t.name,o==null?void 0:o.name,t.attributes);a.attributes=t.attributes,a.startLine=t.startLine,a.endLine=t.endLine,this.functions.push(a),this._functions.get(t.name).info=a,o&&(this._functions.get(t.name).inUse=!0,a.inUse=!0,a.resources=this._findResources(t,!!o),a.inputs=this._getInputs(t.args),a.outputs=this._getOutputs(t.returnType),this.entry[o.name].push(a)),a.arguments=t.args.map(u=>new H7(u.name,this.getTypeInfo(u.type,u.attributes),u.attributes)),a.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(r=>{var s,i,o;if(r instanceof SA){if(r.value)if(ke(r.value))for(const a of r.value)for(const u of this.overrides)a===u.name&&((s=t.info)===null||s===void 0||s.overrides.push(u));else for(const a of this.overrides)r.value===a.name&&((i=t.info)===null||i===void 0||i.overrides.push(a))}else if(r instanceof Lr)for(const a of this.overrides)r.name===a.name&&((o=t.info)===null||o===void 0||o.overrides.push(a))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var r;for(const s of e.calls){const i=(r=this._functions.get(s.name))===null||r===void 0?void 0:r.info;i&&t.add(i)}}findResource(e,t,r){if(r){for(const s of this.entry.compute)if(s.name===r){for(const i of s.resources)if(i.group==e&&i.binding==t)return i}for(const s of this.entry.vertex)if(s.name===r){for(const i of s.resources)if(i.group==e&&i.binding==t)return i}for(const s of this.entry.fragment)if(s.name===r){for(const i of s.resources)if(i.group==e&&i.binding==t)return i}}for(const s of this.uniforms)if(s.group==e&&s.binding==t)return s;for(const s of this.storage)if(s.group==e&&s.binding==t)return s;for(const s of this.textures)if(s.group==e&&s.binding==t)return s;for(const s of this.samplers)if(s.group==e&&s.binding==t)return s;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const r=[],s=this,i=[];return e.search(o=>{if(o instanceof Gh)i.push({});else if(o instanceof Jh)i.pop();else if(o instanceof di){const a=o;t&&a.type!==null&&this._markStructsFromAST(a.type),i.length>0&&(i[i.length-1][a.name]=a)}else if(o instanceof Bs){const a=o;t&&a.type!==null&&this._markStructsFromAST(a.type)}else if(o instanceof Ru){const a=o;t&&a.type!==null&&this._markStructsFromAST(a.type),i.length>0&&(i[i.length-1][a.name]=a)}else if(o instanceof Lr){const a=o;if(i.length>0&&i[i.length-1][a.name])return;const u=s._findResource(a.name);u&&r.push(u)}else if(o instanceof f1){const a=o,u=s._functions.get(a.name);u&&(t&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=s._findResources(u.node,t)),r.push(...u.resources))}else if(o instanceof c1){const a=o,u=s._functions.get(a.name);u&&(t&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=s._findResources(u.node,t)),r.push(...u.resources))}}),[...new Map(r.map(o=>[o.name,o])).values()]}getBindGroups(){const e=[];function t(r,s){r>=e.length&&(e.length=r+1),e[r]===void 0&&(e[r]=[]),s>=e[r].length&&(e[r].length=s+1)}for(const r of this.uniforms)t(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.storage)t(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.textures)t(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.samplers)t(r.group,r.binding),e[r.group][r.binding]=r;return e}_getOutputs(e,t=void 0){if(t===void 0&&(t=[]),e instanceof ui)this._getStructOutputs(e,t);else{const r=this._getOutputInfo(e);r!==null&&t.push(r)}return t}_getStructOutputs(e,t){for(const r of e.members)if(r.type instanceof ui)this._getStructOutputs(r.type,t);else{const s=this._getAttribute(r,"location")||this._getAttribute(r,"builtin");if(s!==null){const i=this.getTypeInfo(r.type,r.type.attributes),o=this._parseInt(s.value),a=new bw(r.name,i,s.name,o);t.push(a)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const r=this.getTypeInfo(e,e.attributes),s=this._parseInt(t.value);return new bw("",r,t.name,s)}return null}_getInputs(e,t=void 0){t===void 0&&(t=[]);for(const r of e)if(r.type instanceof ui)this._getStructInputs(r.type,t);else{const s=this._getInputInfo(r);s!==null&&t.push(s)}return t}_getStructInputs(e,t){for(const r of e.members)if(r.type instanceof ui)this._getStructInputs(r.type,t);else{const s=this._getInputInfo(r);s!==null&&t.push(s)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const r=this._getAttribute(e,"interpolation"),s=this.getTypeInfo(e.type,e.attributes),i=this._parseInt(t.value),o=new j7(e.name,s,t.name,i);return r!==null&&(o.interpolation=this._parseString(r.value)),o}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new $7(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e,t=null){if(this._types.has(e))return this._types.get(e);if(e instanceof Pu){const s=e,i=s.format?this.getTypeInfo(s.format,s.attributes):null,o=new yo(s.name,t);return o.format=i,o.count=s.count,this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof ui){const s=e,i=new ho(s.name,t);i.startLine=s.startLine,i.endLine=s.endLine;for(const o of s.members){const a=this.getTypeInfo(o.type,o.attributes);i.members.push(new xw(o.name,a,o.attributes))}return this._types.set(e,i),this._updateTypeInfo(i),i}if(e instanceof hu){const s=e,i=s.format instanceof me,o=s.format?i?this.getTypeInfo(s.format,null):new Jr(s.format,null):null,a=new wa(s.name,o,t,s.access);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof ne){const s=e,i=s.format?this.getTypeInfo(s.format,null):null,o=new wa(s.name,i,t,s.access);return this._types.set(e,o),this._updateTypeInfo(o),o}const r=new Jr(e.name,t);return this._types.set(e,r),this._updateTypeInfo(r),r}_updateTypeInfo(e){var t,r,s;const i=this._getTypeSize(e);if(e.size=(t=i==null?void 0:i.size)!==null&&t!==void 0?t:0,e instanceof yo&&e.format){const o=this._getTypeSize(e.format);e.stride=Math.max((r=o==null?void 0:o.size)!==null&&r!==void 0?r:0,(s=o==null?void 0:o.align)!==null&&s!==void 0?s:0),this._updateTypeInfo(e.format)}e instanceof ho&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let r=0,s=0,i=0,o=0;for(let a=0,u=e.members.length;a<u;++a){const f=e.members[a],d=this._getTypeSize(f);if(!d)continue;(t=this._getAlias(f.type.name))!==null&&t!==void 0||f.type;const p=d.align,m=d.size;r=this._roundUp(p,r+s),s=m,i=r,o=Math.max(o,p),f.offset=r,f.size=m,this._updateTypeInfo(f.type)}e.size=this._roundUp(o,i+s),e.align=o}_getTypeSize(e){var t,r;if(e==null)return null;const s=this._getAttributeNum(e.attributes,"size",0),i=this._getAttributeNum(e.attributes,"align",0);if(e instanceof xw&&(e=e.type),e instanceof Jr){const o=this._getAlias(e.name);o!==null&&(e=o)}{const o=Vs._typeInfo[e.name];if(o!==void 0){const a=((t=e.format)===null||t===void 0?void 0:t.name)==="f16"?2:1;return new eh(Math.max(i,o.align/a),Math.max(s,o.size/a))}}{const o=Vs._typeInfo[e.name.substring(0,e.name.length-1)];if(o){const a=e.name[e.name.length-1]==="h"?2:1;return new eh(Math.max(i,o.align/a),Math.max(s,o.size/a))}}if(e instanceof yo){let o=e,a=8,u=8;const f=this._getTypeSize(o.format);return f!==null&&(u=f.size,a=f.align),u=o.count*this._getAttributeNum((r=e==null?void 0:e.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(a,u)),s&&(u=s),new eh(Math.max(i,a),Math.max(s,u))}if(e instanceof ho){let o=0,a=0,u=0,f=0,d=0;for(const p of e.members){const m=this._getTypeSize(p.type);m!==null&&(o=Math.max(m.align,o),u=this._roundUp(m.align,u+f),f=m.size,d=u)}return a=this._roundUp(o,d+f),new eh(Math.max(i,o),Math.max(s,a))}return null}_isUniformVar(e){return e instanceof di&&e.storage=="uniform"}_isStorageVar(e){return e instanceof di&&e.storage=="storage"}_isTextureVar(e){return e instanceof di&&e.type!==null&&Vs._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof di&&e.type!==null&&Vs._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,t){const r=e;if(!r||!r.attributes)return null;const s=r.attributes;for(let i of s)if(i.name==t)return i;return null}_getAttributeNum(e,t,r){if(e===null)return r;for(let s of e)if(s.name==t){let i=s!==null&&s.value!==null?s.value:r;return i instanceof Array&&(i=i[0]),typeof i=="number"?i:typeof i=="string"?parseInt(i):r}return r}_roundUp(e,t){return Math.ceil(t/e)*e}}Vs._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Vs._textureTypes=L.any_texture_type.map(n=>n.name),Vs._samplerTypes=L.sampler_type.map(n=>n.name);class d1{constructor(e,t,r){this.name=e,this.value=t,this.node=r}clone(){return new d1(this.name,this.value,this.node)}}class h1{constructor(e){this.name=e.name,this.node=e}clone(){return new h1(this.node)}}class p1{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?(t=this.variables.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?(t=this.functions.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,r){this.variables.set(e,new d1(e,t,r??null))}setVariable(e,t,r){const s=this.getVariable(e);s!==null?s.value=t:this.createVariable(e,t,r)}getVariableValue(e){var t;const r=this.getVariable(e);return(t=r==null?void 0:r.value)!==null&&t!==void 0?t:null}clone(){return new p1(this)}}class fB{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}}class dB{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const r=this.exec.evalExpression(e.args[0],t);let s=!0;if(r instanceof V)return r.data.forEach(i=>{i||(s=!1)}),new G(s?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V){const s=r.data.some(i=>i);return new G(s?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,t){const r=this.exec.evalExpression(e.args[2],t);if(!(r instanceof G))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return r.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.evalExpression(r,t);if(s instanceof ln&&s.typeInfo.size===0){const i=s.typeInfo,o=s.buffer.byteLength/i.stride;return new G(o,this.getTypeInfo("u32"))}return new G(s.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.abs(i)),r.typeInfo);const s=r;return new G(Math.abs(s.value),s.typeInfo)}Acos(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.acos(i)),r.typeInfo);const s=r;return new G(Math.acos(s.value),r.typeInfo)}Acosh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.acosh(i)),r.typeInfo);const s=r;return new G(Math.acosh(s.value),r.typeInfo)}Asin(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.asin(i)),r.typeInfo);const s=r;return new G(Math.asin(s.value),r.typeInfo)}Asinh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.asinh(i)),r.typeInfo);const s=r;return new G(Math.asinh(s.value),r.typeInfo)}Atan(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.atan(i)),r.typeInfo);const s=r;return new G(Math.atan(s.value),r.typeInfo)}Atanh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.atanh(i)),r.typeInfo);const s=r;return new G(Math.atanh(s.value),r.typeInfo)}Atan2(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(r instanceof V&&s instanceof V)return new V(r.data.map((a,u)=>Math.atan2(a,s.data[u])),r.typeInfo);const i=r,o=s;return new G(Math.atan2(i.value,o.value),r.typeInfo)}Ceil(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.ceil(i)),r.typeInfo);const s=r;return new G(Math.ceil(s.value),r.typeInfo)}_clamp(e,t,r){return Math.min(Math.max(e,t),r)}Clamp(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(r instanceof V&&s instanceof V&&i instanceof V)return new V(r.data.map((f,d)=>this._clamp(f,s.data[d],i.data[d])),r.typeInfo);const o=r,a=s,u=i;return new G(this._clamp(o.value,a.value,u.value),r.typeInfo)}Cos(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.cos(i)),r.typeInfo);const s=r;return new G(Math.cos(s.value),r.typeInfo)}Cosh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.cosh(i)),r.typeInfo);const s=r;return new G(Math.cos(s.value),r.typeInfo)}CountLeadingZeros(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.clz32(i)),r.typeInfo);const s=r;return new G(Math.clz32(s.value),r.typeInfo)}_countOneBits(e){let t=0;for(;e!==0;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>this._countOneBits(i)),r.typeInfo);const s=r;return new G(this._countOneBits(s.value),r.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>this._countTrailingZeros(i)),r.typeInfo);const s=r;return new G(this._countTrailingZeros(s.value),r.typeInfo)}Cross(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(r instanceof V&&s instanceof V){if(r.data.length!==3||s.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const i=r.data,o=s.data;return new V([i[1]*o[2]-o[1]*i[2],i[2]*o[0]-o[2]*i[0],i[0]*o[1]-o[0]*i[1]],r.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,t){const r=this.exec.evalExpression(e.args[0],t),s=180/Math.PI;return r instanceof V?new V(r.data.map(i=>i*s),r.typeInfo):new G(r.value*s,this.getTypeInfo("f32"))}Determinant(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof Ze){const s=r.data,i=r.typeInfo.getTypeName(),o=i.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h")return new G(s[0]*s[3]-s[1]*s[2],o);if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h")return new G(s[0]*(s[4]*s[8]-s[5]*s[7])-s[1]*(s[3]*s[8]-s[5]*s[6])+s[2]*(s[3]*s[7]-s[4]*s[6]),o);if(i==="mat2x4"||i==="mat2x4f"||i==="mat2x4h")console.error(`TODO: Determinant for ${i}`);else if(i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h")console.error(`TODO: Determinant for ${i}`);else{if(i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h")return new G(s[0]*(s[4]*s[8]-s[5]*s[7])-s[1]*(s[3]*s[8]-s[5]*s[6])+s[2]*(s[3]*s[7]-s[4]*s[6]),o);i==="mat3x4"||i==="mat3x4f"||i==="mat3x4h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h"?console.error(`TODO: Determinant for ${i}`):i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h"||console.error(`TODO: Determinant for ${i}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(r instanceof V&&s instanceof V){let a=0;for(let u=0;u<r.data.length;++u)a+=(r.data[u]-s.data[u])*(r.data[u]-s.data[u]);return new G(Math.sqrt(a),this.getTypeInfo("f32"))}const i=r,o=s;return new G(Math.abs(i.value-o.value),r.typeInfo)}_dot(e,t){let r=0;for(let s=0;s<e.length;++s)r+=t[s]*e[s];return r}Dot(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);return r instanceof V&&s instanceof V?new G(this._dot(r.data,s.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,t){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,t){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.exp(i)),r.typeInfo);const s=r;return new G(Math.exp(s.value),r.typeInfo)}Exp2(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.pow(2,i)),r.typeInfo);const s=r;return new G(Math.pow(2,s.value),r.typeInfo)}ExtractBits(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const o=s.value,a=i.value;if(r instanceof V)return new V(r.data.map(f=>f>>o&(1<<a)-1),r.typeInfo);if(r.typeInfo.name!=="i32"&&r.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const u=r.value;return new G(u>>o&(1<<a)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(r instanceof V&&s instanceof V&&i instanceof V){const o=this._dot(s.data,i.data);return new V(o<0?Array.from(r.data):r.data.map(a=>-a),r.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>this._firstLeadingBit(i)),r.typeInfo);const s=r;return new G(this._firstLeadingBit(s.value),r.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>this._firstTrailingBit(i)),r.typeInfo);const s=r;return new G(this._firstTrailingBit(s.value),r.typeInfo)}Floor(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.floor(i)),r.typeInfo);const s=r;return new G(Math.floor(s.value),r.typeInfo)}Fma(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(r instanceof V&&s instanceof V&&i instanceof V)return r.data.length!==s.data.length||r.data.length!==i.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new V(r.data.map((f,d)=>f*s.data[d]+i.data[d]),r.typeInfo);const o=r,a=s,u=i;return new G(o.value*a.value+u.value,o.typeInfo)}Fract(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>i-Math.floor(i)),r.typeInfo);const s=r;return new G(s.value-Math.floor(s.value),r.typeInfo)}Frexp(e,t){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t),o=this.exec.evalExpression(e.args[3],t);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const a=i.value,u=(1<<o.value)-1<<a,f=~u;if(r instanceof V&&s instanceof V)return new V(r.data.map((m,v)=>m&f|s.data[v]<<a&u),r.typeInfo);const d=r.value,p=s.value;return new G(d&f|p<<a&u,r.typeInfo)}InverseSqrt(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>1/Math.sqrt(i)),r.typeInfo);const s=r;return new G(1/Math.sqrt(s.value),r.typeInfo)}Ldexp(e,t){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V){let i=0;return r.data.forEach(o=>{i+=o*o}),new G(Math.sqrt(i),this.getTypeInfo("f32"))}const s=r;return new G(Math.abs(s.value),r.typeInfo)}Log(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.log(i)),r.typeInfo);const s=r;return new G(Math.log(s.value),r.typeInfo)}Log2(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.log2(i)),r.typeInfo);const s=r;return new G(Math.log2(s.value),r.typeInfo)}Max(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(r instanceof V&&s instanceof V)return new V(r.data.map((a,u)=>Math.max(a,s.data[u])),r.typeInfo);const i=r,o=s;return new G(Math.max(i.value,o.value),r.typeInfo)}Min(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(r instanceof V&&s instanceof V)return new V(r.data.map((a,u)=>Math.min(a,s.data[u])),r.typeInfo);const i=r,o=s;return new G(Math.min(i.value,o.value),r.typeInfo)}Mix(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(r instanceof V&&s instanceof V&&i instanceof V)return new V(r.data.map((u,f)=>r.data[f]*(1-i.data[f])+s.data[f]*i.data[f]),r.typeInfo);const o=s,a=i;return new G(r.value*(1-a.value)+o.value*a.value,r.typeInfo)}Modf(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(r instanceof V&&s instanceof V)return new V(r.data.map((o,a)=>o%s.data[a]),r.typeInfo);const i=s;return new G(r.value%i.value,r.typeInfo)}Normalize(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V){const s=this.Length(e,t).value;return new V(r.data.map(i=>i/s),r.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(r instanceof V&&s instanceof V)return new V(r.data.map((a,u)=>Math.pow(a,s.data[u])),r.typeInfo);const i=r,o=s;return new G(Math.pow(i.value,o.value),r.typeInfo)}QuantizeToF16(e,t){const r=this.exec.evalExpression(e.args[0],t);return r instanceof V?new V(r.data.map(s=>s),r.typeInfo):new G(r.value,r.typeInfo)}Radians(e,t){const r=this.exec.evalExpression(e.args[0],t);return r instanceof V?new V(r.data.map(s=>s*Math.PI/180),r.typeInfo):new G(r.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(r instanceof V&&s instanceof V){const i=this._dot(r.data,s.data);return new V(r.data.map((o,a)=>o-2*i*s.data[a]),r.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,t){let r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(r instanceof V&&s instanceof V&&i instanceof G){const o=this._dot(s.data,r.data);return new V(r.data.map((a,u)=>{const f=1-i.value*i.value*(1-o*o);if(f<0)return 0;const d=Math.sqrt(f);return i.value*a-(i.value*o+d)*s.data[u]}),r.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,t){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.round(i)),r.typeInfo);const s=r;return new G(Math.round(s.value),r.typeInfo)}Saturate(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.min(Math.max(i,0),1)),r.typeInfo);const s=r;return new G(Math.min(Math.max(s.value,0),1),r.typeInfo)}Sign(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.sign(i)),r.typeInfo);const s=r;return new G(Math.sign(s.value),r.typeInfo)}Sin(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.sin(i)),r.typeInfo);const s=r;return new G(Math.sin(s.value),r.typeInfo)}Sinh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.sinh(i)),r.typeInfo);const s=r;return new G(Math.sinh(s.value),r.typeInfo)}_smoothstep(e,t,r){const s=Math.min(Math.max((r-e)/(t-e),0),1);return s*s*(3-2*s)}SmoothStep(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(i instanceof V&&r instanceof V&&s instanceof V)return new V(i.data.map((f,d)=>this._smoothstep(r.data[d],s.data[d],f)),i.typeInfo);const o=r,a=s,u=i;return new G(this._smoothstep(o.value,a.value,u.value),i.typeInfo)}Sqrt(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.sqrt(i)),r.typeInfo);const s=r;return new G(Math.sqrt(s.value),r.typeInfo)}Step(e,t){const r=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(s instanceof V&&r instanceof V)return new V(s.data.map((o,a)=>o<r.data[a]?0:1),s.typeInfo);const i=r;return new G(s.value<i.value?0:1,i.typeInfo)}Tan(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.tan(i)),r.typeInfo);const s=r;return new G(Math.tan(s.value),r.typeInfo)}Tanh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.tanh(i)),r.typeInfo);const s=r;return new G(Math.tanh(s.value),r.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return t==="mat2x2f"||t==="mat2x2h"?e:t==="mat2x3f"?this.getTypeInfo("mat3x2f"):t==="mat2x3h"?this.getTypeInfo("mat3x2h"):t==="mat2x4f"?this.getTypeInfo("mat4x2f"):t==="mat2x4h"?this.getTypeInfo("mat4x2h"):t==="mat3x2f"?this.getTypeInfo("mat2x3f"):t==="mat3x2h"?this.getTypeInfo("mat2x3h"):t==="mat3x3f"||t==="mat3x3h"?e:t==="mat3x4f"?this.getTypeInfo("mat4x3f"):t==="mat3x4h"?this.getTypeInfo("mat4x3h"):t==="mat4x2f"?this.getTypeInfo("mat2x4f"):t==="mat4x2h"?this.getTypeInfo("mat2x4h"):t==="mat4x3f"?this.getTypeInfo("mat3x4f"):t==="mat4x3h"?this.getTypeInfo("mat3x4h"):(t==="mat4x4f"||t==="mat4x4h"||console.error(`Invalid matrix type ${t}`),e)}Transpose(e,t){const r=this.exec.evalExpression(e.args[0],t);if(!(r instanceof Ze))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const s=this._getTransposeType(r.typeInfo);if(r.typeInfo.name==="mat2x2"||r.typeInfo.name==="mat2x2f"||r.typeInfo.name==="mat2x2h"){const i=r.data;return new Ze([i[0],i[2],i[1],i[3]],s)}if(r.typeInfo.name==="mat2x3"||r.typeInfo.name==="mat2x3f"||r.typeInfo.name==="mat2x3h"){const i=r.data;return new Ze([i[0],i[3],i[6],i[1],i[4],i[7]],s)}if(r.typeInfo.name==="mat2x4"||r.typeInfo.name==="mat2x4f"||r.typeInfo.name==="mat2x4h"){const i=r.data;return new Ze([i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13]],s)}if(r.typeInfo.name==="mat3x2"||r.typeInfo.name==="mat3x2f"||r.typeInfo.name==="mat3x2h"){const i=r.data;return new Ze([i[0],i[3],i[1],i[4],i[2],i[5]],s)}if(r.typeInfo.name==="mat3x3"||r.typeInfo.name==="mat3x3f"||r.typeInfo.name==="mat3x3h"){const i=r.data;return new Ze([i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8]],s)}if(r.typeInfo.name==="mat3x4"||r.typeInfo.name==="mat3x4f"||r.typeInfo.name==="mat3x4h"){const i=r.data;return new Ze([i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14]],s)}if(r.typeInfo.name==="mat4x2"||r.typeInfo.name==="mat4x2f"||r.typeInfo.name==="mat4x2h"){const i=r.data;return new Ze([i[0],i[4],i[1],i[5],i[2],i[6]],s)}if(r.typeInfo.name==="mat4x3"||r.typeInfo.name==="mat4x3f"||r.typeInfo.name==="mat4x3h"){const i=r.data;return new Ze([i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]],s)}if(r.typeInfo.name==="mat4x4"||r.typeInfo.name==="mat4x4f"||r.typeInfo.name==="mat4x4h"){const i=r.data;return new Ze([i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15]],s)}return console.error(`Invalid matrix type ${r.typeInfo.name}`),null}Trunc(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof V)return new V(r.data.map(i=>Math.trunc(i)),r.typeInfo);const s=r;return new G(Math.trunc(s.value),r.typeInfo)}Dpdx(e,t){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,t){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,t){return console.error("TODO: dpdxFine"),null}Dpdy(e,t){return console.error("TODO: dpdy"),null}DpdyCoarse(e,t){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,t){return console.error("TODO: dpdyFine"),null}Fwidth(e,t){return console.error("TODO: fwidth"),null}FwidthCoarse(e,t){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,t){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,t){const r=e.args[0],s=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(r instanceof Lr){const i=r.name,o=t.getVariableValue(i);if(o instanceof fi){if(s<0||s>=o.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const a=o.getMipLevelSize(s),u=o.dimension;return u==="1d"?new G(a[0],this.getTypeInfo("u32")):u==="3d"?new V(a,this.getTypeInfo("vec3u")):u==="2d"?new V(a.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${u} not found. Line ${e.line}`),null)}return console.error(`Texture ${i} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,t){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,t){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,t){const r=e.args[0],s=this.exec.evalExpression(e.args[1],t),i=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(s instanceof V)||s.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(r instanceof Lr){const o=r.name,a=t.getVariableValue(o);if(a instanceof fi){const u=Math.floor(s.data[0]),f=Math.floor(s.data[1]);if(u<0||u>=a.width||f<0||f>=a.height)return console.error(`Texture ${o} out of bounds. Line ${e.line}`),null;const d=a.getPixel(u,f,0,i);return d===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new V(d,this.getTypeInfo("vec4f"))}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,t){const r=e.args[0];if(r instanceof Lr){const s=r.name,i=t.getVariableValue(s);return i instanceof fi?new G(i.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${s} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,t){const r=e.args[0];if(r instanceof Lr){const s=r.name,i=t.getVariableValue(s);return i instanceof fi?new G(i.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${s} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,t){const r=e.args[0];if(r instanceof Lr){const s=r.name,i=t.getVariableValue(s);return i instanceof fi?new G(i.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${s} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,t){return console.error("TODO: textureSample"),null}TextureSampleBias(e,t){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,t){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,t){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,t){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,t){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,t){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,t){const r=e.args[0],s=this.exec.evalExpression(e.args[1],t),i=e.args.length===4?this.exec.evalExpression(e.args[2],t).value:0,o=e.args.length===4?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(o.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(s instanceof V)||s.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(r instanceof Lr){const a=r.name,u=t.getVariableValue(a);if(u instanceof fi){const f=u.getMipLevelSize(0),d=Math.floor(s.data[0]),p=Math.floor(s.data[1]);return d<0||d>=f[0]||p<0||p>=f[1]?(console.error(`Texture ${a} out of bounds. Line ${e.line}`),null):(u.setPixel(d,p,0,i,Array.from(o)),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t);return t.getVariable(s).value.getSubData(this.exec,r.postfix,t)}AtomicStore(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t),i=t.getVariable(s);let o=e.args[1];const a=this.exec.evalExpression(o,t),u=i.value.getSubData(this.exec,r.postfix,t);return u instanceof G&&a instanceof G&&(u.value=a.value),i.value instanceof ln&&i.value.setDataValue(this.exec,u,r.postfix,t),null}AtomicAdd(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t),i=t.getVariable(s);let o=e.args[1];const a=this.exec.evalExpression(o,t),u=i.value.getSubData(this.exec,r.postfix,t),f=new G(u.value,u.typeInfo);return u instanceof G&&a instanceof G&&(u.value+=a.value),i.value instanceof ln&&i.value.setDataValue(this.exec,u,r.postfix,t),f}AtomicSub(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t),i=t.getVariable(s);let o=e.args[1];const a=this.exec.evalExpression(o,t),u=i.value.getSubData(this.exec,r.postfix,t),f=new G(u.value,u.typeInfo);return u instanceof G&&a instanceof G&&(u.value-=a.value),i.value instanceof ln&&i.value.setDataValue(this.exec,u,r.postfix,t),f}AtomicMax(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t),i=t.getVariable(s);let o=e.args[1];const a=this.exec.evalExpression(o,t),u=i.value.getSubData(this.exec,r.postfix,t),f=new G(u.value,u.typeInfo);return u instanceof G&&a instanceof G&&(u.value=Math.max(u.value,a.value)),i.value instanceof ln&&i.value.setDataValue(this.exec,u,r.postfix,t),f}AtomicMin(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t),i=t.getVariable(s);let o=e.args[1];const a=this.exec.evalExpression(o,t),u=i.value.getSubData(this.exec,r.postfix,t),f=new G(u.value,u.typeInfo);return u instanceof G&&a instanceof G&&(u.value=Math.min(u.value,a.value)),i.value instanceof ln&&i.value.setDataValue(this.exec,u,r.postfix,t),f}AtomicAnd(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t),i=t.getVariable(s);let o=e.args[1];const a=this.exec.evalExpression(o,t),u=i.value.getSubData(this.exec,r.postfix,t),f=new G(u.value,u.typeInfo);return u instanceof G&&a instanceof G&&(u.value=u.value&a.value),i.value instanceof ln&&i.value.setDataValue(this.exec,u,r.postfix,t),f}AtomicOr(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t),i=t.getVariable(s);let o=e.args[1];const a=this.exec.evalExpression(o,t),u=i.value.getSubData(this.exec,r.postfix,t),f=new G(u.value,u.typeInfo);return u instanceof G&&a instanceof G&&(u.value=u.value|a.value),i.value instanceof ln&&i.value.setDataValue(this.exec,u,r.postfix,t),f}AtomicXor(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t),i=t.getVariable(s);let o=e.args[1];const a=this.exec.evalExpression(o,t),u=i.value.getSubData(this.exec,r.postfix,t),f=new G(u.value,u.typeInfo);return u instanceof G&&a instanceof G&&(u.value=u.value^a.value),i.value instanceof ln&&i.value.setDataValue(this.exec,u,r.postfix,t),f}AtomicExchange(e,t){let r=e.args[0];r instanceof _n&&(r=r.right);const s=this.exec.getVariableName(r,t),i=t.getVariable(s);let o=e.args[1];const a=this.exec.evalExpression(o,t),u=i.value.getSubData(this.exec,r.postfix,t),f=new G(u.value,u.typeInfo);return u instanceof G&&a instanceof G&&(u.value=a.value),i.value instanceof ln&&i.value.setDataValue(this.exec,u,r.postfix,t),f}AtomicCompareExchangeWeak(e,t){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,t){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,t){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,t){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,t){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,t){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,t){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,t){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,t){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,t){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,t){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,t){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,t){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,t){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,t){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,t){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,t){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,t){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,t){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,t){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,t){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,t){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,t){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,t){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,t){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,t){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,t){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,t){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,t){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,t){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,t){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,t){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,t){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,t){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,t){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,t){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,t){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,t){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,t){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,t){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,t){return console.error("TODO: quadSwapY"),null}}const Y0={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},or={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class Qn extends fB{constructor(e,t){var r;super(),this.ast=e??[],this.reflection=new Vs,this.reflection.updateAST(this.ast),this.context=(r=t==null?void 0:t.clone())!==null&&r!==void 0?r:new p1,this.builtins=new dB(this),this.typeInfo={bool:this.getTypeInfo(me.bool),i32:this.getTypeInfo(me.i32),u32:this.getTypeInfo(me.u32),f32:this.getTypeInfo(me.f32),f16:this.getTypeInfo(me.f16),vec2f:this.getTypeInfo(ne.vec2f),vec2u:this.getTypeInfo(ne.vec2u),vec2i:this.getTypeInfo(ne.vec2i),vec2h:this.getTypeInfo(ne.vec2h),vec3f:this.getTypeInfo(ne.vec3f),vec3u:this.getTypeInfo(ne.vec3u),vec3i:this.getTypeInfo(ne.vec3i),vec3h:this.getTypeInfo(ne.vec3h),vec4f:this.getTypeInfo(ne.vec4f),vec4u:this.getTypeInfo(ne.vec4u),vec4i:this.getTypeInfo(ne.vec4i),vec4h:this.getTypeInfo(ne.vec4h),mat2x2f:this.getTypeInfo(ne.mat2x2f),mat2x3f:this.getTypeInfo(ne.mat2x3f),mat2x4f:this.getTypeInfo(ne.mat2x4f),mat3x2f:this.getTypeInfo(ne.mat3x2f),mat3x3f:this.getTypeInfo(ne.mat3x3f),mat3x4f:this.getTypeInfo(ne.mat3x4f),mat4x2f:this.getTypeInfo(ne.mat4x2f),mat4x3f:this.getTypeInfo(ne.mat4x3f),mat4x4f:this.getTypeInfo(ne.mat4x4f)}}getVariableValue(e){var t,r;const s=(r=(t=this.context.getVariable(e))===null||t===void 0?void 0:t.value)!==null&&r!==void 0?r:null;if(s===null)return null;if(s instanceof G)return s.value;if(s instanceof V||s instanceof Ze)return Array.from(s.data);if(s instanceof ln&&s.typeInfo instanceof yo){if(s.typeInfo.format.name==="u32")return Array.from(new Uint32Array(s.buffer,s.offset,s.typeInfo.count));if(s.typeInfo.format.name==="i32")return Array.from(new Int32Array(s.buffer,s.offset,s.typeInfo.count));if(s.typeInfo.format.name==="f32")return Array.from(new Float32Array(s.buffer,s.offset,s.typeInfo.count))}return console.error(`Unsupported return variable type ${s.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,r,s){const i=this.context.clone();(s=s??{}).constants&&this._setOverrides(s.constants,i),this._execStatements(this.ast,i);const o=i.getFunction(e);if(!o)return void console.error(`Function ${e} not found`);if(typeof t=="number")t=[t,1,1];else{if(t.length===0)return void console.error("Invalid dispatch count");t.length===1?t=[t[0],1,1]:t.length===2?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const a=t[0],u=t[1],f=t[2],d=this.getTypeInfo("vec3u");i.setVariable("@num_workgroups",new V(t,d));for(const p in r)for(const m in r[p]){const v=r[p][m];i.variables.forEach(x=>{var b;const w=x.node;if(w!=null&&w.attributes){let S=null,R=null;for(const C of w.attributes)C.name==="binding"?S=C.value:C.name==="group"&&(R=C.value);if(m==S&&p==R)if(v.texture!==void 0&&v.descriptor!==void 0){const C=new fi(v.texture,this.getTypeInfo(w.type),v.descriptor,(b=v.texture.view)!==null&&b!==void 0?b:null);x.value=C}else v.uniform!==void 0?x.value=new ln(v.uniform,this.getTypeInfo(w.type)):x.value=new ln(v,this.getTypeInfo(w.type))}})}for(let p=0;p<f;++p)for(let m=0;m<u;++m)for(let v=0;v<a;++v)i.setVariable("@workgroup_id",new V([v,m,p],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(o,[v,m,p],i)}execStatement(e,t){if(e instanceof pA)return this.evalExpression(e.value,t);if(e instanceof mA){if(e.condition){const r=this.evalExpression(e.condition,t);if(!(r instanceof G))throw new Error("Invalid break-if condition");if(!r.value)return null}return Qn._breakObj}if(e instanceof vA)return Qn._continueObj;if(e instanceof Ru)this._let(e,t);else if(e instanceof di)this._var(e,t);else if(e instanceof bh)this._const(e,t);else if(e instanceof Xu)this._function(e,t);else{if(e instanceof hA)return this._if(e,t);if(e instanceof dA)return this._switch(e,t);if(e instanceof lA)return this._for(e,t);if(e instanceof aA)return this._while(e,t);if(e instanceof fA)return this._loop(e,t);if(e instanceof Sy){const r=t.clone();return r.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,r)}if(e instanceof uA)this._assign(e,t);else if(e instanceof cA)this._increment(e,t);else{if(e instanceof ui)return null;if(e instanceof l1){const r=e.name;t.getVariable(r)===null&&t.setVariable(r,new G(0,this.getTypeInfo("u32")))}else if(e instanceof c1)this._call(e,t);else{if(e instanceof gA||e instanceof u1)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,t){return e instanceof gs?this._evalBinaryOp(e,t):e instanceof Cn?this._evalLiteral(e,t):e instanceof Lr?this._evalVariable(e,t):e instanceof f1?this._evalCall(e,t):e instanceof Bs?this._evalCreate(e,t):e instanceof yA?this._evalConst(e,t):e instanceof _A?this._evalBitcast(e,t):e instanceof _n?this._evalUnaryOp(e,t):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var t;if(e instanceof me){const s=this.reflection.getTypeInfo(e);if(s!==null)return s}let r=(t=this.typeInfo[e])!==null&&t!==void 0?t:null;return r!==null||(r=this.reflection.getTypeInfoByName(e)),r}_setOverrides(e,t){for(const r in e){const s=e[r],i=this.reflection.getOverrideInfo(r);i!==null?(i.type===null&&(i.type=this.getTypeInfo("u32")),i.type.name==="u32"||i.type.name==="i32"||i.type.name==="f32"||i.type.name==="f16"?t.setVariable(r,new G(s,i.type)):i.type.name==="bool"?t.setVariable(r,new G(s?1:0,i.type)):i.type.name==="vec2"||i.type.name==="vec3"||i.type.name==="vec4"||i.type.name==="vec2f"||i.type.name==="vec3f"||i.type.name==="vec4f"||i.type.name==="vec2i"||i.type.name==="vec3i"||i.type.name==="vec4i"||i.type.name==="vec2u"||i.type.name==="vec3u"||i.type.name==="vec4u"||i.type.name==="vec2h"||i.type.name==="vec3h"||i.type.name==="vec4h"?t.setVariable(r,new V(s,i.type)):console.error(`Invalid constant type for ${r}`)):console.error(`Override ${r} does not exist in the shader.`)}}_dispatchWorkgroup(e,t,r){const s=[1,1,1];for(const d of e.node.attributes)if(d.name==="workgroup_size"){if(d.value.length>0){const p=r.getVariableValue(d.value[0]);s[0]=p instanceof G?p.value:parseInt(d.value[0])}if(d.value.length>1){const p=r.getVariableValue(d.value[1]);s[1]=p instanceof G?p.value:parseInt(d.value[1])}if(d.value.length>2){const p=r.getVariableValue(d.value[2]);s[2]=p instanceof G?p.value:parseInt(d.value[2])}}const i=this.getTypeInfo("vec3u"),o=this.getTypeInfo("u32");r.setVariable("@workgroup_size",new V(s,i));const a=s[0],u=s[1],f=s[2];for(let d=0,p=0;d<f;++d)for(let m=0;m<u;++m)for(let v=0;v<a;++v,++p){const x=[v,m,d],b=[v+t[0]*s[0],m+t[1]*s[1],d+t[2]*s[2]];r.setVariable("@local_invocation_id",new V(x,i)),r.setVariable("@global_invocation_id",new V(b,i)),r.setVariable("@local_invocation_index",new G(p,o)),this._dispatchExec(e,r)}}_dispatchExec(e,t){for(const r of e.node.args)for(const s of r.attributes)if(s.name==="builtin"){const i=`@${s.value}`,o=t.getVariable(i);o!==void 0&&t.variables.set(r.name,o)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof _n;)e=e.right;return e instanceof Lr?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,t){for(const r of e){if(r instanceof Array){const i=t.clone(),o=this._execStatements(r,i);if(o)return o;continue}const s=this.execStatement(r,t);if(s)return s}return null}_call(e,t){const r=t.clone();r.currentFunctionName=e.name;const s=t.getFunction(e.name);if(s){for(let i=0;i<s.node.args.length;++i){const o=s.node.args[i],a=this.evalExpression(e.args[i],r);r.setVariable(o.name,a,o)}this._execStatements(s.node.body,r)}else e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const r=this.getVariableName(e.variable,t),s=t.getVariable(r);s?e.operator==="++"?s.value instanceof G?s.value.value++:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):e.operator==="--"?s.value instanceof G?s.value.value--:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${r} not found. Line ${e.line}`)}_getVariableData(e,t){if(e instanceof Lr){const r=this.getVariableName(e,t),s=t.getVariable(r);return s===null?(console.error(`Variable ${r} not found. Line ${e.line}`),null):s.value.getSubData(this,e.postfix,t)}if(e instanceof _n){if(e.operator==="*"){const r=this._getVariableData(e.right,t);return r instanceof _l?r.reference.getSubData(this,e.postfix,t):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const r=this._getVariableData(e.right,t);return new _l(r)}}return null}_assign(e,t){let r=null,s="<var>",i=null;if(e.variable instanceof _n){const u=this._getVariableData(e.variable,t),f=this.evalExpression(e.value,t),d=e.operator;if(d==="="){if(u instanceof G||u instanceof V||u instanceof Ze){if(f instanceof G||f instanceof V||f instanceof Ze&&u.data.length===f.data.length)return void u.data.set(f.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(u instanceof ln&&f instanceof ln&&u.buffer.byteLength-u.offset>=f.buffer.byteLength-f.offset)return void(u.buffer.byteLength%4==0?new Uint32Array(u.buffer,u.offset,u.typeInfo.size/4).set(new Uint32Array(f.buffer,f.offset,f.typeInfo.size/4)):new Uint8Array(u.buffer,u.offset,u.typeInfo.size).set(new Uint8Array(f.buffer,f.offset,f.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(d==="+=")return u instanceof G||u instanceof V||u instanceof Ze?f instanceof G||f instanceof V||f instanceof Ze?void u.data.set(f.data.map((p,m)=>u.data[m]+p)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(d==="-=")return(u instanceof G||u instanceof V||u instanceof Ze)&&(f instanceof G||f instanceof V||f instanceof Ze)?void u.data.set(f.data.map((p,m)=>u.data[m]-p)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof _n){if(e.variable.operator==="*"){s=this.getVariableName(e.variable.right,t);const u=t.getVariable(s);if(!(u&&u.value instanceof _l))return void console.error(`Variable ${s} is not a pointer. Line ${e.line}`);r=u.value.reference;let f=e.variable.postfix;if(!f){let d=e.variable.right;for(;d instanceof _n;){if(d.postfix){f=d.postfix;break}d=d.right}}f&&(r=r.getSubData(this,f,t))}}else{i=e.variable.postfix,s=this.getVariableName(e.variable,t);const u=t.getVariable(s);if(u===null)return void console.error(`Variable ${s} not found. Line ${e.line}`);r=u.value}if(r instanceof _l&&(r=r.reference),r===null)return void console.error(`Variable ${s} not found. Line ${e.line}`);const o=this.evalExpression(e.value,t),a=e.operator;if(a==="=")if(r instanceof ln)r.setDataValue(this,o,i,t);else if(i){if(!(r instanceof V||r instanceof Ze))return void console.error(`Variable ${s} is not a vector or matrix. Line ${e.line}`);if(i instanceof tc){const u=this.evalExpression(i.index,t).value;if(r instanceof V){if(!(o instanceof G))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[u]=o.value}else{if(!(r instanceof Ze))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);{const f=this.evalExpression(i.index,t).value;if(f<0)return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);if(!(o instanceof V))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);{const d=r.typeInfo.getTypeName();if(d==="mat2x2"||d==="mat2x2f"||d==="mat2x2h"){if(!(f<2&&o.data.length===2))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[2*f]=o.data[0],r.data[2*f+1]=o.data[1]}else if(d==="mat2x3"||d==="mat2x3f"||d==="mat2x3h"){if(!(f<2&&o.data.length===3))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[3*f]=o.data[0],r.data[3*f+1]=o.data[1],r.data[3*f+2]=o.data[2]}else if(d==="mat2x4"||d==="mat2x4f"||d==="mat2x4h"){if(!(f<2&&o.data.length===4))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[4*f]=o.data[0],r.data[4*f+1]=o.data[1],r.data[4*f+2]=o.data[2],r.data[4*f+3]=o.data[3]}else if(d==="mat3x2"||d==="mat3x2f"||d==="mat3x2h"){if(!(f<3&&o.data.length===2))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[2*f]=o.data[0],r.data[2*f+1]=o.data[1]}else if(d==="mat3x3"||d==="mat3x3f"||d==="mat3x3h"){if(!(f<3&&o.data.length===3))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[3*f]=o.data[0],r.data[3*f+1]=o.data[1],r.data[3*f+2]=o.data[2]}else if(d==="mat3x4"||d==="mat3x4f"||d==="mat3x4h"){if(!(f<3&&o.data.length===4))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[4*f]=o.data[0],r.data[4*f+1]=o.data[1],r.data[4*f+2]=o.data[2],r.data[4*f+3]=o.data[3]}else if(d==="mat4x2"||d==="mat4x2f"||d==="mat4x2h"){if(!(f<4&&o.data.length===2))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[2*f]=o.data[0],r.data[2*f+1]=o.data[1]}else if(d==="mat4x3"||d==="mat4x3f"||d==="mat4x3h"){if(!(f<4&&o.data.length===3))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[3*f]=o.data[0],r.data[3*f+1]=o.data[1],r.data[3*f+2]=o.data[2]}else{if(d!=="mat4x4"&&d!=="mat4x4f"&&d!=="mat4x4h")return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);if(!(f<4&&o.data.length===4))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);r.data[4*f]=o.data[0],r.data[4*f+1]=o.data[1],r.data[4*f+2]=o.data[2],r.data[4*f+3]=o.data[3]}}}}}else if(i instanceof Ta){const u=i.value;if(!(r instanceof V))return void console.error(`Invalid assignment to ${u}. Variable ${s} is not a vector. Line ${e.line}`);if(o instanceof G){if(u.length>1)return void console.error(`Invalid assignment to ${u} for variable ${s}. Line ${e.line}`);if(u==="x")r.data[0]=o.value;else if(u==="y"){if(r.data.length<2)return void console.error(`Invalid assignment to ${u} for variable ${s}. Line ${e.line}`);r.data[1]=o.value}else if(u==="z"){if(r.data.length<3)return void console.error(`Invalid assignment to ${u} for variable ${s}. Line ${e.line}`);r.data[2]=o.value}else if(u==="w"){if(r.data.length<4)return void console.error(`Invalid assignment to ${u} for variable ${s}. Line ${e.line}`);r.data[3]=o.value}}else{if(!(o instanceof V))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);if(u.length!==o.data.length)return void console.error(`Invalid assignment to ${u} for variable ${s}. Line ${e.line}`);for(let f=0;f<u.length;++f){const d=u[f];if(d==="x"||d==="r")r.data[0]=o.data[f];else if(d==="y"||d==="g"){if(o.data.length<2)return void console.error(`Invalid assignment to ${d} for variable ${s}. Line ${e.line}`);r.data[1]=o.data[f]}else if(d==="z"||d==="b"){if(o.data.length<3)return void console.error(`Invalid assignment to ${d} for variable ${s}. Line ${e.line}`);r.data[2]=o.data[f]}else{if(d!=="w"&&d!=="a")return void console.error(`Invalid assignment to ${d} for variable ${s}. Line ${e.line}`);if(o.data.length<4)return void console.error(`Invalid assignment to ${d} for variable ${s}. Line ${e.line}`);r.data[3]=o.data[f]}}}}}else r instanceof G&&o instanceof G?r.value=o.value:r instanceof V&&o instanceof V||r instanceof Ze&&o instanceof Ze?r.data.set(o.data):console.error(`Invalid assignment to ${s}. Line ${e.line}`);else{const u=r.getSubData(this,i,t);if(u instanceof V&&o instanceof G){const f=u.data,d=o.value;if(a==="+=")for(let p=0;p<f.length;++p)f[p]+=d;else if(a==="-=")for(let p=0;p<f.length;++p)f[p]-=d;else if(a==="*=")for(let p=0;p<f.length;++p)f[p]*=d;else if(a==="/=")for(let p=0;p<f.length;++p)f[p]/=d;else if(a==="%=")for(let p=0;p<f.length;++p)f[p]%=d;else if(a==="&=")for(let p=0;p<f.length;++p)f[p]&=d;else if(a==="|=")for(let p=0;p<f.length;++p)f[p]|=d;else if(a==="^=")for(let p=0;p<f.length;++p)f[p]^=d;else if(a==="<<=")for(let p=0;p<f.length;++p)f[p]<<=d;else if(a===">>=")for(let p=0;p<f.length;++p)f[p]>>=d;else console.error(`Invalid operator ${a}. Line ${e.line}`)}else if(u instanceof V&&o instanceof V){const f=u.data,d=o.data;if(f.length!==d.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(a==="+=")for(let p=0;p<f.length;++p)f[p]+=d[p];else if(a==="-=")for(let p=0;p<f.length;++p)f[p]-=d[p];else if(a==="*=")for(let p=0;p<f.length;++p)f[p]*=d[p];else if(a==="/=")for(let p=0;p<f.length;++p)f[p]/=d[p];else if(a==="%=")for(let p=0;p<f.length;++p)f[p]%=d[p];else if(a==="&=")for(let p=0;p<f.length;++p)f[p]&=d[p];else if(a==="|=")for(let p=0;p<f.length;++p)f[p]|=d[p];else if(a==="^=")for(let p=0;p<f.length;++p)f[p]^=d[p];else if(a==="<<=")for(let p=0;p<f.length;++p)f[p]<<=d[p];else if(a===">>=")for(let p=0;p<f.length;++p)f[p]>>=d[p];else console.error(`Invalid operator ${a}. Line ${e.line}`)}else{if(!(u instanceof G&&o instanceof G))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);a==="+="?u.value+=o.value:a==="-="?u.value-=o.value:a==="*="?u.value*=o.value:a==="/="?u.value/=o.value:a==="%="?u.value%=o.value:a==="&="?u.value&=o.value:a==="|="?u.value|=o.value:a==="^="?u.value^=o.value:a==="<<="?u.value<<=o.value:a===">>="?u.value>>=o.value:console.error(`Invalid operator ${a}. Line ${e.line}`)}r instanceof ln&&r.setDataValue(this,u,i,t)}}_function(e,t){const r=new h1(e);t.functions.set(e.name,r)}_const(e,t){let r=null;e.value!==null&&(r=this.evalExpression(e.value,t)),t.createVariable(e.name,r,e)}_let(e,t){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,t),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof _n||(r=r.clone())}else{const s=e.type.name;if(s==="f32"||s==="i32"||s==="u32"||s==="bool"||s==="f16"||s==="vec2"||s==="vec3"||s==="vec4"||s==="vec2f"||s==="vec3f"||s==="vec4f"||s==="vec2i"||s==="vec3i"||s==="vec4i"||s==="vec2u"||s==="vec3u"||s==="vec4u"||s==="vec2h"||s==="vec3h"||s==="vec4h"||s==="vec2b"||s==="vec3b"||s==="vec4b"||s==="mat2x2"||s==="mat2x3"||s==="mat2x4"||s==="mat3x2"||s==="mat3x3"||s==="mat3x4"||s==="mat4x2"||s==="mat4x3"||s==="mat4x4"||s==="mat2x2f"||s==="mat2x3f"||s==="mat2x4f"||s==="mat3x2f"||s==="mat3x3f"||s==="mat3x4f"||s==="mat4x2f"||s==="mat4x3f"||s==="mat4x4f"||s==="mat2x2h"||s==="mat2x3h"||s==="mat2x4h"||s==="mat3x2h"||s==="mat3x3h"||s==="mat3x4h"||s==="mat4x2h"||s==="mat4x3h"||s==="mat4x4h"||s==="array"){const i=new Bs(e.type,[]);r=this._evalCreate(i,t)}}t.createVariable(e.name,r,e)}_var(e,t){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,t),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof _n||(r=r.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const s=e.type.name;if(s==="f32"||s==="i32"||s==="u32"||s==="bool"||s==="f16"||s==="vec2"||s==="vec3"||s==="vec4"||s==="vec2f"||s==="vec3f"||s==="vec4f"||s==="vec2i"||s==="vec3i"||s==="vec4i"||s==="vec2u"||s==="vec3u"||s==="vec4u"||s==="vec2h"||s==="vec3h"||s==="vec4h"||s==="vec2b"||s==="vec3b"||s==="vec4b"||s==="mat2x2"||s==="mat2x3"||s==="mat2x4"||s==="mat3x2"||s==="mat3x3"||s==="mat3x4"||s==="mat4x2"||s==="mat4x3"||s==="mat4x4"||s==="mat2x2f"||s==="mat2x3f"||s==="mat2x4f"||s==="mat3x2f"||s==="mat3x3f"||s==="mat3x4f"||s==="mat4x2f"||s==="mat4x3f"||s==="mat4x4f"||s==="mat2x2h"||s==="mat2x3h"||s==="mat2x4h"||s==="mat3x2h"||s==="mat3x3h"||s==="mat3x4h"||s==="mat4x2h"||s==="mat4x3h"||s==="mat4x4h"||e.type instanceof Pu||e.type instanceof ui||e.type instanceof ne){const i=new Bs(e.type,[]);r=this._evalCreate(i,t)}}t.createVariable(e.name,r,e)}_switch(e,t){t=t.clone();const r=this.evalExpression(e.condition,t);if(!(r instanceof G))return console.error(`Invalid if condition. Line ${e.line}`),null;let s=null;for(const i of e.cases)if(i instanceof wA)for(const o of i.selectors){if(o instanceof wh){s=i;continue}const a=this.evalExpression(o,t);if(!(a instanceof G))return console.error(`Invalid case selector. Line ${e.line}`),null;if(a.value===r.value)return this._execStatements(i.body,t)}else i instanceof TA&&(s=i);return s?this._execStatements(s.body,t):null}_if(e,t){t=t.clone();const r=this.evalExpression(e.condition,t);if(!(r instanceof G))return console.error(`Invalid if condition. Line ${e.line}`),null;if(r.value)return this._execStatements(e.body,t);for(const s of e.elseif){const i=this.evalExpression(s.condition,t);if(!(i instanceof G))return console.error(`Invalid if condition. Line ${e.line}`),null;if(i.value)return this._execStatements(s.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof G?e.value:(console.error("Expected scalar value.",e),0)}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const r=this._execStatements(e.body,t);if(r===Qn._breakObj)break;if(r!==null&&r!==Qn._continueObj)return r;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const r=this._execStatements(e.body,t);if(r===Qn._breakObj)break;if(r===Qn._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===Qn._breakObj)break}else if(r!==null)return r}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const r=this._execStatements(e.body,t);if(r===Qn._breakObj)break;if(r!==Qn._continueObj&&r!==null)return r}return null}_evalBitcast(e,t){const r=this.evalExpression(e.value,t),s=e.type;if(r instanceof G){const i=Cw(r.value,r.typeInfo.name,s.name);return new G(i,this.getTypeInfo(s))}if(r instanceof V){const i=r.typeInfo.getTypeName();let o="";if(i.endsWith("f"))o="f32";else if(i.endsWith("i"))o="i32";else if(i.endsWith("u"))o="u32";else if(i.endsWith("b"))o="bool";else{if(!i.endsWith("h"))return console.error(`Unknown vector type ${i}. Line ${e.line}`),null;o="f16"}const a=s.getTypeName();let u="";if(a.endsWith("f"))u="f32";else if(a.endsWith("i"))u="i32";else if(a.endsWith("u"))u="u32";else if(a.endsWith("b"))u="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${u}. Line ${e.line}`),null;u="f16"}const f=function(d,p,m){if(p===m)return d;const v=new Array(d.length);for(let x=0;x<d.length;x++)v[x]=Cw(d[x],p,m);return v}(Array.from(r.data),o,u);return new V(f,this.getTypeInfo(s))}return console.error(`TODO: bitcast for ${r.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var r;if(e instanceof Bs){if(e.type===null)return Ey.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}const s=e instanceof Bs?e.type.name:e.name,i=e instanceof Bs?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(i===null)return console.error(`Unknown type ${s}. Line ${e.line}`),null;if(i.size===0)return null;const o=new ln(new ArrayBuffer(i.size),i,0);if(i instanceof ho){if(e.args)for(let a=0;a<e.args.length;++a){const u=i.members[a],f=e.args[a],d=this.evalExpression(f,t);o.setData(this,d,u.type,u.offset,t)}}else if(i instanceof yo){let a=0;if(e.args)for(let u=0;u<e.args.length;++u){const f=e.args[u],d=this.evalExpression(f,t);i.format===null&&(((r=d.typeInfo)===null||r===void 0?void 0:r.name)==="x32"?i.format=this.getTypeInfo("i32"):i.format=d.typeInfo),o.setData(this,d,i.format,a,t),a+=i.stride}}else console.error(`Unknown type "${s}". Line ${e.line}`);return e instanceof Bs?o.getSubData(this,e.postfix,t):o}_evalLiteral(e,t){const r=this.getTypeInfo(e.type),s=r.name;return s==="x32"||s==="u32"||s==="f32"||s==="f16"||s==="i32"||s==="bool"?new G(e.scalarValue,r):s==="vec2"||s==="vec3"||s==="vec4"||s==="vec2f"||s==="vec3f"||s==="vec4f"||s==="vec2h"||s==="vec3h"||s==="vec4h"||s==="vec2i"||s==="vec3i"||s==="vec4i"||s==="vec2u"||s==="vec3u"||s==="vec4u"?this._callConstructorVec(e,t):s==="mat2x2"||s==="mat2x3"||s==="mat2x4"||s==="mat3x2"||s==="mat3x3"||s==="mat3x4"||s==="mat4x2"||s==="mat4x3"||s==="mat4x4"||s==="mat2x2f"||s==="mat2x3f"||s==="mat2x4f"||s==="mat3x2f"||s==="mat3x3f"||s==="mat3x4f"||s==="mat4x2f"||s==="mat4x3f"||s==="mat4x4f"||s==="mat2x2h"||s==="mat2x3h"||s==="mat2x4h"||s==="mat3x2h"||s==="mat3x3h"||s==="mat3x4h"||s==="mat4x2h"||s==="mat4x3h"||s==="mat4x4h"?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const r=t.getVariableValue(e.name);return r===null?r:r.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if(t.name==="f32")return t;for(let r=1;r<e.length;++r){const s=Qn._priority.get(t.name);Qn._priority.get(e[r].name)<s&&(t=e[r])}return t.name==="x32"?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const r=this.evalExpression(e.right,t);if(e.operator==="&")return new _l(r);if(e.operator==="*")return r instanceof _l?r.reference.getSubData(this,e.postfix,t):(console.error(`Invalid dereference. Line ${e.line}`),null);const s=r instanceof G?r.value:r instanceof V?Array.from(r.data):null;switch(e.operator){case"+":{if(ke(s)){const a=s.map((u,f)=>+u);return new V(a,r.typeInfo)}const i=s,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new G(+i,o)}case"-":{if(ke(s)){const a=s.map((u,f)=>-u);return new V(a,r.typeInfo)}const i=s,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new G(-i,o)}case"!":{if(ke(s)){const a=s.map((u,f)=>u?0:1);return new V(a,r.typeInfo)}const i=s,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new G(i?0:1,o)}case"~":{if(ke(s)){const a=s.map((u,f)=>~u);return new V(a,r.typeInfo)}const i=s,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new G(~i,o)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,t){const r=this.evalExpression(e.left,t),s=this.evalExpression(e.right,t),i=r instanceof G?r.value:r instanceof V||r instanceof Ze?Array.from(r.data):null,o=s instanceof G?s.value:s instanceof V||s instanceof Ze?Array.from(s.data):null;switch(e.operator){case"+":{if(ke(i)&&ke(o)){const d=i,p=o;if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v+p[x]);return new V(m,r.typeInfo)}if(ke(i)){const d=o,p=i.map((m,v)=>m+d);return new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d+m);return new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a+u,f)}case"-":{if(ke(i)&&ke(o)){const d=i,p=o;if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v-p[x]);return new V(m,r.typeInfo)}if(ke(i)){const d=o,p=i.map((m,v)=>m-d);return new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d-m);return new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a-u,f)}case"*":{if(ke(i)&&ke(o)){const d=i,p=o;if(r instanceof Ze&&s instanceof Ze){const m=function(w,S,R,C){if(or[S.name]===void 0||or[C.name]===void 0)return null;const O=or[S.name][0],I=or[S.name][1],F=or[C.name][0];if(O!==or[C.name][1])return null;const $=new Array(F*I);for(let q=0;q<I;q++)for(let K=0;K<F;K++){let le=0;for(let he=0;he<O;he++)le+=w[he*I+q]*R[K*O+he];$[q*F+K]=le}return $}(d,r.typeInfo,p,s.typeInfo);if(m===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const v=or[s.typeInfo.name][0],x=or[r.typeInfo.name][1],b=this.getTypeInfo(`mat${v}x${x}f`);return new Ze(m,b)}if(r instanceof Ze&&s instanceof V){const m=function(v,x,b,w){if(or[x.name]===void 0||Y0[w.name]===void 0)return null;const S=or[x.name][0],R=or[x.name][1];if(S!==b.length)return null;const C=new Array(R);for(let O=0;O<R;O++){let I=0;for(let F=0;F<S;F++)I+=v[F*R+O]*b[F];C[O]=I}return C}(d,r.typeInfo,p,s.typeInfo);return m===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new V(m,s.typeInfo)}if(r instanceof V&&s instanceof Ze){const m=function(v,x,b,w){if(Y0[x.name]===void 0||or[w.name]===void 0)return null;const S=or[w.name][0],R=or[w.name][1];if(R!==v.length)return null;const C=[];for(let O=0;O<S;O++){let I=0;for(let F=0;F<R;F++)I+=v[F]*b[F*S+O];C[O]=I}return C}(d,r.typeInfo,p,s.typeInfo);return m===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new V(m,r.typeInfo)}{if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v*p[x]);return new V(m,r.typeInfo)}}if(ke(i)){const d=o,p=i.map((m,v)=>m*d);return r instanceof Ze?new Ze(p,r.typeInfo):new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d*m);return s instanceof Ze?new Ze(p,s.typeInfo):new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a*u,f)}case"%":{if(ke(i)&&ke(o)){const d=i,p=o;if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v%p[x]);return new V(m,r.typeInfo)}if(ke(i)){const d=o,p=i.map((m,v)=>m%d);return new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d%m);return new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a%u,f)}case"/":{if(ke(i)&&ke(o)){const d=i,p=o;if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v/p[x]);return new V(m,r.typeInfo)}if(ke(i)){const d=o,p=i.map((m,v)=>m/d);return new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d/m);return new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a/u,f)}case"&":{if(ke(i)&&ke(o)){const d=i,p=o;if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v&p[x]);return new V(m,r.typeInfo)}if(ke(i)){const d=o,p=i.map((m,v)=>m&d);return new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d&m);return new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a&u,f)}case"|":{if(ke(i)&&ke(o)){const d=i,p=o;if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v|p[x]);return new V(m,r.typeInfo)}if(ke(i)){const d=o,p=i.map((m,v)=>m|d);return new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d|m);return new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a|u,f)}case"^":{if(ke(i)&&ke(o)){const d=i,p=o;if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v^p[x]);return new V(m,r.typeInfo)}if(ke(i)){const d=o,p=i.map((m,v)=>m^d);return new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d^m);return new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a^u,f)}case"<<":{if(ke(i)&&ke(o)){const d=i,p=o;if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v<<p[x]);return new V(m,r.typeInfo)}if(ke(i)){const d=o,p=i.map((m,v)=>m<<d);return new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d<<m);return new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a<<u,f)}case">>":{if(ke(i)&&ke(o)){const d=i,p=o;if(d.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=d.map((v,x)=>v>>p[x]);return new V(m,r.typeInfo)}if(ke(i)){const d=o,p=i.map((m,v)=>m>>d);return new V(p,r.typeInfo)}if(ke(o)){const d=i,p=o.map((m,v)=>d>>m);return new V(p,s.typeInfo)}const a=i,u=o,f=this._maxFormatTypeInfo([r.typeInfo,s.typeInfo]);return new G(a>>u,f)}case">":if(ke(i)&&ke(o)){const a=i,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((d,p)=>d>u[p]?1:0);return new V(f,r.typeInfo)}if(ke(i)){const a=o,u=i.map((f,d)=>f>a?1:0);return new V(u,r.typeInfo)}if(ke(o)){const a=i,u=o.map((f,d)=>a>f?1:0);return new V(u,s.typeInfo)}return new G(i>o?1:0,this.getTypeInfo("bool"));case"<":if(ke(i)&&ke(o)){const a=i,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((d,p)=>d<u[p]?1:0);return new V(f,r.typeInfo)}if(ke(i)){const a=o,u=i.map((f,d)=>f<a?1:0);return new V(u,r.typeInfo)}if(ke(o)){const a=i,u=o.map((f,d)=>a<f?1:0);return new V(u,s.typeInfo)}return new G(i<o?1:0,this.getTypeInfo("bool"));case"==":if(ke(i)&&ke(o)){const a=i,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((d,p)=>d===u[p]?1:0);return new V(f,r.typeInfo)}if(ke(i)){const a=o,u=i.map((f,d)=>f==a?1:0);return new V(u,r.typeInfo)}if(ke(o)){const a=i,u=o.map((f,d)=>a==f?1:0);return new V(u,s.typeInfo)}return new G(i===o?1:0,this.getTypeInfo("bool"));case"!=":if(ke(i)&&ke(o)){const a=i,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((d,p)=>d!==u[p]?1:0);return new V(f,r.typeInfo)}if(ke(i)){const a=o,u=i.map((f,d)=>f!==a?1:0);return new V(u,r.typeInfo)}if(ke(o)){const a=i,u=o.map((f,d)=>a!==f?1:0);return new V(u,s.typeInfo)}return new G(i!==o?1:0,this.getTypeInfo("bool"));case">=":if(ke(i)&&ke(o)){const a=i,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((d,p)=>d>=u[p]?1:0);return new V(f,r.typeInfo)}if(ke(i)){const a=o,u=i.map((f,d)=>f>=a?1:0);return new V(u,r.typeInfo)}if(ke(o)){const a=i,u=o.map((f,d)=>a>=f?1:0);return new V(u,s.typeInfo)}return new G(i>=o?1:0,this.getTypeInfo("bool"));case"<=":if(ke(i)&&ke(o)){const a=i,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((d,p)=>d<=u[p]?1:0);return new V(f,r.typeInfo)}if(ke(i)){const a=o,u=i.map((f,d)=>f<=a?1:0);return new V(u,r.typeInfo)}if(ke(o)){const a=i,u=o.map((f,d)=>a<=f?1:0);return new V(u,s.typeInfo)}return new G(i<=o?1:0,this.getTypeInfo("bool"));case"&&":if(ke(i)&&ke(o)){const a=i,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((d,p)=>d&&u[p]?1:0);return new V(f,r.typeInfo)}if(ke(i)){const a=o,u=i.map((f,d)=>f&&a?1:0);return new V(u,r.typeInfo)}if(ke(o)){const a=i,u=o.map((f,d)=>a&&f?1:0);return new V(u,s.typeInfo)}return new G(i&&o?1:0,this.getTypeInfo("bool"));case"||":if(ke(i)&&ke(o)){const a=i,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((d,p)=>d||u[p]?1:0);return new V(f,r.typeInfo)}if(ke(i)){const a=o,u=i.map((f,d)=>f||a?1:0);return new V(u,r.typeInfo)}if(ke(o)){const a=i,u=o.map((f,d)=>a||f?1:0);return new V(u,s.typeInfo)}return new G(i||o?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,t){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const r=t.clone();r.currentFunctionName=e.name;const s=t.getFunction(e.name);if(!s)return e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)?this._evalCreate(e,t):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let i=0;i<s.node.args.length;++i){const o=s.node.args[i],a=this.evalExpression(e.args[i],r);r.createVariable(o.name,a,o)}return this._execStatements(s.node.body,r)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothStep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const r=t.getFunction(e.name);if(r){const s=t.clone();for(let i=0;i<r.node.args.length;++i){const o=r.node.args[i],a=this.evalExpression(e.args[i],s);s.setVariable(o.name,a,o)}return this._execStatements(r.node.body,s)}return null}_callConstructorValue(e,t){if(!e.args||e.args.length===0)return new G(0,this.getTypeInfo(e.type));const r=this.evalExpression(e.args[0],t);return r.typeInfo=this.getTypeInfo(e.type),r.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const r=this.getTypeInfo(e.type),s=e.type.getTypeName(),i=Y0[s];if(i===void 0)return console.error(`Invalid vec constructor ${s}. Line ${e.line}`),null;const o=[];if(e instanceof Cn)if(e.isVector){const a=e.vectorValue;for(const u of a)o.push(u)}else o.push(e.scalarValue);else if(e.args)for(const a of e.args){const u=this.evalExpression(a,t);if(u instanceof V){const f=u.data;for(let d=0;d<f.length;++d){let p=f[d];o.push(p)}}else if(u instanceof G){let f=u.value;o.push(f)}}if(e.type instanceof ne&&e.type.format===null&&(e.type.format=ne.f32),o.length===0){const a=new Array(i).fill(0);return new V(a,r).getSubData(this,e.postfix,t)}if(o.length===1)for(;o.length<i;)o.push(o[0]);return o.length<i?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new V(o.length>i?o.slice(0,i):o,r).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const r=this.getTypeInfo(e.type),s=e.type.getTypeName(),i=or[s];if(i===void 0)return console.error(`Invalid matrix constructor ${s}. Line ${e.line}`),null;const o=[];if(e instanceof Cn)if(e.isVector){const a=e.vectorValue;for(const u of a)o.push(u)}else o.push(e.scalarValue);else if(e.args)for(const a of e.args){const u=this.evalExpression(a,t);u instanceof V?o.push(...u.data):u instanceof G?o.push(u.value):u instanceof Ze&&o.push(...u.data)}if(r instanceof wa&&r.format===null&&(r.format=this.getTypeInfo("f32")),o.length===0){const a=new Array(i[2]).fill(0);return new Ze(a,r).getSubData(this,e.postfix,t)}return o.length!==i[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ze(o,r).getSubData(this,e.postfix,t)}}Qn._breakObj=new ns(new Jr("BREAK",null),null),Qn._continueObj=new ns(new Jr("CONTINUE",null),null),Qn._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class hB{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class pB{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new hB,this._exec=new Qn,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const r=this._global_decl_or_directive();if(!r)break;t.push(r)}if(this._deferArrayCountEval.length>0){for(const r of this._deferArrayCountEval){const s=r.arrayType,i=r.countNode;if(i instanceof Lr){const o=i.name,a=this._context.constants.get(o);if(a)try{const u=a.constEvaluate(this._exec);s.count=u}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const r of t)r.search(s=>{s instanceof Ew||s instanceof X0?s.type=this._forwardType(s.type):s instanceof Pu?s.format=this._forwardType(s.format):s instanceof di||s instanceof Ru||s instanceof bh?s.type=this._forwardType(s.type):s instanceof Xu?s.returnType=this._forwardType(s.returnType):s instanceof Sw&&(s.type=this._forwardType(s.type))});return t}_forwardType(e){if(e instanceof Tw){const t=this._getType(e.name);if(t)return t}else e instanceof X0?e.type=this._forwardType(e.type):e instanceof Pu&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const t=new rB(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=t??this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>`${t}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==L.eof}_match(e){if(e instanceof ee)return!!this._check(e)&&(this._advance(),!0);for(let t=0,r=e.length;t<r;++t){const s=e[t];if(this._check(s))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),`${t}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const r=t.type;let s=!1;for(const i of e){if(r===i)return!0;i===L.tokens.name&&(s=!0)}if(s){const i=L.tokens.name.rule.exec(t.lexeme);if(i&&i.index==0&&i[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===L.tokens.name){const r=L.tokens.name.rule.exec(t.lexeme);return r&&r.index==0&&r[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=(t=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&t!==void 0?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(L.tokens.semicolon)&&!this._isAtEnd(););if(this._match(L.keywords.alias)){const t=this._type_alias();return this._consume(L.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(L.keywords.diagnostic)){const t=this._diagnostic();return this._consume(L.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(L.keywords.requires)){const t=this._requires_directive();return this._consume(L.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(L.keywords.enable)){const t=this._enable_directive();return this._consume(L.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}const e=this._attribute();if(this._check(L.keywords.var)){const t=this._global_variable_decl();return t!=null&&(t.attributes=e),this._consume(L.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(L.keywords.override)){const t=this._override_variable_decl();return t!=null&&(t.attributes=e),this._consume(L.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(L.keywords.let)){const t=this._global_let_decl();return t!=null&&(t.attributes=e),this._consume(L.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(L.keywords.const)){const t=this._global_const_decl();return t!=null&&(t.attributes=e),this._consume(L.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(L.keywords.struct)){const t=this._struct_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(L.keywords.fn)){const t=this._function_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(L.keywords.fn))return null;const e=this._currentLine,t=this._consume(L.tokens.ident,"Expected function name.").toString();this._consume(L.tokens.paren_left,"Expected '(' for function arguments.");const r=[];if(!this._check(L.tokens.paren_right))do{if(this._check(L.tokens.paren_right))break;const a=this._attribute(),u=this._consume(L.tokens.name,"Expected argument name.").toString();this._consume(L.tokens.colon,"Expected ':' for argument type.");const f=this._attribute(),d=this._type_decl();d!=null&&(d.attributes=f,r.push(this._updateNode(new Sw(u,d,a))))}while(this._match(L.tokens.comma));this._consume(L.tokens.paren_right,"Expected ')' after function arguments.");let s=null;if(this._match(L.tokens.arrow)){const a=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=a)}const i=this._compound_statement(),o=this._currentLine;return this._updateNode(new Xu(t,r,s,i,e,o),e)}_compound_statement(){const e=[];for(this._consume(L.tokens.brace_left,"Expected '{' for block.");!this._check(L.tokens.brace_right);){const t=this._statement();t!==null&&e.push(t)}return this._consume(L.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(L.tokens.semicolon)&&!this._isAtEnd(););if(this._check(L.tokens.attr)&&this._attribute(),this._check(L.keywords.if))return this._if_statement();if(this._check(L.keywords.switch))return this._switch_statement();if(this._check(L.keywords.loop))return this._loop_statement();if(this._check(L.keywords.for))return this._for_statement();if(this._check(L.keywords.while))return this._while_statement();if(this._check(L.keywords.continuing))return this._continuing_statement();if(this._check(L.keywords.static_assert))return this._static_assert_statement();if(this._check(L.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(L.keywords.return))e=this._return_statement();else if(this._check([L.keywords.var,L.keywords.let,L.keywords.const]))e=this._variable_statement();else if(this._match(L.keywords.discard))e=this._updateNode(new eB);else if(this._match(L.keywords.break)){const t=this._updateNode(new mA);if(this._currentLoop.length>0){const r=this._currentLoop[this._currentLoop.length-1];t.loopId=r.id}e=t,this._check(L.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(L.keywords.continue)){const t=this._updateNode(new vA);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${t.line}`);{const r=this._currentLoop[this._currentLoop.length-1];t.loopId=r.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(L.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(L.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new Q7(t),e)}_while_statement(){if(!this._match(L.keywords.while))return null;const e=this._updateNode(new aA(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(L.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(L.keywords.continuing))return null;const t=this._currentLine,r=this._compound_statement();return this._updateNode(new Sy(r,e),t)}_for_statement(){if(!this._match(L.keywords.for))return null;this._consume(L.tokens.paren_left,"Expected '('.");const e=this._updateNode(new lA(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(L.tokens.semicolon)?null:this._for_init(),this._consume(L.tokens.semicolon,"Expected ';'."),e.condition=this._check(L.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(L.tokens.semicolon,"Expected ';'."),e.increment=this._check(L.tokens.paren_right)?null:this._for_increment(),this._consume(L.tokens.paren_right,"Expected ')'."),this._check(L.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(L.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(L.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new di(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(L.keywords.let)){const e=this._currentLine,t=this._consume(L.tokens.name,"Expected name for let.").toString();let r=null;if(this._match(L.tokens.colon)){const i=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=i)}this._consume(L.tokens.equal,"Expected '=' for let.");const s=this._short_circuit_or_expression();return this._updateNode(new Ru(t,r,null,null,s),e)}if(this._match(L.keywords.const)){const e=this._currentLine,t=this._consume(L.tokens.name,"Expected name for const.").toString();let r=null;if(this._match(L.tokens.colon)){const i=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=i)}this._consume(L.tokens.equal,"Expected '=' for const.");const s=this._short_circuit_or_expression();return r===null&&s instanceof Cn&&(r=s.type),this._updateNode(new bh(t,r,null,null,s),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(t==null)return null;if(!this._check(L.increment_operators))return this._current=e,null;const r=this._consume(L.increment_operators,"Expected increment operator");return this._updateNode(new cA(r.type===L.tokens.plus_plus?Pl.increment:Pl.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(L.tokens.brace_right))return null;let r=this._match(L.tokens.underscore);if(r||(e=this._unary_expression()),!r&&e==null)return null;const s=this._consume(L.assignment_operators,"Expected assignment operator."),i=this._short_circuit_or_expression();return this._updateNode(new uA(du.parse(s.lexeme),e,i),t)}_func_call_statement(){if(!this._check(L.tokens.ident))return null;const e=this._currentLine,t=this._current,r=this._consume(L.tokens.ident,"Expected function name."),s=this._argument_expression_list();return s===null?(this._current=t,null):this._updateNode(new c1(r.lexeme,s),e)}_loop_statement(){if(!this._match(L.keywords.loop))return null;this._check(L.tokens.attr)&&this._attribute(),this._consume(L.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new fA([],null));this._currentLoop.push(e);let t=this._statement();for(;t!==null;){if(Array.isArray(t))for(let r of t)e.body.push(r);else e.body.push(t);if(t instanceof Sy){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(L.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(L.keywords.switch))return null;const e=this._updateNode(new dA(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(L.tokens.attr)&&this._attribute(),this._consume(L.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(L.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([L.keywords.default,L.keywords.case]);){if(this._match(L.keywords.case)){const r=this._case_selectors();for(const i of r)if(i instanceof wh){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(L.tokens.colon),this._check(L.tokens.attr)&&this._attribute(),this._consume(L.tokens.brace_left,"Exected '{' for switch case.");const s=this._case_body();this._consume(L.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new wA(r,s)))}if(this._match(L.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(L.tokens.colon),this._check(L.tokens.attr)&&this._attribute(),this._consume(L.tokens.brace_left,"Exected '{' for switch default.");const r=this._case_body();this._consume(L.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new TA(r)))}}return e}_case_selectors(){const e=[];for(this._match(L.keywords.default)?e.push(this._updateNode(new wh)):e.push(this._shift_expression());this._match(L.tokens.comma);)this._match(L.keywords.default)?e.push(this._updateNode(new wh)):e.push(this._shift_expression());return e}_case_body(){if(this._match(L.keywords.fallthrough))return this._consume(L.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const t=this._case_body();return t.length==0?e:[...e,t[0]]}_if_statement(){if(!this._match(L.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(L.tokens.attr)&&this._attribute();const r=this._compound_statement();let s=[];this._match_elseif()&&(this._check(L.tokens.attr)&&this._attribute(),s=this._elseif_statement(s));let i=null;return this._match(L.keywords.else)&&(this._check(L.tokens.attr)&&this._attribute(),i=this._compound_statement()),this._updateNode(new hA(t,r,s,i),e)}_match_elseif(){return this._tokens[this._current].type===L.keywords.else&&this._tokens[this._current+1].type===L.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const t=this._optional_paren_expression(),r=this._compound_statement();return e.push(this._updateNode(new tB(t,r))),this._match_elseif()&&(this._check(L.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(L.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new pA(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(L.tokens.or_or);)e=this._updateNode(new gs(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(L.tokens.and_and);)e=this._updateNode(new gs(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(L.tokens.or);)e=this._updateNode(new gs(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(L.tokens.xor);)e=this._updateNode(new gs(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(L.tokens.and);)e=this._updateNode(new gs(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([L.tokens.equal_equal,L.tokens.not_equal])?this._updateNode(new gs(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([L.tokens.less_than,L.tokens.greater_than,L.tokens.less_than_equal,L.tokens.greater_than_equal]);)e=this._updateNode(new gs(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([L.tokens.shift_left,L.tokens.shift_right]);)e=this._updateNode(new gs(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([L.tokens.plus,L.tokens.minus]);)e=this._updateNode(new gs(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([L.tokens.star,L.tokens.forward_slash,L.tokens.modulo]);)e=this._updateNode(new gs(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([L.tokens.minus,L.tokens.bang,L.tokens.tilde,L.tokens.star,L.tokens.and])?this._updateNode(new _n(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(L.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(L.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new tc(e)),r=this._postfix_expression();return r&&(t.postfix=r),t}if(this._match(L.tokens.period)){const e=this._consume(L.tokens.name,"Expected member name."),t=this._postfix_expression(),r=this._updateNode(new Ta(e.lexeme));return t&&(r.postfix=t),r}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(t!==null)return t;switch(e){case"void":return me.void;case"bool":return me.bool;case"i32":return me.i32;case"u32":return me.u32;case"f32":return me.f32;case"f16":return me.f16;case"vec2f":return ne.vec2f;case"vec3f":return ne.vec3f;case"vec4f":return ne.vec4f;case"vec2i":return ne.vec2i;case"vec3i":return ne.vec3i;case"vec4i":return ne.vec4i;case"vec2u":return ne.vec2u;case"vec3u":return ne.vec3u;case"vec4u":return ne.vec4u;case"vec2h":return ne.vec2h;case"vec3h":return ne.vec3h;case"vec4h":return ne.vec4h;case"mat2x2f":return ne.mat2x2f;case"mat2x3f":return ne.mat2x3f;case"mat2x4f":return ne.mat2x4f;case"mat3x2f":return ne.mat3x2f;case"mat3x3f":return ne.mat3x3f;case"mat3x4f":return ne.mat3x4f;case"mat4x2f":return ne.mat4x2f;case"mat4x3f":return ne.mat4x3f;case"mat4x4f":return ne.mat4x4f;case"mat2x2h":return ne.mat2x2h;case"mat2x3h":return ne.mat2x3h;case"mat2x4h":return ne.mat2x4h;case"mat3x2h":return ne.mat3x2h;case"mat3x3h":return ne.mat3x3h;case"mat3x4h":return ne.mat3x4h;case"mat4x2h":return ne.mat4x2h;case"mat4x3h":return ne.mat4x3h;case"mat4x4h":return ne.mat4x4h;case"mat2x2i":return ne.mat2x2i;case"mat2x3i":return ne.mat2x3i;case"mat2x4i":return ne.mat2x4i;case"mat3x2i":return ne.mat3x2i;case"mat3x3i":return ne.mat3x3i;case"mat3x4i":return ne.mat3x4i;case"mat4x2i":return ne.mat4x2i;case"mat4x3i":return ne.mat4x3i;case"mat4x4i":return ne.mat4x4i;case"mat2x2u":return ne.mat2x2u;case"mat2x3u":return ne.mat2x3u;case"mat2x4u":return ne.mat2x4u;case"mat3x2u":return ne.mat3x2u;case"mat3x3u":return ne.mat3x3u;case"mat3x4u":return ne.mat3x4u;case"mat4x2u":return ne.mat4x2u;case"mat4x3u":return ne.mat4x3u;case"mat4x4u":return ne.mat4x4u}return null}_validateTypeRange(e,t){if(t.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(t.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(L.tokens.ident)){const r=this._previous().toString();if(this._check(L.tokens.paren_left)){const s=this._argument_expression_list(),i=this._getType(r);return i!==null?this._updateNode(new Bs(i,s)):this._updateNode(new f1(r,s))}if(this._context.constants.has(r)){const s=this._context.constants.get(r);return this._updateNode(new yA(r,s.value))}return this._updateNode(new Lr(r))}if(this._match(L.tokens.int_literal)){const r=this._previous().toString();let s=r.endsWith("i")||r.endsWith("i")?me.i32:r.endsWith("u")||r.endsWith("U")?me.u32:me.x32;const i=parseInt(r);return this._validateTypeRange(i,s),this._updateNode(new Cn(new G(i,this._exec.getTypeInfo(s)),s))}if(this._match(L.tokens.uint_literal)){const r=parseInt(this._previous().toString());return this._validateTypeRange(r,me.u32),this._updateNode(new Cn(new G(r,this._exec.getTypeInfo(me.u32)),me.u32))}if(this._match([L.tokens.decimal_float_literal,L.tokens.hex_float_literal])){let r=this._previous().toString(),s=r.endsWith("h");s&&(r=r.substring(0,r.length-1));const i=parseFloat(r);this._validateTypeRange(i,s?me.f16:me.f32);const o=s?me.f16:me.f32;return this._updateNode(new Cn(new G(i,this._exec.getTypeInfo(o)),o))}if(this._match([L.keywords.true,L.keywords.false])){let r=this._previous().toString()===L.keywords.true.rule;return this._updateNode(new Cn(new G(r?1:0,this._exec.getTypeInfo(me.bool)),me.bool))}if(this._check(L.tokens.paren_left))return this._paren_expression();if(this._match(L.keywords.bitcast)){this._consume(L.tokens.less_than,"Expected '<'.");const r=this._type_decl();this._consume(L.tokens.greater_than,"Expected '>'.");const s=this._paren_expression();return this._updateNode(new _A(r,s))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new Bs(e,t))}_argument_expression_list(){if(!this._match(L.tokens.paren_left))return null;const e=[];do{if(this._check(L.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(L.tokens.comma));return this._consume(L.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(L.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(L.tokens.paren_right),e}_paren_expression(){this._consume(L.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(L.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(L.keywords.struct))return null;const e=this._currentLine,t=this._consume(L.tokens.ident,"Expected name for struct.").toString();this._consume(L.tokens.brace_left,"Expected '{' for struct body.");const r=[];for(;!this._check(L.tokens.brace_right);){const o=this._attribute(),a=this._consume(L.tokens.name,"Expected variable name.").toString();this._consume(L.tokens.colon,"Expected ':' for struct member type.");const u=this._attribute(),f=this._type_decl();f!=null&&(f.attributes=u),this._check(L.tokens.brace_right)?this._match(L.tokens.comma):this._consume(L.tokens.comma,"Expected ',' for struct member."),r.push(this._updateNode(new Ew(a,f,o)))}this._consume(L.tokens.brace_right,"Expected '}' after struct body.");const s=this._currentLine,i=this._updateNode(new ui(t,r,e,s),e);return this._context.structs.set(t,i),i}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(L.tokens.equal)){const t=this._const_expression();e.value=t}if(e.type!==null&&e.value instanceof Cn){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof Cn&&(e.type=e.value.type.name==="x32"?me.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(L.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(L.keywords.const))return null;const t=this._consume(L.tokens.name,"Expected variable name"),r=this._currentLine;let s=null;if(this._match(L.tokens.colon)){const u=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=u)}let i=null;this._consume(L.tokens.equal,"const declarations require an assignment");const o=this._short_circuit_or_expression();try{let u=[me.f32],f=o.constEvaluate(this._exec,u);f instanceof G&&this._validateTypeRange(f.value,u[0]),u[0]instanceof ne&&u[0].format===null&&f.typeInfo instanceof wa&&f.typeInfo.format!==null&&(f.typeInfo.format.name==="f16"?u[0].format=me.f16:f.typeInfo.format.name==="f32"?u[0].format=me.f32:f.typeInfo.format.name==="i32"?u[0].format=me.i32:f.typeInfo.format.name==="u32"?u[0].format=me.u32:f.typeInfo.format.name==="bool"?u[0].format=me.bool:console.error(`TODO: impelement template format type ${f.typeInfo.format.name}`)),i=this._updateNode(new Cn(f,u[0])),this._exec.context.setVariable(t.toString(),f)}catch{i=o}if(s!==null&&i instanceof Cn){if(i.type.name!=="x32"&&s.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${s.name}. Line:${this._currentLine}`);i.type=s,i.isScalar&&this._validateTypeRange(i.scalarValue,i.type)}else s===null&&i instanceof Cn&&(s=(e=i==null?void 0:i.type)!==null&&e!==void 0?e:me.f32,s===me.x32&&(s=me.i32));const a=this._updateNode(new bh(t.toString(),s,"","",i),r);return this._context.constants.set(a.name,a),a}_global_let_decl(){if(!this._match(L.keywords.let))return null;const e=this._currentLine,t=this._consume(L.tokens.name,"Expected variable name");let r=null;if(this._match(L.tokens.colon)){const i=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=i)}let s=null;if(this._match(L.tokens.equal)&&(s=this._const_expression()),r!==null&&s instanceof Cn){if(s.type.name!=="x32"&&r.getTypeName()!==s.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${s.type.name} to ${r.name}. Line:${this._currentLine}`);s.type=r}else r===null&&s instanceof Cn&&(r=s.type.name==="x32"?me.i32:s.type);return s instanceof Cn&&s.isScalar&&this._validateTypeRange(s.scalarValue,r),this._updateNode(new Ru(t.toString(),r,"","",s),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(L.keywords.var))return null;const e=this._currentLine;let t="",r="";this._match(L.tokens.less_than)&&(t=this._consume(L.storage_class,"Expected storage_class.").toString(),this._match(L.tokens.comma)&&(r=this._consume(L.access_mode,"Expected access_mode.").toString()),this._consume(L.tokens.greater_than,"Expected '>'."));const s=this._consume(L.tokens.name,"Expected variable name");let i=null;if(this._match(L.tokens.colon)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}return this._updateNode(new di(s.toString(),i,t,r,null),e)}_override_decl(){if(!this._match(L.keywords.override))return null;const e=this._consume(L.tokens.name,"Expected variable name");let t=null;if(this._match(L.tokens.colon)){const r=this._attribute();t=this._type_decl(),t!=null&&(t.attributes=r)}return this._updateNode(new l1(e.toString(),t,null))}_diagnostic(){this._consume(L.tokens.paren_left,"Expected '('");const e=this._consume(L.tokens.ident,"Expected severity control name.");this._consume(L.tokens.comma,"Expected ','");let t=this._consume(L.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(L.tokens.period)&&(t+=`.${this._consume(L.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(L.tokens.paren_right,"Expected ')'"),this._updateNode(new gA(e.toString(),t))}_enable_directive(){const e=this._consume(L.tokens.ident,"identity expected.");return this._updateNode(new G7(e.toString()))}_requires_directive(){const e=[this._consume(L.tokens.ident,"identity expected.").toString()];for(;this._match(L.tokens.comma);){const t=this._consume(L.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new J7(e))}_type_alias(){const e=this._consume(L.tokens.ident,"identity expected.");this._consume(L.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(t===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const r=this._updateNode(new u1(e.toString(),t));return this._context.aliases.set(r.name,r),r}_type_decl(){if(this._check([L.tokens.ident,...L.texel_format,L.keywords.bool,L.keywords.f32,L.keywords.i32,L.keywords.u32])){const r=this._advance().toString();if(this._context.structs.has(r))return this._context.structs.get(r);if(this._context.aliases.has(r))return this._context.aliases.get(r).type;if(!this._getType(r)){const s=this._updateNode(new Tw(r));return this._forwardTypeCount++,s}return this._updateNode(new me(r))}let e=this._texture_sampler_types();if(e)return e;if(this._check(L.template_types)){let r=this._advance().toString(),s=null,i=null;return this._match(L.tokens.less_than)&&(s=this._type_decl(),i=null,this._match(L.tokens.comma)&&(i=this._consume(L.access_mode,"Expected access_mode for pointer").toString()),this._consume(L.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new ne(r,s,i))}if(this._match(L.keywords.ptr)){let r=this._previous().toString();this._consume(L.tokens.less_than,"Expected '<' for pointer.");const s=this._consume(L.storage_class,"Expected storage_class for pointer");this._consume(L.tokens.comma,"Expected ',' for pointer.");const i=this._type_decl();let o=null;return this._match(L.tokens.comma)&&(o=this._consume(L.access_mode,"Expected access_mode for pointer").toString()),this._consume(L.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new X0(r,s.toString(),i,o))}const t=this._attribute();if(this._match(L.keywords.array)){let r=null,s=-1;const i=this._previous();let o=null;if(this._match(L.tokens.less_than)){r=this._type_decl(),this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let u="";if(this._match(L.tokens.comma)){o=this._shift_expression();try{u=o.constEvaluate(this._exec).toString(),o=null}catch{u="1"}}this._consume(L.tokens.greater_than,"Expected '>' for array."),s=u?parseInt(u):0}const a=this._updateNode(new Pu(i.toString(),t,r,s));return o&&this._deferArrayCountEval.push({arrayType:a,countNode:o}),a}return null}_texture_sampler_types(){if(this._match(L.sampler_type))return this._updateNode(new hu(this._previous().toString(),null,null));if(this._match(L.depth_texture_type))return this._updateNode(new hu(this._previous().toString(),null,null));if(this._match(L.sampled_texture_type)||this._match(L.multisampled_texture_type)){const e=this._previous();this._consume(L.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(L.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new hu(e.toString(),t,null))}if(this._match(L.storage_texture_type)){const e=this._previous();this._consume(L.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(L.texel_format,"Invalid texel format.").toString();this._consume(L.tokens.comma,"Expected ',' after texel format.");const r=this._consume(L.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(L.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new hu(e.toString(),t,r))}return null}_attribute(){let e=[];for(;this._match(L.tokens.attr);){const t=this._consume(L.attribute_name,"Expected attribute name"),r=this._updateNode(new SA(t.toString(),null));if(this._match(L.tokens.paren_left)){if(r.value=this._consume(L.literal_or_ident,"Expected attribute value").toString(),this._check(L.tokens.comma)){this._advance();do{const s=this._consume(L.literal_or_ident,"Expected attribute value").toString();r.value instanceof Array||(r.value=[r.value]),r.value.push(s)}while(this._match(L.tokens.comma))}this._consume(L.tokens.paren_right,"Expected ')'")}e.push(r)}return e.length==0?null:e}}class gB extends Vs{constructor(e){super(),e&&this.update(e)}update(e){const t=new pB().parse(e);this.updateAST(t)}}function mB(n){var i;const e={attributes:[],bindings:[]};let t;try{t=vB(n)}catch(o){return Re.error(o.message)(),e}for(const o of t.uniforms){const a=[];for(const u of((i=o.type)==null?void 0:i.members)||[])a.push({name:u.name,type:Rw(u.type)});e.bindings.push({type:"uniform",name:o.name,location:o.binding,group:o.group,members:a})}const r=t.entry.vertex[0],s=(r==null?void 0:r.inputs.length)||0;for(let o=0;o<s;o++){const a=r.inputs[o];if(a.locationType==="location"){const u=Rw(a.type);e.attributes.push({name:a.name,location:Number(a.location),type:u})}}return e}function Rw(n){return n.format?`${n.name}<${n.format.name}>`:n.name}function vB(n){try{return new gB(n)}catch(e){if(e instanceof Error)throw e;let t="WGSL parse error";throw typeof e=="object"&&(e!=null&&e.message)&&(t+=`: ${e.message} `),typeof e=="object"&&(e!=null&&e.token)&&(t+=e.token.line||""),new Error(t,{cause:e})}}const yB=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;
const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;
const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;
const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;
float sin_taylor_fp32(float a) {
float r, s, t, x;
if (a == 0.0) {
return 0.0;
}
x = -a * a;
s = a;
r = a;
r = r * x;
t = r * INVERSE_FACTORIAL_3;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_5;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_7;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_9;
s = s + t;
return s;
}
void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
if (a == 0.0) {
sin_t = 0.0;
cos_t = 1.0;
}
sin_t = sin_taylor_fp32(a);
cos_t = sqrt(1.0 - sin_t * sin_t);
}
float tan_taylor_fp32(float a) {
float sin_a;
float cos_a;
if (a == 0.0) {
return 0.0;
}
float z = floor(a / TWO_PI);
float r = a - TWO_PI * z;
float t;
float q = floor(r / PI_2 + 0.5);
int j = int(q);
if (j < -2 || j > 2) {
return 1.0 / 0.0;
}
t = r - PI_2 * q;
q = floor(t / PI_16 + 0.5);
int k = int(q);
int abs_k = int(abs(float(k)));
if (abs_k > 4) {
return 1.0 / 0.0;
} else {
t = t - PI_16 * q;
}
float u = 0.0;
float v = 0.0;
float sin_t, cos_t;
float s, c;
sincos_taylor_fp32(t, sin_t, cos_t);
if (k == 0) {
s = sin_t;
c = cos_t;
} else {
if (abs(float(abs_k) - 1.0) < 0.5) {
u = COS_TABLE_0;
v = SIN_TABLE_0;
} else if (abs(float(abs_k) - 2.0) < 0.5) {
u = COS_TABLE_1;
v = SIN_TABLE_1;
} else if (abs(float(abs_k) - 3.0) < 0.5) {
u = COS_TABLE_2;
v = SIN_TABLE_2;
} else if (abs(float(abs_k) - 4.0) < 0.5) {
u = COS_TABLE_3;
v = SIN_TABLE_3;
}
if (k > 0) {
s = u * sin_t + v * cos_t;
c = u * cos_t - v * sin_t;
} else {
s = u * sin_t - v * cos_t;
c = u * cos_t + v * sin_t;
}
}
if (j == 0) {
sin_a = s;
cos_a = c;
} else if (j == 1) {
sin_a = c;
cos_a = -s;
} else if (j == -1) {
sin_a = -c;
cos_a = s;
} else {
sin_a = -s;
cos_a = -c;
}
return sin_a / cos_a;
}
#endif
float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
return tan_taylor_fp32(a);
#else
return tan(a);
#endif
}
`,_B={name:"fp32",vs:yB},xB=[0,1,1,1],bB=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
out vec4 picking_vRGBcolor_Avalid;
vec3 picking_normalizeColor(vec3 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
vec4 picking_normalizeColor(vec4 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
bool picking_isColorZero(vec3 color) {
return dot(color, vec3(1.0)) < 0.00001;
}
bool picking_isColorValid(vec3 color) {
return dot(color, vec3(1.0)) > 0.00001;
}
bool isVertexHighlighted(vec3 vertexColor) {
vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
return
bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}
void picking_setPickingColor(vec3 pickingColor) {
pickingColor = picking_normalizeColor(pickingColor);
if (bool(picking.isActive)) {
picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));
if (!bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = pickingColor;
}
} else {
picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
}
}
void picking_setPickingAttribute(float value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.r = value;
}
}
void picking_setPickingAttribute(vec2 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rg = value;
}
}
void picking_setPickingAttribute(vec3 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = value;
}
}
`,wB=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
if (picking.isActive > 0.5) {
return color;
}
bool selected = bool(picking_vRGBcolor_Avalid.a);
if (selected) {
float highLightAlpha = picking.highlightColor.a;
float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
float highLightRatio = highLightAlpha / blendedAlpha;
vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
return vec4(blendedRGB, blendedAlpha);
} else {
return color;
}
}
vec4 picking_filterPickingColor(vec4 color) {
if (bool(picking.isActive)) {
if (picking_vRGBcolor_Avalid.a == 0.0) {
discard;
}
return picking_vRGBcolor_Avalid;
}
return color;
}
vec4 picking_filterColor(vec4 color) {
vec4 highlightColor = picking_filterHighlightColor(color);
return picking_filterPickingColor(highlightColor);
}
`,Pw={name:"picking",vs:bB,fs:wB,uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:xB},getUniforms:TB};function TB(n={},e){const t={};if(n.highlightedObjectColor!==void 0)if(n.highlightedObjectColor===null)t.isHighlightActive=!1;else{t.isHighlightActive=!0;const r=n.highlightedObjectColor.slice(0,3);t.highlightedObjectColor=r}if(n.highlightColor){const r=Array.from(n.highlightColor,s=>s/255);Number.isFinite(r[3])||(r[3]=1),t.highlightColor=r}return n.isActive!==void 0&&(t.isActive=!!n.isActive,t.isAttribute=!!n.isAttribute),n.useFloatColors!==void 0&&(t.useFloatColors=!!n.useFloatColors),t}function EA(n,e=[],t=0){const r=Math.fround(n),s=n-r;return e[t]=r,e[t+1]=s,e}function SB(n){return n-Math.fround(n)}function EB(n){const e=new Float32Array(32);for(let t=0;t<4;++t)for(let r=0;r<4;++r){const s=t*4+r;EA(n[r*4+t],e,s*2)}return e}const AB=`uniform float ONE;
vec2 split(float a) {
const float SPLIT = 4097.0;
float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float a_hi = t * ONE - (t - a);
float a_lo = a * ONE - a_hi;
#else
float a_hi = t - (t - a);
float a_lo = a - a_hi;
#endif
return vec2(a_hi, a_lo);
}
vec2 split2(vec2 a) {
vec2 b = split(a.x);
b.y += a.y;
return b;
}
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float sum = (a + b) * ONE;
float err = b - (sum - a) * ONE;
#else
float sum = a + b;
float err = b - (sum - a);
#endif
return vec2(sum, err);
}
vec2 twoSum(float a, float b) {
float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);
#else
float v = s - a;
float err = (a - (s - v)) + (b - v);
#endif
return vec2(s, err);
}
vec2 twoSub(float a, float b) {
float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);
#else
float v = s - a;
float err = (a - (s - v)) - (b + v);
#endif
return vec2(s, err);
}
vec2 twoSqr(float a) {
float prod = a * a;
vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *
a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;
#else
float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
return vec2(prod, err);
}
vec2 twoProd(float a, float b) {
float prod = a * b;
vec2 a_fp64 = split(a);
vec2 b_fp64 = split(b);
float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
return vec2(prod, err);
}
vec2 sum_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSum(a.x, b.x);
t = twoSum(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 sub_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSub(a.x, b.x);
t = twoSub(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 mul_fp64(vec2 a, vec2 b) {
vec2 prod = twoProd(a.x, b.x);
prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
return prod;
}
vec2 div_fp64(vec2 a, vec2 b) {
float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
vec2 yn = a * xn;
#endif
float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
vec2 prod = twoProd(xn, diff);
return sum_fp64(yn, prod);
}
vec2 sqrt_fp64(vec2 a) {
if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);
float x = 1.0 / sqrt(a.x);
float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
vec2 yn_sqr = twoSqr(yn) * ONE;
#else
vec2 yn_sqr = twoSqr(yn);
#endif
float diff = sub_fp64(a, yn_sqr).x;
vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
return sum_fp64(split(yn), prod);
#else
return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,CB={ONE:1};function RB(){return CB}const PB={name:"fp64-arithmetic",vs:AB,getUniforms:RB,fp64ify:EA,fp64LowPart:SB,fp64ifyMatrix4:EB},Iw=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
vec3 color;
};
struct PointLight {
vec3 color;
vec3 position;
vec3 attenuation;
};
struct DirectionalLight {
vec3 color;
vec3 direction;
};
uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;
uniform bool lighting_uEnabled;
float getPointLightAttenuation(PointLight pointLight, float distance) {
return pointLight.attenuation.x
+ pointLight.attenuation.y * distance
+ pointLight.attenuation.z * distance * distance;
}
#endif
`,IB={lightSources:{}};function q0(n={}){const{color:e=[0,0,0],intensity:t=1}=n;return e.map(r=>r*t/255)}function kB({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const r={};return n?r["lighting_uAmbientLight.color"]=q0(n):r["lighting_uAmbientLight.color"]=[0,0,0],e.forEach((s,i)=>{r[`lighting_uPointLight[${i}].color`]=q0(s),r[`lighting_uPointLight[${i}].position`]=s.position,r[`lighting_uPointLight[${i}].attenuation`]=s.attenuation||[1,0,0]}),r.lighting_uPointLightCount=e.length,t.forEach((s,i)=>{r[`lighting_uDirectionalLight[${i}].color`]=q0(s),r[`lighting_uDirectionalLight[${i}].direction`]=s.direction}),r.lighting_uDirectionalLightCount=t.length,r}function AA(n=IB){var e,t;if("lightSources"in n){const{ambientLight:r,pointLights:s,directionalLights:i}=n.lightSources||{};return r||s&&s.length>0||i&&i.length>0?Object.assign({},kB({ambientLight:r,pointLights:s,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const r={pointLights:[],directionalLights:[]};for(const s of n.lights||[])switch(s.type){case"ambient":r.ambientLight=s;break;case"directional":(e=r.directionalLights)==null||e.push(s);break;case"point":(t=r.pointLights)==null||t.push(s);break}return AA({lightSources:r})}return{}}const MB={name:"lights",vs:Iw,fs:Iw,getUniforms:AA,defines:{MAX_LIGHTS:3}},OB=`uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
vec3 halfway_direction = normalize(light_direction + view_direction);
float lambertian = dot(light_direction, normal_worldspace);
float specular = 0.0;
if (lambertian > 0.0) {
float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
specular = pow(specular_angle, lighting_uShininess);
}
lambertian = max(lambertian, 0.0);
return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = surfaceColor;
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = vec3(0, 0, 0);
vec3 surfaceColor = vec3(0, 0, 0);
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
`,NB={};function DB(n){const{ambient:e=.35,diffuse:t=.6,shininess:r=32,specularColor:s=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:r,lighting_uSpecularColor:s.map(i=>i/255)}}function LB(n=NB){if(!("material"in n))return{};const{material:e}=n;return e?DB(e):{lighting_uEnabled:!1}}const FB={name:"gouraud-lighting",dependencies:[MB],vs:OB,defines:{LIGHTING_VERTEX:1},getUniforms:LB},CA="#define SMOOTH_EDGE_RADIUS 0.5",BB=`
${CA}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,UB=`
${CA}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,VB={name:"geometry",vs:BB,fs:UB},tt={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(tt,"IDENTITY",{get:()=>(ft.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const vs={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},So={common:0,meters:1,pixels:2},Ay={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},zB=Object.keys(tt).map(n=>`const int COORDINATE_SYSTEM_${n} = ${tt[n]};`).join(""),$B=Object.keys(vs).map(n=>`const int PROJECTION_MODE_${n} = ${vs[n]};`).join(""),jB=Object.keys(So).map(n=>`const int UNIT_${n.toUpperCase()} = ${So[n]};`).join(""),WB=`${zB}
${$B}
${jB}
uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project_uPseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project_uCommonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project_uCommonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project_uCommonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project_uWrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project_uModelMatrix * position;
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project_uCoordinateOrigin;
}
}
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
(project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project_uCoordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
return offset * project_uFocalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project_uScale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project_uScale;
}
`;function HB(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}return!1}function Ef(n){let e={},t;return r=>{for(const s in r)if(!HB(r[s],e[s])){t=n(r),e=r;break}return t}}const kw=[0,0,0,0],XB=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],RA=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],YB=[0,0,0],PA=[0,0,0],qB=Ef(QB);function IA(n,e,t=PA){t.length<3&&(t=[t[0],t[1],0]);let r=t,s,i=!0;switch(e===tt.LNGLAT_OFFSETS||e===tt.METER_OFFSETS?s=t:s=n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case vs.WEB_MERCATOR:(e===tt.LNGLAT||e===tt.CARTESIAN)&&(s=[0,0,0],i=!1);break;case vs.WEB_MERCATOR_AUTO_OFFSET:e===tt.LNGLAT?r=s:e===tt.CARTESIAN&&(r=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],s=n.unprojectPosition(r),r[0]-=t[0],r[1]-=t[1],r[2]-=t[2]);break;case vs.IDENTITY:r=n.position.map(Math.fround),r[2]=r[2]||0;break;case vs.GLOBE:i=!1,s=null;break;default:i=!1}return{geospatialOrigin:s,shaderCoordinateOrigin:r,offsetMode:i}}function KB(n,e,t){const{viewMatrixUncentered:r,projectionMatrix:s}=n;let{viewMatrix:i,viewProjectionMatrix:o}=n,a=kw,u=kw,f=n.cameraPosition;const{geospatialOrigin:d,shaderCoordinateOrigin:p,offsetMode:m}=IA(n,e,t);return m&&(u=n.projectPosition(d||p),f=[f[0]-u[0],f[1]-u[1],f[2]-u[2]],u[3]=1,a=fc([],u,o),i=r||i,o=ha([],s,i),o=ha([],o,XB)),{viewMatrix:i,viewProjectionMatrix:o,projectionCenter:a,originCommon:u,cameraPosCommon:f,shaderCoordinateOrigin:p,geospatialOrigin:d}}function ZB({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:r=tt.DEFAULT,coordinateOrigin:s=PA,autoWrapLongitude:i=!1}){r===tt.DEFAULT&&(r=n.isGeospatial?tt.LNGLAT:tt.CARTESIAN);const o=qB({viewport:n,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:s});return o.project_uWrapLongitude=i,o.project_uModelMatrix=t||RA,o}function QB({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:r}){const{projectionCenter:s,viewProjectionMatrix:i,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:u,geospatialOrigin:f}=KB(n,t,r),d=n.getDistanceScales(),p=[n.width*e,n.height*e],m=fc([],[0,0,-n.focalDistance,1],n.projectionMatrix)[3]||1,v={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:u,project_uCommonOrigin:o.slice(0,3),project_uCenter:s,project_uPseudoMeters:!!n._pseudoMeters,project_uViewportSize:p,project_uDevicePixelRatio:e,project_uFocalDistance:m,project_uCommonUnitsPerMeter:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:YB,project_uScale:n.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:i,project_uModelMatrix:RA,project_uCameraPosition:a};if(f){const x=n.getDistanceScales(f);switch(t){case tt.METER_OFFSETS:v.project_uCommonUnitsPerWorldUnit=x.unitsPerMeter,v.project_uCommonUnitsPerWorldUnit2=x.unitsPerMeter2;break;case tt.LNGLAT:case tt.LNGLAT_OFFSETS:n._pseudoMeters||(v.project_uCommonUnitsPerMeter=x.unitsPerMeter),v.project_uCommonUnitsPerWorldUnit=x.unitsPerDegree,v.project_uCommonUnitsPerWorldUnit2=x.unitsPerDegree2;break;case tt.CARTESIAN:v.project_uCommonUnitsPerWorldUnit=[1,1,x.unitsPerMeter[2]],v.project_uCommonUnitsPerWorldUnit2=[0,0,x.unitsPerMeter2[2]];break}}return v}const GB={};function JB(n=GB){return"viewport"in n?ZB(n):{}}const g1={name:"project",dependencies:[_B,VB],vs:WB,getUniforms:JB},e9=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Oo={name:"project32",dependencies:[g1],vs:e9};function t9(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Ul(n,e){const t=fc([],e,n);return D_(t,t,1/t[3]),t}function Mw(n,e){const t=n%e;return t<0?e+t:t}function Cy(n,e,t){return n<e?e:n>t?t:n}function n9(n){return Math.log(n)*Math.LOG2E}const m1=Math.log2||n9;function yi(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const ys=Math.PI,kA=ys/4,es=ys/180,Ry=180/ys,nc=512,rp=4003e4,Ow=85.051129,r9=1.5;function s9(n){return m1(n)}function Eo(n){const[e,t]=n;yi(Number.isFinite(e)),yi(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude");const r=e*es,s=t*es,i=nc*(r+ys)/(2*ys),o=nc*(ys+Math.log(Math.tan(kA+s*.5)))/(2*ys);return[i,o]}function rc(n){const[e,t]=n,r=e/nc*(2*ys)-ys,s=2*(Math.atan(Math.exp(t/nc*(2*ys)-ys))-kA);return[r*Ry,s*Ry]}function i9(n){const{latitude:e}=n;yi(Number.isFinite(e));const t=Math.cos(e*es);return s9(rp*t)-9}function K0(n){const e=Math.cos(n*es);return nc/rp/e}function Py(n){const{latitude:e,longitude:t,highPrecision:r=!1}=n;yi(Number.isFinite(e)&&Number.isFinite(t));const s=nc,i=Math.cos(e*es),o=s/360,a=o/i,u=s/rp/i,f={unitsPerMeter:[u,u,u],metersPerUnit:[1/u,1/u,1/u],unitsPerDegree:[o,a,u],degreesPerUnit:[1/o,1/a,1/u]};if(r){const d=es*Math.tan(e*es)/i,p=o*d/2,m=s/rp*d,v=m/a*u;f.unitsPerDegree2=[0,p,m],f.unitsPerMeter2=[v,0,v]}return f}function MA(n,e){const[t,r,s]=n,[i,o,a]=e,{unitsPerMeter:u,unitsPerMeter2:f}=Py({longitude:t,latitude:r,highPrecision:!0}),d=Eo(n);d[0]+=i*(u[0]+f[0]*o),d[1]+=o*(u[1]+f[1]*o);const p=rc(d),m=(s||0)+(a||0);return Number.isFinite(s)||Number.isFinite(a)?[p[0],p[1],m]:p}function o9(n){const{height:e,pitch:t,bearing:r,altitude:s,scale:i,center:o}=n,a=t9();Fh(a,a,[0,0,-s]),$E(a,a,-t*es),jE(a,a,r*es);const u=i/e;return N_(a,a,[u,u,u]),o&&Fh(a,a,J5([],o)),a}function a9(n){const{width:e,height:t,altitude:r,pitch:s=0,offset:i,center:o,scale:a,nearZMultiplier:u=1,farZMultiplier:f=1}=n;let{fovy:d=sp(r9)}=n;r!==void 0&&(d=sp(r));const p=d*es,m=s*es,v=OA(d);let x=v;o&&(x+=o[2]*a/Math.cos(m)/t);const b=p*(.5+(i?i[1]:0)/t),w=Math.sin(b)*x/Math.sin(Cy(Math.PI/2-m-b,.01,Math.PI-.01)),S=Math.sin(m)*w+x,R=x*10,C=Math.min(S*f,R);return{fov:p,aspect:e/t,focalDistance:v,near:u,far:C}}function sp(n){return 2*Math.atan(.5/n)*Ry}function OA(n){return .5/Math.tan(.5*n*es)}function NA(n,e){const[t,r,s=0]=n;return yi(Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(s)),Ul(e,[t,r,s,1])}function rg(n,e,t=0){const[r,s,i]=n;if(yi(Number.isFinite(r)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(i))return Ul(e,[r,s,i,1]);const o=Ul(e,[r,s,0,1]),a=Ul(e,[r,s,1,1]),u=o[2],f=a[2],d=u===f?0:((t||0)-u)/(f-u);return ME([],o,a,d)}function l9(n){const{width:e,height:t,bounds:r,minExtent:s=0,maxZoom:i=24,offset:o=[0,0]}=n,[[a,u],[f,d]]=r,p=c9(n.padding),m=Eo([a,Cy(d,-85.051129,Ow)]),v=Eo([f,Cy(u,-85.051129,Ow)]),x=[Math.max(Math.abs(v[0]-m[0]),s),Math.max(Math.abs(v[1]-m[1]),s)],b=[e-p.left-p.right-Math.abs(o[0])*2,t-p.top-p.bottom-Math.abs(o[1])*2];yi(b[0]>0&&b[1]>0);const w=b[0]/x[0],S=b[1]/x[1],R=(p.right-p.left)/2/w,C=(p.top-p.bottom)/2/S,O=[(v[0]+m[0])/2+R,(v[1]+m[1])/2+C],I=rc(O),F=Math.min(i,m1(Math.abs(Math.min(w,S))));return yi(Number.isFinite(F)),{longitude:I[0],latitude:I[1],zoom:F}}function c9(n=0){return typeof n=="number"?{top:n,bottom:n,left:n,right:n}:(yi(Number.isFinite(n.top)&&Number.isFinite(n.bottom)&&Number.isFinite(n.left)&&Number.isFinite(n.right)),n)}const Nw=Math.PI/180;function u9(n,e=0){const{width:t,height:r,unproject:s}=n,i={targetZ:e},o=s([0,r],i),a=s([t,r],i);let u,f;const d=n.fovy?.5*n.fovy*Nw:Math.atan(.5/n.altitude),p=(90-n.pitch)*Nw;return d>p-.01?(u=Dw(n,0,e),f=Dw(n,t,e)):(u=s([0,0],i),f=s([t,0],i)),[o,a,f,u]}function Dw(n,e,t){const{pixelUnprojectionMatrix:r}=n,s=Ul(r,[e,0,1,1]),i=Ul(r,[e,n.height,1,1]),a=(t*n.distanceScales.unitsPerMeter[2]-s[2])/(i[2]-s[2]),u=ME([],s,i,a),f=rc(u);return f.push(t),f}const Lw=512;function f9(n){const{width:e,height:t,pitch:r=0}=n;let{longitude:s,latitude:i,zoom:o,bearing:a=0}=n;(s<-180||s>180)&&(s=Mw(s+180,360)-180),(a<-180||a>180)&&(a=Mw(a+180,360)-180);const u=m1(t/Lw);if(o<=u)o=u,i=0;else{const f=t/2/Math.pow(2,o),d=rc([0,f])[1];if(i<d)i=d;else{const p=rc([0,Lw-f])[1];i>p&&(i=p)}}return{width:e,height:t,longitude:s,latitude:i,zoom:o,pitch:r,bearing:a}}const d9=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,h9=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,p9=Ef(_9),g9=Ef(x9),m9=[0,0,0,1],v9=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function y9(n,e){const[t,r,s]=n,i=rg([t,r,s],e);return Number.isFinite(s)?i:[i[0],i[1],0]}function _9({viewport:n,center:e}){return new At(n.viewProjectionMatrix).invert().transform(e)}function x9({viewport:n,shadowMatrices:e}){const t=[],r=n.pixelUnprojectionMatrix,s=n.isGeospatial?void 0:1,i=[[0,0,s],[n.width,0,s],[0,n.height,s],[n.width,n.height,s],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>y9(o,r));for(const o of e){const a=o.clone().translate(new Fe(n.center).negate()),u=i.map(d=>a.transform(d)),f=new At().ortho({left:Math.min(...u.map(d=>d[0])),right:Math.max(...u.map(d=>d[0])),bottom:Math.min(...u.map(d=>d[1])),top:Math.max(...u.map(d=>d[1])),near:Math.min(...u.map(d=>-d[2])),far:Math.max(...u.map(d=>-d[2]))});t.push(f.multiplyRight(o))}return t}function b9(n,e){const{shadowEnabled:t=!0}=n;if(!t||!n.shadowMatrices||!n.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1,shadow_uShadowMap0:n.dummyShadowMap,shadow_uShadowMap1:n.dummyShadowMap};const r={shadow_uDrawShadowMap:!!n.drawToShadowMap,shadow_uUseShadowMap:n.shadowMaps?n.shadowMaps.length>0:!1,shadow_uColor:n.shadowColor||m9,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},s=p9({viewport:n.viewport,center:e.project_uCenter}),i=[],o=g9({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let a=0;a<n.shadowMatrices.length;a++){const u=o[a],f=u.clone().translate(new Fe(n.viewport.center).negate());e.project_uCoordinateSystem===tt.LNGLAT&&e.project_uProjectionMode===vs.WEB_MERCATOR?(o[a]=f,i[a]=s):(o[a]=u.clone().multiplyRight(v9),i[a]=f.transform(s))}for(let a=0;a<o.length;a++)r[`shadow_uViewProjectionMatrices[${a}]`]=o[a],r[`shadow_uProjectCenters[${a}]`]=i[a];for(let a=0;a<2;a++)r[`shadow_uShadowMap${a}`]=n.shadowMaps&&n.shadowMaps[a]||n.dummyShadowMap;return r}const Fw={name:"shadow",dependencies:[g1],vs:d9,fs:h9,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(n={},e={})=>"viewport"in n&&(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0)?b9(n,e):{}},No={...Pw,defaultUniforms:{...Pw.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},w9=[g1],T9=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function S9(){const n=Gl.getDefaultShaderAssembler();for(const e of w9)n.addDefaultModule(e);for(const e of T9)n.addShaderHook(e);return n}const E9=[255,255,255],A9=1;let C9=0;class R9{constructor(e={}){this.type="ambient";const{color:t=E9}=e,{intensity:r=A9}=e;this.id=e.id||`ambient-${C9++}`,this.color=t,this.intensity=r}}const P9=[255,255,255],I9=1,k9=[0,0,-1];let M9=0;class Bw{constructor(e={}){this.type="directional";const{color:t=P9}=e,{intensity:r=I9}=e,{direction:s=k9}=e,{_shadow:i=!1}=e;this.id=e.id||`directional-${M9++}`,this.color=t,this.intensity=r,this.type="directional",this.direction=new Fe(s).normalize().toArray(),this.shadow=i}getProjectedLight(e){return this}}class O9{constructor(e,t={id:"pass"}){const{id:r}=t;this.id=r,this.device=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class v1 extends O9{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[t,r]=this.device.canvasContext.getDrawingBufferSize(),s=e.clearCanvas??!0,i=e.clearColor??(s?[0,0,0,0]:!1),o=s?1:!1,a=s?0:!1,u=e.colorMask??15,f={viewport:[0,0,t,r]};e.colorMask&&(f.colorMask=u),e.scissorRect&&(f.scissorRect=e.scissorRect);const d=this.device.beginRenderPass({framebuffer:e.target,parameters:f,clearColor:i,clearDepth:o,clearStencil:a});try{return this._drawLayers(d,e)}finally{d.end()}}_drawLayers(e,t){const{target:r,moduleParameters:s,viewports:i,views:o,onViewportActive:a,clearStack:u=!0}=t;t.pass=t.pass||"unknown",u&&(this._lastRenderIndex=-1);const f=[];for(const d of i){const p=o&&o[d.id];a==null||a(d);const m=this._getDrawLayerParams(d,t),v=d.subViewports||[d];for(const x of v){const b=this._drawLayersInViewport(e,{target:r,moduleParameters:s,viewport:x,view:p,pass:t.pass,layers:t.layers},m);f.push(b)}}return f}_getDrawLayerParams(e,{layers:t,pass:r,isPicking:s=!1,layerFilter:i,cullRect:o,effects:a,moduleParameters:u},f=!1){var x;const d=[],p=DA(this._lastRenderIndex+1),m={layer:t[0],viewport:e,isPicking:s,renderPass:r,cullRect:o},v={};for(let b=0;b<t.length;b++){const w=t[b],S=this._shouldDrawLayer(w,m,i,v),R={shouldDrawLayer:S};S&&!f&&(R.layerRenderIndex=p(w,S),R.moduleParameters=this._getModuleParameters(w,a,r,u),R.layerParameters={...(x=w.context.deck)==null?void 0:x.props.parameters,...this.getLayerParameters(w,b,e)}),d[b]=R}return d}_drawLayersInViewport(e,{layers:t,moduleParameters:r,pass:s,target:i,viewport:o,view:a},u){const f=N9(this.device,{moduleParameters:r,target:i,viewport:o});if(a&&a.props.clear){const p=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;this.device.withParametersWebGL({scissorTest:!0,scissor:f},()=>this.device.clearWebGL(p))}const d={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:f});for(let p=0;p<t.length;p++){const m=t[p],{shouldDrawLayer:v,layerRenderIndex:x,moduleParameters:b,layerParameters:w}=u[p];if(v&&m.props.pickable&&d.pickableCount++,m.isComposite)d.compositeCount++;else if(v){d.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,x),b.viewport=o,m.context.renderPass=e;try{m._drawLayer({renderPass:e,moduleParameters:b,uniforms:{layerIndex:x},parameters:w})}catch(S){m.raiseError(S,`drawing ${m} to ${s}`)}}}return d}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t,r){return e.props.parameters}_shouldDrawLayer(e,t,r,s){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(t))return!1;t.layer=o,o=o.parent}if(r){const a=t.layer.id;if(a in s||(s[a]=r(t)),!s[a])return!1}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,r,s){var a,u;const i=this.device.canvasContext.cssToDeviceRatio(),o=Object.assign(Object.create(((a=e.internalState)==null?void 0:a.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,picking:{isActive:0},devicePixelRatio:i});if(t)for(const f of t)Object.assign(o,(u=f.getModuleParameters)==null?void 0:u.call(f,e));return Object.assign(o,this.getModuleParameters(e,t),s)}}function DA(n=0,e={}){const t={},r=(s,i)=>{const o=s.props._offset,a=s.id,u=s.parent&&s.parent.id;let f;if(u&&!(u in e)&&r(s.parent,!1),u in t){const d=t[u]=t[u]||DA(e[u],e);f=d(s,i),t[a]=d}else Number.isFinite(o)?(f=o+(e[u]||0),t[a]=null):f=n;return i&&f>=n&&(n=f+1),e[a]=f,f};return r}function N9(n,{moduleParameters:e,target:t,viewport:r}){const s=e&&e.devicePixelRatio||n.canvasContext.cssToDeviceRatio(),[,i]=n.canvasContext.getDrawingBufferSize(),o=t?t.height:i,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}class D9 extends v1{constructor(e,t){super(e,t),this.shadowMap=e.createTexture({width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),this.depthBuffer=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1,dataFormat:6402,type:5125}),this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[this.shadowMap],depthStencilAttachment:this.depthBuffer})}render(e){const t=this.fbo,r=this.device.canvasContext.cssToDeviceRatio(),s=e.viewports[0],i=s.width*r,o=s.height*r,a=[1,1,1,1];(i!==t.width||o!==t.height)&&t.resize({width:i,height:o}),super.render({...e,clearColor:a,target:t,pass:"shadow"})}getLayerParameters(e,t,r){return{...e.props.parameters,blend:!1,depthRange:[0,1],depthTest:!0}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null),this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)}}const L9={color:[255,255,255],intensity:1},Uw=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],F9=[0,0,0,200/255];class LA{constructor(e={}){this.id="lighting-effect",this.shadowColor=F9,this.shadow=!1,this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:r}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),r._addDefaultShaderModule(Fw),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const t in e){const r=e[t];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:t,viewports:r,onViewportActive:s,views:i}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:e,layerFilter:t,viewports:r,onViewportActive:s,views:i,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},t}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(Fw))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const r=new At().lookAt({eye:new Fe(t.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const r=new D9(e);this.shadowPasses[t]=r,this.shadowMaps[t]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:r}=this;!e&&t.length===0&&r.length===0&&(this.ambientLight=new R9(L9),this.directionalLights.push(new Bw(Uw[0]),new Bw(Uw[1])))}}class B9{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:r=1,type:s,padding:i=0,copy:o=!1,initialize:a=!1,maxCount:u}){const f=s||e&&e.constructor||Float32Array,d=t*r+i;if(ArrayBuffer.isView(e)){if(d<=e.length)return e;if(d*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new f(e.buffer,0,d)}let p=1/0;u&&(p=u*r+i);const m=this._allocate(f,d,a,p);return e&&o?m.set(e):a||m.fill(0,0,4),this._release(e),m}release(e){this._release(e)}_allocate(e,t,r,s){let i=Math.max(Math.ceil(t*this.opts.overAlloc),1);i>s&&(i=s);const o=this._pool,a=e.BYTES_PER_ELEMENT*i,u=o.findIndex(f=>f.byteLength>=a);if(u>=0){const f=new e(o.splice(u,1)[0],0,i);return r&&f.fill(0),f}return new e(i)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:r}=e,{byteLength:s}=r,i=t.findIndex(o=>o.byteLength>=s);i<0?t.push(r):(i>0||t.length<this.opts.poolSize)&&t.splice(i,0,r),t.length>this.opts.poolSize&&t.shift()}}const sc=new B9;function pu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function U9(n,e){const t=n%e;return t<0?e+t:t}function V9(n){return[n[12],n[13],n[14]]}function z9(n){return{left:xl(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),right:xl(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),bottom:xl(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),top:xl(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),near:xl(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),far:xl(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14])}}const Vw=new Fe;function xl(n,e,t,r){Vw.set(n,e,t);const s=Vw.len();return{distance:r/s,normal:new Fe(-n/s,-e/s,-t/s)}}function $9(n){return n-Math.fround(n)}let Jc;function Z0(n,e){const{size:t=1,startIndex:r=0}=e,s=e.endIndex!==void 0?e.endIndex:n.length,i=(s-r)/t;Jc=sc.allocate(Jc,i,{type:Float32Array,size:t*2});let o=r,a=0;for(;o<s;){for(let u=0;u<t;u++){const f=n[o++];Jc[a+u]=f,Jc[a+u+t]=$9(f)}a+=t*2}return Jc.subarray(0,i*t*2)}function j9(n){let e=null,t=!1;for(const r of n)r&&(e?(t||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],t=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const W9=Math.PI/180,H9=pu(),zw=[0,0,0],X9={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function Y9({width:n,height:e,orthographic:t,fovyRadians:r,focalDistance:s,padding:i,near:o,far:a}){const u=n/e,f=t?new At().orthographic({fovy:r,aspect:u,focalDistance:s,near:o,far:a}):new At().perspective({fovy:r,aspect:u,near:o,far:a});if(i){const{left:d=0,right:p=0,top:m=0,bottom:v=0}=i,x=un((d+n-p)/2,0,n)-n/2,b=un((m+e-v)/2,0,e)-e/2;f[8]-=x*2/n,f[9]+=b*2/e}return f}class La{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||X9,this.focalDistance=e.focalDistance||1,this.position=e.position||zw,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?vs.WEB_MERCATOR:vs.WEB_MERCATOR_AUTO_OFFSET:vs.IDENTITY}equals(e){return e instanceof La?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&gi(e.projectionMatrix,this.projectionMatrix)&&gi(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:t=!0}={}){const r=this.projectPosition(e),s=NA(r,this.pixelProjectionMatrix),[i,o]=s,a=t?o:this.height-o;return e.length===2?[i,a]:[i,a,s[2]]}unproject(e,{topLeft:t=!0,targetZ:r}={}){const[s,i,o]=e,a=t?i:this.height-i,u=r&&r*this.distanceScales.unitsPerMeter[2],f=rg([s,a,o],this.pixelUnprojectionMatrix,u),[d,p,m]=this.unprojectPosition(f);return Number.isFinite(o)?[d,p,m]:Number.isFinite(r)?[d,p,r]:[d,p]}projectPosition(e){const[t,r]=this.projectFlat(e),s=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[t,r,s]}unprojectPosition(e){const[t,r]=this.unprojectFlat(e),s=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[t,r,s]}projectFlat(e){if(this.isGeospatial){const t=Eo(e);return t[1]=un(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?rc(e):e}getBounds(e={}){const t={targetZ:e.z||0},r=this.unproject([0,0],t),s=this.unproject([this.width,0],t),i=this.unproject([0,this.height],t),o=this.unproject([this.width,this.height],t);return[Math.min(r[0],s[0],i[0],o[0]),Math.min(r[1],s[1],i[1],o[1]),Math.max(r[0],s[0],i[0],o[0]),Math.max(r[1],s[1],i[1],o[1])]}getDistanceScales(e){return e?Py({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:r=1,height:s=1}){return e<this.x+this.width&&this.x<e+r&&t<this.y+this.height&&this.y<t+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,z9(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=i9({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Py({latitude:r,longitude:t}));const s=Math.pow(2,this.zoom);this.scale=s;const{position:i,modelMatrix:o}=e;let a=zw;if(i&&(a=o?new At(o).transformAsVector(i,[]):i),this.isGeospatial){const u=this.projectPosition([t,r,0]);this.center=new Fe(a).scale(this.distanceScales.unitsPerMeter).add(u)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:t=H9,projectionMatrix:r=null,orthographic:s=!1,fovyRadians:i,fovy:o=75,near:a=.1,far:u=1e3,padding:f=null,focalDistance:d=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=new At().multiplyRight(t).translate(new Fe(this.center).negate()),this.projectionMatrix=r||Y9({width:this.width,height:this.height,orthographic:s,fovyRadians:i||o*W9,focalDistance:d,padding:f,near:a,far:u});const p=pu();ha(p,p,this.projectionMatrix),ha(p,p,this.viewMatrix),this.viewProjectionMatrix=p,this.viewMatrixInverse=qv([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=V9(this.viewMatrixInverse);const m=pu(),v=pu();N_(m,m,[this.width/2,-this.height/2,1]),Fh(m,m,[1,-1,0]),ha(v,m,this.viewProjectionMatrix),this.pixelProjectionMatrix=v,this.pixelUnprojectionMatrix=qv(pu(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||ft.warn("Pixel project matrix not invertible")()}}La.displayName="Viewport";class Ao extends La{constructor(e={}){const{latitude:t=0,longitude:r=0,zoom:s=0,pitch:i=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:u=1.01,nearZ:f,farZ:d,orthographic:p=!1,projectionMatrix:m,repeat:v=!1,worldOffset:x=0,position:b,padding:w,legacyMeterSizes:S=!1}=e;let{width:R,height:C,altitude:O=1.5}=e;const I=Math.pow(2,s);R=R||1,C=C||1;let F,$=null;if(m)O=m[5]/2,F=sp(O);else{e.fovy?(F=e.fovy,O=OA(F)):F=sp(O);let K;if(w){const{top:le=0,bottom:he=0}=w;K=[0,un((le+C-he)/2,0,C)-C/2]}$=a9({width:R,height:C,scale:I,center:b&&[0,0,b[2]*K0(t)],offset:K,pitch:i,fovy:F,nearZMultiplier:a,farZMultiplier:u}),Number.isFinite(f)&&($.near=f),Number.isFinite(d)&&($.far=d)}let q=o9({height:C,pitch:i,bearing:o,scale:I,altitude:O});x&&(q=new At().translate([512*x,0,0]).multiplyLeft(q)),super({...e,width:R,height:C,viewMatrix:q,longitude:r,latitude:t,zoom:s,...$,fovy:F,focalDistance:O}),this.latitude=t,this.longitude=r,this.zoom=s,this.pitch=i,this.bearing=o,this.altitude=O,this.fovy=F,this.orthographic=p,this._subViewports=v?[]:null,this._pseudoMeters=S,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let s=t;s<=r;s++){const i=s?new Ao({...this,worldOffset:s}):this;this._subViewports.push(i)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,r]=this.projectFlat(e),s=(e[2]||0)*K0(e[1]);return[t,r,s]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,r]=this.unprojectFlat(e),s=(e[2]||0)/K0(r);return[t,r,s]}addMetersToLngLat(e,t){return MA(e,t)}panByPosition(e,t){const r=rg(t,this.pixelUnprojectionMatrix),s=this.projectFlat(e),i=Lh([],s,kE([],r)),o=Lh([],this.center,i),[a,u]=this.unprojectFlat(o);return{longitude:a,latitude:u}}getBounds(e={}){const t=u9(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:r,height:s}=this,{longitude:i,latitude:o,zoom:a}=l9({width:r,height:s,bounds:e,...t});return new Ao({width:r,height:s,longitude:i,latitude:o,zoom:a})}}Ao.displayName="WebMercatorViewport";const $w=[0,0,0];function Q0(n,e,t=!1){const r=e.projectPosition(n);if(t&&e instanceof Ao){const[s,i,o=0]=n,a=e.getDistanceScales([s,i]);r[2]=o*a.unitsPerMeter[2]}return r}function q9(n){const{viewport:e,modelMatrix:t,coordinateOrigin:r}=n;let{coordinateSystem:s,fromCoordinateSystem:i,fromCoordinateOrigin:o}=n;return s===tt.DEFAULT&&(s=e.isGeospatial?tt.LNGLAT:tt.CARTESIAN),i===void 0&&(i=s),o===void 0&&(o=r),{viewport:e,coordinateSystem:s,coordinateOrigin:r,modelMatrix:t,fromCoordinateSystem:i,fromCoordinateOrigin:o}}function FA(n,{viewport:e,modelMatrix:t,coordinateSystem:r,coordinateOrigin:s,offsetMode:i}){let[o,a,u=0]=n;switch(t&&([o,a,u]=fc([],[o,a,u,1],t)),r){case tt.LNGLAT:return Q0([o,a,u],e,i);case tt.LNGLAT_OFFSETS:return Q0([o+s[0],a+s[1],u+(s[2]||0)],e,i);case tt.METER_OFFSETS:return Q0(MA(s,[o,a,u]),e,i);case tt.CARTESIAN:default:return e.isGeospatial?[o+s[0],a+s[1],u+s[2]]:e.projectPosition([o,a,u])}}function K9(n,e){const{viewport:t,coordinateSystem:r,coordinateOrigin:s,modelMatrix:i,fromCoordinateSystem:o,fromCoordinateOrigin:a}=q9(e),{autoOffset:u=!0}=e,{geospatialOrigin:f=$w,shaderCoordinateOrigin:d=$w,offsetMode:p=!1}=u?IA(t,r,s):{},m=FA(n,{viewport:t,modelMatrix:i,coordinateSystem:o,coordinateOrigin:a,offsetMode:p});if(p){const v=t.projectPosition(f||d);UE(m,m,v)}return m}let Z9=1,Q9=1;class BA{constructor(){E(this,"time",0);E(this,"channels",new Map);E(this,"animations",new Map);E(this,"playing",!1);E(this,"lastEngineTime",-1)}addChannel(e){const{delay:t=0,duration:r=Number.POSITIVE_INFINITY,rate:s=1,repeat:i=1}=e,o=Z9++,a={time:0,delay:t,duration:r,rate:s,repeat:i};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,r]of this.animations)r.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return t===void 0?!1:this.time>=t.delay+t.duration*t.repeat}getTime(e){if(e===void 0)return this.time;const t=this.channels.get(e);return t===void 0?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const s of t)this._setChannelTime(s,this.time);const r=this.animations.values();for(const s of r){const{animation:i,channel:o}=s;i.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const r=Q9++;return this.animations.set(r,{animation:e,channel:t}),e.setTime(this.getTime(t)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const r=t-e.delay,s=e.duration*e.repeat;r>=s?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}let G9=0;const J9={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:n=>console.error(n),stats:Bl.stats.get(`animation-loop-${G9++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class eU{constructor(e){E(this,"device",null);E(this,"canvas",null);E(this,"props");E(this,"animationProps",null);E(this,"timeline",null);E(this,"stats");E(this,"cpuTime");E(this,"gpuTime");E(this,"frameRate");E(this,"display");E(this,"needsRedraw","initialized");E(this,"_initialized",!1);E(this,"_running",!1);E(this,"_animationFrameId",null);E(this,"_nextFramePromise",null);E(this,"_resolveNextFrame",null);E(this,"_cpuStartTime",0);if(this.props={...J9,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:t=!0}=this.props;this.stats=e.stats||new wf({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:t}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var e;return(e=this.device)!=null&&e.isLost?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=V7(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(z7(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){var e,t;if(!this.device)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:(t=(e=this.device)==null?void 0:e.canvasContext)==null?void 0:t.canvas,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){var e;if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=((e=this.device.canvasContext)==null?void 0:e.canvas)||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const r=this.props.onAddHTML(t);r&&(t.innerHTML=r)}}_getSizeAndAspect(){var i,o,a,u;if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=((o=(i=this.device)==null?void 0:i.canvasContext)==null?void 0:o.getPixelSize())||[1,1];let r=1;const s=(u=(a=this.device)==null?void 0:a.canvasContext)==null?void 0:u.canvas;return s&&s.clientHeight?r=s.clientWidth/s.clientHeight:e>0&&t>0&&(r=e/t),{width:e,height:t,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){var e,t;this.props.autoResizeDrawingBuffer&&((t=(e=this.device)==null?void 0:e.canvasContext)==null||t.resize({useDevicePixels:this.props.useDevicePixels}))}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}class jw{constructor(e){E(this,"id");E(this,"userData",{});E(this,"topology");E(this,"bufferLayout",[]);E(this,"vertexCount");E(this,"indices");E(this,"attributes");this.id=e.id||Da("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&Ht(this.indices.usage===fn.INDEX)}destroy(){var e;(e=this.indices)==null||e.destroy();for(const t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices}_calculateVertexCount(e){return e.byteLength/12}}function tU(n,e){if(e instanceof jw)return e;const t=nU(n,e),{attributes:r,bufferLayout:s}=rU(n,e);return new jw({topology:e.topology||"triangle-list",bufferLayout:s,vertexCount:e.vertexCount,indices:t,attributes:r})}function nU(n,e){if(!e.indices)return;const t=e.indices.value;return n.createBuffer({usage:fn.INDEX,data:t})}function rU(n,e){const t=[],r={};for(const[i,o]of Object.entries(e.attributes)){let a=i;switch(i){case"POSITION":a="positions";break;case"NORMAL":a="normals";break;case"TEXCOORD_0":a="texCoords";break;case"COLOR_0":a="colors";break}r[a]=n.createBuffer({data:o.value,id:`${i}-buffer`});const{value:u,size:f,normalized:d}=o;t.push({name:a,format:D7(u,f,d)})}const s=e._calculateVertexCount(e.attributes,e.indices);return{attributes:r,bufferLayout:t,vertexCount:s}}class sU{constructor(e){E(this,"modules");E(this,"moduleUniforms");E(this,"moduleBindings");E(this,"moduleUniformsChanged");const t=tg(Object.values(e).filter(r=>r.dependencies));for(const r of t)e[r.name]=r;Re.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[r,s]of Object.entries(e)){const i=r;this.moduleUniforms[i]=s.defaultUniforms||{},this.moduleBindings[i]={}}}destroy(){}setProps(e){var t;for(const r of Object.keys(e)){const s=r,i=e[s],o=this.modules[s];if(!o){Re.warn(`Module ${r} not found`)();continue}const a=this.moduleUniforms[s],u=this.moduleBindings[s],f=((t=o.getUniforms)==null?void 0:t.call(o,i,a))||i,{uniforms:d,bindings:p}=o1(f);this.moduleUniforms[s]={...a,...d},this.moduleBindings[s]={...u,...p}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindings(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){var t;const e={};for(const[r,s]of Object.entries(this.moduleUniforms))for(const[i,o]of Object.entries(s))e[`${r}.${i}`]={type:(t=this.modules[r].uniformTypes)==null?void 0:t[i],value:String(o)};return e}}const Vp=class Vp{constructor(e){E(this,"device");E(this,"_hashCounter",0);E(this,"_hashes",{});E(this,"_renderPipelineCache",{});E(this,"_computePipelineCache",{});this.device=e}static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new Vp(e),e._lumaData.defaultPipelineFactory}createRenderPipeline(e){const t={...ec.defaultProps,...e},r=this._hashRenderPipeline(t);if(!this._renderPipelineCache[r]){const s=this.device.createRenderPipeline({...t,id:t.id?`${t.id}-cached`:void 0});s.hash=r,this._renderPipelineCache[r]={pipeline:s,useCount:0}}return this._renderPipelineCache[r].useCount++,this._renderPipelineCache[r].pipeline}createComputePipeline(e){const t={...Qh.defaultProps,...e},r=this._hashComputePipeline(t);if(!this._computePipelineCache[r]){const s=this.device.createComputePipeline({...t,id:t.id?`${t.id}-cached`:void 0});s.hash=r,this._computePipelineCache[r]={pipeline:s,useCount:0}}return this._computePipelineCache[r].useCount++,this._computePipelineCache[r].pipeline}release(e){const t=e.hash,r=e instanceof Qh?this._computePipelineCache:this._renderPipelineCache;r[t].useCount--,r[t].useCount===0&&(r[t].pipeline.destroy(),delete r[t])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const t=this._getHash(e.vs.source),r=e.fs?this._getHash(e.fs.source):0,s="-",i=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${t}/${r}V${s}BL${i}`;default:const o=this._getHash(JSON.stringify(e.parameters));return`${t}/${r}V${s}T${e.topology}P${o}BL${i}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};E(Vp,"defaultProps",{...ec.defaultProps});let Iy=Vp;const zp=class zp{constructor(e){E(this,"device");E(this,"_cache",{});this.device=e}static getDefaultShaderFactory(e){var t;return(t=e._lumaData).defaultShaderFactory||(t.defaultShaderFactory=new zp(e)),e._lumaData.defaultShaderFactory}createShader(e){const t=this._hashShader(e);let r=this._cache[t];if(!r){const s=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=r={shader:s,useCount:0}}return r.useCount++,r.shader}release(e){const t=this._hashShader(e),r=this._cache[t];r&&(r.useCount--,r.useCount===0&&(delete this._cache[t],r.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}};E(zp,"defaultProps",{...qh.defaultProps});let ky=zp;function iU(n,e){var s;const t={},r="Values";if(n.attributes.length===0&&!((s=n.varyings)!=null&&s.length))return{"No attributes or varyings":{[r]:"N/A"}};for(const i of n.attributes)if(i){const o=`${i.location} ${i.name}: ${i.type}`;t[`in ${o}`]={[r]:i.stepMode||"vertex"}}for(const i of n.varyings||[]){const o=`${i.location} ${i.name}`;t[`out ${o}`]={[r]:JSON.stringify(i.accessor)}}return t}let Dn=null,G0=null;function oU(n,{id:e,minimap:t,opaque:r,top:s="0",left:i="0",rgbaScale:o=1}){Dn||(Dn=document.createElement("canvas"),Dn.id=e,Dn.title=e,Dn.style.zIndex="100",Dn.style.position="absolute",Dn.style.top=s,Dn.style.left=i,Dn.style.border="blue 1px solid",Dn.style.transform="scaleY(-1)",document.body.appendChild(Dn),G0=Dn.getContext("2d")),(Dn.width!==n.width||Dn.height!==n.height)&&(Dn.width=n.width/2,Dn.height=n.height/2,Dn.style.width="400px",Dn.style.height="400px");const a=n.device.readPixelsToArrayWebGL(n),u=G0.createImageData(n.width,n.height),f=0;for(let d=0;d<a.length;d+=4)u.data[f+d+0]=a[d+0]*o,u.data[f+d+1]=a[d+1]*o,u.data[f+d+2]=a[d+2]*o,u.data[f+d+3]=r?255:a[d+3]*o;G0.putImageData(u,0,0)}const bl=2,aU=1e4,$p=class $p{constructor(e,t){E(this,"device");E(this,"id");E(this,"source");E(this,"vs");E(this,"fs");E(this,"pipelineFactory");E(this,"shaderFactory");E(this,"userData",{});E(this,"parameters");E(this,"topology");E(this,"bufferLayout");E(this,"isInstanced");E(this,"instanceCount",0);E(this,"vertexCount");E(this,"indexBuffer",null);E(this,"bufferAttributes",{});E(this,"constantAttributes",{});E(this,"bindings",{});E(this,"uniforms",{});E(this,"vertexArray");E(this,"transformFeedback",null);E(this,"pipeline");E(this,"shaderInputs");E(this,"_uniformStore");E(this,"_attributeInfos",{});E(this,"_gpuGeometry",null);E(this,"_getModuleUniforms");E(this,"props");E(this,"_pipelineNeedsUpdate","newly created");E(this,"_needsRedraw","initializing");E(this,"_destroyed",!1);E(this,"_lastDrawTimestamp",-1);E(this,"_lastLogTime",0);E(this,"_logOpen",!1);E(this,"_drawCount",0);var a,u,f,d;this.props={...$p.defaultProps,...t},t=this.props,this.id=t.id||Da("model"),this.device=e,Object.assign(this.userData,t.userData);const r=Object.fromEntries(((a=this.props.modules)==null?void 0:a.map(p=>[p.name,p]))||[]);this.setShaderInputs(t.shaderInputs||new sU(r));const s=lU(e),i=(((u=this.props.modules)==null?void 0:u.length)>0?this.props.modules:(f=this.shaderInputs)==null?void 0:f.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){(d=this.props).shaderLayout||(d.shaderLayout=mB(this.props.source));const{source:p,getUniforms:m}=this.props.shaderAssembler.assembleShader({platformInfo:s,...this.props,modules:i});this.source=p,this._getModuleUniforms=m}else{const{vs:p,fs:m,getUniforms:v}=this.props.shaderAssembler.assembleShaderPair({platformInfo:s,...this.props,modules:i});this.vs=p,this.fs=m,this._getModuleUniforms=v}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||Iy.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||ky.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.uniforms&&this.setUniforms(t.uniforms),t.moduleSettings&&this.updateModuleSettings(t.moduleSettings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),(e=this._gpuGeometry)==null||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){this.predraw();let t;try{this._logDrawCallStart(),this.pipeline=this._updatePipeline(),this.pipeline.setBindings(this.bindings,{disableWarnings:this.props.disableWarnings}),Xh(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:r}=this.vertexArray,s=r?r.byteLength/(r.indexType==="uint32"?4:2):void 0;t=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{this._logDrawCallEnd()}return this._logFramebuffer(e),t?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",t}setGeometry(e){var r;(r=this._gpuGeometry)==null||r.destroy();const t=e&&tU(this.device,e);t&&(this.setTopology(t.topology||"triangle-list"),this.bufferLayout=Ww(t.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(t)),this._gpuGeometry=t}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){this.bufferLayout=this._gpuGeometry?Ww(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){Ty(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new N7(this.shaderInputs.modules);for(const t of Object.keys(this.shaderInputs.modules)){const r=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=r}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindings()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){e.indices&&Re.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();for(const[r,s]of Object.entries(e)){const i=this.bufferLayout.find(u=>Hw(u).includes(r));if(!i){Re.warn(`Model(${this.id}): Missing layout for buffer "${r}".`)();continue}const o=Hw(i);let a=!1;for(const u of o){const f=this._attributeInfos[u];f&&(this.vertexArray.setBuffer(f.location,s),a=!0)}!a&&!((t==null?void 0:t.disableWarnings)??this.props.disableWarnings)&&Re.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${r}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[r,s]of Object.entries(e)){const i=this._attributeInfos[r];i?this.vertexArray.setConstantWebGL(i.location,s):((t==null?void 0:t.disableWarnings)??this.props.disableWarnings)||Re.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${r}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){Xh(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettings(e){const{bindings:t,uniforms:r}=o1(this._getModuleUniforms(e));Object.assign(this.bindings,t),Object.assign(this.uniforms,r),this.setNeedsRedraw("moduleSettings")}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof Yh?e=Math.max(e,t.texture.updateTimestamp):t instanceof fn||t instanceof Zr?e=Math.max(e,t.updateTimestamp):t instanceof Kh||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[r]of Object.entries(t))!this.pipeline.shaderLayout.attributes.find(s=>s.name===r)&&r!=="positions"&&delete t[r];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(Re.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const r=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debug:this.props.debugShaders});let s=null;this.source?s=r:this.fs&&(s=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debug:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,vs:r,fs:s}),this._attributeInfos=J4(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_logDrawCallStart(){const e=Re.level>3?0:aU;Re.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,Re.group(bl,`>>> DRAWING MODEL ${this.id}`,{collapsed:Re.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=iU(this.pipeline.shaderLayout,this.id);Re.table(bl,e)();const t=this.shaderInputs.getDebugTable();for(const[s,i]of Object.entries(this.uniforms))t[s]={value:i};Re.table(bl,t)();const r=this._getAttributeDebugTable();Re.table(bl,this._attributeInfos)(),Re.table(bl,r)(),Re.groupEnd(bl)(),this._logOpen=!1}}_logFramebuffer(e){const t=Re.get("framebuffer");if(this._drawCount++,!t||this._drawCount++>3&&this._drawCount%60)return;const r=e.props.framebuffer;r&&oU(r,{id:r.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,r]of Object.entries(this._attributeInfos))e[r.location]={name:t,type:r.shaderType,values:this._getBufferOrConstantValues(this.vertexArray.attributes[r.location],r.bufferDataType)};if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,r=t.indexType==="uint32"?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:r.toString()}}return e}_getBufferOrConstantValues(e,t){const r=nA(t);return(e instanceof fn?new r(e.debugData):e).toString()}};E($p,"defaultProps",{...ec.defaultProps,source:null,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Gl.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});let rr=$p;function Ww(n,e){const t=[...n];for(const r of e){const s=t.findIndex(i=>i.name===r.name);s<0?t.push(r):t[s]=r}return t}function lU(n){return{type:n.type,shaderLanguage:n.info.shadingLanguage,shaderLanguageVersion:n.info.shadingLanguageVersion,gpu:n.info.gpu,features:n.features}}function Hw(n){var e;return n.attributes?(e=n.attributes)==null?void 0:e.map(t=>t.attribute):[n.name]}class Yu{constructor(e,t=rr.defaultProps){E(this,"device");E(this,"model");E(this,"transformFeedback");Ht(Yu.isSupported(e),"BufferTransform not yet implemented on WebGPU"),this.device=e,this.model=new rr(this.device,{id:t.id||"buffer-transform-model",fs:t.fs||LF(),topology:t.topology||"point-list",...t}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}static isSupported(e){var t;return((t=e==null?void 0:e.info)==null?void 0:t.type)==="webgl"}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}update(...e){console.warn("TextureTransform#update() not implemented")}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(t instanceof fn)return t.readAsync();const{buffer:r,byteOffset:s=0,byteLength:i=r.byteLength}=t;return r.readAsync(s,i)}}class _i{constructor(e){E(this,"id");E(this,"topology");E(this,"vertexCount");E(this,"indices");E(this,"attributes");E(this,"userData",{});const{attributes:t={},indices:r=null,vertexCount:s=null}=e;this.id=e.id||Da("geometry"),this.topology=e.topology,r&&(this.indices=ArrayBuffer.isView(r)?{value:r,size:1}:r),this.attributes={};for(const[i,o]of Object.entries(t)){const a=ArrayBuffer.isView(o)?{value:o}:o;Ht(ArrayBuffer.isView(a.value),`${this._print(i)}: must be typed array or object with value as typed array`),(i==="POSITION"||i==="positions")&&!a.size&&(a.size=3),i==="indices"?(Ht(!this.indices),this.indices=a):this.attributes[i]=a}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=s||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let r=1/0;for(const s of Object.values(e)){const{value:i,size:o,constant:a}=s;!a&&i&&o>=1&&(r=Math.min(r,i.length/o))}return Ht(Number.isFinite(r)),r}}const cU={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class UA extends v1{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:r,viewports:s,onViewportActive:i,pickingFBO:o,deviceRect:{x:a,y:u,width:f,height:d},cullRect:p,effects:m,pass:v="picking",pickZ:x,moduleParameters:b}){this.pickZ=x;const w=this._resetColorEncoder(x),S=[a,u,f,d],R=super.render({target:o,layers:e,layerFilter:t,views:r,viewports:s,onViewportActive:i,cullRect:p,effects:m==null?void 0:m.filter(O=>O.useInPicking),pass:v,isPicking:!0,moduleParameters:b,clearColor:[0,0,0,0],colorMask:15,scissorRect:S});return this._colorEncoderState=null,{decodePickingColor:w&&fU.bind(null,w),stats:R}}shouldDrawLayer(e){const{pickable:t,operation:r}=e.props;return t&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{picking:{isActive:1,isAttribute:this.pickZ},lightSources:{}}}getLayerParameters(e,t,r){const s={depthMask:!0,depthTest:!0,depthRange:[0,1],...e.props.parameters},{pickable:i,operation:o}=e.props;return!this._colorEncoderState||o.includes("terrain")?s.blend=!1:i&&o.includes("draw")&&(Object.assign(s,cU),s.blend=!0,s.blendColor=uU(this._colorEncoderState,e,r)),s}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function uU(n,e,t){const{byLayer:r,byAlpha:s}=n;let i,o=r.get(e);return o?(o.viewports.push(t),i=o.a):(i=r.size+1,i<=255?(o={a:i,layer:e,viewports:[t]},r.set(e,o),s[i]=o):(ft.warn("Too many pickable layers, only picking the first 255")(),i=0)),[0,0,0,i/255]}function fU(n,e){const t=n.byAlpha[e[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(e)}}const Sl={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},ip=Symbol.for("component"),_o=Symbol.for("propTypes"),J0=Symbol.for("deprecatedProps"),Vl=Symbol.for("asyncPropDefaults"),Sa=Symbol.for("asyncPropOriginal"),po=Symbol.for("asyncPropResolved");function sg(n,e=()=>!0){return Array.isArray(n)?VA(n,e,[]):e(n)?[n]:[]}function VA(n,e,t){let r=-1;for(;++r<n.length;){const s=n[r];Array.isArray(s)?VA(s,e,t):e(s)&&t.push(s)}return t}function dU({target:n,source:e,start:t=0,count:r=1}){const s=e.length,i=r*s;let o=0;for(let a=t;o<s;o++)n[a++]=e[o];for(;o<i;)o<i-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+i-o),o=i);return n}class hU{constructor(e,t,r){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=r,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const r=++this._loadCount;let s=e;typeof e=="string"&&(s=Wh(e)),s instanceof Promise?(this.isLoaded=!1,this._loader=s.then(i=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=i)}).catch(i=>{this._loadCount===r&&(this.isLoaded=!0,this._error=i||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const i of this._subscribers)i.onChange(this.getData())}}class pU{constructor(e){var t;this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:(t=e.device)==null?void 0:t.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:t,forceUpdate:r=!1,persistent:s=!0}){let i=this._resources[e];i?i.setData(t,r):(i=new hU(e,t,this._context),this._resources[e]=i),i.persistent=s}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const r in t){const s=t[r],i=this._resources[s.resourceId];i&&i.unsubscribe(s)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:r,requestId:s="default"}){const{_resources:i,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),i[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=i[e];if(this._track(r,s,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,r,s){const i=this._consumers,o=i[e]=i[e]||{};let a=o[t];const u=a&&a.resourceId&&this._resources[a.resourceId];u&&(u.unsubscribe(a),this.prune()),r&&(a?(a.onChange=s,a.resourceId=r.id):a={onChange:s,resourceId:r.id},o[t]=a,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const gU="layerManager.setLayers",mU="layerManager.activateViewport";class vU{constructor(e,t){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=a=>{er(mU,this,a),a&&(this.context.viewport=a)};const{deck:r,stats:s,viewport:i,timeline:o}=t||{};this.layers=[],this.resourceManager=new pU({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e==null?void 0:e.gl,deck:r,shaderAssembler:S9(),defaultShaderModules:[],renderPass:void 0,stats:s||new wf({id:"deck.gl"}),viewport:i||new La({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new BA,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const s=r.getNeedsRedraw(e);t=t||s}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(r=>t.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){er(gU,this,t,e),this._lastRenderedLayers=e;const r=sg(e,Boolean);for(const s of r)s.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find(r=>r.name===e.name)||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,r=t.findIndex(s=>s.name===e.name);r>=0&&(t.splice(r,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,r){r.raiseError(t,`${e} of ${r}`)}_updateLayers(e,t){const r={};for(const o of e)r[o.id]?ft.warn(`Multiple old layers with same id ${o.id}`)():r[o.id]=o;if(this._defaultShaderModulesChanged){for(const o of e)o.setNeedsUpdate(),o.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const s=[];this._updateSublayersRecursively(t,r,s),this._finalizeOldLayers(r);let i=!1;for(const o of s)if(o.hasUniformTransition()){i=`Uniform transition in ${o}`;break}this._needsUpdate=i,this.layers=s}_updateSublayersRecursively(e,t,r){for(const s of e){s.context=this.context;const i=t[s.id];i===null&&ft.warn(`Multiple new layers with same id ${s.id}`)(),t[s.id]=null;let o=null;try{this._debug&&i!==s&&s.validateProps(),i?(this._transferLayerState(i,s),this._updateLayer(s)):this._initializeLayer(s),r.push(s),o=s.isComposite?s.getSubLayers():null}catch(a){this._handleError("matching",a,s)}o&&this._updateSublayersRecursively(o,t,r)}}_finalizeOldLayers(e){for(const t in e){const r=e[t];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Sl.INITIALIZED}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=Sl.MATCHED,t!==e&&(e.lifecycle=Sl.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=Sl.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Sl.FINALIZED}catch(t){this._handleError("finalization",t,e)}}}function Qr(n,e,t){if(n===e)return!0;if(!t||!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!Qr(n[r],e[r],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const r=Object.keys(n),s=Object.keys(e);if(r.length!==s.length)return!1;for(const i of r)if(!e.hasOwnProperty(i)||!Qr(n[i],e[i],t-1))return!1;return!0}return!1}class yU{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t=typeof e=="string"?this.getView(e):e,r=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,t){const r=this.getViewports(),s={x:e[0],y:e[1]};for(let i=r.length-1;i>=0;--i){const o=r[i];if(o.containsPixel(s)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=sg(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Qr(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):ft.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){const r=t.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:i=>{var o;return(o=this.getView(e.id))==null?void 0:o.makeViewport({viewState:i,width:this.width,height:this.height})}})}_updateController(e,t,r,s){const i=e.controller;if(i&&r){const o={...t,...i,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!s||s.constructor!==i.type)&&(s=this._createController(e,o)),s&&s.setProps(o),s}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let s=e.length;s--;){const i=e[s],o=this.getViewState(i),a=i.makeViewport({viewState:o,width:this.width,height:this.height});let u=t[i.id];const f=!!i.controller;f&&!u&&(r=!0),(r||!f)&&u&&(u.finalize(),u=null),this.controllers[i.id]=this._updateController(i,o,a,u),a&&this._viewports.unshift(a)}for(const s in t){const i=t[s];i&&!this.controllers[s]&&i.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length?!0:e.some((r,s)=>!e[s].equals(t[s]))}}const _U=/([0-9]+\.?[0-9]*)(%|px)/;function Ji(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=_U.exec(n);if(e&&e.length>=3){const t=e[2]==="%",r=parseFloat(e[1]);return{position:t?r/100:r,relative:t}}default:throw new Error(`Could not parse position string ${n}`)}}function eo(n,e){return n.relative?Math.round(n.position*e):n.position}class Ea{constructor(e){const{id:t,x:r=0,y:s=0,width:i="100%",height:o="100%",padding:a=null}=e;this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Ji(r),this._y=Ji(s),this._width=Ji(i),this._height=Ji(o),this._padding=a&&{left:Ji(a.left||0),right:Ji(a.right||0),top:Ji(a.top||0),bottom:Ji(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.ViewportType===e.ViewportType&&Qr(this.props,e.props,2)}makeViewport({width:e,height:t,viewState:r}){r=this.filterViewState(r);const s=this.getDimensions({width:e,height:t});return!s.height||!s.width?null:new this.ViewportType({...r,...this.props,...s})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const r in this.props.viewState)r!=="id"&&(t[r]=this.props.viewState[r]);return t}return e}getDimensions({width:e,height:t}){const r={x:eo(this._x,e),y:eo(this._y,t),width:eo(this._width,e),height:eo(this._height,t)};return this._padding&&(r.padding={left:eo(this._padding.left,e),top:eo(this._padding.top,t),right:eo(this._padding.right,e),bottom:eo(this._padding.bottom,t)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class ig{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){var t,r;this.cancel(),this.settings=e,this._inProgress=!0,(r=(t=this.settings).onStart)==null||r.call(t,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(t=(e=this.settings).onEnd)==null||t.call(e,this))}cancel(){var e,t;this._inProgress&&((t=(e=this.settings).onInterrupt)==null||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:s}=this;this._handle=r.addChannel({delay:r.getTime(),duration:s.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(t=(e=this.settings).onUpdate)==null||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Xw=()=>{},My={BREAK:1,SNAP_TO_END:2,IGNORE:3},xU=n=>n,bU=My.BREAK;class wU{constructor(e){this._onTransitionUpdate=t=>{const{time:r,settings:{interpolator:s,startProps:i,endProps:o,duration:a,easing:u}}=t,f=u(r/a),d=s.interpolateProps(i,o,f);this.propsInTransition=this.getControllerState({...this.props,...d}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new ig(e.timeline),this.onViewStateChange=e.onViewStateChange||Xw,this.onStateChange=e.onStateChange||Xw}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let s=r;if(this.transition.inProgress){const{interruption:i,endProps:o}=this.transition.settings;s={...r,...i===My.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(s,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:r}=e;return(t>0||t==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?this.transition.settings.interruption===My.IGNORE||this._isUpdateDueToCurrentTransition(t):this._isTransitionEnabled(t)?t.transitionInterpolator.arePropsEqual(e,t):!0}_triggerTransition(e,t){const r=this.getControllerState(e),s=this.getControllerState(t).shortestPathFrom(r),i=t.transitionInterpolator,o=i.getDuration?i.getDuration(e,t):t.transitionDuration;if(o===0)return;const a=i.initializeProps(e,s);this.propsInTransition={};const u={duration:o,easing:t.transitionEasing||xU,interpolator:i,interruption:t.transitionInterruption||bU,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(u),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(t)}}}function Un(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}class TU{constructor(e){const{compare:t,extract:r,required:s}=e;this._propsToCompare=t,this._propsToExtract=r||t,this._requiredProps=s}arePropsEqual(e,t){for(const r of this._propsToCompare)if(!(r in e)||!(r in t)||!gi(e[r],t[r]))return!1;return!0}initializeProps(e,t){const r={},s={};for(const i of this._propsToExtract)(i in e||i in t)&&(r[i]=e[i],s[i]=t[i]);return this._checkRequiredProps(r),this._checkRequiredProps(s),{start:r,end:s}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const r=e[t];Un(Number.isFinite(r)||Array.isArray(r),`${t} is required for transition`)})}}const SU=["longitude","latitude","zoom","bearing","pitch"],EU=["longitude","latitude","zoom"];class y1 extends TU{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:SU,required:EU},super(r.transitionProps),this.opts=r}initializeProps(e,t){const r=super.initializeProps(e,t),{makeViewport:s,around:i}=this.opts;if(s&&i){const o=s(e),a=s(t),u=o.unproject(i);r.start.around=i,Object.assign(r.end,{around:a.project(u),aroundPosition:u,width:t.width,height:t.height})}return r}interpolateProps(e,t,r){const s={};for(const i of this._propsToExtract)s[i]=da(e[i]||0,t[i]||0,r);if(t.aroundPosition&&this.opts.makeViewport){const i=this.opts.makeViewport({...t,...s});Object.assign(s,i.panByPosition(t.aroundPosition,da(e.around,t.around,r)))}return s}}const to={transitionDuration:0},AU=300,th=n=>1-(1-n)*(1-n),wl={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Go={};class zA{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new wU({...e,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){var e;for(const t in this._events)this._events[t]&&((e=this.eventManager)==null||e.off(t,this.handleEvent));this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return t?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return t?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return t?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:r}=this.props,{offsetCenter:s}=e;return[s.x-t,s.y-r]}isPointInBounds(e,t){const{width:r,height:s}=this.props;if(t&&t.handled)return!1;const i=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=s;return i&&t&&t.stopPropagation(),i}isFunctionKeyPressed(e){const{srcEvent:t}=e;return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:t===!0?AU:0;const{scrollZoom:r=!0,dragPan:s=!0,dragRotate:i=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:u=!1,keyboard:f=!0}=e,d=!!this.onViewStateChange;this.toggleEvents(wl.WHEEL,d&&r),this.toggleEvents(wl.PAN,d),this.toggleEvents(wl.PINCH,d&&(a||u)),this.toggleEvents(wl.TRIPLE_PAN,d&&u),this.toggleEvents(wl.DOUBLE_TAP,d&&o),this.toggleEvents(wl.KEYBOARD,d&&f),this.scrollZoom=r,this.dragPan=s,this.dragRotate=i,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=u,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(r=>{this._events[r]!==t&&(this._events[r]=t,t?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,t=null,r={}){const s={...e.getViewportProps(),...t},i=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),i){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:s,interactionState:this._interactionState,oldViewState:o,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const s=this.controllerState[r?"panStart":"rotateStart"]({pos:t});return this._panMove=r,this.updateViewport(s,to,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),r=this.controllerState.pan({pos:t});return this.updateViewport(r,to,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const r=this.getCenter(e),s=[r[0]+e.velocityX*t/2,r[1]+e.velocityY*t/2],i=this.controllerState.pan({pos:s}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:th},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),r=this.controllerState.rotate({pos:t});return this.updateViewport(r,to,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const r=this.getCenter(e),s=[r[0]+e.velocityX*t/2,r[1]+e.velocityY*t/2],i=this.controllerState.rotate({pos:s}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:th},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:s=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:i}=e;let o=2/(1+Math.exp(-Math.abs(i*r)));i<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:t}),transitionDuration:s?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const r=this.controllerState.rotateStart({pos:t});return this.updateViewport(r,to,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const r=this.controllerState.rotate({pos:t});return this.updateViewport(r,to,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const r=this.getCenter(e),s=[r[0],r[1]+=e.velocityY*t/2],i=this.controllerState.rotate({pos:s});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:th},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const r=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return Go._startPinchRotation=e.rotation,Go._lastPinchEvent=e,this.updateViewport(r,to,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:r}=e,s=this.getCenter(e);t=t.zoom({pos:s,scale:r})}if(this.touchRotate){const{rotation:r}=e;t=t.rotate({deltaAngleX:Go._startPinchRotation-r})}return this.updateViewport(t,to,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Go._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:r}=Go;if(this.touchZoom&&t&&r&&e.scale!==r.scale){const s=this.getCenter(e);let i=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),u=Math.pow(2,o+a*t/2);i=i.zoom({pos:s,scale:u}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:s}),transitionDuration:t,transitionEasing:th},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const s=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(s,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Go._startPinchRotation=null,Go._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const r=this.isFunctionKeyPressed(e),s=this.controllerState.zoom({pos:t,scale:r?.5:2});return this.updateViewport(s,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:s,rotateSpeedX:i,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let u;const f={};switch(e.srcEvent.code){case"Minus":u=t?a.zoomOut(r).zoomOut(r):a.zoomOut(r),f.isZooming=!0;break;case"Equal":u=t?a.zoomIn(r).zoomIn(r):a.zoomIn(r),f.isZooming=!0;break;case"ArrowLeft":t?(u=a.rotateLeft(i),f.isRotating=!0):(u=a.moveLeft(s),f.isPanning=!0);break;case"ArrowRight":t?(u=a.rotateRight(i),f.isRotating=!0):(u=a.moveRight(s),f.isPanning=!0);break;case"ArrowUp":t?(u=a.rotateUp(o),f.isRotating=!0):(u=a.moveUp(s),f.isPanning=!0);break;case"ArrowDown":t?(u=a.rotateDown(o),f.isRotating=!0):(u=a.moveDown(s),f.isPanning=!0);break;default:return!1}return this.updateViewport(u,this._getTransitionProps(),f),!0}_getTransitionProps(e){const{transition:t}=this;return!t||!t.transitionInterpolator?to:e?{...t,transitionInterpolator:new y1({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t}}class $A{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Yw=5,CU=1.2;class RU extends $A{constructor(e){const{width:t,height:r,latitude:s,longitude:i,zoom:o,bearing:a=0,pitch:u=0,altitude:f=1.5,position:d=[0,0,0],maxZoom:p=20,minZoom:m=0,maxPitch:v=60,minPitch:x=0,startPanLngLat:b,startZoomLngLat:w,startRotatePos:S,startBearing:R,startPitch:C,startZoom:O,normalize:I=!0}=e;Un(Number.isFinite(i)),Un(Number.isFinite(s)),Un(Number.isFinite(o)),super({width:t,height:r,latitude:s,longitude:i,zoom:o,bearing:a,pitch:u,altitude:f,maxZoom:p,minZoom:m,maxPitch:v,minPitch:x,normalize:I,position:d},{startPanLngLat:b,startZoomLngLat:w,startRotatePos:S,startBearing:R,startPitch:C,startZoom:O}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const r=this.getState().startPanLngLat||this._unproject(t);if(!r)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:r=0}){const{startRotatePos:s,startBearing:i,startPitch:o}=this.getState();if(!s||i===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,s,o,i):a={bearing:i+t,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:r}){let{startZoom:s,startZoomLngLat:i}=this.getState();if(i||(s=this.getViewportProps().zoom,i=this._unproject(t)||this._unproject(e)),!i)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let u=s+Math.log2(r);u=un(u,a,o);const f=this.makeViewport({...this.getViewportProps(),zoom:u});return this._getUpdatedState({zoom:u,...f.panByPosition(i,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),r={...this.getViewportProps()},{bearing:s,longitude:i}=r;return Math.abs(s-t.bearing)>180&&(r.bearing=s<0?s+360:s-360),Math.abs(i-t.longitude)>180&&(r.longitude=i<0?i+360:i-360),r}applyConstraints(e){const{maxZoom:t,minZoom:r,zoom:s}=e;e.zoom=un(s,r,t);const{maxPitch:i,minPitch:o,pitch:a}=e;e.pitch=un(a,o,i);const{normalize:u=!0}=e;return u&&Object.assign(e,f9(e)),e}_zoomFromCenter(e){const{width:t,height:r}=this.getViewportProps();return this.zoom({pos:[t/2,r/2],scale:e})}_panFromCenter(e){const{width:t,height:r}=this.getViewportProps();return this.pan({startPos:[t/2,r/2],pos:[t/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,r,s){const i=e[0]-t[0],o=e[1]-t[1],a=e[1],u=t[1],{width:f,height:d}=this.getViewportProps(),p=i/f;let m=0;o>0?Math.abs(d-u)>Yw&&(m=o/(u-d)*CU):o<0&&u>Yw&&(m=1-a/u),m=un(m,-1,1);const{minPitch:v,maxPitch:x}=this.getViewportProps(),b=s+180*p;let w=r;return m>0?w=r+m*(x-r):m<0&&(w=r-m*(v-r)),{pitch:w,bearing:b}}}class PU extends zA{constructor(){super(...arguments),this.ControllerState=RU,this.transition={transitionDuration:300,transitionInterpolator:new y1({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class jA extends Ea{constructor(e={}){super(e)}get ViewportType(){return Ao}get ControllerType(){return PU}}jA.displayName="MapView";const IU=new LA;function kU(n,e){const t=n.order??1/0,r=e.order??1/0;return t-r}class MU{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(r=>r.id===e.id)){const r=t.findIndex(s=>kU(s,e)>0);r<0?t.push(e):t.splice(r,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Qr(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const s of this.effects)t[s.id]=s;const r=[];for(const s of e){const i=t[s.id];let o=s;i&&i!==s?i.setProps?(i.setProps(s.props),o=i):i.cleanup(this._context):i||s.setup(this._context),r.push(o),delete t[s.id]}for(const s in t)t[s].cleanup(this._context);this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(s=>s instanceof LA)||this._resolvedEffects.push(IU),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class OU extends v1{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const NU="deckRenderer.renderLayers";class DU{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new OU(e),this.pickLayersPass=new UA(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};r.effects&&this._preRender(r.effects,r);const s=this.lastPostProcessEffect?this.renderBuffers[0]:r.target;this.lastPostProcessEffect&&(r.clearColor=[0,0,0,0],r.clearCanvas=!0);const i=t.render({...r,target:s});r.effects&&this._postRender(r.effects,r),this.renderCount++,er(NU,this,i,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const r of e)t.preRenderStats[r.id]=r.preRender(t),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(r=>{const s=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${r}`,colorAttachments:[s]}))});for(const r of e)r.resize(t)}_postRender(e,t){const{renderBuffers:r}=this,s={...t,inputBuffer:r[0],swapBuffer:r[1]};for(const i of e)if(i.postRender){s.target=i.id===this.lastPostProcessEffect?t.target:void 0;const o=i.postRender(s);s.inputBuffer=o,s.swapBuffer=o===r[0]?r[1]:r[0]}}}const LU={pickedColor:null,pickedObjectIndex:-1};function FU({pickedColors:n,decodePickingColor:e,deviceX:t,deviceY:r,deviceRadius:s,deviceRect:i}){const{x:o,y:a,width:u,height:f}=i;let d=s*s,p=-1,m=0;for(let v=0;v<f;v++){const x=v+a-r,b=x*x;if(b>d)m+=4*u;else for(let w=0;w<u;w++){if(n[m+3]-1>=0){const R=w+o-t,C=R*R+b;C<=d&&(d=C,p=m)}m+=4}}if(p>=0){const v=n.slice(p,p+4),x=e(v);if(x){const b=Math.floor(p/4/u),w=p/4-b*u;return{...x,pickedColor:v,pickedX:o+w,pickedY:a+b}}ft.error("Picked non-existent layer. Is picking buffer corrupt?")()}return LU}function BU({pickedColors:n,decodePickingColor:e}){const t=new Map;if(n){for(let r=0;r<n.length;r+=4)if(n[r+3]-1>=0){const i=n.slice(r,r+4),o=i.join(",");if(!t.has(o)){const a=e(i);a?t.set(o,{...a,color:i}):ft.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}function WA({pickInfo:n,viewports:e,pixelRatio:t,x:r,y:s,z:i}){let o=e[0];e.length>1&&(o=VU((n==null?void 0:n.pickedViewports)||e,{x:r,y:s}));let a;if(o){const u=[r-o.x,s-o.y];i!==void 0&&(u[2]=i),a=o.unproject(u)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:s,pixel:[r,s],coordinate:a,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:t}}function UU(n){const{pickInfo:e,lastPickedInfo:t,mode:r,layers:s}=n,{pickedColor:i,pickedLayer:o,pickedObjectIndex:a}=e,u=o?[o]:[];if(r==="hover"){const p=t.index,m=t.layerId,v=o?o.props.id:null;if(v!==m||a!==p){if(v!==m){const x=s.find(b=>b.props.id===m);x&&u.unshift(x)}t.layerId=v,t.index=a,t.info=null}}const f=WA(n),d=new Map;return d.set(null,f),u.forEach(p=>{let m={...f};p===o&&(m.color=i,m.index=a,m.picked=!0),m=HA({layer:p,info:m,mode:r});const v=m.layer;p===o&&r==="hover"&&(t.info=m),d.set(v.id,m),r==="hover"&&v.updateAutoHighlight(m)}),d}function HA({layer:n,info:e,mode:t}){for(;n&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:r}),n=n.parent}return e}function VU(n,e){for(let t=n.length-1;t>=0;t--){const r=n[t];if(r.containsPixel(e))return r}return n[0]}class zU{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new UA(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:r,viewports:s},i=this.lastPickedInfo.info){const o=i&&i.layer&&i.layer.id,a=i&&i.viewport&&i.viewport.id,u=o?r.find(m=>m.id===o):null,f=a&&s.find(m=>m.id===a)||s[0],d=f&&f.unproject([e-f.x,t-f.y]);return{...i,...{x:e,y:t,viewport:f,coordinate:d,layer:u}}}_resizeBuffer(){var t,r;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const s=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=s}const{canvas:e}=this.device.getCanvasContext();(t=this.pickingFBO)==null||t.resize({width:e.width,height:e.height}),(r=this.depthFBO)==null||r.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const t=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:r,x:s,y:i,radius:o=0,depth:a=1,mode:u="query",unproject3D:f,onViewportActive:d,effects:p}){const m=this.device.canvasContext.cssToDeviceRatio(),v=this._getPickable(e);if(!v||r.length===0)return{result:[],emptyInfo:WA({viewports:r,x:s,y:i,pixelRatio:m})};this._resizeBuffer();const x=this.device.canvasContext.cssToDevicePixels([s,i],!0),b=[x.x+Math.floor(x.width/2),x.y+Math.floor(x.height/2)],w=Math.round(o*m),{width:S,height:R}=this.pickingFBO,C=this._getPickingRect({deviceX:b[0],deviceY:b[1],deviceRadius:w,deviceWidth:S,deviceHeight:R}),O={x:s-o,y:i-o,width:o*2+1,height:o*2+1};let I;const F=[],$=new Set;for(let q=0;q<a;q++){let K;if(C){const he=this._drawAndSample({layers:v,views:t,viewports:r,onViewportActive:d,deviceRect:C,cullRect:O,effects:p,pass:`picking:${u}`});K=FU({...he,deviceX:b[0],deviceY:b[1],deviceRadius:w,deviceRect:C})}else K={pickedColor:null,pickedObjectIndex:-1};let le;if(K.pickedLayer&&f&&this.depthFBO){const{pickedColors:he}=this._drawAndSample({layers:[K.pickedLayer],views:t,viewports:r,onViewportActive:d,deviceRect:{x:K.pickedX,y:K.pickedY,width:1,height:1},cullRect:O,effects:p,pass:`picking:${u}:z`},!0);he[3]&&(le=he[0])}K.pickedLayer&&q+1<a&&($.add(K.pickedLayer),K.pickedLayer.disablePickingIndex(K.pickedObjectIndex)),I=UU({pickInfo:K,lastPickedInfo:this.lastPickedInfo,mode:u,layers:v,viewports:r,x:s,y:i,z:le,pixelRatio:m});for(const he of I.values())he.layer&&F.push(he);if(!K.pickedColor)break}for(const q of $)q.restorePickingColors();return{result:F,emptyInfo:I.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:r,x:s,y:i,width:o=1,height:a=1,mode:u="query",maxObjects:f=null,onViewportActive:d,effects:p}){const m=this._getPickable(e);if(!m||r.length===0)return[];this._resizeBuffer();const v=this.device.canvasContext.cssToDeviceRatio(),x=this.device.canvasContext.cssToDevicePixels([s,i],!0),b=x.x,w=x.y+x.height,S=this.device.canvasContext.cssToDevicePixels([s+o,i+a],!0),R=S.x+S.width,C=S.y,O={x:b,y:C,width:R-b,height:w-C},I=this._drawAndSample({layers:m,views:t,viewports:r,onViewportActive:d,deviceRect:O,cullRect:{x:s,y:i,width:o,height:a},effects:p,pass:`picking:${u}`}),F=BU(I),$=new Map,q=[],K=Number.isFinite(f);for(let le=0;le<F.length&&!(K&&q.length>=f);le++){const he=F[le];let pe={color:he.pickedColor,layer:null,index:he.pickedObjectIndex,picked:!0,x:s,y:i,pixelRatio:v};pe=HA({layer:he.pickedLayer,info:pe,mode:u});const se=pe.layer.id;$.has(se)||$.set(se,new Set);const ye=$.get(se),Me=pe.object??pe.index;ye.has(Me)||(ye.add(Me),q.push(pe))}return q}_drawAndSample({layers:e,views:t,viewports:r,onViewportActive:s,deviceRect:i,cullRect:o,effects:a,pass:u},f=!1){const d=f?this.depthFBO:this.pickingFBO,p={layers:e,layerFilter:this.layerFilter,views:t,viewports:r,onViewportActive:s,pickingFBO:d,deviceRect:i,cullRect:o,effects:a,pass:u,pickZ:f,preRenderStats:{},isPicking:!0};for(const R of a)R.useInPicking&&(p.preRenderStats[R.id]=R.preRender(p));const{decodePickingColor:m}=this.pickLayersPass.render(p),{x:v,y:x,width:b,height:w}=i,S=new(f?Float32Array:Uint8Array)(b*w*4);return this.device.readPixelsToArrayWebGL(d,{sourceX:v,sourceY:x,sourceWidth:b,sourceHeight:w,target:S}),{pickedColors:S,decodePickingColor:m}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:r,deviceWidth:s,deviceHeight:i}){const o=Math.max(0,e-r),a=Math.max(0,t-r),u=Math.min(s,e+r+1)-o,f=Math.min(i,t+r+1)-a;return u<=0||f<=0?null:{x:o,y:a,width:u,height:f}}}const $U={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},jU="top-left",qw="__root";class WU{constructor({deck:e,parentElement:t}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=t}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!Qr(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(t=>t.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const t={};for(const r of this.resolvedWidgets)t[r.id]=r;this.resolvedWidgets.length=0;for(const r of this.defaultWidgets)t[r.id]=null,this.resolvedWidgets.push(r);for(let r of e){const s=t[r.id];s?s.viewId!==r.viewId||s.placement!==r.placement?(this._remove(s),this._add(r)):r!==s&&(s.setProps(r.props),r=s):this._add(r),t[r.id]=null,this.resolvedWidgets.push(r)}for(const r in t){const s=t[r];s&&this._remove(s)}this.widgets=e}_add(e){const{viewId:t=null,placement:r=jU}=e,s=e.onAdd({deck:this.deck,viewId:t});s&&this._getContainer(t,r).append(s),e._element=s}_remove(e){e.onRemove(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,t){var o;const r=e||qw;let s=this.containers[r];s||(s=document.createElement("div"),s.style.pointerEvents="none",s.style.position="absolute",s.style.overflow="hidden",(o=this.parentElement)==null||o.append(s),this.containers[r]=s);let i=s.querySelector(`.${t}`);return i||(i=document.createElement("div"),i.className=t,i.style.position="absolute",i.style.zIndex="2",Object.assign(i.style,$U[t]),s.append(i)),i}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const r in this.containers){const s=this.lastViewports[r]||null,i=r===qw||s,o=this.containers[r];i?(o.style.display="block",o.style.left=`${s?s.x:0}px`,o.style.top=`${s?s.y:0}px`,o.style.width=`${s?s.width:e}px`,o.style.height=`${s?s.height:t}px`):o.style.display="none"}}onRedraw({viewports:e,layers:t}){var i,o;const r=e.reduce((a,u)=>(a[u.id]=u,a),{}),{lastViewports:s}=this;for(const a of this.getWidgets()){const{viewId:u}=a;if(u){const f=r[u];f&&(a.onViewportChange&&!f.equals(s[u])&&a.onViewportChange(f),(i=a.onRedraw)==null||i.call(a,{viewports:[f],layers:t}))}else{if(a.onViewportChange)for(const f of e)f.equals(s[f.id])||a.onViewportChange(f);(o=a.onRedraw)==null||o.call(a,{viewports:e,layers:t})}}this.lastViewports=r,this._updateContainers()}onHover(e,t){var r,s;for(const i of this.getWidgets()){const{viewId:o}=i;(!o||o===((r=e.viewport)==null?void 0:r.id))&&((s=i.onHover)==null||s.call(i,e,t))}}onEvent(e,t){var s,i;const r=Ay[t.type];if(r)for(const o of this.getWidgets()){const{viewId:a}=o;(!a||a===((s=e.viewport)==null?void 0:s.id))&&((i=o[r.handler])==null||i.call(o,e,t))}}}const HU={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class XU{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const t=document.createElement("div");return t.className="deck-tooltip",Object.assign(t.style,HU),this.deck=e,this.element=t,t}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){var t;this.isVisible&&e.id===((t=this.lastViewport)==null?void 0:t.id)&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:t}=this,r=t&&t.props.getTooltip;if(!r)return;const s=r(e);this.lastViewport=e.viewport,this.setTooltip(s,e.x,e.y)}setTooltip(e,t,r){const s=this.element;if(s){if(typeof e=="string")s.innerText=e;else if(e)e.text&&(s.innerText=e.text),e.html&&(s.innerHTML=e.html),e.className&&(s.className=e.className);else{this.isVisible=!1,s.style.display="none";return}this.isVisible=!0,s.style.display="block",s.style.transform=`translate(${t}px, ${r}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(s.style,e.style)}}}var gt;(function(n){n[n.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",n[n.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",n[n.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.SRC_COLOR=768]="SRC_COLOR",n[n.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",n[n.SRC_ALPHA=770]="SRC_ALPHA",n[n.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",n[n.DST_ALPHA=772]="DST_ALPHA",n[n.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",n[n.DST_COLOR=774]="DST_COLOR",n[n.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",n[n.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",n[n.CONSTANT_COLOR=32769]="CONSTANT_COLOR",n[n.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",n[n.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",n[n.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",n[n.FUNC_ADD=32774]="FUNC_ADD",n[n.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",n[n.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",n[n.BLEND_EQUATION=32777]="BLEND_EQUATION",n[n.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",n[n.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",n[n.BLEND_DST_RGB=32968]="BLEND_DST_RGB",n[n.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",n[n.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",n[n.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",n[n.BLEND_COLOR=32773]="BLEND_COLOR",n[n.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",n[n.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",n[n.LINE_WIDTH=2849]="LINE_WIDTH",n[n.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",n[n.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",n[n.CULL_FACE_MODE=2885]="CULL_FACE_MODE",n[n.FRONT_FACE=2886]="FRONT_FACE",n[n.DEPTH_RANGE=2928]="DEPTH_RANGE",n[n.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",n[n.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",n[n.DEPTH_FUNC=2932]="DEPTH_FUNC",n[n.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",n[n.STENCIL_FUNC=2962]="STENCIL_FUNC",n[n.STENCIL_FAIL=2964]="STENCIL_FAIL",n[n.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",n[n.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",n[n.STENCIL_REF=2967]="STENCIL_REF",n[n.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",n[n.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",n[n.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",n[n.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",n[n.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",n[n.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",n[n.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",n[n.VIEWPORT=2978]="VIEWPORT",n[n.SCISSOR_BOX=3088]="SCISSOR_BOX",n[n.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",n[n.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",n[n.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",n[n.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",n[n.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",n[n.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",n[n.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",n[n.RED_BITS=3410]="RED_BITS",n[n.GREEN_BITS=3411]="GREEN_BITS",n[n.BLUE_BITS=3412]="BLUE_BITS",n[n.ALPHA_BITS=3413]="ALPHA_BITS",n[n.DEPTH_BITS=3414]="DEPTH_BITS",n[n.STENCIL_BITS=3415]="STENCIL_BITS",n[n.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",n[n.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",n[n.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",n[n.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",n[n.SAMPLES=32937]="SAMPLES",n[n.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",n[n.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",n[n.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",n[n.VENDOR=7936]="VENDOR",n[n.RENDERER=7937]="RENDERER",n[n.VERSION=7938]="VERSION",n[n.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",n[n.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",n[n.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",n[n.STATIC_DRAW=35044]="STATIC_DRAW",n[n.STREAM_DRAW=35040]="STREAM_DRAW",n[n.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.BUFFER_SIZE=34660]="BUFFER_SIZE",n[n.BUFFER_USAGE=34661]="BUFFER_USAGE",n[n.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",n[n.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",n[n.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",n[n.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",n[n.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",n[n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",n[n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",n[n.CULL_FACE=2884]="CULL_FACE",n[n.FRONT=1028]="FRONT",n[n.BACK=1029]="BACK",n[n.FRONT_AND_BACK=1032]="FRONT_AND_BACK",n[n.BLEND=3042]="BLEND",n[n.DEPTH_TEST=2929]="DEPTH_TEST",n[n.DITHER=3024]="DITHER",n[n.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",n[n.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",n[n.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",n[n.SCISSOR_TEST=3089]="SCISSOR_TEST",n[n.STENCIL_TEST=2960]="STENCIL_TEST",n[n.NO_ERROR=0]="NO_ERROR",n[n.INVALID_ENUM=1280]="INVALID_ENUM",n[n.INVALID_VALUE=1281]="INVALID_VALUE",n[n.INVALID_OPERATION=1282]="INVALID_OPERATION",n[n.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",n[n.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",n[n.CW=2304]="CW",n[n.CCW=2305]="CCW",n[n.DONT_CARE=4352]="DONT_CARE",n[n.FASTEST=4353]="FASTEST",n[n.NICEST=4354]="NICEST",n[n.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",n[n.BYTE=5120]="BYTE",n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.SHORT=5122]="SHORT",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.INT=5124]="INT",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.FLOAT=5126]="FLOAT",n[n.DOUBLE=5130]="DOUBLE",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.ALPHA=6406]="ALPHA",n[n.RGB=6407]="RGB",n[n.RGBA=6408]="RGBA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",n[n.VERTEX_SHADER=35633]="VERTEX_SHADER",n[n.COMPILE_STATUS=35713]="COMPILE_STATUS",n[n.DELETE_STATUS=35712]="DELETE_STATUS",n[n.LINK_STATUS=35714]="LINK_STATUS",n[n.VALIDATE_STATUS=35715]="VALIDATE_STATUS",n[n.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",n[n.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",n[n.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",n[n.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",n[n.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",n[n.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",n[n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",n[n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",n[n.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",n[n.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",n[n.SHADER_TYPE=35663]="SHADER_TYPE",n[n.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",n[n.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",n[n.NEVER=512]="NEVER",n[n.LESS=513]="LESS",n[n.EQUAL=514]="EQUAL",n[n.LEQUAL=515]="LEQUAL",n[n.GREATER=516]="GREATER",n[n.NOTEQUAL=517]="NOTEQUAL",n[n.GEQUAL=518]="GEQUAL",n[n.ALWAYS=519]="ALWAYS",n[n.KEEP=7680]="KEEP",n[n.REPLACE=7681]="REPLACE",n[n.INCR=7682]="INCR",n[n.DECR=7683]="DECR",n[n.INVERT=5386]="INVERT",n[n.INCR_WRAP=34055]="INCR_WRAP",n[n.DECR_WRAP=34056]="DECR_WRAP",n[n.NEAREST=9728]="NEAREST",n[n.LINEAR=9729]="LINEAR",n[n.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",n[n.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",n[n.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",n[n.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",n[n.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",n[n.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",n[n.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",n[n.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE=5890]="TEXTURE",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n[n.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",n[n.TEXTURE0=33984]="TEXTURE0",n[n.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",n[n.REPEAT=10497]="REPEAT",n[n.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n[n.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",n[n.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",n[n.FLOAT_VEC2=35664]="FLOAT_VEC2",n[n.FLOAT_VEC3=35665]="FLOAT_VEC3",n[n.FLOAT_VEC4=35666]="FLOAT_VEC4",n[n.INT_VEC2=35667]="INT_VEC2",n[n.INT_VEC3=35668]="INT_VEC3",n[n.INT_VEC4=35669]="INT_VEC4",n[n.BOOL=35670]="BOOL",n[n.BOOL_VEC2=35671]="BOOL_VEC2",n[n.BOOL_VEC3=35672]="BOOL_VEC3",n[n.BOOL_VEC4=35673]="BOOL_VEC4",n[n.FLOAT_MAT2=35674]="FLOAT_MAT2",n[n.FLOAT_MAT3=35675]="FLOAT_MAT3",n[n.FLOAT_MAT4=35676]="FLOAT_MAT4",n[n.SAMPLER_2D=35678]="SAMPLER_2D",n[n.SAMPLER_CUBE=35680]="SAMPLER_CUBE",n[n.LOW_FLOAT=36336]="LOW_FLOAT",n[n.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",n[n.HIGH_FLOAT=36338]="HIGH_FLOAT",n[n.LOW_INT=36339]="LOW_INT",n[n.MEDIUM_INT=36340]="MEDIUM_INT",n[n.HIGH_INT=36341]="HIGH_INT",n[n.FRAMEBUFFER=36160]="FRAMEBUFFER",n[n.RENDERBUFFER=36161]="RENDERBUFFER",n[n.RGBA4=32854]="RGBA4",n[n.RGB5_A1=32855]="RGB5_A1",n[n.RGB565=36194]="RGB565",n[n.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",n[n.STENCIL_INDEX=6401]="STENCIL_INDEX",n[n.STENCIL_INDEX8=36168]="STENCIL_INDEX8",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n[n.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",n[n.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",n[n.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",n[n.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",n[n.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",n[n.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",n[n.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",n[n.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",n[n.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",n[n.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",n[n.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",n[n.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",n[n.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",n[n.NONE=0]="NONE",n[n.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",n[n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",n[n.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",n[n.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",n[n.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",n[n.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",n[n.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",n[n.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",n[n.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",n[n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",n[n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",n[n.READ_BUFFER=3074]="READ_BUFFER",n[n.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",n[n.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",n[n.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",n[n.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",n[n.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",n[n.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",n[n.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",n[n.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",n[n.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",n[n.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",n[n.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",n[n.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",n[n.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",n[n.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",n[n.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",n[n.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",n[n.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",n[n.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",n[n.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",n[n.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",n[n.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",n[n.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",n[n.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",n[n.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",n[n.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",n[n.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",n[n.RED=6403]="RED",n[n.RGB8=32849]="RGB8",n[n.RGBA8=32856]="RGBA8",n[n.RGB10_A2=32857]="RGB10_A2",n[n.TEXTURE_3D=32879]="TEXTURE_3D",n[n.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",n[n.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",n[n.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",n[n.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",n[n.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",n[n.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",n[n.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",n[n.SRGB=35904]="SRGB",n[n.SRGB8=35905]="SRGB8",n[n.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",n[n.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",n[n.RGBA32F=34836]="RGBA32F",n[n.RGB32F=34837]="RGB32F",n[n.RGBA16F=34842]="RGBA16F",n[n.RGB16F=34843]="RGB16F",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",n[n.R11F_G11F_B10F=35898]="R11F_G11F_B10F",n[n.RGB9_E5=35901]="RGB9_E5",n[n.RGBA32UI=36208]="RGBA32UI",n[n.RGB32UI=36209]="RGB32UI",n[n.RGBA16UI=36214]="RGBA16UI",n[n.RGB16UI=36215]="RGB16UI",n[n.RGBA8UI=36220]="RGBA8UI",n[n.RGB8UI=36221]="RGB8UI",n[n.RGBA32I=36226]="RGBA32I",n[n.RGB32I=36227]="RGB32I",n[n.RGBA16I=36232]="RGBA16I",n[n.RGB16I=36233]="RGB16I",n[n.RGBA8I=36238]="RGBA8I",n[n.RGB8I=36239]="RGB8I",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.R8=33321]="R8",n[n.RG8=33323]="RG8",n[n.R16F=33325]="R16F",n[n.R32F=33326]="R32F",n[n.RG16F=33327]="RG16F",n[n.RG32F=33328]="RG32F",n[n.R8I=33329]="R8I",n[n.R8UI=33330]="R8UI",n[n.R16I=33331]="R16I",n[n.R16UI=33332]="R16UI",n[n.R32I=33333]="R32I",n[n.R32UI=33334]="R32UI",n[n.RG8I=33335]="RG8I",n[n.RG8UI=33336]="RG8UI",n[n.RG16I=33337]="RG16I",n[n.RG16UI=33338]="RG16UI",n[n.RG32I=33339]="RG32I",n[n.RG32UI=33340]="RG32UI",n[n.R8_SNORM=36756]="R8_SNORM",n[n.RG8_SNORM=36757]="RG8_SNORM",n[n.RGB8_SNORM=36758]="RGB8_SNORM",n[n.RGBA8_SNORM=36759]="RGBA8_SNORM",n[n.RGB10_A2UI=36975]="RGB10_A2UI",n[n.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",n[n.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.HALF_FLOAT=5131]="HALF_FLOAT",n[n.RG=33319]="RG",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",n[n.CURRENT_QUERY=34917]="CURRENT_QUERY",n[n.QUERY_RESULT=34918]="QUERY_RESULT",n[n.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",n[n.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",n[n.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",n[n.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",n[n.DRAW_BUFFER0=34853]="DRAW_BUFFER0",n[n.DRAW_BUFFER1=34854]="DRAW_BUFFER1",n[n.DRAW_BUFFER2=34855]="DRAW_BUFFER2",n[n.DRAW_BUFFER3=34856]="DRAW_BUFFER3",n[n.DRAW_BUFFER4=34857]="DRAW_BUFFER4",n[n.DRAW_BUFFER5=34858]="DRAW_BUFFER5",n[n.DRAW_BUFFER6=34859]="DRAW_BUFFER6",n[n.DRAW_BUFFER7=34860]="DRAW_BUFFER7",n[n.DRAW_BUFFER8=34861]="DRAW_BUFFER8",n[n.DRAW_BUFFER9=34862]="DRAW_BUFFER9",n[n.DRAW_BUFFER10=34863]="DRAW_BUFFER10",n[n.DRAW_BUFFER11=34864]="DRAW_BUFFER11",n[n.DRAW_BUFFER12=34865]="DRAW_BUFFER12",n[n.DRAW_BUFFER13=34866]="DRAW_BUFFER13",n[n.DRAW_BUFFER14=34867]="DRAW_BUFFER14",n[n.DRAW_BUFFER15=34868]="DRAW_BUFFER15",n[n.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",n[n.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",n[n.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",n[n.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",n[n.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",n[n.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",n[n.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",n[n.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",n[n.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",n[n.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",n[n.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",n[n.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",n[n.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",n[n.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",n[n.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",n[n.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",n[n.SAMPLER_3D=35679]="SAMPLER_3D",n[n.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",n[n.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",n[n.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",n[n.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",n[n.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",n[n.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",n[n.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",n[n.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",n[n.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",n[n.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",n[n.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",n[n.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",n[n.MAX_SAMPLES=36183]="MAX_SAMPLES",n[n.SAMPLER_BINDING=35097]="SAMPLER_BINDING",n[n.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",n[n.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",n[n.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",n[n.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",n[n.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",n[n.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",n[n.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",n[n.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",n[n.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",n[n.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",n[n.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",n[n.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",n[n.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",n[n.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",n[n.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",n[n.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",n[n.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",n[n.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",n[n.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",n[n.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",n[n.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",n[n.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",n[n.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",n[n.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",n[n.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",n[n.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",n[n.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",n[n.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",n[n.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",n[n.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",n[n.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",n[n.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",n[n.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",n[n.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",n[n.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",n[n.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",n[n.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",n[n.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",n[n.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",n[n.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",n[n.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",n[n.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",n[n.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n[n.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",n[n.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",n[n.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",n[n.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",n[n.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",n[n.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",n[n.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",n[n.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",n[n.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",n[n.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",n[n.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",n[n.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",n[n.UNIFORM_TYPE=35383]="UNIFORM_TYPE",n[n.UNIFORM_SIZE=35384]="UNIFORM_SIZE",n[n.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",n[n.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",n[n.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",n[n.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",n[n.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",n[n.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",n[n.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",n[n.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",n[n.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",n[n.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",n[n.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",n[n.OBJECT_TYPE=37138]="OBJECT_TYPE",n[n.SYNC_CONDITION=37139]="SYNC_CONDITION",n[n.SYNC_STATUS=37140]="SYNC_STATUS",n[n.SYNC_FLAGS=37141]="SYNC_FLAGS",n[n.SYNC_FENCE=37142]="SYNC_FENCE",n[n.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",n[n.UNSIGNALED=37144]="UNSIGNALED",n[n.SIGNALED=37145]="SIGNALED",n[n.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",n[n.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",n[n.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",n[n.WAIT_FAILED=37149]="WAIT_FAILED",n[n.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",n[n.COLOR=6144]="COLOR",n[n.DEPTH=6145]="DEPTH",n[n.STENCIL=6146]="STENCIL",n[n.MIN=32775]="MIN",n[n.MAX=32776]="MAX",n[n.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",n[n.STREAM_READ=35041]="STREAM_READ",n[n.STREAM_COPY=35042]="STREAM_COPY",n[n.STATIC_READ=35045]="STATIC_READ",n[n.STATIC_COPY=35046]="STATIC_COPY",n[n.DYNAMIC_READ=35049]="DYNAMIC_READ",n[n.DYNAMIC_COPY=35050]="DYNAMIC_COPY",n[n.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",n[n.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",n[n.INVALID_INDEX=4294967295]="INVALID_INDEX",n[n.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",n[n.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",n[n.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",n[n.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",n[n.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",n[n.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",n[n.R16_EXT=33322]="R16_EXT",n[n.RG16_EXT=33324]="RG16_EXT",n[n.RGB16_EXT=32852]="RGB16_EXT",n[n.RGBA16_EXT=32859]="RGBA16_EXT",n[n.R16_SNORM_EXT=36760]="R16_SNORM_EXT",n[n.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",n[n.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",n[n.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",n[n.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",n[n.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",n[n.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",n[n.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",n[n.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",n[n.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",n[n.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",n[n.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",n[n.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",n[n.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",n[n.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",n[n.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",n[n.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",n[n.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",n[n.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",n[n.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",n[n.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",n[n.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",n[n.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",n[n.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",n[n.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",n[n.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",n[n.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",n[n.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",n[n.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",n[n.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",n[n.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",n[n.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",n[n.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",n[n.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",n[n.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",n[n.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",n[n.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",n[n.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",n[n.LINE_WEBGL=6913]="LINE_WEBGL",n[n.FILL_WEBGL=6914]="FILL_WEBGL",n[n.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",n[n.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",n[n.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",n[n.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",n[n.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",n[n.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",n[n.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",n[n.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",n[n.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",n[n.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",n[n.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",n[n.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",n[n.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",n[n.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",n[n.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",n[n.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",n[n.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",n[n.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",n[n.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",n[n.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",n[n.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",n[n.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",n[n.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",n[n.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(gt||(gt={}));const _1={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},vn=(n,e,t)=>e?n.enable(t):n.disable(t),Kw=(n,e,t)=>n.hint(t,e),Mr=(n,e,t)=>n.pixelStorei(t,e),Zw=(n,e,t)=>{const r=t===36006?36009:36008;return n.bindFramebuffer(r,e)},eu=(n,e,t)=>{const s={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[t];n.bindBuffer(s,e)};function ev(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}const YU={3042:vn,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:vn,2885:(n,e)=>n.cullFace(e),2929:vn,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:vn,35723:Kw,35725:(n,e)=>n.useProgram(e),36007:(n,e)=>n.bindRenderbuffer(36161,e),36389:(n,e)=>{var t;return(t=n.bindTransformFeedback)==null?void 0:t.call(n,36386,e)},34229:(n,e)=>n.bindVertexArray(e),36006:Zw,36010:Zw,34964:eu,36662:eu,36663:eu,35053:eu,35055:eu,2886:(n,e)=>n.frontFace(e),33170:Kw,2849:(n,e)=>n.lineWidth(e),32823:vn,32824:"polygonOffset",10752:"polygonOffset",35977:vn,32926:vn,32928:vn,32938:"sampleCoverage",32939:"sampleCoverage",3089:vn,3088:(n,e)=>n.scissor(...e),2960:vn,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),34383:vn,10754:vn,12288:vn,12289:vn,12290:vn,12291:vn,12292:vn,12293:vn,12294:vn,12295:vn,3333:Mr,3317:Mr,37440:Mr,37441:Mr,37443:Mr,3330:Mr,3332:Mr,3331:Mr,3314:Mr,32878:Mr,3316:Mr,3315:Mr,32877:Mr,framebuffer:(n,e)=>{const t=e&&"handle"in e?e.handle:e;return n.bindFramebuffer(36160,t)},blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{const t=typeof e=="number"?[e,e]:e;n.blendEquationSeparate(...t)},blendFunc:(n,e)=>{const t=(e==null?void 0:e.length)===2?[...e,...e]:e;n.blendFuncSeparate(...t)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=ev(e)?e:[e,e];const[t,r]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,r)},stencilFunc:(n,e)=>{e=ev(e)&&e.length===3?[...e,...e]:e;const[t,r,s,i,o,a]=e;n.stencilFuncSeparate(1028,t,r,s),n.stencilFuncSeparate(1029,i,o,a)},stencilOp:(n,e)=>{e=ev(e)&&e.length===3?[...e,...e]:e;const[t,r,s,i,o,a]=e;n.stencilOpSeparate(1028,t,r,s),n.stencilOpSeparate(1029,i,o,a)},viewport:(n,e)=>n.viewport(...e)};function on(n,e,t){return e[n]!==void 0?e[n]:t[n]}const qU={blendEquation:(n,e,t)=>n.blendEquationSeparate(on(32777,e,t),on(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(on(32969,e,t),on(32968,e,t),on(32971,e,t),on(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(on(32824,e,t),on(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(on(32938,e,t),on(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,on(2962,e,t),on(2967,e,t),on(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,on(34816,e,t),on(36003,e,t),on(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,on(2964,e,t),on(2965,e,t),on(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,on(34817,e,t),on(34818,e,t),on(34819,e,t))},Qw={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),useProgram:(n,e)=>n({35725:e}),bindRenderbuffer:(n,e,t)=>n({36007:t}),bindTransformFeedback:(n,e,t)=>n({36389:t}),bindVertexArray:(n,e)=>n({34229:e}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},bindBuffer:(n,e,t)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return r?n({[r]:t}):{valueChanged:!0}},blendColor:(n,e,t,r,s)=>n({32773:new Float32Array([e,t,r,s])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,r,s)=>n({32969:e,32968:t,32971:r,32970:s}),clearColor:(n,e,t,r,s)=>n({3106:new Float32Array([e,t,r,s])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,r,s)=>n({3107:[e,t,r,s]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,r,s)=>n({3088:new Int32Array([e,t,r,s])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[e===1028?2968:36005]:t}),stencilFunc:(n,e,t,r)=>n({2962:e,2967:t,2963:r,34816:e,36003:t,36004:r}),stencilFuncSeparate:(n,e,t,r,s)=>n({[e===1028?2962:34816]:t,[e===1028?2967:36003]:r,[e===1028?2963:36004]:s}),stencilOp:(n,e,t,r)=>n({2964:e,2965:t,2966:r,34817:e,34818:t,34819:r}),stencilOpSeparate:(n,e,t,r,s)=>n({[e===1028?2964:34817]:t,[e===1028?2965:34818]:r,[e===1028?2966:34819]:s}),viewport:(n,e,t,r,s)=>n({2978:[e,t,r,s]})},Os=(n,e)=>n.isEnabled(e),Gw={3042:Os,2884:Os,2929:Os,3024:Os,32823:Os,32926:Os,32928:Os,3089:Os,2960:Os,35977:Os},KU=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function hc(n,e){if(QU(e))return;const t={};for(const s in e){const i=Number(s),o=YU[s];o&&(typeof o=="string"?t[o]=!0:o(n,e[s],i))}const r=n.state&&n.state.cache;if(r)for(const s in t){const i=qU[s];i(n,e,r)}}function XA(n,e=_1){if(typeof e=="number"){const s=e,i=Gw[s];return i?i(n,s):n.getParameter(s)}const t=Array.isArray(e)?e:Object.keys(e),r={};for(const s of t){const i=Gw[s];r[s]=i?i(n,Number(s)):n.getParameter(Number(s))}return r}function ZU(n){hc(n,_1)}function QU(n){for(const e in n)return!1;return!0}function GU(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),r=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&r&&n.length===e.length){for(let s=0;s<n.length;++s)if(n[s]!==e[s])return!1;return!0}return!1}class JU{constructor(e,{copyState:t=!1,log:r=()=>{}}={}){E(this,"gl");E(this,"program",null);E(this,"stateStack",[]);E(this,"enable",!0);E(this,"cache");E(this,"log");this.gl=e,this.cache=t?XA(e):Object.assign({},_1),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Ht(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];hc(this.gl,e),this.stateStack.pop()}_updateCache(e){let t=!1,r;const s=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const i in e){Ht(i!==void 0);const o=e[i],a=this.cache[i];GU(o,a)||(t=!0,r=a,s&&!(i in s)&&(s[i]=a),this.cache[i]=o)}return{valueChanged:t,oldValue:r}}}function Aa(n){return n.state}function YA(n,e){const{enable:t=!0,copyState:r}=e;if(Ht(r!==void 0),!n.state){n.state=new JU(n,{copyState:r}),tV(n);for(const i in Qw){const o=Qw[i];eV(n,i,o)}Jw(n,"getParameter"),Jw(n,"isEnabled")}const s=Aa(n);return s.enable=t,n}function og(n){let e=Aa(n);e||(YA(n,{copyState:!1}),e=Aa(n)),e.push()}function qu(n){const e=Aa(n);Ht(e),e.pop()}function Jw(n,e){const t=n[e].bind(n);n[e]=function(s){if(s===void 0||KU.has(s))return t(s);const i=Aa(n);return s in i.cache||(i.cache[s]=t(s)),i.enable?i.cache[s]:t(s)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function eV(n,e,t){if(!n[e])return;const r=n[e].bind(n);n[e]=function(...i){const o=Aa(n),{valueChanged:a,oldValue:u}=t(o._updateCache,...i);return a&&r(...i),u},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}function tV(n){const e=n.useProgram.bind(n);n.useProgram=function(r){const s=Aa(n);s.program!==r&&(e(r),s.program=r)}}const nV={powerPreference:"high-performance",onContextLost:()=>console.error("WebGL context lost"),onContextRestored:()=>console.info("WebGL context restored")};function rV(n,e){e={...nV,...e};let t=null;const r=i=>t=i.statusMessage||t;n.addEventListener("webglcontextcreationerror",r,!1);let s=null;if(s||(s=n.getContext("webgl2",e)),n.removeEventListener("webglcontextcreationerror",r,!1),!s)throw new Error(`Failed to create WebGL context: ${t||"Unknown error"}`);if(e.onContextLost){const{onContextLost:i}=e;n.addEventListener("webglcontextlost",o=>i(o),!1)}if(e.onContextRestored){const{onContextRestored:i}=e;n.addEventListener("webglcontextrestored",o=>i(o),!1)}return s}function Co(n,e,t){return t[e]===void 0&&(t[e]=n.getExtension(e)||null),t[e]}function sV(n,e){const t=n.getParameter(7936),r=n.getParameter(7937);Co(n,"WEBGL_debug_renderer_info",e);const s=e.WEBGL_debug_renderer_info,i=n.getParameter(s?s.UNMASKED_VENDOR_WEBGL:7936),o=n.getParameter(s?s.UNMASKED_RENDERER_WEBGL:7937),a=i||t,u=o||r,f=n.getParameter(7938),d=qA(a,u),p=iV(a,u),m=oV(a,u);return{type:"webgl",gpu:d,gpuType:m,gpuBackend:p,vendor:a,renderer:u,version:f,shadingLanguage:"glsl",shadingLanguageVersion:300}}function qA(n,e){return/NVIDIA/i.exec(n)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(n)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(n)||/Apple/i.exec(e)?"apple":/AMD/i.exec(n)||/AMD/i.exec(e)||/ATI/i.exec(n)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(n)||/SwiftShader/i.exec(e)?"software":"unknown"}function iV(n,e){return/Metal/i.exec(n)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(n)||/ANGLE/i.exec(e)?"opengl":"unknown"}function oV(n,e){if(/SwiftShader/i.exec(n)||/SwiftShader/i.exec(e))return"cpu";switch(qA(n,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function KA(n){switch(n){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(n))}const Kn="texture-compression-bc",Lt="texture-compression-astc",Ns="texture-compression-etc2",aV="texture-compression-etc1-webgl",nh="texture-compression-pvrtc-webgl",tv="texture-compression-atc-webgl",tu="float32-renderable-webgl",nv="float16-renderable-webgl",lV="rgb9e5ufloat_renderable-webgl",rv="snorm8-renderable-webgl",nu="norm16-renderable-webgl",sv="snorm16-renderable-webgl",rh="float32-filterable",eT="float16-filterable-webgl",gu="WEBGL_compressed_texture_s3tc",mu="WEBGL_compressed_texture_s3tc_srgb",Il="EXT_texture_compression_rgtc",kl="EXT_texture_compression_bptc",cV="WEBGL_compressed_texture_etc",uV="WEBGL_compressed_texture_astc",fV="WEBGL_compressed_texture_etc1",dV="WEBGL_compressed_texture_pvrtc",hV="WEBGL_compressed_texture_atc",tT="EXT_texture_norm16",nT="EXT_render_snorm",pV="EXT_color_buffer_float",x1={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat_renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[nT],"norm16-renderable-webgl":[tT],"snorm16-renderable-webgl":[tT,nT],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[gu,mu,Il,kl],"texture-compression-bc5-webgl":[Il],"texture-compression-bc7-webgl":[kl],"texture-compression-etc2":[cV],"texture-compression-astc":[uV],"texture-compression-etc1-webgl":[fV],"texture-compression-pvrtc-webgl":[dV],"texture-compression-atc-webgl":[hV]};function gV(n){return n in x1}function mV(n,e,t){return(x1[e]||[]).every(s=>Co(n,s,t))}const ag={"rgb8unorm-unsized":{gl:6407,b:4,c:2,bpp:4,dataFormat:6407,types:[5121,33635]},"rgba8unorm-unsized":{gl:6408,b:4,c:2,bpp:4,dataFormat:6408,types:[5121,32819,32820]},r8unorm:{gl:33321,b:1,c:1,rb:!0},r8snorm:{gl:36756,b:1,c:1,render:rv},r8uint:{gl:33330,b:1,c:1,rb:!0},r8sint:{gl:33329,b:1,c:1,rb:!0},rg8unorm:{gl:33323,b:2,c:2,rb:!0},rg8snorm:{gl:36757,b:2,c:2,render:rv},rg8uint:{gl:33336,b:2,c:2,rb:!0},rg8sint:{gl:33335,b:2,c:2,rb:!0},r16uint:{gl:33332,b:2,c:1,rb:!0},r16sint:{gl:33331,b:2,c:1,rb:!0},r16float:{gl:33325,b:2,c:1,render:nv,filter:"float16-filterable-webgl",rb:!0},"r16unorm-webgl":{gl:33322,b:2,c:1,f:nu,rb:!0},"r16snorm-webgl":{gl:36760,b:2,c:1,f:sv},"rgba4unorm-webgl":{gl:32854,b:2,c:4,wgpu:!1,rb:!0},"rgb565unorm-webgl":{gl:36194,b:2,c:4,wgpu:!1,rb:!0},"rgb5a1unorm-webgl":{gl:32855,b:2,c:4,wgpu:!1,rb:!0},"rgb8unorm-webgl":{gl:32849,b:3,c:3,wgpu:!1},"rgb8snorm-webgl":{gl:36758,b:3,c:3,wgpu:!1},rgba8unorm:{gl:32856,b:4,c:2,bpp:4},"rgba8unorm-srgb":{gl:35907,b:4,c:4,bpp:4},rgba8snorm:{gl:36759,b:4,c:4,render:rv},rgba8uint:{gl:36220,b:4,c:4,bpp:4},rgba8sint:{gl:36238,b:4,c:4,bpp:4},bgra8unorm:{b:4,c:4},"bgra8unorm-srgb":{b:4,c:4},rg16uint:{gl:33338,b:4,c:1,bpp:4},rg16sint:{gl:33337,b:4,c:2,bpp:4},rg16float:{gl:33327,bpp:4,b:4,c:2,render:nv,filter:eT,rb:!0},"rg16unorm-webgl":{gl:33324,b:2,c:2,render:nu},"rg16snorm-webgl":{gl:36761,b:2,c:2,render:sv},r32uint:{gl:33334,b:4,c:1,bpp:4,rb:!0},r32sint:{gl:33333,b:4,c:1,bpp:4,rb:!0},r32float:{gl:33326,bpp:4,b:4,c:1,render:tu,filter:rh},rgb9e5ufloat:{gl:35901,b:4,c:3,p:1,render:lV},rg11b10ufloat:{gl:35898,b:4,c:3,p:1,render:tu,rb:!0},rgb10a2unorm:{gl:32857,b:4,c:4,p:1,rb:!0},"rgb10a2uint-webgl":{b:4,c:4,gl:36975,p:1,wgpu:!1,bpp:4,rb:!0},"rgb16unorm-webgl":{gl:32852,b:2,c:3,f:nu},"rgb16snorm-webgl":{gl:36762,b:2,c:3,f:nu},rg32uint:{gl:33340,b:8,c:2,rb:!0},rg32sint:{gl:33339,b:8,c:2,rb:!0},rg32float:{gl:33328,b:8,c:2,render:tu,filter:rh,rb:!0},rgba16uint:{gl:36214,b:8,c:4,rb:!0},rgba16sint:{gl:36232,b:8,c:4,rb:!0},rgba16float:{gl:34842,b:8,c:4,render:nv,filter:eT},"rgba16unorm-webgl":{gl:32859,b:2,c:4,render:nu,rb:!0},"rgba16snorm-webgl":{gl:36763,b:2,c:4,render:sv},"rgb32float-webgl":{gl:34837,render:tu,filter:rh,gl2ext:pV,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,b:16,c:4,rb:!0},rgba32sint:{gl:36226,b:16,c:4,rb:!0},rgba32float:{gl:34836,b:16,c:4,render:tu,filter:rh,rb:!0},stencil8:{gl:36168,b:1,c:1,attachment:36128,rb:!0},depth16unorm:{gl:33189,b:2,c:1,attachment:36096,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,b:3,c:1,attachment:36096,dataFormat:6402,types:[5125]},depth32float:{gl:36012,b:4,c:1,attachment:36096,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth24unorm-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,dataFormat:34041,types:[34042],rb:!0},"depth32float-stencil8":{gl:36013,b:5,c:2,p:1,attachment:33306,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:gu,f:Kn},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:mu,f:Kn},"bc1-rgba-unorm":{gl:33777,x:gu,f:Kn},"bc1-rgba-unorm-srgb":{gl:35916,x:mu,f:Kn},"bc2-rgba-unorm":{gl:33778,x:gu,f:Kn},"bc2-rgba-unorm-srgb":{gl:35918,x:mu,f:Kn},"bc3-rgba-unorm":{gl:33779,x:gu,f:Kn},"bc3-rgba-unorm-srgb":{gl:35919,x:mu,f:Kn},"bc4-r-unorm":{gl:36283,x:Il,f:Kn},"bc4-r-snorm":{gl:36284,x:Il,f:Kn},"bc5-rg-unorm":{gl:36285,x:Il,f:Kn},"bc5-rg-snorm":{gl:36286,x:Il,f:Kn},"bc6h-rgb-ufloat":{gl:36495,x:kl,f:Kn},"bc6h-rgb-float":{gl:36494,x:kl,f:Kn},"bc7-rgba-unorm":{gl:36492,x:kl,f:Kn},"bc7-rgba-unorm-srgb":{gl:36493,x:kl,f:Kn},"etc2-rgb8unorm":{gl:37492,f:Ns},"etc2-rgb8unorm-srgb":{gl:37494,f:Ns},"etc2-rgb8a1unorm":{gl:37496,f:Ns},"etc2-rgb8a1unorm-srgb":{gl:37497,f:Ns},"etc2-rgba8unorm":{gl:37493,f:Ns},"etc2-rgba8unorm-srgb":{gl:37495,f:Ns},"eac-r11unorm":{gl:37488,f:Ns},"eac-r11snorm":{gl:37489,f:Ns},"eac-rg11unorm":{gl:37490,f:Ns},"eac-rg11snorm":{gl:37491,f:Ns},"astc-4x4-unorm":{gl:37808,f:Lt},"astc-4x4-unorm-srgb":{gl:37840,f:Lt},"astc-5x4-unorm":{gl:37809,f:Lt},"astc-5x4-unorm-srgb":{gl:37841,f:Lt},"astc-5x5-unorm":{gl:37810,f:Lt},"astc-5x5-unorm-srgb":{gl:37842,f:Lt},"astc-6x5-unorm":{gl:37811,f:Lt},"astc-6x5-unorm-srgb":{gl:37843,f:Lt},"astc-6x6-unorm":{gl:37812,f:Lt},"astc-6x6-unorm-srgb":{gl:37844,f:Lt},"astc-8x5-unorm":{gl:37813,f:Lt},"astc-8x5-unorm-srgb":{gl:37845,f:Lt},"astc-8x6-unorm":{gl:37814,f:Lt},"astc-8x6-unorm-srgb":{gl:37846,f:Lt},"astc-8x8-unorm":{gl:37815,f:Lt},"astc-8x8-unorm-srgb":{gl:37847,f:Lt},"astc-10x5-unorm":{gl:37819,f:Lt},"astc-10x5-unorm-srgb":{gl:37851,f:Lt},"astc-10x6-unorm":{gl:37817,f:Lt},"astc-10x6-unorm-srgb":{gl:37849,f:Lt},"astc-10x8-unorm":{gl:37818,f:Lt},"astc-10x8-unorm-srgb":{gl:37850,f:Lt},"astc-10x10-unorm":{gl:37819,f:Lt},"astc-10x10-unorm-srgb":{gl:37851,f:Lt},"astc-12x10-unorm":{gl:37820,f:Lt},"astc-12x10-unorm-srgb":{gl:37852,f:Lt},"astc-12x12-unorm":{gl:37821,f:Lt},"astc-12x12-unorm-srgb":{gl:37853,f:Lt},"pvrtc-rgb4unorm-webgl":{gl:35840,f:nh},"pvrtc-rgba4unorm-webgl":{gl:35842,f:nh},"pvrtc-rbg2unorm-webgl":{gl:35841,f:nh},"pvrtc-rgba2unorm-webgl":{gl:35843,f:nh},"etc1-rbg-unorm-webgl":{gl:36196,f:aV},"atc-rgb-unorm-webgl":{gl:35986,f:tv},"atc-rgba-unorm-webgl":{gl:35986,f:tv},"atc-rgbai-unorm-webgl":{gl:34798,f:tv}},vV={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},yV={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function b1(n,e,t){const r=ag[e];if(!r||r.gl===void 0)return!1;const s=r.x||r.gl2ext;return s?!!Co(n,s,t):!0}function ZA(n){const e=ag[n],t=e==null?void 0:e.gl;if(t===void 0)throw new Error(`Unsupported texture format ${n}`);return t}function _V(n,e,t){if(!b1(n,e,t)||e.startsWith("depth")||e.startsWith("stencil"))return!1;try{if(K4(e).signed)return!1}catch{return!1}return e.endsWith("32float")?!!Co(n,"OES_texture_float_linear, extensions",t):e.endsWith("16float")?!!Co(n,"OES_texture_half_float_linear, extensions",t):!0}function xV(n,e,t){return!(!b1(n,e,t)||typeof e=="number")}function op(n){var s;const e=ag[n],t=ZA(n),r=K4(n);return{format:t,dataFormat:(e==null?void 0:e.dataFormat)||wV(r.format,r.integer,r.normalized,t),type:r.dataType?KA(r.dataType):((s=e==null?void 0:e.types)==null?void 0:s[0])||5121,compressed:r.compressed}}function bV(n){const e=ag[n];if(!(e!=null&&e.attachment))throw new Error(`${n} is not a depth stencil format`);return e.attachment}function rT(n){const e=op(n),t=vV[e.dataFormat]||4,r=yV[e.type]||1;return t*r}function wV(n,e,t,r){if(r===6408||r===6407)return r;switch(n){case"r":return e&&!t?36244:6403;case"rg":return e&&!t?33320:33319;case"rgb":return e&&!t?36248:6407;case"rgba":return e&&!t?36249:6408;default:return 6408}}const sT={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class TV extends GF{constructor(t,r,s){super([],s);E(this,"gl");E(this,"extensions");E(this,"testedFeatures",new Set);this.gl=t,this.extensions=r,Co(t,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const t=this.getFeatures();for(const r of t)this.has(r)&&(yield r);return[]}has(t){return this.disabledFeatures[t]?!1:(this.testedFeatures.has(t)||(this.testedFeatures.add(t),gV(t)&&mV(this.gl,t,this.extensions)&&this.features.add(t),this.getWebGLFeature(t)&&this.features.add(t)),this.features.has(t))}initializeFeatures(){const t=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of t)this.has(r)}getFeatures(){return[...Object.keys(sT),...Object.keys(x1)]}getWebGLFeature(t){const r=sT[t];return typeof r=="string"?!!Co(this.gl,r,this.extensions):!!r}}class SV extends QF{constructor(t){super();E(this,"gl");E(this,"limits",{});this.gl=t}get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}getParameter(t){return this.limits[t]===void 0&&(this.limits[t]=this.gl.getParameter(t)),this.limits[t]}}function go(n,e,t){if(EV(e))return t(n);const{nocatch:r=!0}=e;og(n),hc(n,e);let s;if(r)s=t(n),qu(n);else try{s=t(n)}finally{qu(n)}return s}function EV(n){for(const e in n)return!1;return!0}function AV(n,e,t,r){if(Xh(e))return r(n);const s=n;og(s.gl);try{return CV(n,e),hc(s.gl,t),r(n)}finally{qu(s.gl)}}function CV(n,e){const t=n,{gl:r}=t;if(e.cullMode)switch(e.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029);break}if(e.frontFace&&r.frontFace(ma("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&n.features.has("depth-clip-control")&&r.enable(34383),e.depthBias!==void 0&&(r.enable(32823),r.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&n.features.has("provoking-vertex-webgl")){const i=t.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,o=ma("provokingVertex",e.provokingVertex,{first:36429,last:36430});i==null||i.provokingVertexWEBGL(o)}if((e.polygonMode||e.polygonOffsetLine)&&n.features.has("polygon-mode-webgl")){if(e.polygonMode){const i=t.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=ma("polygonMode",e.polygonMode,{fill:6914,line:6913});i==null||i.polygonModeWEBGL(1028,o),i==null||i.polygonModeWEBGL(1029,o)}e.polygonOffsetLine&&r.enable(10754)}if(n.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&r.enable(12288),e.clipDistance1&&r.enable(12289),e.clipDistance2&&r.enable(12290),e.clipDistance3&&r.enable(12291),e.clipDistance4&&r.enable(12292),e.clipDistance5&&r.enable(12293),e.clipDistance6&&r.enable(12294),e.clipDistance7&&r.enable(12295)),e.depthWriteEnabled!==void 0&&r.depthMask(PV("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?r.enable(2929):r.disable(2929),r.depthFunc(Oy("depthCompare",e.depthCompare))),e.stencilWriteMask){const s=e.stencilWriteMask;r.stencilMaskSeparate(1028,s),r.stencilMaskSeparate(1029,s)}if(e.stencilReadMask&&Re.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const s=e.stencilReadMask||4294967295,i=Oy("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,i,0,s),r.stencilFuncSeparate(1029,i,0,s)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const s=iv("stencilPassOperation",e.stencilPassOperation),i=iv("stencilFailOperation",e.stencilFailOperation),o=iv("stencilDepthFailOperation",e.stencilDepthFailOperation);r.stencilOpSeparate(1028,i,o,s),r.stencilOpSeparate(1029,i,o,s)}if(e.blendColorOperation||e.blendAlphaOperation){r.enable(3042);const s=iT("blendColorOperation",e.blendColorOperation||"add"),i=iT("blendAlphaOperation",e.blendAlphaOperation||"add");r.blendEquationSeparate(s,i);const o=sh("blendColorSrcFactor",e.blendColorSrcFactor||"one"),a=sh("blendColorDstFactor",e.blendColorDstFactor||"zero"),u=sh("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),f=sh("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");r.blendFuncSeparate(o,a,u,f)}}function Oy(n,e){return ma(n,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function iv(n,e){return ma(n,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function iT(n,e){return ma(n,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function sh(n,e){return ma(n,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function RV(n,e){return`Illegal parameter ${e} for ${n}`}function ma(n,e,t){if(!(e in t))throw new Error(RV(n,e));return t[e]}function PV(n,e){return e}function QA(n){const e={};return n.addressModeU&&(e[10242]=ov(n.addressModeU)),n.addressModeV&&(e[10243]=ov(n.addressModeV)),n.addressModeW&&(e[32882]=ov(n.addressModeW)),n.magFilter&&(e[10240]=GA(n.magFilter)),(n.minFilter||n.mipmapFilter)&&(e[10241]=IV(n.minFilter||"linear",n.mipmapFilter)),n.lodMinClamp!==void 0&&(e[33082]=n.lodMinClamp),n.lodMaxClamp!==void 0&&(e[33083]=n.lodMaxClamp),n.type==="comparison-sampler"&&(e[34892]=34894),n.compare&&(e[34893]=Oy("compare",n.compare)),n.maxAnisotropy&&(e[34046]=n.maxAnisotropy),e}function ov(n){switch(n){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function GA(n){switch(n){case"nearest":return 9728;case"linear":return 9729}}function IV(n,e){if(!e)return GA(n);switch(n){case"nearest":return e==="nearest"?9984:9986;case"linear":return e==="nearest"?9985:9987}}class xo extends fn{constructor(t,r={}){super(t,r);E(this,"device");E(this,"gl");E(this,"handle");E(this,"glTarget");E(this,"glUsage");E(this,"glIndexType",5123);E(this,"byteLength");E(this,"bytesUsed");this.device=t,this.gl=this.device.gl;const s=typeof r=="object"?r.handle:void 0;this.handle=s||this.gl.createBuffer(),t.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=kV(this.props.usage),this.glUsage=MV(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(t,r=0,s=t.byteLength+r){const i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,s,this.glUsage),this.gl.bufferSubData(i,r,t),this.gl.bindBuffer(i,null),this.bytesUsed=s,this.byteLength=s,this._setDebugData(t,r,s),this.trackAllocatedMemory(s)}_initWithByteLength(t){Ht(t>=0);let r=t;t===0&&(r=new Float32Array(0));const s=this.glTarget;return this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,r,this.glUsage),this.gl.bindBuffer(s,null),this.bytesUsed=t,this.byteLength=t,this._setDebugData(null,0,t),this.trackAllocatedMemory(t),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(t,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,t),this.gl.bindBuffer(36663,null),this._setDebugData(t,r,t.byteLength)}async readAsync(t=0,r){return this.readSyncWebGL(t,r)}readSyncWebGL(t=0,r){r=r??this.byteLength-t;const s=new Uint8Array(r),i=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,s,i,r),this.gl.bindBuffer(36662,null),this._setDebugData(s,t,r),s}}function kV(n){return n&fn.INDEX?34963:n&fn.VERTEX?34962:n&fn.UNIFORM?35345:34962}function MV(n){return n&fn.INDEX||n&fn.VERTEX?35044:n&fn.UNIFORM?35048:35044}class Ny extends Kh{constructor(t,r){super(t,r);E(this,"device");E(this,"handle");E(this,"parameters");this.device=t,this.parameters=QA(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(t){for(const[r,s]of Object.entries(t)){const i=Number(r);switch(i){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,i,s);break;default:this.device.gl.samplerParameteri(this.handle,i,s);break}}}}class Ml extends Yh{constructor(t,r){super(t,{...Zr.defaultProps,...r});E(this,"device");E(this,"gl");E(this,"handle");E(this,"texture");this.device=t,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}const OV={parameters:{},pixelStore:{},pixels:null,border:0,dataFormat:void 0,textureUnit:void 0,target:void 0},Lu=class Lu extends Zr{constructor(t,r){var s;super(t,{...OV,format:"rgba8unorm",...r});E(this,"MAX_ATTRIBUTES");E(this,"device");E(this,"gl");E(this,"handle");E(this,"sampler");E(this,"view");E(this,"glFormat");E(this,"type");E(this,"dataFormat");E(this,"mipmaps");E(this,"target");E(this,"textureUnit");E(this,"loaded",!1);E(this,"_video");this.device=t,this.gl=this.device.gl,this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glFormat=6408,this.target=NV(this.props),this.loaded=!1,typeof((s=this.props)==null?void 0:s.data)=="string"&&Object.assign(this.props,{data:U7(this.props.data)}),this.initialize(this.props),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}toString(){return`Texture(${this.id},${this.width}x${this.height})`}createView(t){return new Ml(this.device,{...t,texture:this})}initialize(t={}){if(this.props.dimension==="cube")return this.initializeCube(t);let r=t.data;if(r instanceof Promise)return r.then(S=>this.initialize(Object.assign({},t,{pixels:S,data:S}))),this;const s=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement;if(s&&r.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,r.addEventListener("loadeddata",()=>this.initialize(t)),this;const{parameters:i={}}=t,{pixels:o=null,pixelStore:a={},textureUnit:u=void 0,mipmaps:f=!0}=t;r||(r=o);let{width:d,height:p,dataFormat:m,type:v,compressed:x=!1}=t;const{depth:b=0}=t,w=ZA(t.format);return{width:d,height:p,compressed:x,dataFormat:m,type:v}=this._deduceParameters({format:t.format,type:v,dataFormat:m,compressed:x,data:r,width:d,height:p}),this.width=d,this.height=p,this.glFormat=w,this.type=v,this.dataFormat=m,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),this.mipmaps=f,this.setImageData({data:r,width:d,height:p,depth:b,format:t.format,type:v,dataFormat:m,parameters:a,compressed:x}),this.setSampler(t.sampler),this._setSamplerParameters(i),this.view=this.createView({...this.props,mipLevelCount:1,arrayLayerCount:1}),f&&this.device.isTextureFormatFilterable(t.format)&&this.generateMipmap(),s&&(this._video={video:r,parameters:i,lastTime:r.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?r.currentTime:-1}),this}initializeCube(t){const{mipmaps:r=!0,parameters:s={}}=t;return this.setCubeMapImageData(t).then(()=>{this.loaded=!0,r&&this.generateMipmap(t),this.setSampler(t.sampler),this._setSamplerParameters(s)}),this}setSampler(t={}){let r;t instanceof Ny?(this.sampler=t,r=t.props):(this.sampler=new Ny(this.device,t),r=t);const s=QA(r);return this._setSamplerParameters(s),this}resize(t){const{height:r,width:s,mipmaps:i=!1}=t;return s!==this.width||r!==this.height?this.initialize({width:s,height:r,format:this.format,type:this.type,dataFormat:this.dataFormat,mipmaps:i}):this}update(){if(this._video){const{video:t,parameters:r,lastTime:s}=this._video;if(s===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:r}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}generateMipmap(t={}){return this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),go(this.gl,t,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this}setImageData(t){if(this.props.dimension==="3d"||this.props.dimension==="2d-array")return this.setImageData3D(t);this.trackDeallocatedMemory("Texture");const{target:r=this.target,pixels:s=null,level:i=0,glFormat:o=this.glFormat,offset:a=0,parameters:u={}}=t;let{data:f=null,type:d=this.type,width:p=this.width,height:m=this.height,dataFormat:v=this.dataFormat,compressed:x=!1}=t;f||(f=s),{type:d,dataFormat:v,compressed:x,width:p,height:m}=this._deduceParameters({format:this.props.format,type:d,dataFormat:v,compressed:x,data:f,width:p,height:m});const{gl:b}=this;b.bindTexture(this.target,this.handle);let w=null;if({data:f,dataType:w}=this._getDataType({data:f,compressed:x}),go(this.gl,u,()=>{switch(w){case"null":b.texImage2D(r,i,o,p,m,0,v,d,f);break;case"typed-array":b.texImage2D(r,i,o,p,m,0,v,d,f,a);break;case"buffer":this.device.gl.bindBuffer(35052,f.handle||f),this.device.gl.texImage2D(r,i,o,p,m,0,v,d,a),this.device.gl.bindBuffer(35052,null);break;case"browser-object":b.texImage2D(r,i,o,p,m,0,v,d,f);break;case"compressed":for(const[S,R]of f.entries())b.compressedTexImage2D(r,S,R.format,R.width,R.height,0,R.data);break;default:Ht(!1,"Unknown image data type")}}),f&&f.byteLength)this.trackAllocatedMemory(f.byteLength,"Texture");else{const S=rT(this.props.format);this.trackAllocatedMemory(this.width*this.height*S,"Texture")}return this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:r=null,data:s=null,x:i=0,y:o=0,width:a=this.width,height:u=this.height,level:f=0,glFormat:d=this.glFormat,type:p=this.type,dataFormat:m=this.dataFormat,compressed:v=!1,offset:x=0,parameters:b={}}){if({type:p,dataFormat:m,compressed:v,width:a,height:u}=this._deduceParameters({format:this.props.format,type:p,dataFormat:m,compressed:v,data:s,width:a,height:u}),Ht(this.depth===1,"texSubImage not supported for 3D textures"),s||(s=r),s&&s.data){const w=s;s=w.data,a=w.shape[0],u=w.shape[1]}s instanceof xo&&(s=s.handle),this.gl.bindTexture(this.target,this.handle),go(this.gl,b,()=>{v?this.gl.compressedTexSubImage2D(t,f,i,o,a,u,d,s):s===null?this.gl.texSubImage2D(t,f,i,o,a,u,m,p,null):ArrayBuffer.isView(s)?this.gl.texSubImage2D(t,f,i,o,a,u,m,p,s,x):typeof WebGLBuffer<"u"&&s instanceof WebGLBuffer?(this.device.gl.bindBuffer(35052,s),this.device.gl.texSubImage2D(t,f,i,o,a,u,m,p,x),this.device.gl.bindBuffer(35052,null)):this.device.gl.texSubImage2D(t,f,i,o,a,u,m,p,s)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return Re.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){const{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){const{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.target,null),t}_getDataType({data:t,compressed:r=!1}){return r?{data:t,dataType:"compressed"}:t===null?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof xo?{data:t.handle,dataType:"buffer"}:typeof WebGLBuffer<"u"&&t instanceof WebGLBuffer?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){const{format:r,data:s}=t;let{width:i,height:o,dataFormat:a,type:u,compressed:f}=t;const d=op(r);return a=a||d.dataFormat,u=u||d.type,f=f||d.compressed,{width:i,height:o}=this._deduceImageSize(s,i,o),{dataFormat:a,type:u,compressed:f,width:i,height:o,format:r,data:s}}_deduceImageSize(t,r,s){let i;return typeof ImageData<"u"&&t instanceof ImageData?i={width:t.width,height:t.height}:typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement?i={width:t.naturalWidth,height:t.naturalHeight}:typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement?i={width:t.width,height:t.height}:typeof ImageBitmap<"u"&&t instanceof ImageBitmap?i={width:t.width,height:t.height}:typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?i={width:t.videoWidth,height:t.videoHeight}:t?i={width:r,height:s}:i={width:r>=0?r:1,height:s>=0?s:1},Ht(i,"Could not deduced texture size"),Ht(r===void 0||i.width===r,"Deduced texture width does not match supplied width"),Ht(s===void 0||i.height===s,"Deduced texture height does not match supplied height"),i}async setCubeMapImageData(t){const{gl:r}=this,{width:s,height:i,pixels:o,data:a,format:u=6408,type:f=5121}=t,d=o||a,p=await Promise.all(Lu.FACES.map(m=>{const v=d[m];return Promise.all(Array.isArray(v)?v:[v])}));this.bind(),Lu.FACES.forEach((m,v)=>{p[v].length>1&&this.props.mipmaps!==!1&&Re.warn(`${this.id} has mipmap and multiple LODs.`)(),p[v].forEach((x,b)=>{s&&i?r.texImage2D(m,b,u,s,i,0,u,f,x):r.texImage2D(m,b,u,u,f,x)})}),this.unbind()}setImageDataForFace(t){const{face:r,width:s,height:i,pixels:o,data:a,format:u=6408,type:f=5121}=t,{gl:d}=this,p=o||a;return this.bind(),p instanceof Promise?p.then(m=>this.setImageDataForFace(Object.assign({},t,{face:r,data:m,pixels:m}))):this.width||this.height?d.texImage2D(r,0,u,s,i,0,u,f,p):d.texImage2D(r,0,u,u,f,p),this}setImageData3D(t){const{level:r=0,dataFormat:s,format:i,type:o,width:a,height:u,depth:f=1,offset:d=0,data:p,parameters:m={}}=t;this.trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle);const v=op(i);if(go(this.gl,m,()=>{ArrayBuffer.isView(p)&&this.gl.texImage3D(this.target,r,v.format,a,u,f,0,v.dataFormat,v.type,p),p instanceof xo&&(this.gl.bindBuffer(35052,p.handle),this.gl.texImage3D(this.target,r,s,a,u,f,0,i,o,d))}),p&&p.byteLength)this.trackAllocatedMemory(p.byteLength,"Texture");else{const x=rT(this.props.format);this.trackAllocatedMemory(this.width*this.height*this.depth*x,"Texture")}return this.loaded=!0,this}_setSamplerParameters(t){if(!Xh(t)){DV(t),this.gl.bindTexture(this.target,this.handle);for(const[r,s]of Object.entries(t)){const i=Number(r),o=s;switch(i){case 33082:case 33083:this.gl.texParameterf(this.target,i,o);break;default:this.gl.texParameteri(this.target,i,o);break}}this.gl.bindTexture(this.target,null)}}};E(Lu,"FACES",[34069,34070,34071,34072,34073,34074]);let zs=Lu;function NV(n){switch(n.dimension){case"2d":return 3553;case"cube":return 34067;case"2d-array":return 35866;case"3d":return 32879;case"1d":case"cube-array":default:throw new Error(n.dimension)}}function DV(n){Re.log(1,"texture sampler parameters",n)()}class Iu extends Zh{constructor(t,r){super(t,r);E(this,"device");E(this,"gl");E(this,"handle");const s=r.handle===null;if(this.device=t,this.gl=t.gl,this.handle=this.props.handle||s?this.props.handle:this.gl.createFramebuffer(),!s){t.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures();const i=this.gl.bindFramebuffer(36160,this.handle);for(let o=0;o<this.colorAttachments.length;++o){const a=this.colorAttachments[o],u=36064+o;a&&this._attachOne(u,a)}if(this.depthStencilAttachment&&this._attachOne(bV(this.depthStencilAttachment.props.format),this.depthStencilAttachment),r.check!==!1){const o=this.gl.checkFramebufferStatus(36160);if(o!==36053)throw new Error(`Framebuffer ${FV(o)}`)}this.gl.bindFramebuffer(36160,i)}}get texture(){return this.colorAttachments[0]}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}createDepthStencilTexture(t){return new zs(this.device,{id:`${this.id}-depth-stencil`,format:t,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(t,r){if(this.handle===null)return this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;t===void 0&&(t=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight);for(const s of this.colorAttachments)s.texture.resize({width:t,height:r});return this.depthStencilAttachment&&this.depthStencilAttachment.texture.resize({width:t,height:r}),this}_attachOne(t,r){if(Array.isArray(r)){const[s,i=0,o=0]=r;return this._attachTexture(t,s,i,o),s}if(r instanceof zs)return this._attachTexture(t,r,0,0),r;if(r instanceof Ml){const s=r;return this._attachTexture(t,s.texture,s.props.baseMipLevel,s.props.baseArrayLayer),r.texture}throw new Error("attach")}_attachTexture(t,r,s,i){const{gl:o}=this.device;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:o.framebufferTextureLayer(36160,t,r.target,i,s);break;case 34067:const a=LV(s);o.framebufferTexture2D(36160,t,a,r.handle,i);break;case 3553:o.framebufferTexture2D(36160,t,3553,r.handle,i);break;default:Ht(!1,"Illegal texture type")}o.bindTexture(r.target,null)}}function LV(n){return n<34069?n+34069:n}function FV(n){switch(n){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${n}`}}class BV extends i1{constructor(t,r){super(r);E(this,"device");E(this,"presentationSize");E(this,"_framebuffer",null);this.device=t,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new Iu(this.device,{handle:null}),this._framebuffer}update(){const t=this.getPixelSize();(t[0]!==this.presentationSize[0]||t[1]!==this.presentationSize[1])&&(this.presentationSize=t,this.resize())}resize(t){if(this.device.gl&&this.canvas){const r=this.getDevicePixelRatio(t==null?void 0:t.useDevicePixels);this.setDevicePixelRatio(r,t);return}}commit(){}}const UV={spector:Re.get("spector")||Re.get("spectorjs")},VV="https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",zV=1;let Ft=null,oT=!1;async function $V(n){if(!globalThis.SPECTOR)try{await rA(VV)}catch(e){Re.warn(String(e))}}function jV(n){if(n={...UV,...n},!(n!=null&&n.spector)||(!Ft&&globalThis.SPECTOR&&(Re.probe(zV,"SPECTOR found and initialized")(),Ft=new globalThis.SPECTOR.Spector,globalThis.luma&&(globalThis.luma.spector=Ft)),!Ft))return null;if(oT||(oT=!0,Ft.spyCanvases(),Ft==null||Ft.onCaptureStarted.add(e=>Re.info("Spector capture started:",e)()),Ft==null||Ft.onCapture.add(e=>{Re.info("Spector capture complete:",e)(),Ft==null||Ft.getResultUI(),Ft==null||Ft.resultView.display(),Ft==null||Ft.resultView.addCapture(e)})),n!=null&&n.canvas){if(typeof n.spector=="string"&&n.spector!==n.canvas.id)return Ft;Ft==null||Ft.startCapture(n==null?void 0:n.canvas,500),new Promise(e=>setTimeout(e,2e3)).then(e=>{Re.info("Spector capture stopped after 2 seconds")(),Ft==null||Ft.stopCapture()})}return Ft}const WV="https://unpkg.com/webgl-debug@2.0.1/index.js";function JA(n){return n.luma=n.luma||{},n.luma}async function HV(){Mo()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await rA(WV))}function XV(n,e={}){return n?e.debug?qV(n,e):YV(n):null}function YV(n){const e=JA(n);return e.realContext?e.realContext:n}function qV(n,e){if(!globalThis.WebGLDebugUtils)return Re.warn("webgl-debug not loaded")(),n;const t=JA(n);if(t.debugContext)return t.debugContext;globalThis.WebGLDebugUtils.init({...gt,...n});const r=globalThis.WebGLDebugUtils.makeDebugContext(n,KV.bind(null,e),ZV.bind(null,e));for(const o in gt)!(o in r)&&typeof gt[o]=="number"&&(r[o]=gt[o]);class s{}Object.setPrototypeOf(r,Object.getPrototypeOf(n)),Object.setPrototypeOf(s,r);const i=Object.create(s);return t.realContext=n,t.debugContext=i,i.debug=!0,i}function av(n,e){e=Array.from(e).map(r=>r===void 0?"undefined":r);let t=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,e);return t=`${t.slice(0,100)}${t.length>100?"...":""}`,`gl.${n}(${t})`}function KV(n,e,t,r){r=Array.from(r).map(a=>a===void 0?"undefined":a);const s=globalThis.WebGLDebugUtils.glEnumToString(e),i=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,r),o=`${s} in gl.${t}(${i})`;Re.error(o)();debugger;if(n.throwOnError)throw new Error(o)}function ZV(n,e,t){let r="";if(Re.level>=1&&(r=av(e,t),Re.log(1,r)()),n.break&&n.break.length>0&&(r=r||av(e,t),n.break.every(i=>r.indexOf(i)!==-1)))debugger;for(const s of t)if(s===void 0){if(r=r||av(e,t),n.throwOnError)throw new Error(`Undefined argument: ${r}`);Re.error(`Undefined argument: ${r}`)();debugger}}function QV(n){const e=n.split(/\r?\n/),t=[];for(const r of e){if(r.length<=1)continue;const s=r.split(":");if(s.length===2){const[p,m]=s;t.push({message:m.trim(),type:aT(p),lineNum:0,linePos:0});continue}const[i,o,a,...u]=s;let f=parseInt(a,10);isNaN(f)&&(f=0);let d=parseInt(o,10);isNaN(d)&&(d=0),t.push({message:u.join(":").trim(),type:aT(i),lineNum:f,linePos:d})}return t}function aT(n){const e=["warning","error","info"],t=n.toLowerCase();return e.includes(t)?t:"info"}class GV extends qh{constructor(t,r){super(t,r);E(this,"device");E(this,"handle");switch(this.device=t,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const t=this.device.gl.getShaderInfoLog(this.handle);return QV(t)}getTranslatedSource(){const r=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return r==null?void 0:r.getTranslatedShaderSource(this.handle)}async _compile(t){t=(i=>i.startsWith("#version ")?i:`#version 100
${i}`)(t);const{gl:s}=this.device;if(s.shaderSource(this.handle,t),s.compileShader(this.handle),Re.level===0){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}Re.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),Re.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const t=async i=>await new Promise(o=>setTimeout(o,i));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}const{gl:s}=this.device;for(;;){if(s.getShaderParameter(this.handle,37297))return;await t(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}const JV=256,ez=1024,tz=16384,lv=6144,nz=[1,2,4,8];class rz extends vy{constructor(t,r){super(t,r);E(this,"device");E(this,"glParameters");this.device=t,og(this.device.gl),this.setParameters(this.props.parameters),this.clear()}end(){qu(this.device.gl)}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}setParameters(t={}){const r={...this.glParameters};this.props.framebuffer&&(r.framebuffer=this.props.framebuffer),this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,t.viewport&&(t.viewport.length>=6?(r.viewport=t.viewport.slice(0,4),r.depthRange=[t.viewport[4],t.viewport[5]]):r.viewport=t.viewport),t.scissorRect&&(r.scissorTest=!0,r.scissor=t.scissorRect),t.blendConstant&&(r.blendColor=t.blendConstant),t.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=t.stencilReference),t.colorMask&&(r.colorMask=nz.map(s=>!!(s&t.colorMask))),this.glParameters=r,hc(this.device.gl,r)}beginOcclusionQuery(t){const r=this.props.occlusionQuerySet;r==null||r.beginOcclusionQuery()}endOcclusionQuery(){const t=this.props.occlusionQuerySet;t==null||t.endOcclusionQuery()}clear(){const t={...this.glParameters};let r=0;this.props.clearColor!==!1&&(r|=tz,t.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=JV,t.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=ez,t.clearStencil=this.props.clearStencil),r!==0&&go(this.device.gl,t,()=>{this.device.gl.clear(r)})}clearColorBuffer(t=0,r=[0,0,0,0]){go(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int32Array:this.device.gl.clearBufferiv(lv,t,r);break;case Uint32Array:this.device.gl.clearBufferuiv(lv,t,r);break;case Float32Array:default:this.device.gl.clearBufferfv(lv,t,r);break}})}}const sz="Failed to deduce GL constant from typed array";function iz(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(sz)}}function Dy(n,e){const{clamped:t=!0}=e||{};switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}const oz={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},az={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ku{constructor(...e){E(this,"offset");E(this,"stride");E(this,"type");E(this,"size");E(this,"divisor");E(this,"normalized");E(this,"integer");E(this,"buffer");E(this,"index");e.forEach(t=>this._assign(t)),Object.freeze(this)}static getBytesPerElement(e){return Dy(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Ht(e.size),Dy(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new ku(oz,...e)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ku.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ku.getBytesPerVertex(this)}_assign(e={}){return e=F7("Accessor",e,az),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalize!==void 0&&(this.normalized=e.normalize),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this.offset===void 0&&delete this.offset,this.stride===void 0&&delete this.stride,this.type===void 0&&delete this.type,this.size===void 0&&delete this.size,this.divisor===void 0&&delete this.divisor,this.normalized===void 0&&delete this.normalized,this.integer===void 0&&delete this.integer,this.buffer===void 0&&delete this.buffer,this.index===void 0&&delete this.index,this}}function lz(n){return cz.includes(n)}const cz=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],eC={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function tC(n){const e=eC[n];if(!e)throw new Error("uniform");const[t,r,,s]=e;return{format:s,components:r,glType:t}}function uz(n){const e=eC[n];if(!e)throw new Error("attribute");const[,t,,r,s]=e;return{attributeType:r,vertexFormat:s,components:t}}function fz(n,e){const t={attributes:[],bindings:[]};t.attributes=dz(n,e);const r=gz(n,e);for(const a of r){const u=a.uniforms.map(f=>({name:f.name,format:f.format,byteOffset:f.byteOffset,byteStride:f.byteStride,arrayLength:f.arrayLength}));t.bindings.push({type:"uniform",name:a.name,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:u})}const s=pz(n,e);let i=0;for(const a of s)if(lz(a.type)){const{viewDimension:u,sampleType:f}=vz(a.type);t.bindings.push({type:"texture",name:a.name,location:i,viewDimension:u,sampleType:f}),a.textureUnit=i,i+=1}s.length&&(t.uniforms=s);const o=hz(n,e);return o!=null&&o.length&&(t.varyings=o),t}function dz(n,e){const t=[],r=n.getProgramParameter(e,35721);for(let s=0;s<r;s++){const i=n.getActiveAttrib(e,s);if(!i)throw new Error("activeInfo");const{name:o,type:a}=i,u=n.getAttribLocation(e,o);if(u>=0){const{attributeType:f}=uz(a),d=/instance/i.test(o)?"instance":"vertex";t.push({name:o,location:u,stepMode:d,type:f})}}return t.sort((s,i)=>s.location-i.location),t}function hz(n,e){const t=[],r=n.getProgramParameter(e,35971);for(let s=0;s<r;s++){const i=n.getTransformFeedbackVarying(e,s);if(!i)throw new Error("activeInfo");const{name:o,type:a,size:u}=i,{glType:f,components:d}=tC(a),p=new ku({type:f,size:u*d}),m={location:s,name:o,accessor:p};t.push(m)}return t.sort((s,i)=>s.location-i.location),t}function pz(n,e){const t=[],r=n.getProgramParameter(e,35718);for(let s=0;s<r;s++){const i=n.getActiveUniform(e,s);if(!i)throw new Error("activeInfo");const{name:o,size:a,type:u}=i,{name:f,isArray:d}=yz(o);let p=n.getUniformLocation(e,f);const m={location:p,name:f,size:a,type:u,isArray:d};if(t.push(m),m.size>1)for(let v=0;v<m.size;v++){const x=`${f}[${v}]`;p=n.getUniformLocation(e,x);const b={...m,name:x,location:p};t.push(b)}}return t}function gz(n,e){const t=(i,o)=>n.getActiveUniformBlockParameter(e,i,o),r=[],s=n.getProgramParameter(e,35382);for(let i=0;i<s;i++){const o={name:n.getActiveUniformBlockName(e,i)||"",location:t(i,35391),byteLength:t(i,35392),vertex:t(i,35396),fragment:t(i,35398),uniformCount:t(i,35394),uniforms:[]},a=t(i,35395)||[],u=n.getActiveUniforms(e,a,35383),f=n.getActiveUniforms(e,a,35384),d=n.getActiveUniforms(e,a,35387),p=n.getActiveUniforms(e,a,35388);for(let m=0;m<o.uniformCount;++m){const v=n.getActiveUniform(e,a[m]);if(!v)throw new Error("activeInfo");o.uniforms.push({name:v.name,format:tC(u[m]).format,type:u[m],arrayLength:f[m],byteOffset:d[m],byteStride:p[m]})}r.push(o)}return r.sort((i,o)=>i.location-o.location),r}const mz={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function vz(n){const e=mz[n];if(!e)throw new Error("sampler");const[t,r]=e;return{viewDimension:t,sampleType:r}}function yz(n){if(n[n.length-1]!=="]")return{name:n,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(n);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]?1:0,isArray:!!t[2]}}function _z(n,e,t,r){const s=n;let i=r;i===!0&&(i=1),i===!1&&(i=0);const o=typeof i=="number"?[i]:i;switch(t){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof r!="number")throw new Error("samplers must be set to integers");return n.uniform1i(e,r);case 5126:return n.uniform1fv(e,o);case 35664:return n.uniform2fv(e,o);case 35665:return n.uniform3fv(e,o);case 35666:return n.uniform4fv(e,o);case 5124:return n.uniform1iv(e,o);case 35667:return n.uniform2iv(e,o);case 35668:return n.uniform3iv(e,o);case 35669:return n.uniform4iv(e,o);case 35670:return n.uniform1iv(e,o);case 35671:return n.uniform2iv(e,o);case 35672:return n.uniform3iv(e,o);case 35673:return n.uniform4iv(e,o);case 5125:return s.uniform1uiv(e,o,1);case 36294:return s.uniform2uiv(e,o,2);case 36295:return s.uniform3uiv(e,o,3);case 36296:return s.uniform4uiv(e,o,4);case 35674:return n.uniformMatrix2fv(e,!1,o);case 35675:return n.uniformMatrix3fv(e,!1,o);case 35676:return n.uniformMatrix4fv(e,!1,o);case 35685:return s.uniformMatrix2x3fv(e,!1,o);case 35686:return s.uniformMatrix2x4fv(e,!1,o);case 35687:return s.uniformMatrix3x2fv(e,!1,o);case 35688:return s.uniformMatrix3x4fv(e,!1,o);case 35689:return s.uniformMatrix4x2fv(e,!1,o);case 35690:return s.uniformMatrix4x3fv(e,!1,o)}throw new Error("Illegal uniform")}function xz(n){switch(n){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"line-loop-webgl":return 2;case"triangle-list":return 4;case"triangle-strip":return 5;case"triangle-fan-webgl":return 6;default:throw new Error(n)}}function bz(n){switch(n){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"line-loop-webgl":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;case"triangle-fan-webgl":return 4;default:throw new Error(n)}}const lT=4;class wz extends ec{constructor(t,r){super(t,r);E(this,"device");E(this,"handle");E(this,"vs");E(this,"fs");E(this,"introspectedLayout");E(this,"uniforms",{});E(this,"bindings",{});E(this,"varyings",null);E(this,"_uniformCount",0);E(this,"_uniformSetters",{});this.device=t,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;const{varyings:s,bufferMode:i=35981}=r;switch(s&&s.length>0&&(this.varyings=s,this.device.gl.transformFeedbackVaryings(this.handle,s,i)),this._linkShaders(),Re.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=fz(this.device.gl,this.handle),Re.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=S7(this.introspectedLayout,r.shaderLayout),this.props.topology){case"triangle-fan-webgl":case"line-loop-webgl":Re.warn(`Primitive topology ${this.props.topology} is deprecated and will be removed in v9.1`);break}}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(t,r){for(const[s,i]of Object.entries(t)){const o=this.shaderLayout.bindings.find(a=>a.name===s)||this.shaderLayout.bindings.find(a=>a.name===`${s}Uniforms`);if(!o){const a=this.shaderLayout.bindings.map(u=>`"${u.name}"`).join(", ");r!=null&&r.disableWarnings||Re.warn(`Unknown binding "${s}" in render pipeline "${this.id}", expected one of ${a}`)();continue}switch(i||Re.warn(`Unsetting binding "${s}" in render pipeline "${this.id}"`)(),o.type){case"uniform":if(!(i instanceof xo)&&!(i.buffer instanceof xo))throw new Error("buffer value");break;case"texture":if(!(i instanceof Ml||i instanceof zs||i instanceof Iu))throw new Error("texture value");break;case"sampler":Re.warn(`Ignoring sampler ${s}`)();break;default:throw new Error(o.type)}this.bindings[s]=i}}draw(t){var w;const{renderPass:r,parameters:s=this.props.parameters,topology:i=this.props.topology,vertexArray:o,vertexCount:a,instanceCount:u,isInstanced:f=!1,firstVertex:d=0,transformFeedback:p}=t,m=xz(i),v=!!o.indexBuffer,x=(w=o.indexBuffer)==null?void 0:w.glIndexType;if(this.linkStatus!=="success")return Re.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable()||a===0)return Re.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;if(a===0)return Re.info(2,`RenderPipeline:${this.id}.draw() aborted - no vertices to draw`)(),!0;this.device.gl.useProgram(this.handle),o.bindBeforeRender(r),p&&p.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const b=r;return AV(this.device,s,b.glParameters,()=>{v&&f?this.device.gl.drawElementsInstanced(m,a||0,x,d,u||0):v?this.device.gl.drawElements(m,a||0,x,d):f?this.device.gl.drawArraysInstanced(m,d,a||0,u||0):this.device.gl.drawArrays(m,d,a||0),p&&p.end()}),o.unbindAfterRender(r),!0}setUniformsWebGL(t){const{bindings:r}=o1(t);Object.keys(r).forEach(s=>{Re.warn(`Unsupported value "${JSON.stringify(r[s])}" used in setUniforms() for key ${s}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,t)}async _linkShaders(){const{gl:t}=this.device;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),Re.time(lT,`linkProgram for ${this.id}`)(),t.linkProgram(this.handle),Re.timeEnd(lT,`linkProgram for ${this.id}`)(),Re.level,!this.device.features.has("compilation-status-async-webgl")){const s=this._getLinkStatus();this._reportLinkStatus(s);return}Re.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),Re.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}_reportLinkStatus(t){var r;switch(t){case"success":return;default:throw this.vs.compilationStatus==="error"?(this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`)):((r=this.fs)==null?void 0:r.compilationStatus)==="error"?(this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`)):new Error(`Error during ${t}: ${this.device.gl.getProgramInfoLog(this.handle)}`)}}_getLinkStatus(){const{gl:t}=this.device;return t.getProgramParameter(this.handle,35714)?(t.validateProgram(this.handle),t.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const t=async i=>await new Promise(o=>setTimeout(o,i));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}const{gl:s}=this.device;for(;;){if(s.getProgramParameter(this.handle,37297))return;await t(10)}}_areTexturesRenderable(){let t=!0;for(const[,r]of Object.entries(this.bindings))r instanceof zs&&(r.update(),t=t&&r.loaded);return t}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:t}=this.device;t.useProgram(this.handle);let r=0,s=0;for(const i of this.shaderLayout.bindings){const o=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,"")];if(!o)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case"uniform":const{name:a}=i,u=t.getUniformBlockIndex(this.handle,a);if(u===4294967295)throw new Error(`Invalid uniform block name ${a}`);t.uniformBlockBinding(this.handle,s,u),o instanceof xo?t.bindBufferBase(35345,s,o.handle):t.bindBufferRange(35345,s,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),s+=1;break;case"texture":if(!(o instanceof Ml||o instanceof zs||o instanceof Iu))throw new Error("texture");let f;if(o instanceof Ml)f=o.texture;else if(o instanceof zs)f=o;else if(o instanceof Iu&&o.colorAttachments[0]instanceof Ml)Re.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),f=o.colorAttachments[0].texture;else throw new Error("No texture");t.activeTexture(33984+r),t.bindTexture(f.target,f.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(const t of this.shaderLayout.uniforms||[]){const{name:r,location:s,type:i,textureUnit:o}=t,a=this.uniforms[r]??o;a!==void 0&&_z(this.device.gl,s,i,a)}}}class Tz extends _y{constructor(t){super(t,{});E(this,"device");E(this,"commands",[]);this.device=t}submitCommands(t=this.commands){for(const r of t)switch(r.name){case"copy-buffer-to-buffer":Sz(this.device,r.options);break;case"copy-buffer-to-texture":Ez(this.device,r.options);break;case"copy-texture-to-buffer":Az(this.device,r.options);break;case"copy-texture-to-texture":Cz(this.device,r.options);break}}}function Sz(n,e){const t=e.source,r=e.destination;n.gl.bindBuffer(36662,t.handle),n.gl.bindBuffer(36663,r.handle),n.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),n.gl.bindBuffer(36662,null),n.gl.bindBuffer(36663,null)}function Ez(n,e){throw new Error("Not implemented")}function Az(n,e){const{source:t,mipLevel:r=0,aspect:s="all",width:i=e.source.width,height:o=e.source.height,depthOrArrayLayers:a=0,origin:u=[0,0],destination:f,byteOffset:d=0,bytesPerRow:p,rowsPerImage:m}=e;if(s!=="all")throw new Error("not supported");if(r!==0||a!==0||p||m)throw new Error("not implemented");const{framebuffer:v,destroyFramebuffer:x}=nC(t);let b;try{const w=f,S=i||v.width,R=o||v.height,C=op(v.texture.props.format),O=C.dataFormat,I=C.type;n.gl.bindBuffer(35051,w.handle),b=n.gl.bindFramebuffer(36160,v.handle),n.gl.readPixels(u[0],u[1],S,R,O,I,d)}finally{n.gl.bindBuffer(35051,null),b!==void 0&&n.gl.bindFramebuffer(36160,b),x&&v.destroy()}}function Cz(n,e){const{source:t,destinationMipLevel:r=0,origin:s=[0,0],destinationOrigin:i=[0,0],destination:o}=e;let{width:a=e.destination.width,height:u=e.destination.height}=e;const{framebuffer:f,destroyFramebuffer:d}=nC(t),[p,m]=s,[v,x,b]=i,w=n.gl.bindFramebuffer(36160,f.handle);let S=null,R;if(o instanceof zs)S=o,a=Number.isFinite(a)?a:S.width,u=Number.isFinite(u)?u:S.height,S.bind(0),R=S.target;else throw new Error("invalid destination");switch(R){case 3553:case 34067:n.gl.copyTexSubImage2D(R,r,v,x,p,m,a,u);break;case 35866:case 32879:n.gl.copyTexSubImage3D(R,r,v,x,b,p,m,a,u);break}S&&S.unbind(),n.gl.bindFramebuffer(36160,w),d&&f.destroy()}function nC(n){if(n instanceof Zr){const{width:e,height:t,id:r}=n;return{framebuffer:n.device.createFramebuffer({id:`framebuffer-for-${r}`,width:e,height:t,colorAttachments:[n]}),destroyFramebuffer:!0}}return{framebuffer:n,destroyFramebuffer:!1}}class Rz extends yy{constructor(t,r){super(t,r);E(this,"device");E(this,"commandBuffer");this.device=t,this.commandBuffer=new Tz(t)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(t){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:t})}copyBufferToTexture(t){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:t})}copyTextureToBuffer(t){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:t})}copyTextureToTexture(t){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:t})}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}resolveQuerySet(t,r,s){}}class w1 extends xy{constructor(t,r){super(t,r);E(this,"device");E(this,"handle");E(this,"buffer",null);E(this,"bufferValue",null);this.device=t,this.handle=this.device.gl.createVertexArray()}get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(t){return L8()==="Chrome"}destroy(){var t;super.destroy(),this.buffer&&((t=this.buffer)==null||t.destroy()),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(t){const r=t;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(t,r){const s=r;if(s.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:i,type:o,stride:a,offset:u,normalized:f,integer:d,divisor:p}=this._getAccessor(t);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,s.handle),d?this.device.gl.vertexAttribIPointer(t,i,o,a,u):this.device.gl.vertexAttribPointer(t,i,o,f,a,u),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(t),this.device.gl.vertexAttribDivisor(t,p||0),this.attributes[t]=s,this.device.gl.bindVertexArray(null)}setConstantWebGL(t,r){this._enable(t,!1),this.attributes[t]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let t=0;t<this.maxVertexAttributes;++t){const r=this.attributes[t];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(t,r)}}_getAccessor(t){const r=this.attributeInfos[t];if(!r)throw new Error(`Unknown attribute location ${t}`);const s=KA(r.bufferDataType);return{size:r.bufferComponents,type:s,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(t,r=!0){const i=w1.isConstantAttributeZeroSupported(this.device)||t!==0;(r||i)&&(t=Number(t),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(t):this.device.gl.disableVertexAttribArray(t),this.device.gl.bindVertexArray(null))}getConstantBuffer(t,r){const s=Pz(r),i=s.byteLength*t,o=s.length*t;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let a=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),a=a||!Iz(s,this.bufferValue),a){const u=R7(r.constructor,o);P7({target:u,source:s,start:0,count:o}),this.buffer.write(u),this.bufferValue=r}return this.buffer}}function Pz(n){return Array.isArray(n)?new Float32Array(n):n}function Iz(n,e){if(!n||!e||n.length!==e.length||n.constructor!==e.constructor)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}class kz extends by{constructor(t,r){super(t,r);E(this,"device");E(this,"gl");E(this,"handle");E(this,"layout");E(this,"buffers",{});E(this,"unusedBuffers",{});E(this,"bindOnUse",!0);E(this,"_bound",!1);this.device=t,this.gl=t.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(t="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(bz(t))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(t){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in t)this.setBuffer(r,t[r])})}setBuffer(t,r){const s=this._getVaryingIndex(t),{buffer:i,byteLength:o,byteOffset:a}=this._getBufferRange(r);if(s<0){this.unusedBuffers[t]=i,Re.warn(`${this.id} unusedBuffers varying buffer ${t}`)();return}this.buffers[s]={buffer:i,byteLength:o,byteOffset:a},this.bindOnUse||this._bindBuffer(s,i,a,o)}getBuffer(t){if(cT(t))return this.buffers[t]||null;const r=this._getVaryingIndex(t);return r>=0?this.buffers[r]:null}bind(t=this.handle){if(typeof t!="function")return this.gl.bindTransformFeedback(36386,t),this;let r;return this._bound?r=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(t){if(t instanceof xo)return{buffer:t,byteOffset:0,byteLength:t.byteLength};const{buffer:r,byteOffset:s=0,byteLength:i=t.buffer.byteLength}=t;return{buffer:r,byteOffset:s,byteLength:i}}_getVaryingIndex(t){if(cT(t))return Number(t);for(const r of this.layout.varyings)if(t===r.name)return r.location;return-1}_bindBuffers(){for(const t in this.buffers){const{buffer:r,byteLength:s,byteOffset:i}=this._getBufferRange(this.buffers[t]);this._bindBuffer(Number(t),r,i,s)}}_unbindBuffers(){for(const t in this.buffers)this.gl.bindBufferBase(35982,Number(t),null)}_bindBuffer(t,r,s=0,i){const o=r&&r.handle;!o||i===void 0?this.gl.bindBufferBase(35982,t,o):this.gl.bindBufferRange(35982,t,o,s,i)}}function cT(n){return typeof n=="number"?Number.isInteger(n):/^\d+$/.test(n)}class Mz extends wy{constructor(t,r){super(t,r);E(this,"device");E(this,"handle");E(this,"target",null);E(this,"_queryPending",!1);E(this,"_pollingPromise",null);if(this.device=t,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}get[Symbol.toStringTag](){return"Query"}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(t){return this._begin(t!=null&&t.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(t){this._queryPending||(this.target=t,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const t=this.device.gl.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((s,i)=>{const o=()=>{this.isResultAvailable()?(s(this.getResult()),this._pollingPromise=null):r++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}}function rC(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Ht(!1),0}}function Oz(n){switch(n){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Ht(!1),0}}function Nz(n,e){var w,S;const{sourceX:t=0,sourceY:r=0,sourceFormat:s=6408,sourceAttachment:i=36064}=e||{};let{target:o=null,sourceWidth:a,sourceHeight:u,sourceType:f}=e||{};const{framebuffer:d,deleteFramebuffer:p}=sC(n);Ht(d);const{gl:m,handle:v}=d;a=a||d.width,u=u||d.height;const x=i-36064;f=f||((S=(w=d.colorAttachments[x])==null?void 0:w.texture)==null?void 0:S.type)||5121,o=Fz(o,f,s,a,u),f=f||iz(o);const b=m.bindFramebuffer(36160,v);return m.readPixels(t,r,a,u,s,f,o),m.bindFramebuffer(36160,b||null),p&&d.destroy(),o}function Dz(n,e){const{target:t,sourceX:r=0,sourceY:s=0,sourceFormat:i=6408,targetByteOffset:o=0}=e||{};let{sourceWidth:a,sourceHeight:u,sourceType:f}=e||{};const{framebuffer:d,deleteFramebuffer:p}=sC(n);Ht(d),a=a||d.width,u=u||d.height;const m=d;f=f||5121;let v=t;if(!v){const b=rC(i),w=Oz(f),S=o+a*u*b*w;v=m.device.createBuffer({byteLength:S})}const x=n.device.createCommandEncoder();return x.copyTextureToBuffer({source:n,width:a,height:u,origin:[r,s],destination:v,byteOffset:o}),x.destroy(),p&&d.destroy(),v}function sC(n){return n instanceof Zh?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:Lz(n),deleteFramebuffer:!0}}function Lz(n,e){const{device:t,width:r,height:s,id:i}=n;return t.createFramebuffer({...e,id:`framebuffer-for-${i}`,width:r,height:s,colorAttachments:[n]})}function Fz(n,e,t,r,s){if(n)return n;e=e||5121;const i=Dy(e,{clamped:!1}),o=rC(t);return new i(r*s*o)}const Bz=256,Uz=1024,Vz=16384,zz="clear: bad arguments";function $z(n,e){const{framebuffer:t=null,color:r=null,depth:s=null,stencil:i=null}=e||{},o={};t&&(o.framebuffer=t);let a=0;r&&(a|=Vz,r!==!0&&(o.clearColor=r)),s&&(a|=Bz,s!==!0&&(o.clearDepth=s)),i&&(a|=Uz,s!==!0&&(o.clearStencil=s)),Ht(a!==0,zz);const u=n.gl;go(u,o,()=>{u.clear(a)})}const ru=1,ra=class ra extends Jl{constructor(t){var f,d;super({...t,id:t.id||Da("webgl-device")});E(this,"type","webgl");E(this,"handle");E(this,"features");E(this,"limits");E(this,"info");E(this,"canvasContext");E(this,"lost");E(this,"_resolveContextLost");E(this,"renderPass",null);E(this,"gl");E(this,"debug",!1);E(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});E(this,"_extensions",{});E(this,"_polyfilled",!1);E(this,"spectorJS");E(this,"_constants");const r=(f=t.gl)==null?void 0:f.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);const s=((d=t.gl)==null?void 0:d.canvas)||t.canvas,i=!t.gl;this.canvasContext=new BV(this,{...t,autoResize:i,canvas:s}),this.lost=new Promise(p=>{this._resolveContextLost=p});let o=t.gl||null;if(o||(o=rV(this.canvasContext.canvas,{...t,onContextLost:p=>{var m;return(m=this._resolveContextLost)==null?void 0:m.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})}})),!o)throw new Error("WebGL context creation failed");this.handle=o,this.gl=o,this.gl.device=this,this.gl._version=2,t.spector&&(this.spectorJS=jV({...this.props,canvas:this.handle.canvas})),this.info=sV(this.gl,this._extensions),this.limits=new SV(this.gl),this.features=new TV(this.gl,this._extensions,this.props.disabledFeatures),this.props.initalizeFeatures&&this.features.initializeFeatures(),i&&this.canvasContext.resize();const{enable:a=!0,copyState:u=!1}=t;YA(this.gl,{enable:a,copyState:u}),t.debug&&(this.gl=XV(this.gl,{...t,throwOnError:!0}),this.debug=!0,Re.level=Math.max(Re.level,1),Re.warn("WebGL debug mode activated. Performance reduced.")())}static isSupported(){return typeof WebGL2RenderingContext<"u"}static attach(t){if(t instanceof ra)return t;if((t==null?void 0:t.device)instanceof Jl)return t.device;if(!jz(t))throw new Error("Invalid WebGL2RenderingContext");return new ra({gl:t})}static async create(t={}){var a;Re.groupCollapsed(ru,"WebGLDevice created")();const r=[];t.debug&&r.push(HV()),t.spector&&r.push($V()),typeof t.canvas=="string"&&r.push(i1.pageLoaded);const s=await Promise.allSettled(r);for(const u of s)u.status==="rejected"&&Re.error(`Failed to initialize debug libraries ${u.reason}`)();if(Re.probe(ru+1,"DOM is loaded")(),(a=t.gl)!=null&&a.device)return Re.warn("reattaching existing device")(),ra.attach(t.gl);const i=new ra(t),o=`Created ${i.type}${i.debug?" debug":""} context: ${i.info.vendor}, ${i.info.renderer} for canvas: ${i.canvasContext.id}`;return Re.probe(ru,o)(),Re.table(ru,i.info)(),Re.groupEnd(ru)(),i}destroy(){}get isLost(){return this.gl.isContextLost()}getSize(){return[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]}isTextureFormatSupported(t){return b1(this.gl,t,this._extensions)}isTextureFormatFilterable(t){return _V(this.gl,t,this._extensions)}isTextureFormatRenderable(t){return xV(this.gl,t,this._extensions)}createCanvasContext(t){throw new Error("WebGL only supports a single canvas")}createBuffer(t){const r=this._getBufferProps(t);return new xo(this,r)}_createTexture(t){return new zs(this,t)}createExternalTexture(t){throw new Error("createExternalTexture() not implemented")}createSampler(t){return new Ny(this,t)}createShader(t){return new GV(this,t)}createFramebuffer(t){return new Iu(this,t)}createVertexArray(t){return new w1(this,t)}createTransformFeedback(t){return new kz(this,t)}createQuerySet(t){return new Mz(this,t)}createRenderPipeline(t){return new wz(this,t)}beginRenderPass(t){return new rz(this,t)}createComputePipeline(t){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(t){throw new Error("ComputePass not supported in WebGL")}createCommandEncoder(t){return new Rz(this,t)}submit(){var t;(t=this.renderPass)==null||t.end(),this.renderPass=null}readPixelsToArrayWebGL(t,r){return Nz(t,r)}readPixelsToBufferWebGL(t,r){return Dz(t,r)}setParametersWebGL(t){hc(this.gl,t)}getParametersWebGL(t){return XA(this.gl,t)}withParametersWebGL(t,r){return go(this.gl,t,r)}clearWebGL(t){$z(this,t)}resetWebGL(){Re.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),ZU(this.gl)}loseDevice(){var i;let t=!1;const s=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return s&&(t=!0,s.loseContext()),(i=this._resolveContextLost)==null||i.call(this,{reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){og(this.gl)}popState(){qu(this.gl)}setSpectorMetadata(t,r){t.__SPECTOR_Metadata=r}getGLKey(t,r){r=r||this.gl2||this.gl;const s=Number(t);for(const i in r)if(r[i]===s)return`GL.${i}`;return String(t)}setConstantAttributeWebGL(t,r){const s=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(s).fill(null);const i=this._constants[t];switch(i&&Yz(i,r)&&Re.info(1,`setConstantAttributeWebGL(${t}) could have been skipped, value unchanged`)(),this._constants[t]=r,r.constructor){case Float32Array:Wz(this,t,r);break;case Int32Array:Hz(this,t,r);break;case Uint32Array:Xz(this,t,r);break;default:Ht(!1)}}getExtension(t){return Co(this.gl,t,this._extensions),this._extensions}};E(ra,"type","webgl");let Mu=ra;function jz(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext?!0:!!(n&&Number.isFinite(n._version))}function Wz(n,e,t){switch(t.length){case 1:n.gl.vertexAttrib1fv(e,t);break;case 2:n.gl.vertexAttrib2fv(e,t);break;case 3:n.gl.vertexAttrib3fv(e,t);break;case 4:n.gl.vertexAttrib4fv(e,t);break;default:Ht(!1)}}function Hz(n,e,t){n.gl.vertexAttribI4iv(e,t)}function Xz(n,e,t){n.gl.vertexAttribI4uiv(e,t)}function Yz(n,e){if(!n||!e||n.length!==e.length||n.constructor!==e.constructor)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}var cv={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */var uT;function qz(){return uT||(uT=1,function(n){(function(e,t,r,s){var i=["","webkit","Moz","MS","ms","o"],o=t.createElement("div"),a="function",u=Math.round,f=Math.abs,d=Date.now;function p(P,k,j){return setTimeout(C(P,j),k)}function m(P,k,j){return Array.isArray(P)?(v(P,j[k],j),!0):!1}function v(P,k,j){var fe;if(P)if(P.forEach)P.forEach(k,j);else if(P.length!==s)for(fe=0;fe<P.length;)k.call(j,P[fe],fe,P),fe++;else for(fe in P)P.hasOwnProperty(fe)&&k.call(j,P[fe],fe,P)}function x(P,k,j){var fe="DEPRECATED METHOD: "+k+`
`+j+` AT 
`;return function(){var xe=new Error("get-stack-trace"),Ne=xe&&xe.stack?xe.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",lt=e.console&&(e.console.warn||e.console.log);return lt&&lt.call(e.console,fe,Ne),P.apply(this,arguments)}}var b;typeof Object.assign!="function"?b=function(k){if(k===s||k===null)throw new TypeError("Cannot convert undefined or null to object");for(var j=Object(k),fe=1;fe<arguments.length;fe++){var xe=arguments[fe];if(xe!==s&&xe!==null)for(var Ne in xe)xe.hasOwnProperty(Ne)&&(j[Ne]=xe[Ne])}return j}:b=Object.assign;var w=x(function(k,j,fe){for(var xe=Object.keys(j),Ne=0;Ne<xe.length;)(!fe||fe&&k[xe[Ne]]===s)&&(k[xe[Ne]]=j[xe[Ne]]),Ne++;return k},"extend","Use `assign`."),S=x(function(k,j){return w(k,j,!0)},"merge","Use `assign`.");function R(P,k,j){var fe=k.prototype,xe;xe=P.prototype=Object.create(fe),xe.constructor=P,xe._super=fe,j&&b(xe,j)}function C(P,k){return function(){return P.apply(k,arguments)}}function O(P,k){return typeof P==a?P.apply(k&&k[0]||s,k):P}function I(P,k){return P===s?k:P}function F(P,k,j){v(le(k),function(fe){P.addEventListener(fe,j,!1)})}function $(P,k,j){v(le(k),function(fe){P.removeEventListener(fe,j,!1)})}function q(P,k){for(;P;){if(P==k)return!0;P=P.parentNode}return!1}function K(P,k){return P.indexOf(k)>-1}function le(P){return P.trim().split(/\s+/g)}function he(P,k,j){if(P.indexOf&&!j)return P.indexOf(k);for(var fe=0;fe<P.length;){if(j&&P[fe][j]==k||!j&&P[fe]===k)return fe;fe++}return-1}function pe(P){return Array.prototype.slice.call(P,0)}function se(P,k,j){for(var fe=[],xe=[],Ne=0;Ne<P.length;){var lt=P[Ne][k];he(xe,lt)<0&&fe.push(P[Ne]),xe[Ne]=lt,Ne++}return fe=fe.sort(function(hn,gn){return hn[k]>gn[k]}),fe}function ye(P,k){for(var j,fe,xe=k[0].toUpperCase()+k.slice(1),Ne=0;Ne<i.length;){if(j=i[Ne],fe=j?j+xe:k,fe in P)return fe;Ne++}return s}var Me=1;function U(){return Me++}function H(P){var k=P.ownerDocument||P;return k.defaultView||k.parentWindow||e}var D=/mobile|tablet|ip(ad|hone|od)|android/i,Y="ontouchstart"in e,M=ye(e,"PointerEvent")!==s,T=Y&&D.test(navigator.userAgent),N="touch",W="pen",Z="mouse",te="kinect",re=25,ue=1,ve=2,be=4,Pe=8,Ue=1,Ke=2,nt=4,Ge=8,He=16,Ie=Ke|nt,ct=Ge|He,xn=Ie|ct,$t=["x","y"],Ot=["clientX","clientY"];function ht(P,k){var j=this;this.manager=P,this.callback=k,this.element=P.element,this.target=P.options.inputTarget,this.domHandler=function(fe){O(P.options.enable,[P])&&j.handler(fe)},this.init()}ht.prototype={handler:function(){},init:function(){this.evEl&&F(this.element,this.evEl,this.domHandler),this.evTarget&&F(this.target,this.evTarget,this.domHandler),this.evWin&&F(H(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&$(this.element,this.evEl,this.domHandler),this.evTarget&&$(this.target,this.evTarget,this.domHandler),this.evWin&&$(H(this.element),this.evWin,this.domHandler)}};function at(P){var k,j=P.options.inputClass;return j?k=j:M?k=fr:T?k=Xe:Y?k=Tn:k=kn,new k(P,Mt)}function Mt(P,k,j){var fe=j.pointers.length,xe=j.changedPointers.length,Ne=k&ue&&fe-xe===0,lt=k&(be|Pe)&&fe-xe===0;j.isFirst=!!Ne,j.isFinal=!!lt,Ne&&(P.session={}),j.eventType=k,Ut(P,j),P.emit("hammer.input",j),P.recognize(j),P.session.prevInput=j}function Ut(P,k){var j=P.session,fe=k.pointers,xe=fe.length;j.firstInput||(j.firstInput=Ur(k)),xe>1&&!j.firstMultiple?j.firstMultiple=Ur(k):xe===1&&(j.firstMultiple=!1);var Ne=j.firstInput,lt=j.firstMultiple,dn=lt?lt.center:Ne.center,hn=k.center=Qt(fe);k.timeStamp=d(),k.deltaTime=k.timeStamp-Ne.timeStamp,k.angle=Sr(dn,hn),k.distance=Vt(dn,hn),In(j,k),k.offsetDirection=Ln(k.deltaX,k.deltaY);var gn=mt(k.deltaTime,k.deltaX,k.deltaY);k.overallVelocityX=gn.x,k.overallVelocityY=gn.y,k.overallVelocity=f(gn.x)>f(gn.y)?gn.x:gn.y,k.scale=lt?Ai(lt.pointers,fe):1,k.rotation=lt?cr(lt.pointers,fe):0,k.maxPointers=j.prevInput?k.pointers.length>j.prevInput.maxPointers?k.pointers.length:j.prevInput.maxPointers:k.pointers.length,bn(j,k);var Sn=P.element;q(k.srcEvent.target,Sn)&&(Sn=k.srcEvent.target),k.target=Sn}function In(P,k){var j=k.center,fe=P.offsetDelta||{},xe=P.prevDelta||{},Ne=P.prevInput||{};(k.eventType===ue||Ne.eventType===be)&&(xe=P.prevDelta={x:Ne.deltaX||0,y:Ne.deltaY||0},fe=P.offsetDelta={x:j.x,y:j.y}),k.deltaX=xe.x+(j.x-fe.x),k.deltaY=xe.y+(j.y-fe.y)}function bn(P,k){var j=P.lastInterval||k,fe=k.timeStamp-j.timeStamp,xe,Ne,lt,dn;if(k.eventType!=Pe&&(fe>re||j.velocity===s)){var hn=k.deltaX-j.deltaX,gn=k.deltaY-j.deltaY,Sn=mt(fe,hn,gn);Ne=Sn.x,lt=Sn.y,xe=f(Sn.x)>f(Sn.y)?Sn.x:Sn.y,dn=Ln(hn,gn),P.lastInterval=k}else xe=j.velocity,Ne=j.velocityX,lt=j.velocityY,dn=j.direction;k.velocity=xe,k.velocityX=Ne,k.velocityY=lt,k.direction=dn}function Ur(P){for(var k=[],j=0;j<P.pointers.length;)k[j]={clientX:u(P.pointers[j].clientX),clientY:u(P.pointers[j].clientY)},j++;return{timeStamp:d(),pointers:k,center:Qt(k),deltaX:P.deltaX,deltaY:P.deltaY}}function Qt(P){var k=P.length;if(k===1)return{x:u(P[0].clientX),y:u(P[0].clientY)};for(var j=0,fe=0,xe=0;xe<k;)j+=P[xe].clientX,fe+=P[xe].clientY,xe++;return{x:u(j/k),y:u(fe/k)}}function mt(P,k,j){return{x:k/P||0,y:j/P||0}}function Ln(P,k){return P===k?Ue:f(P)>=f(k)?P<0?Ke:nt:k<0?Ge:He}function Vt(P,k,j){j||(j=$t);var fe=k[j[0]]-P[j[0]],xe=k[j[1]]-P[j[1]];return Math.sqrt(fe*fe+xe*xe)}function Sr(P,k,j){j||(j=$t);var fe=k[j[0]]-P[j[0]],xe=k[j[1]]-P[j[1]];return Math.atan2(xe,fe)*180/Math.PI}function cr(P,k){return Sr(k[1],k[0],Ot)+Sr(P[1],P[0],Ot)}function Ai(P,k){return Vt(k[0],k[1],Ot)/Vt(P[0],P[1],Ot)}var Do={mousedown:ue,mousemove:ve,mouseup:be},Ks="mousedown",Qe="mousemove mouseup";function kn(){this.evEl=Ks,this.evWin=Qe,this.pressed=!1,ht.apply(this,arguments)}R(kn,ht,{handler:function(k){var j=Do[k.type];j&ue&&k.button===0&&(this.pressed=!0),j&ve&&k.which!==1&&(j=be),this.pressed&&(j&be&&(this.pressed=!1),this.callback(this.manager,j,{pointers:[k],changedPointers:[k],pointerType:Z,srcEvent:k}))}});var Zs={pointerdown:ue,pointermove:ve,pointerup:be,pointercancel:Pe,pointerout:Pe},is={2:N,3:W,4:Z,5:te},wn="pointerdown",ur="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(wn="MSPointerDown",ur="MSPointerMove MSPointerUp MSPointerCancel");function fr(){this.evEl=wn,this.evWin=ur,ht.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}R(fr,ht,{handler:function(k){var j=this.store,fe=!1,xe=k.type.toLowerCase().replace("ms",""),Ne=Zs[xe],lt=is[k.pointerType]||k.pointerType,dn=lt==N,hn=he(j,k.pointerId,"pointerId");Ne&ue&&(k.button===0||dn)?hn<0&&(j.push(k),hn=j.length-1):Ne&(be|Pe)&&(fe=!0),!(hn<0)&&(j[hn]=k,this.callback(this.manager,Ne,{pointers:j,changedPointers:[k],pointerType:lt,srcEvent:k}),fe&&j.splice(hn,1))}});var Vr={touchstart:ue,touchmove:ve,touchend:be,touchcancel:Pe},Ci="touchstart",Ba="touchstart touchmove touchend touchcancel";function Ri(){this.evTarget=Ci,this.evWin=Ba,this.started=!1,ht.apply(this,arguments)}R(Ri,ht,{handler:function(k){var j=Vr[k.type];if(j===ue&&(this.started=!0),!!this.started){var fe=Lo.call(this,k,j);j&(be|Pe)&&fe[0].length-fe[1].length===0&&(this.started=!1),this.callback(this.manager,j,{pointers:fe[0],changedPointers:fe[1],pointerType:N,srcEvent:k})}}});function Lo(P,k){var j=pe(P.touches),fe=pe(P.changedTouches);return k&(be|Pe)&&(j=se(j.concat(fe),"identifier")),[j,fe]}var Ua={touchstart:ue,touchmove:ve,touchend:be,touchcancel:Pe},ze="touchstart touchmove touchend touchcancel";function Xe(){this.evTarget=ze,this.targetIds={},ht.apply(this,arguments)}R(Xe,ht,{handler:function(k){var j=Ua[k.type],fe=Rt.call(this,k,j);fe&&this.callback(this.manager,j,{pointers:fe[0],changedPointers:fe[1],pointerType:N,srcEvent:k})}});function Rt(P,k){var j=pe(P.touches),fe=this.targetIds;if(k&(ue|ve)&&j.length===1)return fe[j[0].identifier]=!0,[j,j];var xe,Ne,lt=pe(P.changedTouches),dn=[],hn=this.target;if(Ne=j.filter(function(gn){return q(gn.target,hn)}),k===ue)for(xe=0;xe<Ne.length;)fe[Ne[xe].identifier]=!0,xe++;for(xe=0;xe<lt.length;)fe[lt[xe].identifier]&&dn.push(lt[xe]),k&(be|Pe)&&delete fe[lt[xe].identifier],xe++;if(dn.length)return[se(Ne.concat(dn),"identifier"),dn]}var Yt=2500,pt=25;function Tn(){ht.apply(this,arguments);var P=C(this.handler,this);this.touch=new Xe(this.manager,P),this.mouse=new kn(this.manager,P),this.primaryTouch=null,this.lastTouches=[]}R(Tn,ht,{handler:function(k,j,fe){var xe=fe.pointerType==N,Ne=fe.pointerType==Z;if(!(Ne&&fe.sourceCapabilities&&fe.sourceCapabilities.firesTouchEvents)){if(xe)wt.call(this,j,fe);else if(Ne&&Es.call(this,fe))return;this.callback(k,j,fe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function wt(P,k){P&ue?(this.primaryTouch=k.changedPointers[0].identifier,Ss.call(this,k)):P&(be|Pe)&&Ss.call(this,k)}function Ss(P){var k=P.changedPointers[0];if(k.identifier===this.primaryTouch){var j={x:k.clientX,y:k.clientY};this.lastTouches.push(j);var fe=this.lastTouches,xe=function(){var Ne=fe.indexOf(j);Ne>-1&&fe.splice(Ne,1)};setTimeout(xe,Yt)}}function Es(P){for(var k=P.srcEvent.clientX,j=P.srcEvent.clientY,fe=0;fe<this.lastTouches.length;fe++){var xe=this.lastTouches[fe],Ne=Math.abs(k-xe.x),lt=Math.abs(j-xe.y);if(Ne<=pt&&lt<=pt)return!0}return!1}var Pi=ye(o.style,"touchAction"),Ii=Pi!==s,zr="compute",Fo="auto",$r="manipulation",tn="none",os="pan-x",As="pan-y",dr=vg();function ki(P,k){this.manager=P,this.set(k)}ki.prototype={set:function(P){P==zr&&(P=this.compute()),Ii&&this.manager.element.style&&dr[P]&&(this.manager.element.style[Pi]=P),this.actions=P.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var P=[];return v(this.manager.recognizers,function(k){O(k.options.enable,[k])&&(P=P.concat(k.getTouchAction()))}),mc(P.join(" "))},preventDefaults:function(P){var k=P.srcEvent,j=P.offsetDirection;if(this.manager.session.prevented){k.preventDefault();return}var fe=this.actions,xe=K(fe,tn)&&!dr[tn],Ne=K(fe,As)&&!dr[As],lt=K(fe,os)&&!dr[os];if(xe){var dn=P.pointers.length===1,hn=P.distance<2,gn=P.deltaTime<250;if(dn&&hn&&gn)return}if(!(lt&&Ne)&&(xe||Ne&&j&Ie||lt&&j&ct))return this.preventSrc(k)},preventSrc:function(P){this.manager.session.prevented=!0,P.preventDefault()}};function mc(P){if(K(P,tn))return tn;var k=K(P,os),j=K(P,As);return k&&j?tn:k||j?k?os:As:K(P,$r)?$r:Fo}function vg(){if(!Ii)return!1;var P={},k=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(j){P[j]=k?e.CSS.supports("touch-action",j):!0}),P}var jt=1,hr=2,Cs=4,as=8,pr=as,Bo=16,Er=32;function gr(P){this.options=b({},this.defaults,P||{}),this.id=U(),this.manager=null,this.options.enable=I(this.options.enable,!0),this.state=jt,this.simultaneous={},this.requireFail=[]}gr.prototype={defaults:{},set:function(P){return b(this.options,P),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(P){if(m(P,"recognizeWith",this))return this;var k=this.simultaneous;return P=jn(P,this),k[P.id]||(k[P.id]=P,P.recognizeWith(this)),this},dropRecognizeWith:function(P){return m(P,"dropRecognizeWith",this)?this:(P=jn(P,this),delete this.simultaneous[P.id],this)},requireFailure:function(P){if(m(P,"requireFailure",this))return this;var k=this.requireFail;return P=jn(P,this),he(k,P)===-1&&(k.push(P),P.requireFailure(this)),this},dropRequireFailure:function(P){if(m(P,"dropRequireFailure",this))return this;P=jn(P,this);var k=he(this.requireFail,P);return k>-1&&this.requireFail.splice(k,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(P){return!!this.simultaneous[P.id]},emit:function(P){var k=this,j=this.state;function fe(xe){k.manager.emit(xe,P)}j<as&&fe(k.options.event+Ar(j)),fe(k.options.event),P.additionalEvent&&fe(P.additionalEvent),j>=as&&fe(k.options.event+Ar(j))},tryEmit:function(P){if(this.canEmit())return this.emit(P);this.state=Er},canEmit:function(){for(var P=0;P<this.requireFail.length;){if(!(this.requireFail[P].state&(Er|jt)))return!1;P++}return!0},recognize:function(P){var k=b({},P);if(!O(this.options.enable,[this,k])){this.reset(),this.state=Er;return}this.state&(pr|Bo|Er)&&(this.state=jt),this.state=this.process(k),this.state&(hr|Cs|as|Bo)&&this.tryEmit(k)},process:function(P){},getTouchAction:function(){},reset:function(){}};function Ar(P){return P&Bo?"cancel":P&as?"end":P&Cs?"move":P&hr?"start":""}function Df(P){return P==He?"down":P==Ge?"up":P==Ke?"left":P==nt?"right":""}function jn(P,k){var j=k.manager;return j?j.get(P):P}function Cr(){gr.apply(this,arguments)}R(Cr,gr,{defaults:{pointers:1},attrTest:function(P){var k=this.options.pointers;return k===0||P.pointers.length===k},process:function(P){var k=this.state,j=P.eventType,fe=k&(hr|Cs),xe=this.attrTest(P);return fe&&(j&Pe||!xe)?k|Bo:fe||xe?j&be?k|as:k&hr?k|Cs:hr:Er}});function Va(){Cr.apply(this,arguments),this.pX=null,this.pY=null}R(Va,Cr,{defaults:{event:"pan",threshold:10,pointers:1,direction:xn},getTouchAction:function(){var P=this.options.direction,k=[];return P&Ie&&k.push(As),P&ct&&k.push(os),k},directionTest:function(P){var k=this.options,j=!0,fe=P.distance,xe=P.direction,Ne=P.deltaX,lt=P.deltaY;return xe&k.direction||(k.direction&Ie?(xe=Ne===0?Ue:Ne<0?Ke:nt,j=Ne!=this.pX,fe=Math.abs(P.deltaX)):(xe=lt===0?Ue:lt<0?Ge:He,j=lt!=this.pY,fe=Math.abs(P.deltaY))),P.direction=xe,j&&fe>k.threshold&&xe&k.direction},attrTest:function(P){return Cr.prototype.attrTest.call(this,P)&&(this.state&hr||!(this.state&hr)&&this.directionTest(P))},emit:function(P){this.pX=P.deltaX,this.pY=P.deltaY;var k=Df(P.direction);k&&(P.additionalEvent=this.options.event+k),this._super.emit.call(this,P)}});function vc(){Cr.apply(this,arguments)}R(vc,Cr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[tn]},attrTest:function(P){return this._super.attrTest.call(this,P)&&(Math.abs(P.scale-1)>this.options.threshold||this.state&hr)},emit:function(P){if(P.scale!==1){var k=P.scale<1?"in":"out";P.additionalEvent=this.options.event+k}this._super.emit.call(this,P)}});function Mi(){gr.apply(this,arguments),this._timer=null,this._input=null}R(Mi,gr,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Fo]},process:function(P){var k=this.options,j=P.pointers.length===k.pointers,fe=P.distance<k.threshold,xe=P.deltaTime>k.time;if(this._input=P,!fe||!j||P.eventType&(be|Pe)&&!xe)this.reset();else if(P.eventType&ue)this.reset(),this._timer=p(function(){this.state=pr,this.tryEmit()},k.time,this);else if(P.eventType&be)return pr;return Er},reset:function(){clearTimeout(this._timer)},emit:function(P){this.state===pr&&(P&&P.eventType&be?this.manager.emit(this.options.event+"up",P):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}});function Oi(){Cr.apply(this,arguments)}R(Oi,Cr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[tn]},attrTest:function(P){return this._super.attrTest.call(this,P)&&(Math.abs(P.rotation)>this.options.threshold||this.state&hr)}});function Qs(){Cr.apply(this,arguments)}R(Qs,Cr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ie|ct,pointers:1},getTouchAction:function(){return Va.prototype.getTouchAction.call(this)},attrTest:function(P){var k=this.options.direction,j;return k&(Ie|ct)?j=P.overallVelocity:k&Ie?j=P.overallVelocityX:k&ct&&(j=P.overallVelocityY),this._super.attrTest.call(this,P)&&k&P.offsetDirection&&P.distance>this.options.threshold&&P.maxPointers==this.options.pointers&&f(j)>this.options.velocity&&P.eventType&be},emit:function(P){var k=Df(P.offsetDirection);k&&this.manager.emit(this.options.event+k,P),this.manager.emit(this.options.event,P)}});function Gs(){gr.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}R(Gs,gr,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[$r]},process:function(P){var k=this.options,j=P.pointers.length===k.pointers,fe=P.distance<k.threshold,xe=P.deltaTime<k.time;if(this.reset(),P.eventType&ue&&this.count===0)return this.failTimeout();if(fe&&xe&&j){if(P.eventType!=be)return this.failTimeout();var Ne=this.pTime?P.timeStamp-this.pTime<k.interval:!0,lt=!this.pCenter||Vt(this.pCenter,P.center)<k.posThreshold;this.pTime=P.timeStamp,this.pCenter=P.center,!lt||!Ne?this.count=1:this.count+=1,this._input=P;var dn=this.count%k.taps;if(dn===0)return this.hasRequireFailures()?(this._timer=p(function(){this.state=pr,this.tryEmit()},k.interval,this),hr):pr}return Er},failTimeout:function(){return this._timer=p(function(){this.state=Er},this.options.interval,this),Er},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==pr&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Rs(P,k){return k=k||{},k.recognizers=I(k.recognizers,Rs.defaults.preset),new $a(P,k)}Rs.VERSION="2.0.7",Rs.defaults={domEvents:!1,touchAction:zr,enable:!0,inputTarget:null,inputClass:null,preset:[[Oi,{enable:!1}],[vc,{enable:!1},["rotate"]],[Qs,{direction:Ie}],[Va,{direction:Ie},["swipe"]],[Gs],[Gs,{event:"doubletap",taps:2},["tap"]],[Mi]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var yg=1,za=2;function $a(P,k){this.options=b({},Rs.defaults,k||{}),this.options.inputTarget=this.options.inputTarget||P,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=P,this.input=at(this),this.touchAction=new ki(this,this.options.touchAction),ja(this,!0),v(this.options.recognizers,function(j){var fe=this.add(new j[0](j[1]));j[2]&&fe.recognizeWith(j[2]),j[3]&&fe.requireFailure(j[3])},this)}$a.prototype={set:function(P){return b(this.options,P),P.touchAction&&this.touchAction.update(),P.inputTarget&&(this.input.destroy(),this.input.target=P.inputTarget,this.input.init()),this},stop:function(P){this.session.stopped=P?za:yg},recognize:function(P){var k=this.session;if(!k.stopped){this.touchAction.preventDefaults(P);var j,fe=this.recognizers,xe=k.curRecognizer;(!xe||xe&&xe.state&pr)&&(xe=k.curRecognizer=null);for(var Ne=0;Ne<fe.length;)j=fe[Ne],k.stopped!==za&&(!xe||j==xe||j.canRecognizeWith(xe))?j.recognize(P):j.reset(),!xe&&j.state&(hr|Cs|as)&&(xe=k.curRecognizer=j),Ne++}},get:function(P){if(P instanceof gr)return P;for(var k=this.recognizers,j=0;j<k.length;j++)if(k[j].options.event==P)return k[j];return null},add:function(P){if(m(P,"add",this))return this;var k=this.get(P.options.event);return k&&this.remove(k),this.recognizers.push(P),P.manager=this,this.touchAction.update(),P},remove:function(P){if(m(P,"remove",this))return this;if(P=this.get(P),P){var k=this.recognizers,j=he(k,P);j!==-1&&(k.splice(j,1),this.touchAction.update())}return this},on:function(P,k){if(P!==s&&k!==s){var j=this.handlers;return v(le(P),function(fe){j[fe]=j[fe]||[],j[fe].push(k)}),this}},off:function(P,k){if(P!==s){var j=this.handlers;return v(le(P),function(fe){k?j[fe]&&j[fe].splice(he(j[fe],k),1):delete j[fe]}),this}},emit:function(P,k){this.options.domEvents&&Uo(P,k);var j=this.handlers[P]&&this.handlers[P].slice();if(!(!j||!j.length)){k.type=P,k.preventDefault=function(){k.srcEvent.preventDefault()};for(var fe=0;fe<j.length;)j[fe](k),fe++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ja(P,k){var j=P.element;if(j.style){var fe;v(P.options.cssProps,function(xe,Ne){fe=ye(j.style,Ne),k?(P.oldCssProps[fe]=j.style[fe],j.style[fe]=xe):j.style[fe]=P.oldCssProps[fe]||""}),k||(P.oldCssProps={})}}function Uo(P,k){var j=t.createEvent("Event");j.initEvent(P,!0,!0),j.gesture=k,k.target.dispatchEvent(j)}b(Rs,{INPUT_START:ue,INPUT_MOVE:ve,INPUT_END:be,INPUT_CANCEL:Pe,STATE_POSSIBLE:jt,STATE_BEGAN:hr,STATE_CHANGED:Cs,STATE_ENDED:as,STATE_RECOGNIZED:pr,STATE_CANCELLED:Bo,STATE_FAILED:Er,DIRECTION_NONE:Ue,DIRECTION_LEFT:Ke,DIRECTION_RIGHT:nt,DIRECTION_UP:Ge,DIRECTION_DOWN:He,DIRECTION_HORIZONTAL:Ie,DIRECTION_VERTICAL:ct,DIRECTION_ALL:xn,Manager:$a,Input:ht,TouchAction:ki,TouchInput:Xe,MouseInput:kn,PointerEventInput:fr,TouchMouseInput:Tn,SingleTouchInput:Ri,Recognizer:gr,AttrRecognizer:Cr,Tap:Gs,Pan:Va,Swipe:Qs,Pinch:vc,Rotate:Oi,Press:Mi,on:F,off:$,each:v,merge:S,extend:w,assign:b,inherit:R,bindFn:C,prefixed:ye});var _g=typeof e<"u"?e:typeof self<"u"?self:{};_g.Hammer=Rs,n.exports?n.exports=Rs:e[r]=Rs})(window,document,"Hammer")}(cv)),cv.exports}var Af=qz();const Kz=ka(Af),Ds=nI({__proto__:null,default:Kz},[Af]),iC=1,oC=2,Ly=4,Zz={mousedown:iC,mousemove:oC,mouseup:Ly};function Qz(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return!0;return!1}function Gz(n){const e=n.prototype.handler;n.prototype.handler=function(r){const s=this.store;r.button>0&&r.type==="pointerdown"&&(Qz(s,i=>i.pointerId===r.pointerId)||s.push(r)),e.call(this,r)}}function Jz(n){n.prototype.handler=function(t){let r=Zz[t.type];r&iC&&t.button>=0&&(this.pressed=!0),r&oC&&t.buttons===0&&(r=Ly),this.pressed&&(r&Ly&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}Gz(Af.PointerEventInput);Jz(Af.MouseInput);const e$=Af.Manager;class lg{constructor(e,t,r){this.element=e,this.callback=t,this.options={enable:!0,...r}}}const t$=Ds?[[Ds.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Ds.Rotate,{enable:!1}],[Ds.Pinch,{enable:!1}],[Ds.Swipe,{enable:!1}],[Ds.Pan,{threshold:0,enable:!1}],[Ds.Press,{enable:!1}],[Ds.Tap,{event:"doubletap",taps:2,enable:!1}],[Ds.Tap,{event:"anytap",enable:!1}],[Ds.Tap,{enable:!1}]]:null,fT={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},n$={doubletap:["tap"]},r$={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},T1={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},s$={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},dT={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},i$=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Ol=typeof window<"u"?window:global;let Fy=!1;try{const n={get passive(){return Fy=!0,!0}};Ol.addEventListener("test",null,n),Ol.removeEventListener("test",null)}catch{Fy=!1}const o$=i$.indexOf("firefox")!==-1,{WHEEL_EVENTS:a$}=T1,hT="wheel",pT=4.000244140625,l$=40,c$=.25;class u$ extends lg{constructor(e,t,r){super(e,t,r),this.handleEvent=s=>{if(!this.options.enable)return;let i=s.deltaY;Ol.WheelEvent&&(o$&&s.deltaMode===Ol.WheelEvent.DOM_DELTA_PIXEL&&(i/=Ol.devicePixelRatio),s.deltaMode===Ol.WheelEvent.DOM_DELTA_LINE&&(i*=l$)),i!==0&&i%pT===0&&(i=Math.floor(i/pT)),s.shiftKey&&i&&(i=i*c$),this.callback({type:hT,center:{x:s.clientX,y:s.clientY},delta:-i,srcEvent:s,pointerType:"mouse",target:s.target})},this.events=(this.options.events||[]).concat(a$),this.events.forEach(s=>e.addEventListener(s,this.handleEvent,Fy?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===hT&&(this.options.enable=t)}}const{MOUSE_EVENTS:f$}=T1,gT="pointermove",mT="pointerover",vT="pointerout",yT="pointerenter",_T="pointerleave";class d$ extends lg{constructor(e,t,r){super(e,t,r),this.handleEvent=i=>{this.handleOverEvent(i),this.handleOutEvent(i),this.handleEnterEvent(i),this.handleLeaveEvent(i),this.handleMoveEvent(i)},this.pressed=!1;const{enable:s}=this.options;this.enableMoveEvent=s,this.enableLeaveEvent=s,this.enableEnterEvent=s,this.enableOutEvent=s,this.enableOverEvent=s,this.events=(this.options.events||[]).concat(f$),this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===gT&&(this.enableMoveEvent=t),e===mT&&(this.enableOverEvent=t),e===vT&&(this.enableOutEvent=t),e===yT&&(this.enableEnterEvent=t),e===_T&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(mT,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(vT,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(yT,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(_T,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit(gT,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const{KEY_EVENTS:h$}=T1,xT="keydown",bT="keyup";class p$ extends lg{constructor(e,t,r){super(e,t,r),this.handleEvent=s=>{const i=s.target||s.srcElement;i.tagName==="INPUT"&&i.type==="text"||i.tagName==="TEXTAREA"||(this.enableDownEvent&&s.type==="keydown"&&this.callback({type:xT,srcEvent:s,key:s.key,target:s.target}),this.enableUpEvent&&s.type==="keyup"&&this.callback({type:bT,srcEvent:s,key:s.key,target:s.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(h$),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===xT&&(this.enableDownEvent=t),e===bT&&(this.enableUpEvent=t)}}const wT="contextmenu";class g$ extends lg{constructor(e,t,r){super(e,t,r),this.handleEvent=s=>{this.options.enable&&this.callback({type:wT,center:{x:s.clientX,y:s.clientY},srcEvent:s,pointerType:"mouse",target:s.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===wT&&(this.options.enable=t)}}const TT=1,By=2,ST=4,m$={pointerdown:TT,pointermove:By,pointerup:ST,mousedown:TT,mousemove:By,mouseup:ST},v$=0,y$=1,_$=2,x$=1,b$=2,w$=4;function T$(n){const e=m$[n.srcEvent.type];if(!e)return null;const{buttons:t,button:r}=n.srcEvent;let s=!1,i=!1,o=!1;return e===By?(s=!!(t&x$),i=!!(t&w$),o=!!(t&b$)):(s=r===v$,i=r===y$,o=r===_$),{leftButton:s,middleButton:i,rightButton:o}}function S$(n,e){const t=n.center;if(!t)return null;const r=e.getBoundingClientRect(),s=r.width/e.offsetWidth||1,i=r.height/e.offsetHeight||1,o={x:(t.x-r.left-e.clientLeft)/s,y:(t.y-r.top-e.clientTop)/i};return{center:t,offsetCenter:o}}const uv={srcElement:"root",priority:0};class E${constructor(e){this.handleEvent=t=>{if(this.isEmpty())return;const r=this._normalizeEvent(t);let s=t.srcEvent.target;for(;s&&s!==r.rootElement;){if(this._emit(r,s),r.handled)return;s=s.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,r,s=!1,i=!1){const{handlers:o,handlersByElement:a}=this;let u=uv;typeof r=="string"||r&&r.addEventListener?u={...uv,srcElement:r}:r&&(u={...uv,...r});let f=a.get(u.srcElement);f||(f=[],a.set(u.srcElement,f));const d={type:e,handler:t,srcElement:u.srcElement,priority:u.priority};s&&(d.once=!0),i&&(d.passive=!0),o.push(d),this._active=this._active||!d.passive;let p=f.length-1;for(;p>=0&&!(f[p].priority>=d.priority);)p--;f.splice(p+1,0,d)}remove(e,t){const{handlers:r,handlersByElement:s}=this;for(let i=r.length-1;i>=0;i--){const o=r[i];if(o.type===e&&o.handler===t){r.splice(i,1);const a=s.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&s.delete(o.srcElement)}}this._active=r.some(i=>!i.passive)}_emit(e,t){const r=this.handlersByElement.get(t);if(r){let s=!1;const i=()=>{e.handled=!0},o=()=>{e.handled=!0,s=!0},a=[];for(let u=0;u<r.length;u++){const{type:f,handler:d,once:p}=r[u];if(d({...e,type:f,stopPropagation:i,stopImmediatePropagation:o}),p&&a.push(r[u]),s)break}for(let u=0;u<a.length;u++){const{type:f,handler:d}=a[u];this.remove(f,d)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...T$(e),...S$(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}const A$={events:null,recognizers:null,recognizerOptions:{},Manager:e$,touchAction:"none",tabIndex:0};class C${constructor(e=null,t){this._onBasicInput=s=>{const{srcEvent:i}=s,o=r$[i.type];o&&this.manager.emit(o,s)},this._onOtherEvent=s=>{this.manager.emit(s.type,s)},this.options={...A$,...t},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this,r=t.Manager;this.manager=new r(e,{touchAction:t.touchAction,recognizers:t.recognizers||t$}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(fT).forEach(s=>{const i=this.manager.get(s);i&&fT[s].forEach(o=>{i.recognizeWith(o)})});for(const s in t.recognizerOptions){const i=this.manager.get(s);if(i){const o=t.recognizerOptions[s];delete o.enable,i.set(o)}}this.wheelInput=new u$(e,this._onOtherEvent,{enable:!1}),this.moveInput=new d$(e,this._onOtherEvent,{enable:!1}),this.keyInput=new p$(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new g$(e,this._onOtherEvent,{enable:!1});for(const[s,i]of this.events)i.isEmpty()||(this._toggleRecognizer(i.recognizerName,!0),this.manager.on(s,i.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,r){this._addEventHandler(e,t,r,!1)}once(e,t,r){this._addEventHandler(e,t,r,!0)}watch(e,t,r){this._addEventHandler(e,t,r,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:r}=this;if(!r)return;const s=r.get(e);if(s&&s.options.enable!==t){s.set({enable:t});const i=n$[e];i&&!this.options.recognizers&&i.forEach(o=>{const a=r.get(o);t?(a.requireFailure(e),s.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,r,s,i){if(typeof e!="string"){r=t;for(const d in e)this._addEventHandler(d,e[d],r,s,i);return}const{manager:o,events:a}=this,u=dT[e]||e;let f=a.get(u);f||(f=new E$(this),a.set(u,f),f.recognizerName=s$[u]||u,o&&o.on(u,f.handleEvent)),f.add(e,t,r,s,i),f.isEmpty()||this._toggleRecognizer(f.recognizerName,!0)}_removeEventHandler(e,t){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,s=dT[e]||e,i=r.get(s);if(i&&(i.remove(e,t),i.isEmpty())){const{recognizerName:o}=i;let a=!1;for(const u of r.values())if(u.recognizerName===o&&!u.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function no(){}const R$=({isDragging:n})=>n?"grabbing":"grab",aC={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,glOptions:{},canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:no,onWebGLInitialized:no,onResize:no,onViewStateChange:no,onInteractionStateChange:no,onBeforeRender:no,onAfterRender:no,onLoad:no,onError:n=>ft.error(n.message,n.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:R$,getTooltip:null,debug:!1,drawPickingColors:!1};class S1{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new wf({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=r=>{const{_pickRequest:s}=this;if(r.type==="pointerleave")s.x=-1,s.y=-1,s.radius=0;else{if(r.leftButton||r.rightButton)return;{const i=r.offsetCenter;if(!i)return;s.x=i.x,s.y=i.y,s.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:s.x,y:s.y}),s.event=r},this._onEvent=r=>{const s=Ay[r.type],i=r.offsetCenter;if(!s||!i||!this.layerManager)return;const o=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:o,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:u}=a,f=u&&(u[s.handler]||u.props[s.handler]),d=this.props[s.handler];let p=!1;f&&(p=f.call(u,a,r)),p||(d==null||d(a,r),this.widgetManager.onEvent(a,r))},this._onPointerDown=r=>{const s=r.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:s.x,y:s.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo},this.props={...aC,...e},e=this.props,e.viewState&&e.initialViewState&&ft.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device?this.device=e.device:e.gl&&(e.gl instanceof WebGLRenderingContext&&ft.error("WebGL1 context not supported.")(),this.device=Mu.attach(e.gl));let t=this.device;t||(Bl.registerDevices([Mu]),t=Bl.createDevice({...e.deviceProps,canvas:this._createCanvas(e)})),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&sc.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,r,s,i,o,a,u,f,d;(e=this.animationLoop)==null||e.stop(),(t=this.animationLoop)==null||t.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,(r=this.layerManager)==null||r.finalize(),this.layerManager=null,(s=this.viewManager)==null||s.finalize(),this.viewManager=null,(i=this.effectManager)==null||i.finalize(),this.effectManager=null,(o=this.deckRenderer)==null||o.finalize(),this.deckRenderer=null,(a=this.deckPicker)==null||a.finalize(),this.deckPicker=null,(u=this.eventManager)==null||u.destroy(),this.eventManager=null,(f=this.widgetManager)==null||f.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&((d=this.canvas.parentElement)==null||d.removeChild(this.canvas),this.canvas=null)}setProps(e){var r;this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&ft.removed("onLayerHover","onHover")(),"onLayerClick"in e&&ft.removed("onLayerClick","onClick")(),e.initialViewState&&!Qr(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),(r=this.animationLoop)==null||r.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t),this.widgetManager.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),s=this.layerManager.needsRedraw(e),i=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||r||s||i||o,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return this.viewManager!==null}getViews(){return Un(this.viewManager),this.viewManager.views}getViewports(e){return Un(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){var t;(t=this.layerManager)==null||t.removeDefaultShaderModule(e)}_pick(e,t,r){Un(this.deckPicker);const{stats:s}=this;s.get("Pick Count").incrementCount(),s.get(t).timeStart();const i=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return s.get(t).timeEnd(),i}_createCanvas(e){let t=e.canvas;return typeof t=="string"&&(t=document.getElementById(t),Un(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){var s;if(!this.canvas)return;const{width:t,height:r}=e;if(t||t===0){const i=Number.isFinite(t)?`${t}px`:t;this.canvas.style.width=i}if(r||r===0){const i=Number.isFinite(r)?`${r}px`:r;this.canvas.style.position=((s=e.style)==null?void 0:s.position)||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){var s,i;const{canvas:e}=this;if(!e)return;const t=e.clientWidth??e.width,r=e.clientHeight??e.height;(t!==this.width||r!==this.height)&&(this.width=t,this.height=r,(s=this.viewManager)==null||s.setProps({width:t,height:r}),(i=this.layerManager)==null||i.activateViewport(this.getViewports()[0]),this.props.onResize({width:t,height:r}))}_createAnimationLoop(e,t){const{gl:r,onError:s,useDevicePixels:i}=t;return new eU({device:e,useDevicePixels:i,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new jA({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){var t,r,s;const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:o}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let a=o,u=!1;for(const f of i)a=f,u=((t=f.layer)==null?void 0:t.onHover(f,e.event))||u;u||((s=(r=this.props).onHover)==null||s.call(r,a,e.event),this.widgetManager.onHover(a,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){var s,i;if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=(s=this.device.canvasContext)==null?void 0:s.canvas),this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof Mu&&this.props.onWebGLInitialized(this.device.gl);const t=new BA;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new C$(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const o in Ay)this.eventManager.on(o,this._onEvent);this.viewManager=new yU({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new vU(this.device,{deck:this,stats:this.stats,viewport:r,timeline:t}),this.effectManager=new MU({deck:this,device:this.device}),this.deckRenderer=new DU(this.device),this.deckPicker=new zU(this.device),this.widgetManager=new WU({deck:this,parentElement:(i=this.canvas)==null?void 0:i.parentElement}),this.widgetManager.addDefault(new XU),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){var o;const{device:r,gl:s}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:s});const i={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t};(o=this.deckRenderer)==null||o.renderLayers(i),i.pass==="screen"&&this.widgetManager.onRedraw({viewports:i.viewports,layers:i.layers}),this.props.onAfterRender({device:r,gl:s})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),ft.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const r=Bl.stats.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}S1.defaultProps=aC;S1.VERSION=uF;function P$(n){switch(n){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return nA(n)}}const I$=tA;function ih(n,e){return{attribute:n,format:e.size>1?`${e.type}x${e.size}`:e.type,byteOffset:e.offset||0}}function la(n){return n.stride||n.size*n.bytesPerElement}function k$(n,e){return n.type===e.type&&n.size===e.size&&la(n)===la(e)&&(n.offset||0)===(e.offset||0)}function Uy(n,e){e.offset&&ft.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=la(n),r=e.vertexOffset!==void 0?e.vertexOffset:n.vertexOffset||0,s=e.elementOffset||0,i=r*t+s*n.bytesPerElement+(n.offset||0);return{...e,offset:i,stride:t}}function M$(n,e){const t=Uy(n,e);return{high:t,low:{...t,offset:t.offset+n.size*4}}}class O${constructor(e,t,r){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const s=t.logicalType||t.type,i=s==="float64";let{defaultValue:o}=t;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;i?a="float32":!s&&t.isIndexed?a="uint32":a=s||"float32";let u=P$(s||a);this.doublePrecision=i,i&&t.fp64===!1&&(u=Float32Array),this.value=null,this.settings={...t,defaultType:u,defaultValue:o,logicalType:s,type:a,normalized:a.includes("norm"),size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*la(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),sc.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,t=null){const r={};if(this.state.constant){const s=this.value;if(t){const i=Uy(this.getAccessor(),t),o=i.offset/s.BYTES_PER_ELEMENT,a=i.size||this.size;r[e]=s.subarray(o,o+a)}else r[e]=s}else r[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?r[`${e}64Low`]=r[e]:r[`${e}64Low`]=new Float32Array(this.size)),r}_getBufferLayout(e=this.id,t=null){const r=this.getAccessor(),s=[],i={name:this.id,byteStride:la(r),attributes:s};if(this.doublePrecision){const o=M$(r,t||{});s.push(ih(e,{...r,...o.high}),ih(`${e}64Low`,{...r,...o.low}))}else if(t){const o=Uy(r,t);s.push(ih(e,{...r,...o}))}else s.push(ih(e,r));return i}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:r,size:s}=this,i=r*s;if(t&&i&&t.length>=i){const o=new Array(s).fill(1/0),a=new Array(s).fill(-1/0);for(let u=0;u<i;)for(let f=0;f<s;f++){const d=t[u++];d<o[f]&&(o[f]=d),d>a[f]&&(a[f]=d)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof fn?r={buffer:e}:r=e;const s={...this.settings,...r};if(ArrayBuffer.isView(r.value)){if(!r.type)if(this.doublePrecision&&r.value instanceof Float64Array)s.type="float32";else{const o=I$(r.value);s.type=s.normalized?o.replace("int","norm"):o}s.bytesPerElement=r.value.BYTES_PER_ELEMENT,s.stride=la(s)}if(t.bounds=null,r.constant){let i=r.value;if(i=this._normalizeValue(i,[],0),this.settings.normalized&&(i=this.normalizeConstant(i)),!(!t.constant||!this._areValuesEqual(i,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(i)?i:new Float32Array(i)}else if(r.buffer){const i=r.buffer;t.externalBuffer=i,t.constant=!1,this.value=r.value||null}else if(r.value){this._checkExternalBuffer(r);let i=r.value;t.externalBuffer=null,t.constant=!1,this.value=i;let{buffer:o}=this;const a=la(s),u=(s.vertexOffset||0)*a;if(this.doublePrecision&&i instanceof Float64Array&&(i=Z0(i,s)),this.settings.isIndexed){const d=this.settings.defaultType;i.constructor!==d&&(i=new d(i))}const f=i.byteLength+u+a*2;(!o||o.byteLength<f)&&(o=this._createBuffer(f)),o.write(i,u)}return this.setAccessor(s),!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:r=0,endOffset:s}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?Z0(t,{size:this.size,startIndex:r,endIndex:s}):t.subarray(r,s),r*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,t=!1){const{state:r}=this,s=r.allocatedValue,i=sc.allocate(s,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=i;const{byteOffset:o}=this;let{buffer:a}=this;return(!a||a.byteLength<i.byteLength+o)&&(a=this._createBuffer(i.byteLength+o),t&&s&&a.write(s instanceof Float64Array?Z0(s,this):s,o)),r.allocatedValue=i,r.constant=!1,r.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error(`Attribute ${this.id} value is not TypedArray`);const r=this.settings.defaultType;let s=!1;if(this.doublePrecision&&(s=t.BYTES_PER_ELEMENT<4),s)throw new Error(`Attribute ${this.id} does not support ${t.constructor.name}`);!(t instanceof r)&&this.settings.normalized&&!("normalized"in e)&&ft.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(t=>(t+128)/255*2-1);case"snorm16":return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(t=>t/255);case"unorm16":return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,r){const{defaultValue:s,size:i}=this.settings;if(Number.isFinite(e))return t[r]=e,t;if(!e){let o=i;for(;--o>=0;)t[r+o]=s[o];return t}switch(i){case 4:t[r+3]=Number.isFinite(e[3])?e[3]:s[3];case 3:t[r+2]=Number.isFinite(e[2])?e[2]:s[2];case 2:t[r+1]=Number.isFinite(e[1])?e[1]:s[1];case 1:t[r+0]=Number.isFinite(e[0])?e[0]:s[0];break;default:let o=i;for(;--o>=0;)t[r+o]=Number.isFinite(e[o])?e[o]:s[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:r}=this;for(let s=0;s<r;s++)if(e[s]!==t[s])return!1;return!0}_createBuffer(e){var s;this._buffer&&this._buffer.destroy();const{isIndexed:t,type:r}=this.settings;return this._buffer=this.device.createBuffer({...(s=this._buffer)==null?void 0:s.props,id:this.id,usage:t?fn.INDEX:fn.VERTEX,indexType:t?r:void 0,byteLength:e}),this._buffer}}const ET=[],AT=[];function Cf(n,e=0,t=1/0){let r=ET;const s={index:-1,data:n,target:[]};return n?typeof n[Symbol.iterator]=="function"?r=n:n.length>0&&(AT.length=n.length,r=AT):r=ET,(e>0||Number.isFinite(t))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,t),s.index=e-1),{iterable:r,objectInfo:s}}function lC(n){return n&&n[Symbol.asyncIterator]}function cC(n,e){const{size:t,stride:r,offset:s,startIndices:i,nested:o}=e,a=n.BYTES_PER_ELEMENT,u=r?r/a:t,f=s?s/a:0,d=Math.floor((n.length-f)/u);return(p,{index:m,target:v})=>{if(!i){const S=m*u+f;for(let R=0;R<t;R++)v[R]=n[S+R];return v}const x=i[m],b=i[m+1]||d;let w;if(o){w=new Array(b-x);for(let S=x;S<b;S++){const R=S*u+f;v=new Array(t);for(let C=0;C<t;C++)v[C]=n[R+C];w[S-x]=v}}else if(u===t)w=n.subarray(x*t+f,b*t+f);else{w=new n.constructor((b-x)*t);let S=0;for(let R=x;R<b;R++){const C=R*u+f;for(let O=0;O<t;O++)w[S++]=n[C+O]}}return w}}const N$=[],Th=[[0,1/0]];function D$(n,e){if(n===Th||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],r=n.length;let s=0;for(let i=0;i<r;i++){const o=n[i];o[1]<e[0]?(t.push(o),s=i+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(s,0,e),t}const L$={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function uC(n,e){if(!n)return null;Number.isFinite(n)&&(n={type:"interpolation",duration:n});const t=n.type||"interpolation";return{...L$[t],...e,...n,type:t}}class fC extends O${constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Th}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t;(t=this.state).layoutChanged||(t.layoutChanged=!k$(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,r=this.settings.transition,s=Array.isArray(t)?e[t.find(i=>e[i])]:e[t];return uC(s,r)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:r=0,endRow:s=1/0}=t;this.state.updateRanges=D$(this.state.updateRanges,[r,s])}else this.state.updateRanges=Th}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=N$}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,t.updateRanges!==Th),!0):!1}updateBuffer({numInstances:e,data:t,props:r,context:s}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:o,noAlloc:a}}=this;let u=!0;if(o){for(const[f,d]of i)o.call(s,this,{data:t,startRow:f,endRow:d,props:r,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[f,d]of i){const p=Number.isFinite(f)?this.getVertexOffset(f):0,m=Number.isFinite(d)?this.getVertexOffset(d):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:p,endOffset:m})}this._checkAttributeArray()}else u=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),u}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:r,settings:s}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(s.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),s.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;Un(ArrayBuffer.isView(o.value),`invalid ${s.accessor}`);const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=cC(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:t,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const r in e)Object.assign(t,super.getValue(r,e[r]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,r=super._getBufferLayout(),{stepMode:s}=this.settings;if(s==="dynamic"?r.stepMode=e?e.isInstanced?"instance":"vertex":"instance":r.stepMode=s??"vertex",!t)return r;for(const i in t){const o=super._getBufferLayout(i,t[i]);r.attributes.push(...o.attributes)}return r}_autoUpdater(e,{data:t,startRow:r,endRow:s,props:i,numInstances:o}){if(e.constant)return;const{settings:a,state:u,value:f,size:d,startIndices:p}=e,{accessor:m,transform:v}=a,x=u.binaryAccessor||(typeof m=="function"?m:i[m]);Un(typeof x=="function",`accessor "${m}" is not a function`);let b=e.getVertexOffset(r);const{iterable:w,objectInfo:S}=Cf(t,r,s);for(const R of w){S.index++;let C=x(R,S);if(v&&(C=v.call(this,C)),p){const O=(S.index<p.length-1?p[S.index+1]:o)-p[S.index];if(C&&Array.isArray(C[0])){let I=b;for(const F of C)e._normalizeValue(F,f,I),I+=d}else C&&C.length>d?f.set(C,b):(e._normalizeValue(C,S.target,0),dU({target:f,source:S.target,start:b,count:O}));b+=O*d}else e._normalizeValue(C,f,b),b+=d}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let r=!0;switch(t){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function fv(n){const{source:e,target:t,start:r=0,size:s,getData:i}=n,o=n.end||t.length,a=e.length,u=o-r;if(a>u){t.set(e.subarray(0,u),r);return}if(t.set(e,r),!i)return;let f=a;for(;f<u;){const d=i(f,e);for(let p=0;p<s;p++)t[r+f]=d[p]||0,f++}}function F$({source:n,target:e,size:t,getData:r,sourceStartIndices:s,targetStartIndices:i}){if(!s||!i)return fv({source:n,target:e,size:t,getData:r}),e;let o=0,a=0;const u=r&&((d,p)=>r(d+a,p)),f=Math.min(s.length,i.length);for(let d=1;d<f;d++){const p=s[d]*t,m=i[d]*t;fv({source:n.subarray(o,p),target:e,start:a,end:m,size:t,getData:u}),o=p,a=m}return a<e.length&&fv({source:[],target:e,start:a,size:t,getData:u}),e}function B$(n){const{device:e,settings:t,value:r}=n,s=new fC(e,t);return s.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:t.normalized}),s}function dC(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${n}"`)}}function hC(n){switch(n){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function pC(n){n.push(n.shift())}function U$(n,e){const{doublePrecision:t,settings:r,value:s,size:i}=n,o=t&&s instanceof Float64Array?2:1;let a=0;const{shaderAttributes:u}=n.settings;if(u)for(const f of Object.values(u))a=Math.max(a,f.vertexOffset??0);return(r.noAlloc?s.length:(e+a)*i)*o}function gC({device:n,source:e,target:t}){return(!t||t.byteLength<e.byteLength)&&(t==null||t.destroy(),t=n.createBuffer({byteLength:e.byteLength,usage:e.usage})),t}function mC({device:n,buffer:e,attribute:t,fromLength:r,toLength:s,fromStartIndices:i,getData:o=a=>a}){const a=t.doublePrecision&&t.value instanceof Float64Array?2:1,u=t.size*a,f=t.byteOffset,d=t.settings.bytesPerElement<4?f/t.settings.bytesPerElement*4:f,p=t.startIndices,m=i&&p,v=t.isConstant;if(!m&&e&&r>=s)return e;const x=t.value instanceof Float64Array?Float32Array:t.value.constructor,b=v?t.value:new x(t.getBuffer().readSyncWebGL(f,s*x.BYTES_PER_ELEMENT).buffer);if(t.settings.normalized&&!v){const C=o;o=(O,I)=>t.normalizeConstant(C(O,I))}const w=v?(C,O)=>o(b,O):(C,O)=>o(b.subarray(C+f,C+f+u),O),S=e?new Float32Array(e.readSyncWebGL(d,r*4).buffer):new Float32Array(0),R=new Float32Array(s);return F$({source:S,target:R,sourceStartIndices:i,targetStartIndices:p,size:u,getData:w}),(!e||e.byteLength<R.byteLength+d)&&(e==null||e.destroy(),e=n.createBuffer({byteLength:R.byteLength+d,usage:35050})),e.write(R,d),e}class vC{constructor({device:e,attribute:t,timeline:r}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new ig(r),this.attribute=t,this.attributeInTransition=B$(t),this.currentStartIndices=t.startIndices}get inProgress(){return this.transition.inProgress}start(e,t,r=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=U$(this.attribute,t),this.transition.start({...e,duration:r})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class V$ extends vC{constructor({device:e,attribute:t,timeline:r}){super({device:e,attribute:t,timeline:r}),this.type="interpolation",this.transform=j$(e,t)}start(e,t){const r=this.currentLength,s=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:i,attribute:o}=this;pC(i),i[0]=mC({device:this.device,buffer:i[0],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:s,getData:e.enter}),i[1]=gC({device:this.device,source:i[0],target:i[1]}),this.setBuffer(i[1]);const{transform:a}=this,u=a.model;let f=Math.floor(this.currentLength/o.size);yC(o)&&(f/=2),u.setVertexCount(f),o.isConstant?(u.setAttributes({aFrom:i[0]}),u.setConstantAttributes({aTo:o.value})):u.setAttributes({aFrom:i[0],aTo:o.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:i[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:r}=this.transition;let s=r/e;t&&(s=t(s));const{model:i}=this.transform;i.setUniforms({time:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const z$=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`,$$=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function yC(n){return n.doublePrecision&&n.value instanceof Float64Array}function j$(n,e){const t=e.size,r=dC(t),s=hC(t),i=e.getBufferLayout();return yC(e)?new Yu(n,{vs:$$,bufferLayout:[{name:"aFrom",byteStride:8*t,attributes:[{attribute:"aFrom",format:s,byteOffset:0},{attribute:"aFrom64Low",format:s,byteOffset:4*t}]},{name:"aTo",byteStride:8*t,attributes:[{attribute:"aTo",format:s,byteOffset:0},{attribute:"aTo64Low",format:s,byteOffset:4*t}]}],modules:[PB],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:t},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new Yu(n,{vs:z$,bufferLayout:[{name:"aFrom",format:s},{name:"aTo",format:i.attributes[0].format}],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}class W$ extends vC{constructor({device:e,attribute:t,timeline:r}){super({device:e,attribute:t,timeline:r}),this.type="spring",this.texture=q$(e),this.framebuffer=K$(e,this.texture),this.transform=Y$(e,t)}start(e,t){const r=this.currentLength,s=this.currentStartIndices;super.start(e,t);const{buffers:i,attribute:o}=this;for(let u=0;u<2;u++)i[u]=mC({device:this.device,buffer:i[u],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:s,getData:e.enter});i[2]=gC({device:this.device,source:i[0],target:i[2]}),this.setBuffer(i[1]);const{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?a.setConstantAttributes({aTo:o.value}):a.setAttributes({aTo:o.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:r,transition:s}=this,i=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]}),t.model.setUniforms({stiffness:i.stiffness,damping:i.damping}),t.run({framebuffer:r,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),pC(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(r)[0]>0||s.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const H$=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,X$=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function Y$(n,e){const t=dC(e.size),r=hC(e.size);return new Yu(n,{vs:H$,fs:X$,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],defines:{ATTRIBUTE_TYPE:t},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function q$(n){return n.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function K$(n,e){return n.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const Z$={interpolation:V$,spring:W$};class Q${constructor(e,{id:t,timeline:r}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=t,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:r}){this.numInstances=r||1;for(const s in e){const i=e[s],o=i.getTransitionSetting(t);o&&this._updateAttribute(s,i,o)}for(const s in this.transitions){const i=e[s];(!i||!i.getTransitionSetting(t))&&this._removeTransition(s)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const r=this.transitions[t];r.inProgress&&(e[t]=r.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,r){const s=this.transitions[e];let i=!s||s.type!==r.type;if(i){s&&this._removeTransition(e);const o=Z$[r.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,device:this.device}):(ft.error(`unsupported transition type '${r.type}'`)(),i=!1)}(i||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const CT="attributeManager.invalidate",G$="attributeManager.updateStart",J$="attributeManager.updateEnd",ej="attribute.updateStart",tj="attribute.allocate",nj="attribute.updateEnd";class rj{constructor(e,{id:t="attribute-manager",stats:r,timeline:s}={}){this.mergeBoundsMemoized=Ef(j9),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Q$(e,{id:`${t}-transitions`,timeline:s}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)this.attributes[t]!==void 0&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const r=this._invalidateTrigger(e,t);er(CT,this,e,r)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);er(CT,this,"all")}update({data:e,numInstances:t,startIndices:r=null,transitions:s,props:i={},buffers:o={},context:a={}}){let u=!1;er(G$,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const f in this.attributes){const d=this.attributes[f],p=d.settings.accessor;d.startIndices=r,d.numInstances=t,i[f]&&ft.removed(`props.${f}`,`data.attributes.${f}`)(),d.setExternalBuffer(o[f])||d.setBinaryValue(typeof p=="string"?o[p]:void 0,e.startIndices)||typeof p=="string"&&!o[p]&&d.setConstantValue(i[p])||d.needsUpdate()&&(u=!0,this._updateAttribute({attribute:d,numInstances:t,data:e,props:i,context:a})),this.needsRedraw=this.needsRedraw||d.needsRedraw()}u&&er(J$,this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:s})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const t=e.map(r=>{var s;return(s=this.attributes[r])==null?void 0:s.getBounds()});return this.mergeBoundsMemoized(t)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:r}=this,s={...r.getAttributes()};for(const i in t){const o=t[i];o.needsRedraw(e)&&!r.hasAttribute(i)&&(s[i]=o)}return s}getBufferLayouts(e){return Object.values(this.getAttributes()).map(t=>t.getBufferLayout(e))}_add(e,t){for(const r in e){const s=e[r],i={...s,id:r,size:s.isIndexed&&1||s.size||1,...t};this.attributes[r]=new fC(this.device,i)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(s=>{e[s]||(e[s]=[]),e[s].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:r,updateTriggers:s}=this,i=s[e];return i&&i.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,t)}),i}_updateAttribute(e){const{attribute:t,numInstances:r}=e;if(er(ej,t),t.constant){t.setConstantValue(t.value);return}t.allocate(r)&&er(tj,t,r),t.updateBuffer(e)&&(this.needsRedraw=!0,er(nj,t,r))}}class sj extends ig{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:r,duration:s,easing:i}}=this,o=i(e/s);this._value=da(t,r,o)}}const RT=1e-5;function PT(n,e,t,r,s){const i=e-n,a=(t-e)*s,u=-i*r;return a+u+i+e}function ij(n,e,t,r,s){if(Array.isArray(t)){const i=[];for(let o=0;o<t.length;o++)i[o]=PT(n[o],e[o],t[o],r,s);return i}return PT(n,e,t,r,s)}function IT(n,e){if(Array.isArray(n)){let t=0;for(let r=0;r<n.length;r++){const s=n[r]-e[r];t+=s*s}return Math.sqrt(t)}return Math.abs(n-e)}class oj extends ig{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:r,stiffness:s}=this.settings,{_prevValue:i=e,_currValue:o=e}=this;let a=ij(i,o,t,r,s);const u=IT(a,t),f=IT(a,o);u<RT&&f<RT&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}const aj={interpolation:sj,spring:oj};class lj{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,r,s){const{transitions:i}=this;if(i.has(e)){const u=i.get(e),{value:f=u.settings.fromValue}=u;t=f,this.remove(e)}if(s=uC(s),!s)return;const o=aj[s.type];if(!o){ft.error(`unsupported transition type '${s.type}'`)();return}const a=new o(this.timeline);a.start({...s,fromValue:t,toValue:r}),i.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,r]of this.transitions)r.update(),e[t]=r.value,r.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function cj(n){const e=n[_o];for(const t in e){const r=e[t],{validate:s}=r;if(s&&!s(n[t],r))throw new Error(`Invalid prop ${t}: ${n[t]}`)}}function uj(n,e){const t=_C({newProps:n,oldProps:e,propTypes:n[_o],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=dj(n,e);let s=!1;return r||(s=hj(n,e)),{dataChanged:r,propsChanged:t,updateTriggersChanged:s,extensionsChanged:pj(n,e),transitionsChanged:fj(n,e)}}function fj(n,e){if(!n.transitions)return!1;const t={},r=n[_o];let s=!1;for(const i in n.transitions){const o=r[i],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&Vy(n[i],e[i],o)&&(t[i]=!0,s=!0)}return s?t:!1}function _C({newProps:n,oldProps:e,ignoreProps:t={},propTypes:r={},triggerName:s="props"}){if(e===n)return!1;if(typeof n!="object"||n===null)return`${s} changed shallowly`;if(typeof e!="object"||e===null)return`${s} changed shallowly`;for(const i of Object.keys(n))if(!(i in t)){if(!(i in e))return`${s}.${i} added`;const o=Vy(n[i],e[i],r[i]);if(o)return`${s}.${i} ${o}`}for(const i of Object.keys(e))if(!(i in t)){if(!(i in n))return`${s}.${i} dropped`;if(!Object.hasOwnProperty.call(n,i)){const o=Vy(n[i],e[i],r[i]);if(o)return`${s}.${i} ${o}`}}return!1}function Vy(n,e,t){let r=t&&t.equal;return r&&!r(n,e,t)||!r&&(r=n&&e&&n.equals,r&&!r.call(n,e))?"changed deeply":!r&&e!==n?"changed shallowly":null}function dj(n,e){if(e===null)return"oldProps is null, initial diff";let t=!1;const{dataComparator:r,_dataDiff:s}=n;return r?r(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&s&&(t=s(n.data,e.data)||t),t}function hj(n,e){if(e===null)return{all:!0};if("all"in n.updateTriggers&&kT(n,e,"all"))return{all:!0};const t={};let r=!1;for(const s in n.updateTriggers)s!=="all"&&kT(n,e,s)&&(t[s]=!0,r=!0);return r?t:!1}function pj(n,e){if(e===null)return!0;const t=e.extensions,{extensions:r}=n;if(r===t)return!1;if(!t||!r||r.length!==t.length)return!0;for(let s=0;s<r.length;s++)if(!r[s].equals(t[s]))return!0;return!1}function kT(n,e,t){let r=n.updateTriggers[t];r=r??{};let s=e.updateTriggers[t];return s=s??{},_C({oldProps:s,newProps:r,triggerName:t})}const gj="count(): argument not an object",mj="count(): argument not a container";function vj(n){if(!_j(n))throw new Error(gj);if(typeof n.count=="function")return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(yj(n))return Object.keys(n).length;throw new Error(mj)}function yj(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function _j(n){return n!==null&&typeof n=="object"}function MT(n,e){if(!e)return n;const t={...n,...e};if("defines"in e&&(t.defines={...n.defines,...e.defines}),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=t.modules.findIndex(s=>s.name==="project32");r>=0&&t.modules.splice(r,1)}if("inject"in e)if(!n.inject)t.inject=e.inject;else{const r={...n.inject};for(const s in e.inject)r[s]=(r[s]||"")+e.inject[s];t.inject=r}return t}const xj={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},zy={};function bj(n,e,t,r){if(t instanceof Zr)return t;t.constructor&&t.constructor.name!=="Object"&&(t={data:t});let s=null;t.compressed&&(s={minFilter:"linear",mipmapFilter:t.data.length>1?"nearest":"linear"});const i=e.createTexture({...t,sampler:{...xj,...s,...r}});return zy[i.id]=n,i}function wj(n,e){!e||!(e instanceof Zr)||zy[e.id]===n&&(e.delete(),delete zy[e.id])}const Tj={boolean:{validate(n,e){return!0},equal(n,e,t){return!!n==!!e}},number:{validate(n,e){return Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)}},color:{validate(n,e){return e.optional&&!n||$y(n)&&(n.length===3||n.length===4)},equal(n,e,t){return Qr(n,e,1)}},accessor:{validate(n,e){const t=ap(n);return t==="function"||t===ap(e.value)},equal(n,e,t){return typeof e=="function"?!0:Qr(n,e,1)}},array:{validate(n,e){return e.optional&&!n||$y(n)},equal(n,e,t){const{compare:r}=t,s=Number.isInteger(r)?r:r?1:0;return r?Qr(n,e,s):n===e}},object:{equal(n,e,t){if(t.ignore)return!0;const{compare:r}=t,s=Number.isInteger(r)?r:r?1:0;return r?Qr(n,e,s):n===e}},function:{validate(n,e){return e.optional&&!n||typeof n=="function"},equal(n,e,t){return!t.compare&&t.ignore!==!1||n===e}},data:{transform:(n,e,t)=>{if(!n)return n;const{dataTransform:r}=t.props;return r?r(n):typeof n.shape=="string"&&n.shape.endsWith("-table")&&Array.isArray(n.data)?n.data:n}},image:{transform:(n,e,t)=>{const r=t.context;return!r||!r.device?null:bj(t.id,r.device,n,{...e.parameters,...t.props.textureParameters})},release:(n,e,t)=>{wj(t.id,n)}}};function Sj(n){const e={},t={},r={};for(const[s,i]of Object.entries(n)){const o=i==null?void 0:i.deprecatedFor;if(o)r[s]=Array.isArray(o)?o:[o];else{const a=Ej(s,i);e[s]=a,t[s]=a.value}}return{propTypes:e,defaultProps:t,deprecatedProps:r}}function Ej(n,e){switch(ap(e)){case"object":return su(n,e);case"array":return su(n,{type:"array",value:e,compare:!1});case"boolean":return su(n,{type:"boolean",value:e});case"number":return su(n,{type:"number",value:e});case"function":return su(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function su(n,e){return"type"in e?{name:n,...Tj[e.type],...e}:"value"in e?{name:n,type:ap(e.value),...e}:{name:n,type:"object",value:e}}function $y(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function ap(n){return $y(n)?"array":n===null?"null":typeof n}function Aj(n,e){let t;for(let i=e.length-1;i>=0;i--){const o=e[i];"extensions"in o&&(t=o.extensions)}const r=jy(n.constructor,t),s=Object.create(r);s[ip]=n,s[Sa]={},s[po]={};for(let i=0;i<e.length;++i){const o=e[i];for(const a in o)s[a]=o[a]}return Object.freeze(s),s}const Cj="_mergedDefaultProps";function jy(n,e){if(!(n instanceof cg.constructor))return{};let t=Cj;if(e)for(const s of e){const i=s.constructor;i&&(t+=`:${i.extensionName||i.name}`)}const r=xC(n,t);return r||(n[t]=Rj(n,e||[]))}function Rj(n,e){if(!n.prototype)return null;const r=Object.getPrototypeOf(n),s=jy(r),i=xC(n,"defaultProps")||{},o=Sj(i),a=Object.assign(Object.create(null),s,o.defaultProps),u=Object.assign(Object.create(null),s==null?void 0:s[_o],o.propTypes),f=Object.assign(Object.create(null),s==null?void 0:s[J0],o.deprecatedProps);for(const d of e){const p=jy(d.constructor);p&&(Object.assign(a,p),Object.assign(u,p[_o]),Object.assign(f,p[J0]))}return Pj(a,n),kj(a,u),Ij(a,f),a[_o]=u,a[J0]=f,e.length===0&&!E1(n,"_propTypes")&&(n._propTypes=u),a}function Pj(n,e){const t=Oj(e);Object.defineProperties(n,{id:{writable:!0,value:t}})}function Ij(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(r){const s=`${this.id}: ${t}`;for(const i of e[t])E1(this,i)||(this[i]=r);ft.deprecated(s,e[t].join("/"))()}})}function kj(n,e){const t={},r={};for(const s in e){const i=e[s],{name:o,value:a}=i;i.async&&(t[o]=a,r[o]=Mj(o))}n[Vl]=t,n[Sa]={},Object.defineProperties(n,r)}function Mj(n){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||lC(e)?this[Sa][n]=e:this[po][n]=e},get(){if(this[po]){if(n in this[po])return this[po][n]||this[Vl][n];if(n in this[Sa]){const e=this[ip]&&this[ip].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[Vl][n]}}return this[Vl][n]}}}function E1(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function xC(n,e){return E1(n,e)&&n[e]}function Oj(n){const e=n.componentName;return e||ft.warn(`${n.name}.componentName not specified`)(),e||n.name}let Nj=0;class cg{constructor(...e){this.props=Aj(this,e),this.id=this.props.id,this.count=Nj++}clone(e){const{props:t}=this,r={};for(const s in t[Vl])s in t[po]?r[s]=t[po][s]:s in t[Sa]&&(r[s]=t[Sa][s]);return new this.constructor({...t,...r,...e})}}cg.componentName="Component";cg.defaultProps={};const Dj=Object.freeze({});class Lj{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Dj}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return!!(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[ip]||this.component;const t=e[po]||{},r=e[Sa]||e,s=e[Vl]||{};for(const i in t){const o=t[i];this._createAsyncPropData(i,s[i]),this._updateAsyncProp(i,o),t[i]=this.getAsyncProp(i)}for(const i in r){const o=r[i];this._createAsyncPropData(i,s[i]),this._updateAsyncProp(i,o)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if(typeof t=="string"&&(t=this._fetch(e,t)),t instanceof Promise){this._watchPromise(e,t);return}if(lC(t)){this._resolveAsyncIterable(e,t);return}this._setPropValue(e,t)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const r=this.asyncProps[e];return t===r.resolvedValue||t===r.lastValue?!1:(r.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(t=this._postProcessValue(r,t),r.resolvedValue=t,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,t,r){const s=this.asyncProps[e];s&&r>=s.resolvedLoadCount&&t!==void 0&&(this._freezeAsyncOldProps(),s.resolvedValue=t,s.resolvedLoadCount=r,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const s=r.pendingLoadCount;t.then(i=>{this.component&&(i=this._postProcessValue(r,i),this._setAsyncPropValue(e,i,s),this._onResolve(e,i))}).catch(i=>{this._onError(e,i)})}}async _resolveAsyncIterable(e,t){if(e!=="data"){this._setPropValue(e,t);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const s=r.pendingLoadCount;let i=[],o=0;for await(const a of t){if(!this.component)return;const{dataTransform:u}=this.component.props;u?i=u(a,i):i=i.concat(a),Object.defineProperty(i,"__diff",{enumerable:!1,value:[{startRow:o,endRow:i.length}]}),o=i.length,this._setAsyncPropValue(e,i,s)}this._onResolve(e,i)}_postProcessValue(e,t){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(t,r,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const s=this.component&&this.component.props[_o];this.asyncProps[e]={type:s&&s[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class Fj extends Lj{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const r=this.layer,s=r==null?void 0:r.props.fetch;return s?s(t,{propName:e,layer:r}):super._fetch(e,t)}_onResolve(e,t){const r=this.layer;if(r){const s=r.props.onDataLoad;e==="data"&&s&&s(t,{propName:e,layer:r})}}_onError(e,t){const r=this.layer;r&&r.raiseError(t,`loading ${e} of ${this.layer}`)}}const Bj="layer.changeFlag",Uj="layer.initialize",Vj="layer.update",zj="layer.finalize",$j="layer.matched",OT=2**24-1,jj=Object.freeze([]),Wj=Ef(({oldViewport:n,viewport:e})=>n.equals(e));let Ls=new Uint8ClampedArray(0);const Hj={data:{type:"data",value:jj,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:n=>n&&n.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:r,loadOptions:s,signal:i})=>{const{resourceManager:o}=t.context;s=s||t.getLoadOptions(),r=r||t.props.loaders,i&&(s={...s,fetch:{...s==null?void 0:s.fetch,signal:i}});let a=o.contains(n);return!a&&!s&&(o.add({resourceId:n,data:Wh(n,r),persistent:!1}),a=!0),a?o.subscribe({resourceId:n,onChange:u=>{var f;return(f=t.internalState)==null?void 0:f.reloadAsyncProp(e,u)},consumerId:t.id,requestId:e}):Wh(n,r,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:tt.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,-n*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Br extends cg{constructor(){super(...arguments),this.internalState=null,this.lifecycle=Sl.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Un(this.internalState);const t=this.internalState.viewport||this.context.viewport,r=FA(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,i,o]=NA(r,t.pixelProjectionMatrix);return e.length===2?[s,i]:[s,i,o]}unproject(e){return Un(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){Un(this.internalState);const r=this.internalState.viewport||this.context.viewport;return K9(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setModuleParameters(e){for(const t of this.getModels())t.updateModuleSettings(e)}setShaderModuleProps(...e){for(const t of this.getModels())t.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===tt.DEFAULT||e===tt.LNGLAT||e===tt.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Un(e instanceof Uint8Array);const[t,r,s]=e;return t+r*256+s*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:vj(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){e=MT(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=MT(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&t)if(Array.isArray(r))for(const s of r)t.invalidateAll(s);else t.invalidateAll();if(t){const{props:s}=e,i=this.internalState.hasPickingBuffer,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable||s.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(i!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:u}=t.attributes,f=a||u;f&&(o&&f.constant&&(f.constant=!1,t.invalidate(f.id)),!f.value&&!o&&(f.constant=!0,f.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e)}getPickingInfo({info:e,mode:t,sourceLayer:r}){const{index:s}=e;return s>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[s]),e}raiseError(e,t){var r,s,i,o;t&&(e=new Error(`${t}: ${e.message}`,{cause:e})),(s=(r=this.props).onError)!=null&&s.call(r,e)||(o=(i=this.context)==null?void 0:i.onError)==null||o.call(i,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)==null?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,(!t||!Wj({oldViewport:t,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();t&&(e==="all"?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const r in e)e[r].layoutChanged()&&(t=!0);for(const r of this.getModels())this._setModelAttributes(r,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,r=this.getNumInstances(),s=this.getStartIndices();e.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),r=Object.create(this.props);for(const s in t)Object.defineProperty(r,s,{value:t[s]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const r=Math.floor(Ls.length/4);if(this.internalState.usesPickingColorCache=!0,r<t){t>OT&&ft.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ls=sc.allocate(Ls,t,{size:4,copy:!0,maxCount:Math.max(t,OT)});const s=Math.floor(Ls.length/4),i=[];for(let o=r;o<s;o++)this.encodePickingColor(o,i),Ls[o*4+0]=i[0],Ls[o*4+1]=i[1],Ls[o*4+2]=i[2]}e.value=Ls.subarray(0,t*4)}_setModelAttributes(e,t,r=!1){var a;if(!Object.keys(t).length)return;if(r){const u=this.getAttributeManager();e.setBufferLayout(u.getBufferLayouts(e)),t=u.getAttributes()}const s=((a=e.userData)==null?void 0:a.excludeAttributes)||{},i={},o={};for(const u in t){if(s[u])continue;const f=t[u].getValue();for(const d in f){const p=f[d];p instanceof fn?t[u].settings.isIndexed?e.setIndexBuffer(p):i[d]=p:p&&(o[d]=p)}}e.setAttributes(i),e.setConstantAttributes(o)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:s}=this.getAttributeManager().attributes,i=r||s,o=i&&t.attributes&&t.attributes[i.id];if(o&&o.value){const a=o.value,u=this.encodePickingColor(e);for(let f=0;f<t.length;f++){const d=i.getVertexOffset(f);a[d]===u[0]&&a[d+1]===u[1]&&a[d+2]===u[2]&&this._disablePickingIndex(f)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:r}=this.getAttributeManager().attributes,s=t||r;if(!s)return;const i=s.getVertexOffset(e),o=s.getVertexOffset(e+1);s.buffer.write(new Uint8Array(o-i),i)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,r=e||t;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Ls.buffer&&(r.value=Ls.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Un(!this.internalState),Un(Number.isFinite(this.props.coordinateSystem)),er(Uj,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Fj({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(ft.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new lj(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){er($j,this,this===e);const{state:t,internalState:r}=e;this!==e&&(this.internalState=r,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(er(Vj,this,e),!e)return;const t=this.props,r=this.context,s=this.internalState,i=r.viewport,o=this._updateUniformTransition();s.propsInTransition=o,r.viewport=s.viewport||i,this.props=o;try{const a=this._getUpdateParams(),u=this.getModels();if(r.device)this.updateState(a);else try{this.updateState(a)}catch{}for(const d of this.props.extensions)d.updateState.call(this,a,d);const f=this.getModels()[0]!==u[0];this._postUpdate(a,f)}finally{r.viewport=i,this.props=t,this._clearChangeFlags(),s.needsUpdate=!1,s.resetOldProps()}}_finalize(){er(zj,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,moduleParameters:t=null,uniforms:r={},parameters:s={}}){this._updateAttributeTransition();const i=this.props,o=this.context;this.props=this.internalState.propsInTransition||i;const a=this.props.opacity;r.opacity=Math.pow(a,1/2.2);try{if(t){const{isActive:d,isAttribute:p}=t.picking;this.setModuleParameters(t),this.setShaderModuleProps({picking:{isActive:d,isAttribute:p}})}const{getPolygonOffset:u}=this.props,f=u&&u(r)||[0,0];o.device.setParametersWebGL({polygonOffset:f});for(const d of this.getModels())d.setParameters(s);o.device.withParametersWebGL(s,()=>{const d={renderPass:e,moduleParameters:t,uniforms:r,parameters:s,context:o};for(const p of this.props.extensions)p.draw.call(this,d,p);this.draw(d)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)==null?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const s in e)if(e[s]){let i=!1;switch(s){case"dataChanged":const o=e[s],a=t[s];o&&Array.isArray(a)&&(t.dataChanged=Array.isArray(o)?a.concat(o):o,i=!0);default:t[s]||(t[s]=e[s],i=!0)}i&&er(Bj,this,s,e)}const r=!!(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=r,t.somethingChanged=r||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){var s;const r=uj(e,t);if(r.updateTriggersChanged)for(const i in r.updateTriggersChanged)r.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(r.transitionsChanged)for(const i in r.transitionsChanged)this.internalState.uniformTransitions.add(i,t[i],e[i],(s=e.transitions)==null?void 0:s[i]);return this.setChangeFlags(r)}validateProps(){cj(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(t.highlightColor=r(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new rj(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:r,oldProps:s}=e;this.setNeedsRedraw(),this._updateAttributes();const i=this.state.model;i!=null&&i.isInstanced&&i.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:u}=r;if(t||s.autoHighlight!==o||s.highlightedObjectIndex!==a||s.highlightColor!==u){const f={};Array.isArray(u)&&(f.highlightColor=u),(t||s.autoHighlight!==o||a!==s.highlightedObjectIndex)&&(f.highlightedObjectColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setShaderModuleProps({picking:f})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),s=r?r.getNeedsRedraw(e):!1;if(t=t||s,t)for(const i of this.props.extensions)i.onNeedsRedraw.call(this,i);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}Br.defaultProps=Hj;Br.layerName="Layer";const Xj="compositeLayer.renderLayers";class ss extends Br{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id&&(e.object=t.__source.object,e.index=t.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||t}getSubLayerRow(e,t,r){return e.__source={parent:this,object:t,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const t={index:-1,data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(t.index=r.__source.index,e(r.__source.object,t)):e(r,s)}return e}getSubLayerProps(e={}){var $;const{opacity:t,pickable:r,visible:s,parameters:i,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:u,highlightColor:f,coordinateSystem:d,coordinateOrigin:p,wrapLongitude:m,positionFormat:v,modelMatrix:x,extensions:b,fetch:w,operation:S,_subLayerProps:R}=this.props,C={id:"",updateTriggers:{},opacity:t,pickable:r,visible:s,parameters:i,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:u,highlightColor:f,coordinateSystem:d,coordinateOrigin:p,wrapLongitude:m,positionFormat:v,modelMatrix:x,extensions:b,fetch:w,operation:S},O=R&&e.id&&R[e.id],I=O&&O.updateTriggers,F=e.id||"sublayer";if(O){const q=this.props[_o],K=e.type?e.type._propTypes:{};for(const le in O){const he=K[le]||q[le];he&&he.type==="accessor"&&(O[le]=this.getSubLayerAccessor(O[le]))}}Object.assign(C,e,O),C.id=`${this.props.id}-${F}`,C.updateTriggers={all:($=this.props.updateTriggers)==null?void 0:$.all,...e.updateTriggers,...I};for(const q of b){const K=q.getSubLayerProps.call(this,q);K&&Object.assign(C,K,{updateTriggers:Object.assign(C.updateTriggers,K.updateTriggers)})}return C}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let r=this.internalState.subLayers;const s=!r||this.needsUpdate();if(s){const i=this.renderLayers();r=sg(i,Boolean),this.internalState.subLayers=r}er(Xj,this,s,r);for(const i of r)i.parent=this}}ss.layerName="CompositeLayer";const oh=Math.PI/180,NT=180/Math.PI,Sh=6370972,Nl=256;function Yj(){const n=Nl/Sh,e=Math.PI/180*Nl;return{unitsPerMeter:[n,n,n],unitsPerMeter2:[0,0,0],metersPerUnit:[1/n,1/n,1/n],unitsPerDegree:[e,e,n],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/n]}}class qj extends La{constructor(e={}){const{latitude:t=0,longitude:r=0,zoom:s=0,nearZMultiplier:i=.1,farZMultiplier:o=2,resolution:a=10}=e;let{height:u,altitude:f=1.5}=e;u=u||1,f=Math.max(.75,f);const d=new At().lookAt({eye:[0,-f,0],up:[0,0,1]}),p=Math.pow(2,s);d.rotateX(t*oh),d.rotateZ(-r*oh),d.scale(p/u);const m=Math.atan(.5/f),v=Nl*2*p/u;super({...e,height:u,viewMatrix:d,longitude:r,latitude:t,zoom:s,distanceScales:Yj(),fovyRadians:m*2,focalDistance:f,near:i,far:Math.min(2,1/v+1)*f*o}),this.latitude=t,this.longitude=r,this.resolution=a}get projectionMode(){return vs.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const t={targetZ:e.z||0},r=this.unproject([0,this.height/2],t),s=this.unproject([this.width/2,0],t),i=this.unproject([this.width,this.height/2],t),o=this.unproject([this.width/2,this.height],t);return i[0]<this.longitude&&(i[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}unproject(e,{topLeft:t=!0,targetZ:r}={}){const[s,i,o]=e,a=t?i:this.height-i,{pixelUnprojectionMatrix:u}=this;let f;if(Number.isFinite(o))f=dv(u,[s,a,o,1]);else{const v=dv(u,[s,a,-1,1]),x=dv(u,[s,a,1,1]),b=((r||0)/Sh+1)*Nl,w=k0(UE([],v,x)),S=k0(v),R=k0(x),O=4*((4*S*R-(w-S-R)**2)/16)/w,I=Math.sqrt(S-O),F=Math.sqrt(Math.max(0,b*b-O)),$=(I-F)/Math.sqrt(w);f=tO([],v,x,$)}const[d,p,m]=this.unprojectPosition(f);return Number.isFinite(o)?[d,p,m]:Number.isFinite(r)?[d,p,r]:[d,p]}projectPosition(e){const[t,r,s=0]=e,i=t*oh,o=r*oh,a=Math.cos(o),u=(s/Sh+1)*Nl;return[Math.sin(i)*a*u,-Math.cos(i)*a*u,Math.sin(o)*u]}unprojectPosition(e){const[t,r,s]=e,i=VE(e),o=Math.asin(s/i),u=Math.atan2(t,-r)*NT,f=o*NT,d=(i/Nl-1)*Sh;return[u,f,d]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,t){const r=this.unproject(t);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function dv(n,e){const t=fc([],e,n);return D_(t,t,1/t[3]),t}const Kj=new At().lookAt({eye:[0,0,1]});function Zj({width:n,height:e,near:t,far:r,padding:s}){let i=-n/2,o=n/2,a=-e/2,u=e/2;if(s){const{left:f=0,right:d=0,top:p=0,bottom:m=0}=s,v=un((f+n-d)/2,0,n)-n/2,x=un((p+e-m)/2,0,e)-e/2;i-=v,o-=v,a+=x,u+=x}return new At().ortho({left:i,right:o,bottom:a,top:u,near:t,far:r})}class Qj extends La{constructor(e){const{width:t,height:r,near:s=.1,far:i=1e3,zoom:o=0,target:a=[0,0,0],padding:u=null,flipY:f=!0}=e,d=Array.isArray(o)?o[0]:o,p=Array.isArray(o)?o[1]:o,m=Math.min(d,p),v=Math.pow(2,m);let x;if(d!==p){const b=Math.pow(2,d),w=Math.pow(2,p);x={unitsPerMeter:[b/v,w/v,1],metersPerUnit:[v/b,v/w,1]}}super({...e,longitude:void 0,position:a,viewMatrix:Kj.clone().scale([v,v*(f?-1:1),v]),projectionMatrix:Zj({width:t||1,height:r||1,padding:u,near:s,far:i}),zoom:m,distanceScales:x})}projectFlat([e,t]){const{unitsPerMeter:r}=this.distanceScales;return[e*r[0],t*r[1]]}unprojectFlat([e,t]){const{metersPerUnit:r}=this.distanceScales;return[e*r[0],t*r[1]]}panByPosition(e,t){const r=rg(t,this.pixelUnprojectionMatrix),s=this.projectFlat(e),i=Lh([],s,kE([],r)),o=Lh([],this.center,i);return{target:this.unprojectFlat(o)}}}class Gj extends $A{constructor(e){const{width:t,height:r,rotationX:s=0,rotationOrbit:i=0,target:o=[0,0,0],zoom:a=0,minRotationX:u=-90,maxRotationX:f=90,minZoom:d=-1/0,maxZoom:p=1/0,startPanPosition:m,startRotatePos:v,startRotationX:x,startRotationOrbit:b,startZoomPosition:w,startZoom:S}=e;super({width:t,height:r,rotationX:s,rotationOrbit:i,target:o,zoom:a,minRotationX:u,maxRotationX:f,minZoom:d,maxZoom:p},{startPanPosition:m,startRotatePos:v,startRotationX:x,startRotationOrbit:b,startZoomPosition:w,startZoom:S}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const r=this.getState().startPanPosition||t;if(!r)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:r=0}){const{startRotatePos:s,startRotationX:i,startRotationOrbit:o}=this.getState(),{width:a,height:u}=this.getViewportProps();if(!s||i===void 0||o===void 0)return this;let f;if(e){let d=(e[0]-s[0])/a;const p=(e[1]-s[1])/u;(i<-90||i>90)&&(d*=-1),f={rotationX:i+p*180,rotationOrbit:o+d*180}}else f={rotationX:i+r,rotationOrbit:o+t};return this._getUpdatedState(f)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),r={...this.getViewportProps()},{rotationOrbit:s}=r;return Math.abs(s-t.rotationOrbit)>180&&(r.rotationOrbit=s<0?s+360:s-360),r}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:r}){let{startZoom:s,startZoomPosition:i}=this.getState();if(i||(s=this.getViewportProps().zoom,i=this._unproject(t)||this._unproject(e)),!i)return this;const o=this._calculateNewZoom({scale:r,startZoom:s}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(i,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:r,minZoom:s}=this.getViewportProps();t===void 0&&(t=this.getViewportProps().zoom);const i=t+Math.log2(e);return un(i,s,r)}_panFromCenter(e){const{width:t,height:r,target:s}=this.getViewportProps();return this.pan({startPosition:s,pos:[t/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:t,minZoom:r,zoom:s,maxRotationX:i,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(s)?[un(s[0],r,t),un(s[1],r,t)]:un(s,r,t),e.rotationX=un(e.rotationX,o,i),(a<-180||a>180)&&(e.rotationOrbit=U9(a+180,360)-180),e}}class Jj extends Gj{constructor(e){super(e),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:r,minZoom:s}=this.getViewportProps();t===void 0&&(t=this.getViewportProps().zoom);let i=Math.log2(e);if(Array.isArray(t)){let[o,a]=t;switch(this.zoomAxis){case"X":o=un(o+i,s,r);break;case"Y":a=un(a+i,s,r);break;default:let u=Math.min(o+i,a+i);u<s&&(i+=s-u),u=Math.max(o+i,a+i),u>r&&(i+=r-u),o+=i,a+=i}return[o,a]}return un(t+i,s,r)}}class eW extends zA{constructor(){super(...arguments),this.ControllerState=Jj,this.transition={transitionDuration:300,transitionInterpolator:new y1(["target","zoom"])},this.dragMode="pan"}_onPanRotate(){return!1}}class A1 extends Ea{constructor(e={}){super(e)}get ViewportType(){return Qj}get ControllerType(){return eW}}A1.displayName="OrthographicView";class Fa{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&Qr(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:t}=e.constructor,r={updateTriggers:{}};for(const s in t)if(s in this.props){const i=t[s],o=this.props[s];r[s]=o,i&&i.type==="accessor"&&(r.updateTriggers[s]=this.props.updateTriggers[s],typeof o=="function"&&(r[s]=this.getSubLayerAccessor(o)))}return r}initializeState(e,t){}updateState(e,t){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,t){}finalizeState(e,t){}}Fa.defaultProps={};Fa.extensionName="LayerExtension";class bC{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:t={}}=e;this.typedArrayManager=sc,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:r={},getGeometry:s,geometryBuffer:i,positionFormat:o,dataChanged:a,normalize:u=!0}=this.opts;if(this.data=t,this.getGeometry=s,this.positionSize=i&&i.size||(o==="XY"?2:3),this.buffers=r,this.normalize=u,i&&(Un(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),u||(r.vertexPositions=i)),this.geometryBuffer=r.vertexPositions,Array.isArray(a))for(const f of a)this._rebuildGeometry(f);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:t}){this._rebuildGeometry({startRow:e,endRow:t})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?cC(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:r,buffers:s,_attributeDefs:i,typedArrayManager:o}=this;for(const a in i)if(a in s)o.release(r[a]),r[a]=null;else{const u=i[a];u.copy=t,r[a]=o.allocate(r[a],e,u)}}_forEachGeometry(e,t,r){const{data:s,getGeometry:i}=this,{iterable:o,objectInfo:a}=Cf(s,t,r);for(const u of o){a.index++;const f=i?i(u,a):null;e(f,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:r,instanceCount:s}=this;const{data:i,geometryBuffer:o}=this,{startRow:a=0,endRow:u=1/0}=e||{},f={};if(e||(t=[0],r=[0]),this.normalize||!o)this._forEachGeometry((p,m)=>{const v=p&&this.normalizeGeometry(p);f[m]=v,r[m+1]=r[m]+(v?this.getGeometrySize(v):0)},a,u),s=r[r.length-1];else if(r=i.startIndices,s=r[i.length]||0,ArrayBuffer.isView(o))s=s||o.length/this.positionSize;else if(o instanceof fn){const p=this.positionSize*4;s=s||o.byteLength/p}else if(o.buffer){const p=o.stride||this.positionSize*4;s=s||o.buffer.byteLength/p}else if(o.value){const p=o.value,m=o.stride/p.BYTES_PER_ELEMENT||this.positionSize;s=s||p.length/m}this._allocate(s,!!e),this.indexStarts=t,this.vertexStarts=r,this.instanceCount=s;const d={};this._forEachGeometry((p,m)=>{const v=f[m]||p;d.vertexStart=r[m],d.indexStart=t[m];const x=m<r.length-1?r[m+1]:s;d.geometrySize=x-r[m],d.geometryIndex=m,this.updateGeometryAttributes(v,d)},a,u),this.vertexCount=t[t.length-1]}}const tW=new Uint32Array([0,2,1,0,3,2]),nW=new Float32Array([0,1,0,0,1,0,1,1]);function rW(n,e){if(!e)return sW(n);const t=Math.max(Math.abs(n[0][0]-n[3][0]),Math.abs(n[1][0]-n[2][0])),r=Math.max(Math.abs(n[1][1]-n[0][1]),Math.abs(n[2][1]-n[3][1])),s=Math.ceil(t/e)+1,i=Math.ceil(r/e)+1,o=(s-1)*(i-1)*6,a=new Uint32Array(o),u=new Float32Array(s*i*2),f=new Float64Array(s*i*3);let d=0,p=0;for(let m=0;m<s;m++){const v=m/(s-1);for(let x=0;x<i;x++){const b=x/(i-1),w=iW(n,v,b);f[d*3+0]=w[0],f[d*3+1]=w[1],f[d*3+2]=w[2]||0,u[d*2+0]=v,u[d*2+1]=1-b,m>0&&x>0&&(a[p++]=d-i,a[p++]=d-i-1,a[p++]=d-1,a[p++]=d-i,a[p++]=d-1,a[p++]=d),d++}}return{vertexCount:o,positions:f,indices:a,texCoords:u}}function sW(n){const e=new Float64Array(12);for(let t=0;t<n.length;t++)e[t*3+0]=n[t][0],e[t*3+1]=n[t][1],e[t*3+2]=n[t][2]||0;return{vertexCount:6,positions:e,indices:tW,texCoords:nW}}function iW(n,e,t){return da(da(n[0],n[1],t),da(n[3],n[2],t),e)}const oW=`#version 300 es
#define SHADER_NAME bitmap-layer-vertex-shader

in vec2 texCoords;
in vec3 positions;
in vec3 positions64Low;

out vec2 vTexCoord;
out vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,aW=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,lW=`#version 300 es
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

in vec2 vTexCoord;
in vec2 vTexPos;

out vec4 fragColor;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

${aW}

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture(bitmapTexture, uv);

  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(fragColor, geometry);

  if (bool(picking.isActive) && !bool(picking.isAttribute)) {
    // Since instance information is not used, we can use picking color for pixel index
    fragColor.rgb = packUVsIntoRGB(uv);
  }
}
`,cW={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:tt.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0,value:null}};let Rf=class extends Br{getShaders(){return super.getShaders({vs:oW,fs:lW,modules:[Oo,No]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const t=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:t},positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:t},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:t}})}updateState({props:e,oldProps:t,changeFlags:r}){var i;const s=this.getAttributeManager();if(r.extensionsChanged&&((i=this.state.model)==null||i.destroy(),this.state.model=this._getModel(),s.invalidateAll()),e.bounds!==t.bounds){const o=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const u in a)o&&o[u]!==a[u]&&s.invalidate(u);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==t._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:t}=this.props,r=e.info;if(!r.color||!t)return r.bitmap=null,r;const{width:s,height:i}=t;r.index=0;const o=uW(r.color);return r.bitmap={size:{width:s,height:i},uv:o,pixel:[Math.floor(o[0]*s),Math.floor(o[1]*i)]},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let t=e;return DT(e)&&(t=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),rW(t,this.context.viewport.resolution)}_getModel(){return new rr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1})}draw(e){const{uniforms:t,moduleParameters:r}=e,{model:s,coordinateConversion:i,bounds:o,disablePicking:a}=this.state,{image:u,desaturate:f,transparentColor:d,tintColor:p}=this.props;r.picking.isActive&&a||u&&s&&(s.setUniforms(t),s.setBindings({bitmapTexture:u}),s.setUniforms({desaturate:f,transparentColor:d.map(m=>m/255),tintColor:p.slice(0,3).map(m=>m/255),coordinateConversion:i,bounds:o}),s.draw(this.context.renderPass))}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:t,DEFAULT:r}=tt;let{_imageCoordinateSystem:s}=this.props;if(s!==r){const{bounds:i}=this.props;if(!DT(i))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const o=this.context.viewport.resolution?e:t;if(s=s===e?e:t,s===e&&o===t)return{coordinateConversion:-1,bounds:i};if(s===t&&o===e){const a=Eo([i[0],i[1]]),u=Eo([i[2],i[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],u[0],u[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}};Rf.layerName="BitmapLayer";Rf.defaultProps=cW;function uW(n){const[e,t,r]=n,s=(r&240)/256,i=(r&15)/16;return[(e+i)/256,(t+s)/256]}function DT(n){return Number.isFinite(n[0])}const fW=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`,dW=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * opacity * vColor.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,hW=1024,pW=4,LT=()=>{},FT={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},gW={x:0,y:0,width:0,height:0};function mW(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function vW(n,e,t,r){const s=Math.min(t/e.width,r/e.height),i=Math.floor(e.width*s),o=Math.floor(e.height*s);return s===1?{data:e,width:i,height:o}:(n.canvas.height=o,n.canvas.width=i,n.clearRect(0,0,i,o),n.drawImage(e,0,0,e.width,e.height,0,0,i,o),{data:n.canvas,width:i,height:o})}function Ku(n){return n&&(n.id||n.url)}function yW(n,e,t,r){const{width:s,height:i,device:o}=n,a=o.createTexture({format:"rgba8unorm",width:e,height:t,sampler:r}),u=o.createCommandEncoder();return u.copyTextureToTexture({source:n,destination:a,width:s,height:i}),u.finish(),n.destroy(),a}function BT(n,e,t){for(let r=0;r<e.length;r++){const{icon:s,xOffset:i}=e[r],o=Ku(s);n[o]={...s,x:i,y:t}}}function _W({icons:n,buffer:e,mapping:t={},xOffset:r=0,yOffset:s=0,rowHeight:i=0,canvasWidth:o}){let a=[];for(let u=0;u<n.length;u++){const f=n[u],d=Ku(f);if(!t[d]){const{height:p,width:m}=f;r+m+e>o&&(BT(t,a,s),r=0,s=i+s+e,i=0,a=[]),a.push({icon:f,xOffset:r}),r=r+m+e,i=Math.max(i,p)}}return a.length>0&&BT(t,a,s),{mapping:t,rowHeight:i,xOffset:r,yOffset:s,canvasWidth:o,canvasHeight:mW(i+s+e)}}function xW(n,e,t){if(!n||!e)return null;t=t||{};const r={},{iterable:s,objectInfo:i}=Cf(n);for(const o of s){i.index++;const a=e(o,i),u=Ku(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[u]&&(!t[u]||a.url!==t[u].url)&&(r[u]={...a,source:o,sourceIndex:i.index})}return r}class bW{constructor(e,{onUpdate:t=LT,onError:r=LT}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._textureParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=pW,this._canvasWidth=hW,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=t,this.onError=r}finalize(){var e;(e=this._texture)==null||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?Ku(e):e;return this._mapping[t]||gW}setProps({loadOptions:e,autoPacking:t,iconAtlas:r,iconMapping:s,textureParameters:i}){var o;e&&(this._loadOptions=e),t!==void 0&&(this._autoPacking=t),s&&(this._mapping=s),r&&((o=this._texture)==null||o.delete(),this._texture=null,this._externalTexture=r),i&&(this._textureParameters=i)}get isLoaded(){return this._pendingCount===0}packIcons(e,t){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(xW(e,t,this._mapping)||{});if(r.length>0){const{mapping:s,xOffset:i,yOffset:o,rowHeight:a,canvasHeight:u}=_W({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=s,this._xOffset=i,this._yOffset=o,this._canvasHeight=u,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._textureParameters||FT})),this._texture.height!==this._canvasHeight&&(this._texture=yW(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||FT)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const t=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,Wh(r.url,this._loadOptions).then(s=>{const i=Ku(r),o=this._mapping[i],{x:a,y:u,width:f,height:d}=o,{data:p,width:m,height:v}=vW(t,s,f,d);this._texture.setSubImageData({data:p,x:a+(f-m)/2,y:u+(d-v)/2,width:m,height:v}),o.width=m,o.height=v,this._texture.generateMipmap(),this.onUpdate()}).catch(s=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:s})}).finally(()=>{this._pendingCount--})}}const wC=[0,0,0,255],wW={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:wC},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class ug extends Br{getShaders(){return super.getShaders({vs:fW,fs:dW,modules:[Oo,No]})}initializeState(){this.state={iconManager:new bW(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:wC},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){var v;super.updateState(e);const{props:t,oldProps:r,changeFlags:s}=e,i=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:u,getIcon:f,textureParameters:d}=t,{iconManager:p}=this.state;if(typeof o=="string")return;const m=o||this.internalState.isAsyncPropLoading("iconAtlas");p.setProps({loadOptions:t.loadOptions,autoPacking:!m,iconAtlas:o,iconMapping:m?a:null,textureParameters:d}),m?r.iconMapping!==t.iconMapping&&i.invalidate("getIcon"):(s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged.getIcon))&&p.packIcons(u,f),s.extensionsChanged&&((v=this.state.model)==null||v.destroy(),this.state.model=this._getModel(),i.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:t,sizeMinPixels:r,sizeMaxPixels:s,sizeUnits:i,billboard:o,alphaCutoff:a}=this.props,{iconManager:u}=this.state,f=u.getTexture();if(f){const d=this.state.model;d.setBindings({iconsTexture:f}),d.setUniforms(e),d.setUniforms({iconsTextureDim:[f.width,f.height],sizeUnits:So[i],sizeScale:t,sizeMinPixels:r,sizeMaxPixels:s,billboard:o,alphaCutoff:a}),d.draw(this.context.renderPass)}}_getModel(){const e=[-1,-1,1,-1,-1,1,1,1];return new rr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new _i({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var r;const t=(r=this.getCurrentLayer())==null?void 0:r.props.onIconError;t?t(e):ft.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:r,anchorX:s=t/2,anchorY:i=r/2}=this.state.iconManager.getIconMapping(e);return[t/2-s,r/2-i]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:r,width:s,height:i}=this.state.iconManager.getIconMapping(e);return[t,r,s,i]}}ug.defaultProps=wW;ug.layerName="IconLayer";const TW=`#version 300 es
#define SHADER_NAME line-layer-vertex-shader
in vec3 positions;
in vec3 instanceSourcePositions;
in vec3 instanceTargetPositions;
in vec3 instanceSourcePositions64Low;
in vec3 instanceTargetPositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in float instanceWidths;
uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float useShortestPath;
uniform int widthUnits;
out vec4 vColor;
out vec2 uv;
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
return dir_screenspace * offset_direction * width / 2.0;
}
vec3 splitLine(vec3 a, vec3 b, float x) {
float t = (x - a.x) / (b.x - a.x);
return vec3(x, mix(a.yz, b.yz, t));
}
void main(void) {
geometry.worldPosition = instanceSourcePositions;
geometry.worldPositionAlt = instanceTargetPositions;
vec3 source_world = instanceSourcePositions;
vec3 target_world = instanceTargetPositions;
vec3 source_world_64low = instanceSourcePositions64Low;
vec3 target_world_64low = instanceTargetPositions64Low;
if (useShortestPath > 0.5 || useShortestPath < -0.5) {
source_world.x = mod(source_world.x + 180., 360.0) - 180.;
target_world.x = mod(target_world.x + 180., 360.0) - 180.;
float deltaLng = target_world.x - source_world.x;
if (deltaLng * useShortestPath > 180.) {
source_world.x += 360. * useShortestPath;
source_world = splitLine(source_world, target_world, 180. * useShortestPath);
source_world_64low = vec3(0.0);
} else if (deltaLng * useShortestPath < -180.) {
target_world.x += 360. * useShortestPath;
target_world = splitLine(source_world, target_world, 180. * useShortestPath);
target_world_64low = vec3(0.0);
} else if (useShortestPath < 0.) {
gl_Position = vec4(0.);
return;
}
}
vec4 source_commonspace;
vec4 target_commonspace;
vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);
vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);
float segmentIndex = positions.x;
vec4 p = mix(source, target, segmentIndex);
geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);
uv = positions.xy;
geometry.uv = uv;
geometry.pickingColor = instancePickingColors;
float widthPixels = clamp(
project_size_to_pixel(instanceWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels
);
vec3 offset = vec3(
getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),
0.0);
DECKGL_FILTER_SIZE(offset, geometry);
DECKGL_FILTER_GL_POSITION(p, geometry);
gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,SW=`#version 300 es
#define SHADER_NAME line-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,EW=[0,0,0,255],AW={getSourcePosition:{type:"accessor",value:n=>n.sourcePosition},getTargetPosition:{type:"accessor",value:n=>n.targetPosition},getColor:{type:"accessor",value:EW},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class Ou extends Br{getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:TW,fs:SW,modules:[Oo,No]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(e){var t;super.updateState(e),e.changeFlags.extensionsChanged&&((t=this.state.model)==null||t.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{widthUnits:t,widthScale:r,widthMinPixels:s,widthMaxPixels:i,wrapLongitude:o}=this.props,a=this.state.model;a.setUniforms(e),a.setUniforms({widthUnits:So[t],widthScale:r,widthMinPixels:s,widthMaxPixels:i,useShortestPath:o?1:0}),a.draw(this.context.renderPass),o&&(a.setUniforms({useShortestPath:-1}),a.draw(this.context.renderPass))}_getModel(){const e=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new rr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new _i({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(e)}}}),isInstanced:!0})}}Ou.layerName="LineLayer";Ou.defaultProps=AW;const CW=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
radiusMinPixels, radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
lineWidthMinPixels, lineWidthMaxPixels
);
outerRadiusPixels += stroked * lineWidthPixels / 2.0;
float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
if (billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,RW=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
uniform bool filled;
uniform float stroked;
uniform bool antialiasing;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (stroked > 0.5) {
float isLine = antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (filled) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (!filled) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,UT=[0,0,0,255],PW={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:n=>n.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:UT},getLineColor:{type:"accessor",value:UT},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class C1 extends Br{getShaders(){return super.getShaders({vs:CW,fs:RW,modules:[Oo,No]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var t;super.updateState(e),e.changeFlags.extensionsChanged&&((t=this.state.model)==null||t.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:t,radiusScale:r,radiusMinPixels:s,radiusMaxPixels:i,stroked:o,filled:a,billboard:u,antialiasing:f,lineWidthUnits:d,lineWidthScale:p,lineWidthMinPixels:m,lineWidthMaxPixels:v}=this.props,x=this.state.model;x.setUniforms(e),x.setUniforms({stroked:o?1:0,filled:a,billboard:u,antialiasing:f,radiusUnits:So[t],radiusScale:r,radiusMinPixels:s,radiusMaxPixels:i,lineWidthUnits:So[d],lineWidthScale:p,lineWidthMinPixels:m,lineWidthMaxPixels:v}),x.draw(this.context.renderPass)}_getModel(){const e=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new rr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new _i({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(e)}}}),isInstanced:!0})}}C1.defaultProps=PW;C1.layerName="ScatterplotLayer";const TC={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function SC(n,e,t={}){return IW(n,t)!==e?(MW(n,t),!0):!1}function IW(n,e={}){return Math.sign(kW(n,e))}const VT={x:0,y:1,z:2};function kW(n,e={}){const{start:t=0,end:r=n.length,plane:s="xy"}=e,i=e.size||2;let o=0;const a=VT[s[0]],u=VT[s[1]];for(let f=t,d=r-i;f<r;f+=i)o+=(n[f+a]-n[d+a])*(n[f+u]+n[d+u]),d=f;return o/2}function MW(n,e){const{start:t=0,end:r=n.length,size:s=2}=e,i=(r-t)/s,o=Math.floor(i/2);for(let a=0;a<o;++a){const u=t+a*s,f=t+(i-1-a)*s;for(let d=0;d<s;++d){const p=n[u+d];n[u+d]=n[f+d],n[f+d]=p}}}function _s(n,e){const t=e.length,r=n.length;if(r>0){let s=!0;for(let i=0;i<t;i++)if(n[r-t+i]!==e[i]){s=!1;break}if(s)return!1}for(let s=0;s<t;s++)n[r+s]=e[s];return!0}function Wy(n,e){const t=e.length;for(let r=0;r<t;r++)n[r]=e[r]}function Zu(n,e,t,r,s=[]){const i=r+e*t;for(let o=0;o<t;o++)s[o]=n[i+o];return s}function Hy(n,e,t,r,s=[]){let i,o;if(t&8)i=(r[3]-n[1])/(e[1]-n[1]),o=3;else if(t&4)i=(r[1]-n[1])/(e[1]-n[1]),o=1;else if(t&2)i=(r[2]-n[0])/(e[0]-n[0]),o=2;else if(t&1)i=(r[0]-n[0])/(e[0]-n[0]),o=0;else return null;for(let a=0;a<n.length;a++)s[a]=(o&1)===a?r[o]:i*(e[a]-n[a])+n[a];return s}function Eh(n,e){let t=0;return n[0]<e[0]?t|=1:n[0]>e[2]&&(t|=2),n[1]<e[1]?t|=4:n[1]>e[3]&&(t|=8),t}function EC(n,e){const{size:t=2,broken:r=!1,gridResolution:s=10,gridOffset:i=[0,0],startIndex:o=0,endIndex:a=n.length}=e||{},u=(a-o)/t;let f=[];const d=[f],p=Zu(n,0,t,o);let m,v;const x=CC(p,s,i,[]),b=[];_s(f,p);for(let w=1;w<u;w++){for(m=Zu(n,w,t,o,m),v=Eh(m,x);v;){Hy(p,m,v,x,b);const S=Eh(b,x);S&&(Hy(p,b,S,x,b),v=S),_s(f,b),Wy(p,b),NW(x,s,v),r&&f.length>t&&(f=[],d.push(f),_s(f,p)),v=Eh(m,x)}_s(f,m),Wy(p,m)}return r?d:d[0]}const zT=0,OW=1;function AC(n,e=null,t){if(!n.length)return[];const{size:r=2,gridResolution:s=10,gridOffset:i=[0,0],edgeTypes:o=!1}=t||{},a=[],u=[{pos:n,types:o?new Array(n.length/r).fill(OW):null,holes:e||[]}],f=[[],[]];let d=[];for(;u.length;){const{pos:p,types:m,holes:v}=u.shift();DW(p,r,v[0]||p.length,f),d=CC(f[0],s,i,d);const x=Eh(f[1],d);if(x){let b=$T(p,m,r,0,v[0]||p.length,d,x);const w={pos:b[0].pos,types:b[0].types,holes:[]},S={pos:b[1].pos,types:b[1].types,holes:[]};u.push(w,S);for(let R=0;R<v.length;R++)b=$T(p,m,r,v[R],v[R+1]||p.length,d,x),b[0]&&(w.holes.push(w.pos.length),w.pos=ah(w.pos,b[0].pos),o&&(w.types=ah(w.types,b[0].types))),b[1]&&(S.holes.push(S.pos.length),S.pos=ah(S.pos,b[1].pos),o&&(S.types=ah(S.types,b[1].types)))}else{const b={positions:p};o&&(b.edgeTypes=m),v.length&&(b.holeIndices=v),a.push(b)}}return a}function $T(n,e,t,r,s,i,o){const a=(s-r)/t,u=[],f=[],d=[],p=[],m=[];let v,x,b;const w=Zu(n,a-1,t,r);let S=Math.sign(o&8?w[1]-i[3]:w[0]-i[2]),R=e&&e[a-1],C=0,O=0;for(let I=0;I<a;I++)v=Zu(n,I,t,r,v),x=Math.sign(o&8?v[1]-i[3]:v[0]-i[2]),b=e&&e[r/t+I],x&&S&&S!==x&&(Hy(w,v,o,i,m),_s(u,m)&&d.push(R),_s(f,m)&&p.push(R)),x<=0?(_s(u,v)&&d.push(b),C-=x):d.length&&(d[d.length-1]=zT),x>=0?(_s(f,v)&&p.push(b),O+=x):p.length&&(p[p.length-1]=zT),Wy(w,v),S=x,R=b;return[C?{pos:u,types:e&&d}:null,O?{pos:f,types:e&&p}:null]}function CC(n,e,t,r){const s=Math.floor((n[0]-t[0])/e)*e+t[0],i=Math.floor((n[1]-t[1])/e)*e+t[1];return r[0]=s,r[1]=i,r[2]=s+e,r[3]=i+e,r}function NW(n,e,t){t&8?(n[1]+=e,n[3]+=e):t&4?(n[1]-=e,n[3]-=e):t&2?(n[0]+=e,n[2]+=e):t&1&&(n[0]-=e,n[2]-=e)}function DW(n,e,t,r){let s=1/0,i=-1/0,o=1/0,a=-1/0;for(let u=0;u<t;u+=e){const f=n[u],d=n[u+1];s=f<s?f:s,i=f>i?f:i,o=d<o?d:o,a=d>a?d:a}return r[0][0]=s,r[0][1]=o,r[1][0]=i,r[1][1]=a,r}function ah(n,e){for(let t=0;t<e.length;t++)n.push(e[t]);return n}const LW=85.051129;function FW(n,e){const{size:t=2,startIndex:r=0,endIndex:s=n.length,normalize:i=!0}=e||{},o=n.slice(r,s);RC(o,t,0,s-r);const a=EC(o,{size:t,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(i)for(const u of a)PC(u,t);return a}function BW(n,e=null,t){const{size:r=2,normalize:s=!0,edgeTypes:i=!1}=t||{};e=e||[];const o=[],a=[];let u=0,f=0;for(let p=0;p<=e.length;p++){const m=e[p]||n.length,v=f,x=UW(n,r,u,m);for(let b=x;b<m;b++)o[f++]=n[b];for(let b=u;b<x;b++)o[f++]=n[b];RC(o,r,v,f),VW(o,r,v,f,t==null?void 0:t.maxLatitude),u=m,a[p]=f}a.pop();const d=AC(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:i});if(s)for(const p of d)PC(p.positions,r);return d}function UW(n,e,t,r){let s=-1,i=-1;for(let o=t+1;o<r;o+=e){const a=Math.abs(n[o]);a>s&&(s=a,i=o-1)}return i}function VW(n,e,t,r,s=LW){const i=n[t],o=n[r-e];if(Math.abs(i-o)>180){const a=Zu(n,0,e,t);a[0]+=Math.round((o-i)/360)*360,_s(n,a),a[1]=Math.sign(a[1])*s,_s(n,a),a[0]=i,_s(n,a)}}function RC(n,e,t,r){let s=n[0],i;for(let o=t;o<r;o+=e){i=n[o];const a=i-s;(a>180||a<-180)&&(i-=Math.round(a/360)*360),n[o]=s=i}}function PC(n,e){let t;const r=n.length/e;for(let i=0;i<r&&(t=n[i*e],(t+180)%360===0);i++);const s=-Math.round(t/360)*360;if(s!==0)for(let i=0;i<r;i++)n[i*e]+=s}function zW(n,e,t,r){let s;if(Array.isArray(n[0])){const i=n.length*e;s=new Array(i);for(let o=0;o<n.length;o++)for(let a=0;a<e;a++)s[o*e+a]=n[o][a]||0}else s=n;return t?EC(s,{size:e,gridResolution:t}):r?FW(s,{size:e}):s}const $W=1,jW=2,hv=4;class WW extends bC{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?zW(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(jT(e)){let r=0;for(const s of e)r+=this.getGeometrySize(s);return r}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(t.geometrySize!==0)if(e&&jT(e))for(const r of e){const s=this.getGeometrySize(r);t.geometrySize=s,this.updateGeometryAttributes(r,t),t.vertexStart+=s}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const r=this.attributes.segmentTypes,s=e?this.isClosed(e):!1,{vertexStart:i,geometrySize:o}=t;r.fill(0,i,i+o),s?(r[i]=hv,r[i+o-2]=hv):(r[i]+=$W,r[i+o-2]+=jW),r[i+o-1]=hv}_updatePositions(e,t){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:s,geometrySize:i}=t,o=new Array(3);for(let a=s,u=0;u<i;a++,u++)this.getPointOnPath(e,u,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t,r=[]){const{positionSize:s}=this;t*s>=e.length&&(t+=1-e.length/s);const i=t*s;return r[0]=e[i],r[1]=e[i+1],r[2]=s===3&&e[i+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:t}=this,r=e.length-t;return e[0]===e[r]&&e[1]===e[r+1]&&(t===2||e[2]===e[r+2])}}function jT(n){return Array.isArray(n[0])}const HW=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = capType;
} else {
vJointType = jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0);
vec3 width;
if (billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,XW=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
uniform float miterLimit;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,IC=[0,0,0,255],YW={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:n=>n.path},getColor:{type:"accessor",value:IC},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},pv={enter:(n,e)=>e.length?e.subarray(e.length-n.length):n};class fg extends Br{getShaders(){return super.getShaders({vs:HW,fs:XW,modules:[Oo,No]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:pv,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:pv,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:pv,defaultValue:IC},instancePickingColors:{size:4,type:"uint8",accessor:(r,{index:s,target:i})=>this.encodePickingColor(r&&r.__source?r.__source.index:s,i)}}),this.setState({pathTesselator:new WW({fp64:this.use64bitPositions()})})}updateState(e){var o;super.updateState(e);const{props:t,changeFlags:r}=e,s=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,u=t.data.attributes||{};a.updateGeometry({data:t.data,geometryBuffer:u.getPath,buffers:u,normalize:!t._pathType,loop:t._pathType==="loop",getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||s.invalidateAll()}r.extensionsChanged&&((o=this.state.model)==null||o.destroy(),this.state.model=this._getModel(),s.invalidateAll())}getPickingInfo(e){const t=super.getPickingInfo(e),{index:r}=t,s=this.props.data;return s[0]&&s[0].__source&&(t.object=s.find(i=>i.__source.index===r)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let r=0;r<t.length;r++)t[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:t,capRounded:r,billboard:s,miterLimit:i,widthUnits:o,widthScale:a,widthMinPixels:u,widthMaxPixels:f}=this.props,d=this.state.model;d.setUniforms(e),d.setUniforms({jointType:Number(t),capType:Number(r),billboard:s,widthUnits:So[o],widthScale:a,miterLimit:i,widthMinPixels:u,widthMaxPixels:f}),d.draw(this.context.renderPass)}_getModel(){const e=[0,1,2,1,4,2,1,3,4,3,5,4],t=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new rr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new _i({topology:"triangle-list",attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(t),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}fg.defaultProps=YW;fg.layerName="PathLayer";var lh={exports:{}},WT;function qW(){if(WT)return lh.exports;WT=1,lh.exports=n,lh.exports.default=n;function n(U,H,D){D=D||2;var Y=H&&H.length,M=Y?H[0]*D:U.length,T=e(U,0,M,D,!0),N=[];if(!T||T.next===T.prev)return N;var W,Z,te,re,ue,ve,be;if(Y&&(T=u(U,H,T,D)),U.length>80*D){W=te=U[0],Z=re=U[1];for(var Pe=D;Pe<M;Pe+=D)ue=U[Pe],ve=U[Pe+1],ue<W&&(W=ue),ve<Z&&(Z=ve),ue>te&&(te=ue),ve>re&&(re=ve);be=Math.max(te-W,re-Z),be=be!==0?32767/be:0}return r(T,N,D,W,Z,be,0),N}function e(U,H,D,Y,M){var T,N;if(M===Me(U,H,D,Y)>0)for(T=H;T<D;T+=Y)N=pe(T,U[T],U[T+1],N);else for(T=D-Y;T>=H;T-=Y)N=pe(T,U[T],U[T+1],N);return N&&O(N,N.next)&&(se(N),N=N.next),N}function t(U,H){if(!U)return U;H||(H=U);var D=U,Y;do if(Y=!1,!D.steiner&&(O(D,D.next)||C(D.prev,D,D.next)===0)){if(se(D),D=H=D.prev,D===D.next)break;Y=!0}else D=D.next;while(Y||D!==H);return H}function r(U,H,D,Y,M,T,N){if(U){!N&&T&&v(U,Y,M,T);for(var W=U,Z,te;U.prev!==U.next;){if(Z=U.prev,te=U.next,T?i(U,Y,M,T):s(U)){H.push(Z.i/D|0),H.push(U.i/D|0),H.push(te.i/D|0),se(U),U=te.next,W=te.next;continue}if(U=te,U===W){N?N===1?(U=o(t(U),H,D),r(U,H,D,Y,M,T,2)):N===2&&a(U,H,D,Y,M,T):r(t(U),H,D,Y,M,T,1);break}}}}function s(U){var H=U.prev,D=U,Y=U.next;if(C(H,D,Y)>=0)return!1;for(var M=H.x,T=D.x,N=Y.x,W=H.y,Z=D.y,te=Y.y,re=M<T?M<N?M:N:T<N?T:N,ue=W<Z?W<te?W:te:Z<te?Z:te,ve=M>T?M>N?M:N:T>N?T:N,be=W>Z?W>te?W:te:Z>te?Z:te,Pe=Y.next;Pe!==H;){if(Pe.x>=re&&Pe.x<=ve&&Pe.y>=ue&&Pe.y<=be&&S(M,W,T,Z,N,te,Pe.x,Pe.y)&&C(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.next}return!0}function i(U,H,D,Y){var M=U.prev,T=U,N=U.next;if(C(M,T,N)>=0)return!1;for(var W=M.x,Z=T.x,te=N.x,re=M.y,ue=T.y,ve=N.y,be=W<Z?W<te?W:te:Z<te?Z:te,Pe=re<ue?re<ve?re:ve:ue<ve?ue:ve,Ue=W>Z?W>te?W:te:Z>te?Z:te,Ke=re>ue?re>ve?re:ve:ue>ve?ue:ve,nt=b(be,Pe,H,D,Y),Ge=b(Ue,Ke,H,D,Y),He=U.prevZ,Ie=U.nextZ;He&&He.z>=nt&&Ie&&Ie.z<=Ge;){if(He.x>=be&&He.x<=Ue&&He.y>=Pe&&He.y<=Ke&&He!==M&&He!==N&&S(W,re,Z,ue,te,ve,He.x,He.y)&&C(He.prev,He,He.next)>=0||(He=He.prevZ,Ie.x>=be&&Ie.x<=Ue&&Ie.y>=Pe&&Ie.y<=Ke&&Ie!==M&&Ie!==N&&S(W,re,Z,ue,te,ve,Ie.x,Ie.y)&&C(Ie.prev,Ie,Ie.next)>=0))return!1;Ie=Ie.nextZ}for(;He&&He.z>=nt;){if(He.x>=be&&He.x<=Ue&&He.y>=Pe&&He.y<=Ke&&He!==M&&He!==N&&S(W,re,Z,ue,te,ve,He.x,He.y)&&C(He.prev,He,He.next)>=0)return!1;He=He.prevZ}for(;Ie&&Ie.z<=Ge;){if(Ie.x>=be&&Ie.x<=Ue&&Ie.y>=Pe&&Ie.y<=Ke&&Ie!==M&&Ie!==N&&S(W,re,Z,ue,te,ve,Ie.x,Ie.y)&&C(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.nextZ}return!0}function o(U,H,D){var Y=U;do{var M=Y.prev,T=Y.next.next;!O(M,T)&&I(M,Y,Y.next,T)&&K(M,T)&&K(T,M)&&(H.push(M.i/D|0),H.push(Y.i/D|0),H.push(T.i/D|0),se(Y),se(Y.next),Y=U=T),Y=Y.next}while(Y!==U);return t(Y)}function a(U,H,D,Y,M,T){var N=U;do{for(var W=N.next.next;W!==N.prev;){if(N.i!==W.i&&R(N,W)){var Z=he(N,W);N=t(N,N.next),Z=t(Z,Z.next),r(N,H,D,Y,M,T,0),r(Z,H,D,Y,M,T,0);return}W=W.next}N=N.next}while(N!==U)}function u(U,H,D,Y){var M=[],T,N,W,Z,te;for(T=0,N=H.length;T<N;T++)W=H[T]*Y,Z=T<N-1?H[T+1]*Y:U.length,te=e(U,W,Z,Y,!1),te===te.next&&(te.steiner=!0),M.push(w(te));for(M.sort(f),T=0;T<M.length;T++)D=d(M[T],D);return D}function f(U,H){return U.x-H.x}function d(U,H){var D=p(U,H);if(!D)return H;var Y=he(D,U);return t(Y,Y.next),t(D,D.next)}function p(U,H){var D=H,Y=U.x,M=U.y,T=-1/0,N;do{if(M<=D.y&&M>=D.next.y&&D.next.y!==D.y){var W=D.x+(M-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(W<=Y&&W>T&&(T=W,N=D.x<D.next.x?D:D.next,W===Y))return N}D=D.next}while(D!==H);if(!N)return null;var Z=N,te=N.x,re=N.y,ue=1/0,ve;D=N;do Y>=D.x&&D.x>=te&&Y!==D.x&&S(M<re?Y:T,M,te,re,M<re?T:Y,M,D.x,D.y)&&(ve=Math.abs(M-D.y)/(Y-D.x),K(D,U)&&(ve<ue||ve===ue&&(D.x>N.x||D.x===N.x&&m(N,D)))&&(N=D,ue=ve)),D=D.next;while(D!==Z);return N}function m(U,H){return C(U.prev,U,H.prev)<0&&C(H.next,U,U.next)<0}function v(U,H,D,Y){var M=U;do M.z===0&&(M.z=b(M.x,M.y,H,D,Y)),M.prevZ=M.prev,M.nextZ=M.next,M=M.next;while(M!==U);M.prevZ.nextZ=null,M.prevZ=null,x(M)}function x(U){var H,D,Y,M,T,N,W,Z,te=1;do{for(D=U,U=null,T=null,N=0;D;){for(N++,Y=D,W=0,H=0;H<te&&(W++,Y=Y.nextZ,!!Y);H++);for(Z=te;W>0||Z>0&&Y;)W!==0&&(Z===0||!Y||D.z<=Y.z)?(M=D,D=D.nextZ,W--):(M=Y,Y=Y.nextZ,Z--),T?T.nextZ=M:U=M,M.prevZ=T,T=M;D=Y}T.nextZ=null,te*=2}while(N>1);return U}function b(U,H,D,Y,M){return U=(U-D)*M|0,H=(H-Y)*M|0,U=(U|U<<8)&16711935,U=(U|U<<4)&252645135,U=(U|U<<2)&858993459,U=(U|U<<1)&1431655765,H=(H|H<<8)&16711935,H=(H|H<<4)&252645135,H=(H|H<<2)&858993459,H=(H|H<<1)&1431655765,U|H<<1}function w(U){var H=U,D=U;do(H.x<D.x||H.x===D.x&&H.y<D.y)&&(D=H),H=H.next;while(H!==U);return D}function S(U,H,D,Y,M,T,N,W){return(M-N)*(H-W)>=(U-N)*(T-W)&&(U-N)*(Y-W)>=(D-N)*(H-W)&&(D-N)*(T-W)>=(M-N)*(Y-W)}function R(U,H){return U.next.i!==H.i&&U.prev.i!==H.i&&!q(U,H)&&(K(U,H)&&K(H,U)&&le(U,H)&&(C(U.prev,U,H.prev)||C(U,H.prev,H))||O(U,H)&&C(U.prev,U,U.next)>0&&C(H.prev,H,H.next)>0)}function C(U,H,D){return(H.y-U.y)*(D.x-H.x)-(H.x-U.x)*(D.y-H.y)}function O(U,H){return U.x===H.x&&U.y===H.y}function I(U,H,D,Y){var M=$(C(U,H,D)),T=$(C(U,H,Y)),N=$(C(D,Y,U)),W=$(C(D,Y,H));return!!(M!==T&&N!==W||M===0&&F(U,D,H)||T===0&&F(U,Y,H)||N===0&&F(D,U,Y)||W===0&&F(D,H,Y))}function F(U,H,D){return H.x<=Math.max(U.x,D.x)&&H.x>=Math.min(U.x,D.x)&&H.y<=Math.max(U.y,D.y)&&H.y>=Math.min(U.y,D.y)}function $(U){return U>0?1:U<0?-1:0}function q(U,H){var D=U;do{if(D.i!==U.i&&D.next.i!==U.i&&D.i!==H.i&&D.next.i!==H.i&&I(D,D.next,U,H))return!0;D=D.next}while(D!==U);return!1}function K(U,H){return C(U.prev,U,U.next)<0?C(U,H,U.next)>=0&&C(U,U.prev,H)>=0:C(U,H,U.prev)<0||C(U,U.next,H)<0}function le(U,H){var D=U,Y=!1,M=(U.x+H.x)/2,T=(U.y+H.y)/2;do D.y>T!=D.next.y>T&&D.next.y!==D.y&&M<(D.next.x-D.x)*(T-D.y)/(D.next.y-D.y)+D.x&&(Y=!Y),D=D.next;while(D!==U);return Y}function he(U,H){var D=new ye(U.i,U.x,U.y),Y=new ye(H.i,H.x,H.y),M=U.next,T=H.prev;return U.next=H,H.prev=U,D.next=M,M.prev=D,Y.next=D,D.prev=Y,T.next=Y,Y.prev=T,Y}function pe(U,H,D,Y){var M=new ye(U,H,D);return Y?(M.next=Y.next,M.prev=Y,Y.next.prev=M,Y.next=M):(M.prev=M,M.next=M),M}function se(U){U.next.prev=U.prev,U.prev.next=U.next,U.prevZ&&(U.prevZ.nextZ=U.nextZ),U.nextZ&&(U.nextZ.prevZ=U.prevZ)}function ye(U,H,D){this.i=U,this.x=H,this.y=D,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}n.deviation=function(U,H,D,Y){var M=H&&H.length,T=M?H[0]*D:U.length,N=Math.abs(Me(U,0,T,D));if(M)for(var W=0,Z=H.length;W<Z;W++){var te=H[W]*D,re=W<Z-1?H[W+1]*D:U.length;N-=Math.abs(Me(U,te,re,D))}var ue=0;for(W=0;W<Y.length;W+=3){var ve=Y[W]*D,be=Y[W+1]*D,Pe=Y[W+2]*D;ue+=Math.abs((U[ve]-U[Pe])*(U[be+1]-U[ve+1])-(U[ve]-U[be])*(U[Pe+1]-U[ve+1]))}return N===0&&ue===0?0:Math.abs((ue-N)/N)};function Me(U,H,D,Y){for(var M=0,T=H,N=D-Y;T<D;T+=Y)M+=(U[N]-U[T])*(U[T+1]+U[N+1]),N=T;return M}return n.flatten=function(U){for(var H=U[0][0].length,D={vertices:[],holes:[],dimensions:H},Y=0,M=0;M<U.length;M++){for(var T=0;T<U[M].length;T++)for(var N=0;N<H;N++)D.vertices.push(U[M][T][N]);M>0&&(Y+=U[M-1].length,D.holes.push(Y))}return D},lh.exports}var KW=qW();const ZW=ka(KW),ch=TC.CLOCKWISE,HT=TC.COUNTER_CLOCKWISE,mo={};function QW(n){if(n=n&&n.positions||n,!Array.isArray(n)&&!ArrayBuffer.isView(n))throw new Error("invalid polygon")}function vu(n){return"positions"in n?n.positions:n}function Ah(n){return"holeIndices"in n?n.holeIndices:null}function GW(n){return Array.isArray(n[0])}function JW(n){return n.length>=1&&n[0].length>=2&&Number.isFinite(n[0][0])}function eH(n){const e=n[0],t=n[n.length-1];return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function tH(n,e,t,r){for(let s=0;s<e;s++)if(n[t+s]!==n[r-e+s])return!1;return!0}function XT(n,e,t,r,s){let i=e;const o=t.length;for(let a=0;a<o;a++)for(let u=0;u<r;u++)n[i++]=t[a][u]||0;if(!eH(t))for(let a=0;a<r;a++)n[i++]=t[0][a]||0;return mo.start=e,mo.end=i,mo.size=r,SC(n,s,mo),i}function YT(n,e,t,r,s=0,i,o){i=i||t.length;const a=i-s;if(a<=0)return e;let u=e;for(let f=0;f<a;f++)n[u++]=t[s+f];if(!tH(t,r,s,i))for(let f=0;f<r;f++)n[u++]=t[s+f];return mo.start=e,mo.end=u,mo.size=r,SC(n,o,mo),u}function kC(n,e){QW(n);const t=[],r=[];if("positions"in n){const{positions:s,holeIndices:i}=n;if(i){let o=0;for(let a=0;a<=i.length;a++)o=YT(t,o,s,e,i[a-1],i[a],a===0?ch:HT),r.push(o);return r.pop(),{positions:t,holeIndices:r}}n=s}if(!GW(n))return YT(t,0,n,e,0,t.length,ch),t;if(!JW(n)){let s=0;for(const[i,o]of n.entries())s=XT(t,s,o,e,i===0?ch:HT),r.push(s);return r.pop(),{positions:t,holeIndices:r}}return XT(t,0,n,e,ch),t}function gv(n,e,t){const r=n.length/3;let s=0;for(let i=0;i<r;i++){const o=(i+1)%r;s+=n[i*3+e]*n[o*3+t],s-=n[o*3+e]*n[i*3+t]}return Math.abs(s/2)}function qT(n,e,t,r){const s=n.length/3;for(let i=0;i<s;i++){const o=i*3,a=n[o+0],u=n[o+1],f=n[o+2];n[o+e]=a,n[o+t]=u,n[o+r]=f}}function nH(n,e,t,r){let s=Ah(n);s&&(s=s.map(a=>a/e));let i=vu(n);const o=r&&e===3;if(t){const a=i.length;i=i.slice();const u=[];for(let f=0;f<a;f+=e){u[0]=i[f],u[1]=i[f+1],o&&(u[2]=i[f+2]);const d=t(u);i[f]=d[0],i[f+1]=d[1],o&&(i[f+2]=d[2])}}if(o){const a=gv(i,0,1),u=gv(i,0,2),f=gv(i,1,2);if(!a&&!u&&!f)return[];a>u&&a>f||(u>f?(t||(i=i.slice()),qT(i,0,2,1)):(t||(i=i.slice()),qT(i,2,0,1)))}return ZW(i,s,e)}class rH extends bC{constructor(e){const{fp64:t,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:t}=this;return e==="indices"?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=kC(e,this.positionSize);return this.opts.resolution?AC(vu(t),Ah(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?BW(vu(t),Ah(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(KT(e)){let t=0;for(const r of e)t+=this.getGeometrySize(r);return t}return vu(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&KT(e))for(const r of e){const s=this.getGeometrySize(r);t.geometrySize=s,this.updateGeometryAttributes(r,t),t.vertexStart+=s,t.indexStart=this.indexStarts[t.geometryIndex+1]}else{const r=e;this._updateIndices(r,t),this._updatePositions(r,t),this._updateVertexValid(r,t)}}_updateIndices(e,{geometryIndex:t,vertexStart:r,indexStart:s}){const{attributes:i,indexStarts:o,typedArrayManager:a}=this;let u=i.indices;if(!u||!e)return;let f=s;const d=nH(e,this.positionSize,this.opts.preproject,this.opts.full3d);u=a.allocate(u,s+d.length,{copy:!0});for(let p=0;p<d.length;p++)u[f++]=d[p]+r;o[t+1]=s+d.length,i.indices=u}_updatePositions(e,{vertexStart:t,geometrySize:r}){const{attributes:{positions:s},positionSize:i}=this;if(!s||!e)return;const o=vu(e);for(let a=t,u=0;u<r;a++,u++){const f=o[u*i],d=o[u*i+1],p=i>2?o[u*i+2]:0;s[a*3]=f,s[a*3+1]=d,s[a*3+2]=p}}_updateVertexValid(e,{vertexStart:t,geometrySize:r}){const{positionSize:s}=this,i=this.attributes.vertexValid,o=e&&Ah(e);if(e&&e.edgeTypes?i.set(e.edgeTypes,t):i.fill(1,t,t+r),o)for(let a=0;a<o.length;a++)i[t+o[a]/s-1]=0;i[t+r-1]=0}}function KT(n){return Array.isArray(n)&&n.length>0&&!Number.isFinite(n[0])}const MC=`uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;
in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project_uCommonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (extruded) {
pos.z += props.elevations * elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * opacity);
} else {
vColor = vec4(colors.rgb, colors.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,sH=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${MC}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`,iH=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${MC}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`,oH=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,lp=[0,0,0,255],aH={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:n=>n.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:lp},getLineColor:{type:"accessor",value:lp},material:!0},uh={enter:(n,e)=>e.length?e.subarray(e.length-n.length):n};class Pf extends Br{getShaders(e){return super.getShaders({vs:e==="top"?sH:iH,fs:oH,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Oo,FB,No]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:t}=this.props;const{_full3d:r}=this.props;e.isGeospatial&&t===tt.DEFAULT&&(t=tt.LNGLAT);let s;t===tt.LNGLAT&&(r?s=e.projectPosition.bind(e):s=e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new rH({preproject:s,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const i=this.getAttributeManager(),o=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:uh,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,stepMode:"dynamic",transition:uh,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:uh,accessor:"getFillColor",defaultValue:lp},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:uh,accessor:"getLineColor",defaultValue:lp},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(a,{index:u,target:f})=>this.encodePickingColor(a&&a.__source?a.__source.index:u,f)}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:r}=t,s=this.props.data;return s[0]&&s[0].__source&&(t.object=s.find(i=>i.__source.index===r)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let r=0;r<t.length;r++)t[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:t,filled:r,wireframe:s,elevationScale:i}=this.props,{topModel:o,sideModel:a,wireframeModel:u,polygonTesselator:f}=this.state,d={...e,extruded:!!t,elevationScale:i};u&&s&&(u.setInstanceCount(f.instanceCount-1),u.setUniforms(d),u.draw(this.context.renderPass)),a&&r&&(a.setInstanceCount(f.instanceCount-1),a.setUniforms(d),a.draw(this.context.renderPass)),o&&r&&(o.setVertexCount(f.vertexCount),o.setUniforms(d),o.draw(this.context.renderPass))}updateState(e){var a;super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:r,changeFlags:s}=e,i=this.getAttributeManager();(s.extensionsChanged||t.filled!==r.filled||t.extruded!==r.extruded)&&((a=this.state.models)==null||a.forEach(u=>u.destroy()),this.setState(this._getModels()),i.invalidateAll())}updateGeometry({props:e,oldProps:t,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:i}=this.state,o=e.data.attributes||{};i.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:i.instanceCount,startIndices:i.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:t,extruded:r}=this.props;let s,i,o;if(t){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1;const u=this.getAttributeManager().getBufferLayouts({isInstanced:!1});s=new rr(this.context.device,{...a,id:`${e}-top`,topology:"triangle-list",uniforms:{isWireframe:!1},bufferLayout:u,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(r){const a=this.getAttributeManager().getBufferLayouts({isInstanced:!0});i=new rr(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:a,uniforms:{isWireframe:!1},geometry:new _i({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),o=new rr(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:a,uniforms:{isWireframe:!0},geometry:new _i({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[i,o,s].filter(Boolean),topModel:s,sideModel:i,wireframeModel:o}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}Pf.defaultProps=aH;Pf.layerName="SolidPolygonLayer";function OC({data:n,getIndex:e,dataRange:t,replace:r}){const{startRow:s=0,endRow:i=1/0}=t,o=n.length;let a=o,u=o;for(let m=0;m<o;m++){const v=e(n[m]);if(a>m&&v>=s&&(a=m),v>=i){u=m;break}}let f=a;const p=u-a!==r.length?n.slice(u):void 0;for(let m=0;m<r.length;m++)n[f++]=r[m];if(p){for(let m=0;m<p.length;m++)n[f++]=p[m];n.length=f}return{startRow:a,endRow:a+r.length}}const NC=[0,0,0,255],lH=[0,0,0,255],cH={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:n=>n.polygon},getFillColor:{type:"accessor",value:lH},getLineColor:{type:"accessor",value:NC},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class cp extends ss{initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&ft.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const t=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(t&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),s=e.dataChanged.map(i=>OC({data:r,getIndex:o=>o.__source.index,dataRange:i,replace:this._getPaths(i)}));this.setState({paths:r,pathsDiff:s})}else t&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:t,getPolygon:r,positionFormat:s,_normalize:i}=this.props,o=[],a=s==="XY"?2:3,{startRow:u,endRow:f}=e,{iterable:d,objectInfo:p}=Cf(t,u,f);for(const m of d){p.index++;let v=r(m,p);i&&(v=kC(v,a));const{holeIndices:x}=v,b=v.positions||v;if(x)for(let w=0;w<=x.length;w++){const S=b.slice(x[w-1]||0,x[w]||b.length);o.push(this.getSubLayerRow({path:S},m,p.index))}else o.push(this.getSubLayerRow({path:b},m,p.index))}return o}renderLayers(){const{data:e,_dataDiff:t,stroked:r,filled:s,extruded:i,wireframe:o,_normalize:a,_windingOrder:u,elevationScale:f,transitions:d,positionFormat:p}=this.props,{lineWidthUnits:m,lineWidthScale:v,lineWidthMinPixels:x,lineWidthMaxPixels:b,lineJointRounded:w,lineMiterLimit:S,lineDashJustified:R}=this.props,{getFillColor:C,getLineColor:O,getLineWidth:I,getLineDashArray:F,getElevation:$,getPolygon:q,updateTriggers:K,material:le}=this.props,{paths:he,pathsDiff:pe}=this.state,se=this.getSubLayerClass("fill",Pf),ye=this.getSubLayerClass("stroke",fg),Me=this.shouldRenderSubLayer("fill",he)&&new se({_dataDiff:t,extruded:i,elevationScale:f,filled:s,wireframe:o,_normalize:a,_windingOrder:u,getElevation:$,getFillColor:C,getLineColor:i&&o?O:NC,material:le,transitions:d},this.getSubLayerProps({id:"fill",updateTriggers:K&&{getPolygon:K.getPolygon,getElevation:K.getElevation,getFillColor:K.getFillColor,lineColors:i&&o,getLineColor:K.getLineColor}}),{data:e,positionFormat:p,getPolygon:q}),U=!i&&r&&this.shouldRenderSubLayer("stroke",he)&&new ye({_dataDiff:pe&&(()=>pe),widthUnits:m,widthScale:v,widthMinPixels:x,widthMaxPixels:b,jointRounded:w,miterLimit:S,dashJustified:R,_pathType:"loop",transitions:d&&{getWidth:d.getLineWidth,getColor:d.getLineColor,getPath:d.getPolygon},getColor:this.getSubLayerAccessor(O),getWidth:this.getSubLayerAccessor(I),getDashArray:this.getSubLayerAccessor(F)},this.getSubLayerProps({id:"stroke",updateTriggers:K&&{getWidth:K.getLineWidth,getColor:K.getLineColor,getDashArray:K.getLineDashArray}}),{data:he,positionFormat:p,getPath:H=>H.path});return[!i&&Me,U,i&&Me]}}cp.layerName="PolygonLayer";cp.defaultProps=cH;function uH(n,e){if(!n)return null;const t="startIndices"in n?n.startIndices[e]:e,r=n.featureIds.value[t];return t!==-1?fH(n,r,t):null}function fH(n,e,t){const r={properties:{...n.properties[e]}};for(const s in n.numericProps)r.properties[s]=n.numericProps[s].value[t];return r}function dH(n,e){const t={points:null,lines:null,polygons:null};for(const r in t){const s=n[r].globalFeatureIds.value;t[r]=new Uint8ClampedArray(s.length*4);const i=[];for(let o=0;o<s.length;o++)e(s[o],i),t[r][o*4+0]=i[0],t[r][o*4+1]=i[1],t[r][o*4+2]=i[2],t[r][o*4+3]=255}return t}const hH=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf) {
float distance = alpha;
alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);
if (outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
color = mix(outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,mv=192/256,ZT=[],pH={getIconOffsets:{type:"accessor",value:n=>n.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class R1 extends ug{getShaders(){return{...super.getShaders(),fs:hH}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(t,{index:r,target:s})=>this.encodePickingColor(r,s)}})}updateState(e){super.updateState(e);const{props:t,oldProps:r}=e;let{outlineColor:s}=t;s!==r.outlineColor&&(s=s.map(i=>i/255),s[3]=Number.isFinite(s[3])?s[3]:1,this.setState({outlineColor:s})),!t.sdf&&t.outlineWidth&&ft.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){const{sdf:t,smoothing:r,outlineWidth:s}=this.props,{outlineColor:i}=this.state,o=s?Math.max(r,mv*(1-s)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:mv,outlineBuffer:o,gamma:r,sdf:!!t,outlineColor:i},super.draw(e),t&&s){const{iconManager:a}=this.state,u=a.getTexture(),f=this.state.model;u&&(f.setUniforms({outlineBuffer:mv}),f.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(t=>super.getInstanceOffset(t)):ZT}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(t=>super.getInstanceIconFrame(t)):ZT}}R1.defaultProps=pH;R1.layerName="MultiIconLayer";const up=1e20;class gH{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:s=.25,fontFamily:i="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}={}){this.buffer=t,this.cutoff=s,this.radius=r;const u=this.size=e+t*4,f=this._createCanvas(u),d=this.ctx=f.getContext("2d",{willReadFrequently:!0});d.font=`${a} ${o} ${e}px ${i}`,d.textBaseline="alphabetic",d.textAlign="left",d.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:s,actualBoundingBoxLeft:i,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(r),u=0,f=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-i))),d=Math.min(this.size-this.buffer,a+Math.ceil(s)),p=f+2*this.buffer,m=d+2*this.buffer,v=Math.max(p*m,0),x=new Uint8ClampedArray(v),b={data:x,width:p,height:m,glyphWidth:f,glyphHeight:d,glyphTop:a,glyphLeft:u,glyphAdvance:t};if(f===0||d===0)return b;const{ctx:w,buffer:S,gridInner:R,gridOuter:C}=this;w.clearRect(S,S,f,d),w.fillText(e,S,S+a);const O=w.getImageData(S,S,f,d);C.fill(up,0,v),R.fill(0,0,v);for(let I=0;I<d;I++)for(let F=0;F<f;F++){const $=O.data[4*(I*f+F)+3]/255;if($===0)continue;const q=(I+S)*p+F+S;if($===1)C[q]=0,R[q]=up;else{const K=.5-$;C[q]=K>0?K*K:0,R[q]=K<0?K*K:0}}QT(C,0,0,p,m,p,this.f,this.v,this.z),QT(R,S,S,f,d,p,this.f,this.v,this.z);for(let I=0;I<v;I++){const F=Math.sqrt(C[I])-Math.sqrt(R[I]);x[I]=Math.round(255-255*(F/this.radius+this.cutoff))}return b}}function QT(n,e,t,r,s,i,o,a,u){for(let f=e;f<e+r;f++)GT(n,t*i+f,i,s,o,a,u);for(let f=t;f<t+s;f++)GT(n,f*i+e,1,r,o,a,u)}function GT(n,e,t,r,s,i,o){i[0]=0,o[0]=-1e20,o[1]=up,s[0]=n[e];for(let a=1,u=0,f=0;a<r;a++){s[a]=n[e+a*t];const d=a*a;do{const p=i[u];f=(s[a]-s[p]+d-p*p)/(a-p)/2}while(f<=o[u]&&--u>-1);u++,i[u]=a,o[u]=f,o[u+1]=up}for(let a=0,u=0;a<r;a++){for(;o[u+1]<a;)u++;const f=i[u],d=a-f;n[e+a*t]=s[f]+d*d}}const mH=32,vH=[];function yH(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function _H({characterSet:n,getFontWidth:e,fontHeight:t,buffer:r,maxCanvasWidth:s,mapping:i={},xOffset:o=0,yOffset:a=0}){let u=0,f=o;const d=t+r*2;for(const p of n)if(!i[p]){const m=e(p);f+m+r*2>s&&(f=0,u++),i[p]={x:f+r,y:a+u*d+r,width:m,height:d,layoutWidth:m,layoutHeight:t},f+=m+r*2}return{mapping:i,xOffset:f,yOffset:a+u*d,canvasHeight:yH(a+(u+1)*d)}}function DC(n,e,t,r){var i;let s=0;for(let o=e;o<t;o++){const a=n[o];s+=((i=r[a])==null?void 0:i.layoutWidth)||0}return s}function LC(n,e,t,r,s,i){let o=e,a=0;for(let u=e;u<t;u++){const f=DC(n,u,u+1,s);a+f>r&&(o<u&&i.push(u),o=u,a=0),a+=f}return a}function xH(n,e,t,r,s,i){let o=e,a=e,u=e,f=0;for(let d=e;d<t;d++)if((n[d]===" "||n[d+1]===" "||d+1===t)&&(u=d+1),u>a){let p=DC(n,a,u,s);f+p>r&&(o<a&&(i.push(a),o=a,f=0),p>r&&(p=LC(n,a,u,r,s,i),o=i[i.length-1])),a=u,f+=p}return f}function bH(n,e,t,r,s=0,i){i===void 0&&(i=n.length);const o=[];return e==="break-all"?LC(n,s,i,t,r,o):xH(n,s,i,t,r,o),o}function wH(n,e,t,r,s,i){let o=0,a=0;for(let u=e;u<t;u++){const f=n[u],d=r[f];d?(a||(a=d.layoutHeight),s[u]=o+d.layoutWidth/2,o+=d.layoutWidth):(ft.warn(`Missing character: ${f} (${f.codePointAt(0)})`)(),s[u]=o,o+=mH)}i[0]=o,i[1]=a}function TH(n,e,t,r,s){var w;const i=Array.from(n),o=i.length,a=new Array(o),u=new Array(o),f=new Array(o),d=(t==="break-word"||t==="break-all")&&isFinite(r)&&r>0,p=[0,0],m=[0,0];let v=0,x=0,b=0;for(let S=0;S<=o;S++){const R=i[S];if((R===`
`||S===o)&&(b=S),b>x){const C=d?bH(i,t,r,s,x,b):vH;for(let O=0;O<=C.length;O++){const I=O===0?x:C[O-1],F=O<C.length?C[O]:b;wH(i,I,F,s,a,m);for(let $=I;$<F;$++){const q=i[$],K=((w=s[q])==null?void 0:w.layoutOffsetY)||0;u[$]=v+m[1]/2+K,f[$]=m[0]}v=v+m[1]*e,p[0]=Math.max(p[0],m[0])}x=b}R===`
`&&(a[x]=0,u[x]=0,f[x]=0,x++)}return p[1]=v,{x:a,y:u,rowWidth:f,size:p}}function SH({value:n,length:e,stride:t,offset:r,startIndices:s,characterSet:i}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:1,u=r?r/o:0,f=s[e]||Math.ceil((n.length-u)/a),d=i&&new Set,p=new Array(e);let m=n;if(a>1||u>0){const v=n.constructor;m=new v(f);for(let x=0;x<f;x++)m[x]=n[x*a+u]}for(let v=0;v<e;v++){const x=s[v],b=s[v+1]||f,w=m.subarray(x,b);p[v]=String.fromCodePoint.apply(null,w),d&&w.forEach(d.add,d)}if(d)for(const v of d)i.add(String.fromCodePoint(v));return{texts:p,characterCount:f}}class FC{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}function EH(){const n=[];for(let e=32;e<128;e++)n.push(String.fromCharCode(e));return n}const zl={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:EH(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},JT=1024,eS=.9,tS=1.2,BC=3;let fp=new FC(BC);function AH(n,e){let t;typeof e=="string"?t=new Set(Array.from(e)):t=new Set(e);const r=fp.get(n);if(!r)return t;for(const s in r.mapping)t.has(s)&&t.delete(s);return t}function CH(n,e){for(let t=0;t<n.length;t++)e.data[4*t+3]=n[t]}function nS(n,e,t,r){n.font=`${r} ${t}px ${e}`,n.fillStyle="#000",n.textBaseline="alphabetic",n.textAlign="left"}function RH(n){ft.assert(Number.isFinite(n)&&n>=BC,"Invalid cache limit"),fp=new FC(n)}class PH{constructor(){this.props={...zl}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:t}=this.props;return(e*tS+t*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const t=AH(this._key,this.props.characterSet),r=fp.get(this._key);if(r&&t.size===0){this._atlas!==r&&(this._atlas=r);return}const s=this._generateFontAtlas(t,r);this._atlas=s,fp.set(this._key,s)}_generateFontAtlas(e,t){const{fontFamily:r,fontWeight:s,fontSize:i,buffer:o,sdf:a,radius:u,cutoff:f}=this.props;let d=t&&t.data;d||(d=document.createElement("canvas"),d.width=JT);const p=d.getContext("2d",{willReadFrequently:!0});nS(p,r,i,s);const{mapping:m,canvasHeight:v,xOffset:x,yOffset:b}=_H({getFontWidth:w=>p.measureText(w).width,fontHeight:i*tS,buffer:o,characterSet:e,maxCanvasWidth:JT,...t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset}});if(d.height!==v){const w=p.getImageData(0,0,d.width,d.height);d.height=v,p.putImageData(w,0,0)}if(nS(p,r,i,s),a){const w=new gH({fontSize:i,buffer:o,radius:u,cutoff:f,fontFamily:r,fontWeight:`${s}`});for(const S of e){const{data:R,width:C,height:O,glyphTop:I}=w.draw(S);m[S].width=C,m[S].layoutOffsetY=i*eS-I;const F=p.createImageData(C,O);CH(R,F),p.putImageData(F,m[S].x,m[S].y)}}else for(const w of e)p.fillText(w,m[w].x,m[w].y+o+i*eS);return{xOffset:x,yOffset:b,mapping:m,data:d,width:d.width,height:d.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:r,buffer:s,sdf:i,radius:o,cutoff:a}=this.props;return i?`${e} ${t} ${r} ${s} ${o} ${a}`:`${e} ${t} ${r} ${s}`}}const IH=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,kH=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
uniform bool stroked;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec2 pixelPosition = uv * dimensions;
if (stroked) {
float distToEdge = min(
min(pixelPosition.x, dimensions.x - pixelPosition.x),
min(pixelPosition.y, dimensions.y - pixelPosition.y)
);
float isBorder = smoothedge(distToEdge, vLineWidth);
fragColor = mix(vFillColor, vLineColor, isBorder);
} else {
fragColor = vFillColor;
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,MH={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:n=>n.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class P1 extends Br{getShaders(){return super.getShaders({vs:IH,fs:kH,modules:[Oo,No]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var r;super.updateState(e);const{changeFlags:t}=e;t.extensionsChanged&&((r=this.state.model)==null||r.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{billboard:t,sizeScale:r,sizeUnits:s,sizeMinPixels:i,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:u}=this.props;u.length<4&&(u=[u[0],u[1],u[0],u[1]]);const f=this.state.model;f.setUniforms(e),f.setUniforms({billboard:t,stroked:!!a,padding:u,sizeUnits:So[s],sizeScale:r,sizeMinPixels:i,sizeMaxPixels:o}),f.draw(this.context.renderPass)}_getModel(){const e=[0,0,1,0,1,1,0,1];return new rr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new _i({topology:"triangle-fan-webgl",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}}P1.defaultProps=MH;P1.layerName="TextBackgroundLayer";const rS={start:1,middle:0,end:-1},sS={top:1,center:0,bottom:-1},vv=[0,0,0,255],OH=1,NH={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:vv},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:zl.characterSet},fontFamily:zl.fontFamily,fontWeight:zl.fontWeight,lineHeight:OH,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:vv},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:n=>n.text},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:vv},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class pc extends ss{constructor(){super(...arguments),this.getBoundingRect=(e,t)=>{let{size:[r,s]}=this.transformParagraph(e,t);const{fontSize:i}=this.state.fontAtlasManager.props;r/=i,s/=i;const{getTextAnchor:o,getAlignmentBaseline:a}=this.props,u=rS[typeof o=="function"?o(e,t):o],f=sS[typeof a=="function"?a(e,t):a];return[(u-1)*r/2,(f-1)*s/2,r,s]},this.getIconOffsets=(e,t)=>{const{getTextAnchor:r,getAlignmentBaseline:s}=this.props,{x:i,y:o,rowWidth:a,size:[u,f]}=this.transformParagraph(e,t),d=rS[typeof r=="function"?r(e,t):r],p=sS[typeof s=="function"?s(e,t):s],m=i.length,v=new Array(m*2);let x=0;for(let b=0;b<m;b++){const w=(1-d)*(u-a[b])/2;v[x++]=(d-1)*u/2+w+i[b],v[x++]=(p-1)*f/2+o[b]}return v}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new PH},this.props.maxWidth>0&&ft.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:t,oldProps:r,changeFlags:s}=e;(s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||t.lineHeight!==r.lineHeight||t.wordBreak!==r.wordBreak||t.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:r}=this.props,{fontAtlasManager:s,characterSet:i}=this.state,o={...e,characterSet:i,fontFamily:t,fontWeight:r};if(!s.mapping)return s.setProps(o),!0;for(const a in o)if(o[a]!==s.props[a])return s.setProps(o),!0;return!1}_updateText(){var u;const{data:e,characterSet:t}=this.props,r=(u=e.attributes)==null?void 0:u.getText;let{getText:s}=this.props,i=e.startIndices,o;const a=t==="auto"&&new Set;if(r&&i){const{texts:f,characterCount:d}=SH({...ArrayBuffer.isView(r)?{value:r}:r,length:e.length,startIndices:i,characterSet:a});o=d,s=(p,{index:m})=>f[m]}else{const{iterable:f,objectInfo:d}=Cf(e);i=[0],o=0;for(const p of f){d.index++;const m=Array.from(s(p,d)||"");a&&m.forEach(a.add,a),o+=m.length,i.push(o)}}this.setState({getText:s,startIndices:i,numInstances:o,characterSet:a||t})}transformParagraph(e,t){const{fontAtlasManager:r}=this.state,s=r.mapping,i=this.state.getText,{wordBreak:o,lineHeight:a,maxWidth:u}=this.props,f=i(e,t)||"";return TH(f,a,o,u*r.props.fontSize,s)}renderLayers(){const{startIndices:e,numInstances:t,getText:r,fontAtlasManager:{scale:s,atlas:i,mapping:o},styleVersion:a}=this.state,{data:u,_dataDiff:f,getPosition:d,getColor:p,getSize:m,getAngle:v,getPixelOffset:x,getBackgroundColor:b,getBorderColor:w,getBorderWidth:S,backgroundPadding:R,background:C,billboard:O,fontSettings:I,outlineWidth:F,outlineColor:$,sizeScale:q,sizeUnits:K,sizeMinPixels:le,sizeMaxPixels:he,transitions:pe,updateTriggers:se}=this.props,ye=this.getSubLayerClass("characters",R1),Me=this.getSubLayerClass("background",P1);return[C&&new Me({getFillColor:b,getLineColor:w,getLineWidth:S,padding:R,getPosition:d,getSize:m,getAngle:v,getPixelOffset:x,billboard:O,sizeScale:q,sizeUnits:K,sizeMinPixels:le,sizeMaxPixels:he,transitions:pe&&{getPosition:pe.getPosition,getAngle:pe.getAngle,getSize:pe.getSize,getFillColor:pe.getBackgroundColor,getLineColor:pe.getBorderColor,getLineWidth:pe.getBorderWidth,getPixelOffset:pe.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:se.getPosition,getAngle:se.getAngle,getSize:se.getSize,getFillColor:se.getBackgroundColor,getLineColor:se.getBorderColor,getLineWidth:se.getBorderWidth,getPixelOffset:se.getPixelOffset,getBoundingRect:{getText:se.getText,getTextAnchor:se.getTextAnchor,getAlignmentBaseline:se.getAlignmentBaseline,styleVersion:a}}}),{data:u.attributes&&u.attributes.background?{length:u.length,attributes:u.attributes.background}:u,_dataDiff:f,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new ye({sdf:I.sdf,smoothing:Number.isFinite(I.smoothing)?I.smoothing:zl.smoothing,outlineWidth:F/(I.radius||zl.radius),outlineColor:$,iconAtlas:i,iconMapping:o,getPosition:d,getColor:p,getSize:m,getAngle:v,getPixelOffset:x,billboard:O,sizeScale:q*s,sizeUnits:K,sizeMinPixels:le*s,sizeMaxPixels:he*s,transitions:pe&&{getPosition:pe.getPosition,getAngle:pe.getAngle,getColor:pe.getColor,getSize:pe.getSize,getPixelOffset:pe.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:se.getText,getPosition:se.getPosition,getAngle:se.getAngle,getColor:se.getColor,getSize:se.getSize,getPixelOffset:se.getPixelOffset,getIconOffsets:{getTextAnchor:se.getTextAnchor,getAlignmentBaseline:se.getAlignmentBaseline,styleVersion:a}}}),{data:u,_dataDiff:f,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){RH(e)}}pc.defaultProps=NH;pc.layerName="TextLayer";const Ch={circle:{type:C1,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:ug,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:pc,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Rh={type:fg,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Xy={type:Pf,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function iu({type:n,props:e}){const t={};for(const r in e)t[r]=n.defaultProps[e[r]];return t}function yv(n,e){const{transitions:t,updateTriggers:r}=n.props,s={updateTriggers:{},transitions:t&&{getPosition:t.geometry}};for(const i in e){const o=e[i];let a=n.props[i];i.startsWith("get")&&(a=n.getSubLayerAccessor(a),s.updateTriggers[o]=r[i],t&&(s.transitions[o]=t[i])),s[o]=a}return s}function DH(n){if(Array.isArray(n))return n;switch(ft.assert(n.type,"GeoJSON does not have type"),n.type){case"Feature":return[n];case"FeatureCollection":return ft.assert(Array.isArray(n.features),"GeoJSON does not have features array"),n.features;default:return[{geometry:n}]}}function iS(n,e,t={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:s=0,endRow:i=n.length}=t;for(let o=s;o<i;o++){const a=n[o],{geometry:u}=a;if(u)if(u.type==="GeometryCollection"){ft.assert(Array.isArray(u.geometries),"GeoJSON does not have geometries array");const{geometries:f}=u;for(let d=0;d<f.length;d++){const p=f[d];oS(p,r,e,a,o)}}else oS(u,r,e,a,o)}return r}function oS(n,e,t,r,s){const{type:i,coordinates:o}=n,{pointFeatures:a,lineFeatures:u,polygonFeatures:f,polygonOutlineFeatures:d}=e;if(!FH(i,o)){ft.warn(`${i} coordinates are malformed`)();return}switch(i){case"Point":a.push(t({geometry:n},r,s));break;case"MultiPoint":o.forEach(p=>{a.push(t({geometry:{type:"Point",coordinates:p}},r,s))});break;case"LineString":u.push(t({geometry:n},r,s));break;case"MultiLineString":o.forEach(p=>{u.push(t({geometry:{type:"LineString",coordinates:p}},r,s))});break;case"Polygon":f.push(t({geometry:n},r,s)),o.forEach(p=>{d.push(t({geometry:{type:"LineString",coordinates:p}},r,s))});break;case"MultiPolygon":o.forEach(p=>{f.push(t({geometry:{type:"Polygon",coordinates:p}},r,s)),p.forEach(m=>{d.push(t({geometry:{type:"LineString",coordinates:m}},r,s))})});break}}const LH={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function FH(n,e){let t=LH[n];for(ft.assert(t,`Unknown GeoJSON type ${n}`);e&&--t>0;)e=e[0];return e&&Number.isFinite(e[0])}function UC(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function fh(n){return n.geometry.coordinates}function BH(n,e){const t=UC(),{pointFeatures:r,lineFeatures:s,polygonFeatures:i,polygonOutlineFeatures:o}=n;return t.points.data=r,t.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),t.points.getPosition=fh,t.lines.data=s,t.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),t.lines.getPath=fh,t.polygons.data=i,t.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),t.polygons.getPolygon=fh,t.polygonsOutline.data=o,t.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),t.polygonsOutline.getPath=fh,t}function UH(n,e){const t=UC(),{points:r,lines:s,polygons:i}=n,o=dH(n,e);return t.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:4,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},t.lines.data={length:s.pathIndices.value.length-1,startIndices:s.pathIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:4,value:o.lines}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},t.lines._pathType="open",t.polygons.data={length:i.polygonIndices.value.length-1,startIndices:i.polygonIndices.value,attributes:{...i.attributes,getPolygon:i.positions,pickingColors:{size:4,value:o.polygons}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},t.polygons._normalize=!1,i.triangles&&(t.polygons.data.attributes.indices=i.triangles.value),t.polygonsOutline.data={length:i.primitivePolygonIndices.value.length-1,startIndices:i.primitivePolygonIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:4,value:o.polygons}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},t.polygonsOutline._pathType="open",t}const VH=["points","linestrings","polygons"],zH={...iu(Ch.circle),...iu(Ch.icon),...iu(Ch.text),...iu(Rh),...iu(Xy),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:n=>n.properties.icon},getText:{type:"accessor",value:n=>n.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class I1 extends ss{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:t}){if(!t.dataChanged)return;const{data:r}=this.props,s=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:s}),s?this._updateStateBinary({props:e,changeFlags:t}):this._updateStateJSON({props:e,changeFlags:t})}_updateStateBinary({props:e,changeFlags:t}){const r=UH(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:t}){const r=DH(e.data),s=this.getSubLayerRow.bind(this);let i={};const o={};if(Array.isArray(t.dataChanged)){const u=this.state.features;for(const f in u)i[f]=u[f].slice(),o[f]=[];for(const f of t.dataChanged){const d=iS(r,s,f);for(const p in u)o[p].push(OC({data:i[p],getIndex:m=>m.__source.index,dataRange:f,replace:d[p]}))}}else i=iS(r,s);const a=BH(i,o);this.setState({features:i,featuresDiff:o,layerProps:a})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:r,sourceLayer:s}=t;return t.featureType=VH.find(i=>s.id.startsWith(`${this.id}-${i}-`)),r>=0&&s.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[r]),t}_updateAutoHighlight(e){const t=`${this.id}-points-`,r=e.featureType==="points";for(const s of this.getSubLayers())s.id.startsWith(t)===r&&s.updateAutoHighlight(e)}_renderPolygonLayer(){var o;const{extruded:e,wireframe:t}=this.props,{layerProps:r}=this.state,s="polygons-fill",i=this.shouldRenderSubLayer(s,(o=r.polygons)==null?void 0:o.data)&&this.getSubLayerClass(s,Xy.type);if(i){const a=yv(this,Xy.props),u=e&&t;return u||delete a.getLineColor,a.updateTriggers.lineColors=u,new i(a,this.getSubLayerProps({id:s,updateTriggers:a.updateTriggers}),r.polygons)}return null}_renderLineLayers(){var u,f;const{extruded:e,stroked:t}=this.props,{layerProps:r}=this.state,s="polygons-stroke",i="linestrings",o=!e&&t&&this.shouldRenderSubLayer(s,(u=r.polygonsOutline)==null?void 0:u.data)&&this.getSubLayerClass(s,Rh.type),a=this.shouldRenderSubLayer(i,(f=r.lines)==null?void 0:f.data)&&this.getSubLayerClass(i,Rh.type);if(o||a){const d=yv(this,Rh.props);return[o&&new o(d,this.getSubLayerProps({id:s,updateTriggers:d.updateTriggers}),r.polygonsOutline),a&&new a(d,this.getSubLayerProps({id:i,updateTriggers:d.updateTriggers}),r.lines)]}return null}_renderPointLayers(){var a;const{pointType:e}=this.props,{layerProps:t,binary:r}=this.state;let{highlightedObjectIndex:s}=this.props;!r&&Number.isFinite(s)&&(s=t.points.data.findIndex(u=>u.__source.index===s));const i=new Set(e.split("+")),o=[];for(const u of i){const f=`points-${u}`,d=Ch[u],p=d&&this.shouldRenderSubLayer(f,(a=t.points)==null?void 0:a.data)&&this.getSubLayerClass(f,d.type);if(p){const m=yv(this,d.props);let v=t.points;if(u==="text"&&r){const{instancePickingColors:x,...b}=v.data.attributes;v={...v,data:{...v.data,attributes:b}}}o.push(new p(m,this.getSubLayerProps({id:f,updateTriggers:m.updateTriggers,highlightedObjectIndex:s}),v))}}return o}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer(),r=this._renderLineLayers(),s=this._renderPointLayers();return[!e&&t,r,s,e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return!t||typeof e!="function"?super.getSubLayerAccessor(e):(r,s)=>{const{data:i,index:o}=s,a=uH(i,o);return e(a,s)}}}I1.layerName="GeoJsonLayer";I1.defaultProps=zH;class $H{constructor(e){this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:t,onLoad:r,onError:s}){const{index:i,id:o,bbox:a,userData:u,zoom:f}=this,d=this._loaderId;this._abortController=new AbortController;const{signal:p}=this._abortController,m=await t.scheduleRequest(this,b=>b.isSelected?1:-1);if(!m){this._isCancelled=!0;return}if(this._isCancelled){m.done();return}let v=null,x;try{v=await e({index:i,id:o,bbox:a,userData:u,zoom:f,signal:p})}catch(b){x=b||!0}finally{m.done()}if(d===this._loaderId){if(this._loader=void 0,this.content=v,this._isCancelled&&!v){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,x?s(x,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)==null||e.abort())}}const tr={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},aS=new Fe,jH=new Fe;class k1{constructor(e=[0,0,0],t=[0,0,0],r){r=r||aS.copy(e).add(t).scale(.5),this.center=new Fe(r),this.halfDiagonal=new Fe(t).subtract(this.center),this.minimum=new Fe(e),this.maximum=new Fe(t)}clone(){return new k1(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:t}=this,r=jH.from(e.normal),s=t.x*Math.abs(r.x)+t.y*Math.abs(r.y)+t.z*Math.abs(r.z),i=this.center.dot(r)+e.distance;return i-s>0?tr.INSIDE:i+s<0?tr.OUTSIDE:tr.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=aS.from(e).subtract(this.center),{halfDiagonal:r}=this;let s=0,i;return i=Math.abs(t.x)-r.x,i>0&&(s+=i*i),i=Math.abs(t.y)-r.y,i>0&&(s+=i*i),i=Math.abs(t.z)-r.z,i>0&&(s+=i*i),s}}const ou=new Fe,lS=new Fe;class M1{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new Fe,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=ou.from(t),this.center=new Fe().from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new M1(this.center,this.radius)}union(e){const t=this.center,r=this.radius,s=e.center,i=e.radius,o=ou.copy(s).subtract(t),a=o.magnitude();if(r>=a+i)return this.clone();if(i>=a+r)return e.clone();const u=(r+a+i)*.5;return lS.copy(o).scale((-r+u)/a).add(t),this.center.copy(lS),this.radius=u,this}expand(e){const r=ou.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const t=bO(ou,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const r=ou.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const t=this.center,r=this.radius,i=e.normal.dot(t)+e.distance;return i<-r?tr.OUTSIDE:i<r?tr.INTERSECTING:tr.INSIDE}}const WH=new Fe,HH=new Fe,dh=new Fe,hh=new Fe,ph=new Fe,XH=new Fe,YH=new Fe,ai={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class O1{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=new Fe().from(e),this.halfAxes=new zn(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new Fe(e).len(),new Fe(t).len(),new Fe(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),s=new Fe(e).normalize(),i=new Fe(t).normalize(),o=new Fe(r).normalize();return new _3().fromMatrix3(new zn([...s,...i,...o]))}fromCenterHalfSizeQuaternion(e,t,r){const s=new _3(r),i=new zn().fromQuaternion(s);return i[0]=i[0]*t[0],i[1]=i[1]*t[0],i[2]=i[2]*t[0],i[3]=i[3]*t[1],i[4]=i[4]*t[1],i[5]=i[5]*t[1],i[6]=i[6]*t[2],i[7]=i[7]*t[2],i[8]=i[8]*t[2],this.center=new Fe().from(e),this.halfAxes=i,this}clone(){return new O1(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new M1){const t=this.halfAxes,r=t.getColumn(0,dh),s=t.getColumn(1,hh),i=t.getColumn(2,ph),o=WH.copy(r).add(s).add(i);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const t=this.center,r=e.normal,s=this.halfAxes,i=r.x,o=r.y,a=r.z,u=Math.abs(i*s[ai.COLUMN0ROW0]+o*s[ai.COLUMN0ROW1]+a*s[ai.COLUMN0ROW2])+Math.abs(i*s[ai.COLUMN1ROW0]+o*s[ai.COLUMN1ROW1]+a*s[ai.COLUMN1ROW2])+Math.abs(i*s[ai.COLUMN2ROW0]+o*s[ai.COLUMN2ROW1]+a*s[ai.COLUMN2ROW2]),f=r.dot(t)+e.distance;return f<=-u?tr.OUTSIDE:f>=u?tr.INSIDE:tr.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=HH.from(e).subtract(this.center),r=this.halfAxes,s=r.getColumn(0,dh),i=r.getColumn(1,hh),o=r.getColumn(2,ph),a=s.magnitude(),u=i.magnitude(),f=o.magnitude();s.normalize(),i.normalize(),o.normalize();let d=0,p;return p=Math.abs(t.dot(s))-a,p>0&&(d+=p*p),p=Math.abs(t.dot(i))-u,p>0&&(d+=p*p),p=Math.abs(t.dot(o))-f,p>0&&(d+=p*p),d}computePlaneDistances(e,t,r=[-0,-0]){let s=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,u=a.getColumn(0,dh),f=a.getColumn(1,hh),d=a.getColumn(2,ph),p=XH.copy(u).add(f).add(d).add(o),m=YH.copy(p).subtract(e);let v=t.dot(m);return s=Math.min(v,s),i=Math.max(v,i),p.copy(o).add(u).add(f).subtract(d),m.copy(p).subtract(e),v=t.dot(m),s=Math.min(v,s),i=Math.max(v,i),p.copy(o).add(u).subtract(f).add(d),m.copy(p).subtract(e),v=t.dot(m),s=Math.min(v,s),i=Math.max(v,i),p.copy(o).add(u).subtract(f).subtract(d),m.copy(p).subtract(e),v=t.dot(m),s=Math.min(v,s),i=Math.max(v,i),o.copy(p).subtract(u).add(f).add(d),m.copy(p).subtract(e),v=t.dot(m),s=Math.min(v,s),i=Math.max(v,i),o.copy(p).subtract(u).add(f).subtract(d),m.copy(p).subtract(e),v=t.dot(m),s=Math.min(v,s),i=Math.max(v,i),o.copy(p).subtract(u).subtract(f).add(d),m.copy(p).subtract(e),v=t.dot(m),s=Math.min(v,s),i=Math.max(v,i),o.copy(p).subtract(u).subtract(f).subtract(d),m.copy(p).subtract(e),v=t.dot(m),s=Math.min(v,s),i=Math.max(v,i),r[0]=s,r[1]=i,r}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,dh);t.transformAsPoint(e);const r=this.halfAxes.getColumn(1,hh);r.transformAsPoint(e);const s=this.halfAxes.getColumn(2,ph);return s.transformAsPoint(e),this.halfAxes=new zn([...t,...r,...s]),this}getTransform(){throw new Error("not implemented")}}const cS=new Fe,uS=new Fe;class ic{constructor(e=[0,0,1],t=0){this.normal=new Fe,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return zu(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=cS.from(e),this.normal.from(t).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,t,r,s){return this.normal.set(e,t,r),zu(gi(this.normal.len(),1)),this.distance=s,this}clone(){return new ic(this.normal,this.distance)}equals(e){return gi(this.distance,e.distance)&&gi(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=uS.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,t)}projectPointOntoPlane(e,t=[0,0,0]){const r=cS.from(e),s=this.getPointDistance(r),i=uS.copy(this.normal).scale(s);return r.subtract(i).to(t)}}const fS=[new Fe([1,0,0]),new Fe([0,1,0]),new Fe([0,0,1])],dS=new Fe,qH=new Fe;class hi{constructor(e=[]){this.planes=e}fromBoundingSphere(e){this.planes.length=2*fS.length;const t=e.center,r=e.radius;let s=0;for(const i of fS){let o=this.planes[s],a=this.planes[s+1];o||(o=this.planes[s]=new ic),a||(a=this.planes[s+1]=new ic);const u=dS.copy(i).scale(-r).add(t);o.fromPointNormal(u,i);const f=dS.copy(i).scale(r).add(t),d=qH.copy(i).negate();a.fromPointNormal(f,d),s+=2}return this}computeVisibility(e){let t=tr.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case tr.OUTSIDE:return tr.OUTSIDE;case tr.INTERSECTING:t=tr.INTERSECTING;break}return t}computeVisibilityWithPlaneMask(e,t){if(zu(Number.isFinite(t),"parentPlaneMask is required."),t===hi.MASK_OUTSIDE||t===hi.MASK_INSIDE)return t;let r=hi.MASK_INSIDE;const s=this.planes;for(let i=0;i<this.planes.length;++i){const o=i<31?1<<i:0;if(i<31&&(t&o)===0)continue;const a=s[i],u=e.intersectPlane(a);if(u===tr.OUTSIDE)return hi.MASK_OUTSIDE;u===tr.INTERSECTING&&(r|=o)}return r}}hi.MASK_OUTSIDE=4294967295;hi.MASK_INSIDE=0;hi.MASK_INDETERMINATE=2147483647;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;new Fe;const Fs=new zn,KH=new zn,ZH=new zn,gh=new zn,hS=new zn;function QH(n,e={}){const t=iN,r=10;let s=0,i=0;const o=KH,a=ZH;o.identity(),a.copy(n);const u=t*GH(a);for(;i<r&&JH(a)>u;)eX(a,gh),hS.copy(gh).transpose(),a.multiplyRight(gh),a.multiplyLeft(hS),o.multiplyRight(gh),++s>2&&(++i,s=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function GH(n){let e=0;for(let t=0;t<9;++t){const r=n[t];e+=r*r}return Math.sqrt(e)}const Yy=[1,0,0],qy=[2,2,1];function JH(n){let e=0;for(let t=0;t<3;++t){const r=n[Fs.getElementIndex(qy[t],Yy[t])];e+=2*r*r}return Math.sqrt(e)}function eX(n,e){const t=sN;let r=0,s=1;for(let f=0;f<3;++f){const d=Math.abs(n[Fs.getElementIndex(qy[f],Yy[f])]);d>r&&(s=f,r=d)}const i=Yy[s],o=qy[s];let a=1,u=0;if(Math.abs(n[Fs.getElementIndex(o,i)])>t){const f=n[Fs.getElementIndex(o,o)],d=n[Fs.getElementIndex(i,i)],p=n[Fs.getElementIndex(o,i)],m=(f-d)/2/p;let v;m<0?v=-1/(-m+Math.sqrt(1+m*m)):v=1/(m+Math.sqrt(1+m*m)),a=1/Math.sqrt(1+v*v),u=v*a}return zn.IDENTITY.to(e),e[Fs.getElementIndex(i,i)]=e[Fs.getElementIndex(o,o)]=a,e[Fs.getElementIndex(o,i)]=u,e[Fs.getElementIndex(i,o)]=-u,e}const ro=new Fe,tX=new Fe,nX=new Fe,rX=new Fe,sX=new Fe,iX=new zn,oX={diagonal:new zn,unitary:new zn};function aX(n,e=new O1){if(!n||n.length===0)return e.halfAxes=new zn([0,0,0,0,0,0,0,0,0]),e.center=new Fe,e;const t=n.length,r=new Fe(0,0,0);for(const K of n)r.add(K);const s=1/t;r.multiplyByScalar(s);let i=0,o=0,a=0,u=0,f=0,d=0;for(const K of n){const le=ro.copy(K).subtract(r);i+=le.x*le.x,o+=le.x*le.y,a+=le.x*le.z,u+=le.y*le.y,f+=le.y*le.z,d+=le.z*le.z}i*=s,o*=s,a*=s,u*=s,f*=s,d*=s;const p=iX;p[0]=i,p[1]=o,p[2]=a,p[3]=o,p[4]=u,p[5]=f,p[6]=a,p[7]=f,p[8]=d;const{unitary:m}=QH(p,oX),v=e.halfAxes.copy(m);let x=v.getColumn(0,nX),b=v.getColumn(1,rX),w=v.getColumn(2,sX),S=-Number.MAX_VALUE,R=-Number.MAX_VALUE,C=-Number.MAX_VALUE,O=Number.MAX_VALUE,I=Number.MAX_VALUE,F=Number.MAX_VALUE;for(const K of n)ro.copy(K),S=Math.max(ro.dot(x),S),R=Math.max(ro.dot(b),R),C=Math.max(ro.dot(w),C),O=Math.min(ro.dot(x),O),I=Math.min(ro.dot(b),I),F=Math.min(ro.dot(w),F);x=x.multiplyByScalar(.5*(O+S)),b=b.multiplyByScalar(.5*(I+R)),w=w.multiplyByScalar(.5*(F+C)),e.center.copy(x).add(b).add(w);const $=tX.set(S-O,R-I,C-F).multiplyByScalar(.5),q=new zn([$[0],0,0,0,$[1],0,0,0,$[2]]);return e.halfAxes.multiplyRight(q),e}const Dl=512,lX=3,VC=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],zC=VC.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),cX=zC.concat([[.25,.5],[.75,.5]]);class Ll{constructor(e,t,r){this.x=e,this.y=t,this.z=r}get children(){if(!this._children){const e=this.x*2,t=this.y*2,r=this.z+1;this._children=[new Ll(e,t,r),new Ll(e,t+1,r),new Ll(e+1,t,r),new Ll(e+1,t+1,r)]}return this._children}update(e){const{viewport:t,cullingVolume:r,elevationBounds:s,minZ:i,maxZ:o,bounds:a,offset:u,project:f}=e,d=this.getBoundingVolume(s,u,f);if(a&&!this.insideBounds(a)||r.computeVisibility(d)<0)return!1;if(!this.childVisible){let{z:m}=this;if(m<o&&m>=i){const v=d.distanceTo(t.cameraPosition)*t.scale/t.height;m+=Math.floor(Math.log2(v))}if(m>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const m of this.children)m.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const t of this._children)t.getSelected(e);return e}insideBounds([e,t,r,s]){const i=Math.pow(2,this.z),o=Dl/i;return this.x*o<r&&this.y*o<s&&(this.x+1)*o>e&&(this.y+1)*o>t}getBoundingVolume(e,t,r){if(r){const u=this.z<1?cX:this.z<2?zC:VC,f=[];for(const d of u){const p=Zy(this.x+d[0],this.y+d[1],this.z);p[2]=e[0],f.push(r(p)),e[0]!==e[1]&&(p[2]=e[1],f.push(r(p)))}return aX(f)}const s=Math.pow(2,this.z),i=Dl/s,o=this.x*i+t*Dl,a=Dl-(this.y+1)*i;return new k1([o,a,e[0]],[o+i,a+i,e[1]])}}function uX(n,e,t,r){const s=n instanceof qj&&n.resolution?n.projectPosition:null,i=Object.values(n.getFrustumPlanes()).map(({normal:v,distance:x})=>new ic(v.clone().negate(),x)),o=new hi(i),a=n.distanceScales.unitsPerMeter[2],u=t&&t[0]*a||0,f=t&&t[1]*a||0,d=n instanceof Ao&&n.pitch<=60?e:0;if(r){const[v,x,b,w]=r,S=Eo([v,w]),R=Eo([b,x]);r=[S[0],Dl-S[1],R[0],Dl-R[1]]}const p=new Ll(0,0,0),m={viewport:n,project:s,cullingVolume:o,elevationBounds:[u,f],minZ:d,maxZ:e,bounds:r,offset:0};if(p.update(m),n instanceof Ao&&n.subViewports&&n.subViewports.length>1){for(m.offset=-1;p.update(m)&&!(--m.offset<-3););for(m.offset=1;p.update(m)&&!(++m.offset>lX););}return p.getSelected()}const xi=512,fX=[-1/0,-1/0,1/0,1/0],dX={equal:(n,e)=>{if(n===e)return!0;if(!Array.isArray(n)||!Array.isArray(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}};function $C(n,e){const t=[e.transformAsPoint([n[0],n[1]]),e.transformAsPoint([n[2],n[1]]),e.transformAsPoint([n[0],n[3]]),e.transformAsPoint([n[2],n[3]])];return[Math.min(...t.map(s=>s[0])),Math.min(...t.map(s=>s[1])),Math.max(...t.map(s=>s[0])),Math.max(...t.map(s=>s[1]))]}function hX(n){return Math.abs(n.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)|0,0))}function pX(n,e){if(!n||!n.length)return null;const{index:t,id:r}=e;if(Array.isArray(n)){const i=hX(r)%n.length;n=n[i]}let s=n;for(const i of Object.keys(t)){const o=new RegExp(`{${i}}`,"g");s=s.replace(o,String(t[i]))}return Number.isInteger(t.y)&&Number.isInteger(t.z)&&(s=s.replace(/\{-y\}/g,String(Math.pow(2,t.z)-t.y-1))),s}function gX(n,e,t){let r;return r=n.getBounds(),n.isGeospatial?[Math.max(r[0],t[0]),Math.max(r[1],t[1]),Math.min(r[2],t[2]),Math.min(r[3],t[3])]:[Math.max(Math.min(r[0],t[2]),t[0]),Math.max(Math.min(r[1],t[3]),t[1]),Math.min(Math.max(r[2],t[0]),t[2]),Math.min(Math.max(r[3],t[1]),t[3])]}function mX({viewport:n,z:e,cullRect:t}){return(n.subViewports||[n]).map(s=>Ky(s,e||0,t))}function Ky(n,e,t){if(!Array.isArray(e)){const i=t.x-n.x,o=t.y-n.y,{width:a,height:u}=t,f={targetZ:e},d=n.unproject([i,o],f),p=n.unproject([i+a,o],f),m=n.unproject([i,o+u],f),v=n.unproject([i+a,o+u],f);return[Math.min(d[0],p[0],m[0],v[0]),Math.min(d[1],p[1],m[1],v[1]),Math.max(d[0],p[0],m[0],v[0]),Math.max(d[1],p[1],m[1],v[1])]}const r=Ky(n,e[0],t),s=Ky(n,e[1],t);return[Math.min(r[0],s[0]),Math.min(r[1],s[1]),Math.max(r[2],s[2]),Math.max(r[3],s[3])]}function vX(n,e,t){return t?$C(n,t).map(s=>s*e/xi):n.map(r=>r*e/xi)}function N1(n,e){return Math.pow(2,n)*xi/e}function Zy(n,e,t){const r=N1(t,xi),s=n/r*360-180,i=Math.PI-2*Math.PI*e/r,o=180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)));return[s,o]}function pS(n,e,t,r){const s=N1(t,r);return[n/s*xi,e/s*xi]}function yX(n,e,t,r,s=xi){if(n.isGeospatial){const[f,d]=Zy(e,t,r),[p,m]=Zy(e+1,t+1,r);return{west:f,north:d,east:p,south:m}}const[i,o]=pS(e,t,r,s),[a,u]=pS(e+1,t+1,r,s);return{left:i,top:o,right:a,bottom:u}}function _X(n,e,t,r,s){const i=gX(n,null,r),o=N1(e,t),[a,u,f,d]=vX(i,o,s),p=[];for(let m=Math.floor(a);m<f;m++)for(let v=Math.floor(u);v<d;v++)p.push({x:m,y:v,z:e});return p}function xX({viewport:n,maxZoom:e,minZoom:t,zRange:r,extent:s,tileSize:i=xi,modelMatrix:o,modelMatrixInverse:a,zoomOffset:u=0}){let f=n.isGeospatial?Math.round(n.zoom+Math.log2(xi/i))+u:Math.ceil(n.zoom)+u;if(typeof t=="number"&&Number.isFinite(t)&&f<t){if(!s)return[];f=t}typeof e=="number"&&Number.isFinite(e)&&f>e&&(f=e);let d=s;return o&&a&&s&&!n.isGeospatial&&(d=$C(s,o)),n.isGeospatial?uX(n,f,r,s):_X(n,f,i,d||fX,a)}function bX(n){let e={},t;return r=>{for(const s in r)if(!wX(r[s],e[s])){t=n(r),e=r;break}return t}}function wX(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}return!1}const gS=1,dg=2,TX="never",SX="no-overlap",D1="best-available",EX=5,AX={[D1]:PX,[SX]:IX,[TX]:()=>{}},CX={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class RX{constructor(e){this._getCullBounds=bX(mX),this.opts={...CX,...e},this.setOptions(this.opts),this.onTileLoad=t=>{var r,s;(s=(r=this.opts).onTileLoad)==null||s.call(r,t),this.opts.maxCacheByteSize!=null&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new wD({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new At,this._modelMatrixInverse=new At}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const t=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(t)?this._cache.delete(e):t.setNeedsReload()}}update(e,{zRange:t,modelMatrix:r}={zRange:null,modelMatrix:null}){const s=r?new At(r):new At,i=!s.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!gi(this._zRange,t)||i){i&&(this._modelMatrixInverse=s.clone().invert(),this._modelMatrix=s),this._viewport=e,this._zRange=t;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:t,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(u=>this._getTile(u,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(e,t){if(!e.isVisible)return!1;if(t&&this._viewport){const r=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:t}),{bbox:s}=e;for(const[i,o,a,u]of r){let f;if("west"in s)f=s.west<a&&s.east>i&&s.south<u&&s.north>o;else{const d=Math.min(s.top,s.bottom),p=Math.max(s.top,s.bottom);f=s.left<a&&s.right>i&&d<u&&p>o}if(f)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:t,minZoom:r,zRange:s,modelMatrix:i,modelMatrixInverse:o}){const{tileSize:a,extent:u,zoomOffset:f}=this.opts;return xX({viewport:e,maxZoom:t,minZoom:r,zRange:s,tileSize:a,extent:u,modelMatrix:i,modelMatrixInverse:o,zoomOffset:f})}getTileId(e){return`${e.x}-${e.y}-${e.z}`}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:t}=this.opts;return{bbox:yX(this._viewport,e.x,e.y,e.z,t)}}getParentIndex(e){const t=Math.floor(e.x/2),r=Math.floor(e.y/2),s=e.z-1;return{x:t,y:r,z:s}}updateTileStates(){const e=this.opts.refinementStrategy||D1,t=new Array(this._cache.size);let r=0;for(const s of this._cache.values())t[r++]=s.isVisible,s.isSelected=!1,s.isVisible=!1;for(const s of this._selectedTiles)s.isSelected=!0,s.isVisible=!0;(typeof e=="function"?e:AX[e])(Array.from(this._cache.values())),r=0;for(const s of this._cache.values())if(t[r++]!==s.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,t=[];let r=0;for(const s of this._cache.values())s.isLoading&&(r++,!s.isSelected&&!s.isVisible&&t.push(s));for(;e>0&&r>e&&t.length>0;)t.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const t of e.values())t.parent=null,t.children&&(t.children.length=0);for(const t of e.values()){const r=this._getNearestAncestor(t);t.parent=r,r!=null&&r.children&&r.children.push(t)}}_resizeCache(){var o,a;const{_cache:e,opts:t}=this,r=t.maxCacheSize??(t.maxCacheByteSize!=null?1/0:EX*this.selectedTiles.length),s=t.maxCacheByteSize??1/0;if(e.size>r||this._cacheByteSize>s){for(const[u,f]of e)if(!f.isVisible&&!f.isSelected&&(this._cacheByteSize-=t.maxCacheByteSize!=null?f.byteLength:0,e.delete(u),(a=(o=this.opts).onTileUnload)==null||a.call(o,f)),e.size<=r&&this._cacheByteSize<=s)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((u,f)=>u.zoom-f.zoom),this._dirty=!1)}_getTile(e,t){const r=this.getTileId(e);let s=this._cache.get(r),i=!1;return!s&&t?(s=new $H(e),Object.assign(s,this.getTileMetadata(s.index)),Object.assign(s,{id:r,zoom:this.getTileZoom(s.index)}),i=!0,this._cache.set(r,s),this._dirty=!0):s&&s.needsReload&&(i=!0),s&&i&&s.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),s}_getNearestAncestor(e){const{_minZoom:t=0}=this;let r=e.index;for(;this.getTileZoom(r)>t;){r=this.getParentIndex(r);const s=this._getTile(r);if(s)return s}return null}}function PX(n){for(const e of n)e.state=0;for(const e of n)e.isSelected&&!jC(e)&&L1(e);for(const e of n)e.isVisible=!!(e.state&dg)}function IX(n){for(const t of n)t.state=0;for(const t of n)t.isSelected&&jC(t);const e=Array.from(n).sort((t,r)=>t.zoom-r.zoom);for(const t of e)if(t.isVisible=!!(t.state&dg),t.children&&(t.isVisible||t.state&gS))for(const r of t.children)r.state=gS;else t.isSelected&&L1(t)}function jC(n){let e=n;for(;e;){if(e.isLoaded||e.content)return e.state|=dg,!0;e=e.parent}return!1}function L1(n){for(const e of n.children)e.isLoaded||e.content?e.state|=dg:L1(e)}const kX={TilesetClass:RX,data:{type:"data",value:[]},dataComparator:dX.equal,renderSubLayers:{type:"function",value:n=>new I1(n)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:n=>{}},onTileUnload:{type:"function",value:n=>{}},onTileError:{type:"function",value:n=>console.error(n)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:D1,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0};class hg extends ss{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,t;(t=(e=this.state)==null?void 0:e.tileset)==null||t.finalize()}get isLoaded(){var e,t,r;return!!((r=(t=(e=this.state)==null?void 0:e.tileset)==null?void 0:t.selectedTiles)!=null&&r.every(s=>s.isLoaded&&s.layers&&s.layers.every(i=>i.isLoaded)))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:t}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,s=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);t?r&&(t.setOptions(this._getTilesetOptions()),s?t.reloadAll():t.tiles.forEach(i=>{i.layers=null})):(t=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:t})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:t,maxCacheByteSize:r,refinementStrategy:s,extent:i,maxZoom:o,minZoom:a,maxRequests:u,debounceTime:f,zoomOffset:d}=this.props;return{maxCacheSize:t,maxCacheByteSize:r,maxZoom:o,minZoom:a,tileSize:e,refinementStrategy:s,extent:i,maxRequests:u,debounceTime:f,zoomOffset:d,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const e=this.state.tileset,{zRange:t,modelMatrix:r}=this.props,s=e.update(this.context.viewport,{zRange:t,modelMatrix:r}),{isLoaded:i}=e,o=this.state.isLoaded!==i,a=this.state.frameNumber!==s;i&&(o||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:s}),this.state.isLoaded=i}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:t}=this.props;t&&t(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,t){this.props.onTileError(e),t.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:t,getTileData:r,fetch:s}=this.props,{signal:i}=e;return e.url=typeof t=="string"||Array.isArray(t)?pX(t,e):null,r?r(e):s&&e.url?s(e.url,{propName:"data",layer:this,signal:i}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo(e){const t=e.sourceLayer,r=t.props.tile,s=e.info;return s.picked&&(s.tile=r),s.sourceTile=r,s.sourceTileSubLayer=t,s}_updateAutoHighlight(e){e.sourceTileSubLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const t=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)t&&e.layers[0]&&Object.keys(t).some(r=>e.layers[0].props[r]!==t[r])&&(e.layers=e.layers.map(r=>r.clone(t)));else{const r=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=sg(r,Boolean).map(s=>s.clone({tile:e,...t}))}return e.layers})}filterSubLayer({layer:e,cullRect:t}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,t)}}hg.defaultProps=kX;hg.layerName="TileLayer";const MX=typeof window<"u"?B.useLayoutEffect:B.useEffect;function dp(n,e){for(;n;){if(n===e)return!0;n=Object.getPrototypeOf(n)}return!1}const OX={position:"absolute",zIndex:-1};function WC(n,e){if(typeof n=="function")return n(e);if(Array.isArray(n))return n.map(t=>WC(t,e));if(pg(n)){if(NX(n))return e.style=OX,B.cloneElement(n,e);if(DX(n))return B.cloneElement(n,e)}return n}function pg(n){return n&&typeof n=="object"&&"type"in n||!1}function NX(n){var e;return(e=n.props)==null?void 0:e.mapStyle}function DX(n){const e=n.type;return e&&e.deckGLViewProps}function Qy(n){if(typeof n=="function")return B.createElement(Ea,{},n);if(Array.isArray(n))return n.map(Qy);if(pg(n)){if(n.type===B.Fragment)return Qy(n.props.children);if(dp(n.type,Ea))return n}return n}function LX({children:n,layers:e=[],views:t=null}){const r=[],s=[],i={};return B.Children.forEach(Qy(n),o=>{if(pg(o)){const a=o.type;if(dp(a,Br)){const u=FX(a,o.props);s.push(u)}else r.push(o);if(dp(a,Ea)&&a!==Ea&&o.props.id){const u=new a(o.props);i[u.id]=u}}else o&&r.push(o)}),Object.keys(i).length>0&&(Array.isArray(t)?t.forEach(o=>{i[o.id]=o}):t&&(i[t.id]=t),t=Object.values(i)),e=s.length>0?[...s,...e]:e,{layers:e,children:r,views:t}}function FX(n,e){const t={},r=n.defaultProps||{};for(const s in e)r[s]!==e[s]&&(t[s]=e[s]);return new n(t)}function BX({children:n,deck:e,ContextProvider:t}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const s={},i=r.views[0].id;for(const o of n){let a=i,u=o;pg(o)&&dp(o.type,Ea)&&(a=o.props.id||i,u=o.props.children);const f=r.getViewport(a),d=r.getViewState(a);if(f){d.padding=f.padding;const{x:p,y:m,width:v,height:x}=f;u=WC(u,{x:p,y:m,width:v,height:x,viewport:f,viewState:d}),s[a]||(s[a]={viewport:f,children:[]}),s[a].children.push(u)}}return Object.keys(s).map(o=>{const{viewport:a,children:u}=s[o],{x:f,y:d,width:p,height:m}=a,v={position:"absolute",left:f,top:d,width:p,height:m},x=`view-${o}`,b=B.createElement("div",{key:x,id:x,style:v},...u);if(t){const w={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:S=>{S.viewId=o,e._onViewStateChange(S)}};return B.createElement(t,{key:x,value:w},b)}return b})}const UX={mixBlendMode:null};function VX({width:n,height:e,style:t}){const r={position:"absolute",zIndex:0,left:0,top:0,width:n,height:e},s={left:0,top:0};if(t)for(const i in t)i in UX?s[i]=t[i]:r[i]=t[i];return{containerStyle:r,canvasStyle:s}}function zX(n){return{get deck(){return n.deck},pickObject:e=>n.deck.pickObject(e),pickMultipleObjects:e=>n.deck.pickMultipleObjects(e),pickObjects:e=>n.deck.pickObjects(e)}}function HC(n){n.redrawReason&&(n.deck._drawLayers(n.redrawReason),n.redrawReason=null)}function $X(n,e,t){const r=new e({...t,_customRender:s=>{n.redrawReason=s;const i=r.getViewports();n.lastRenderedViewports!==i?n.forceUpdate():HC(n)}});return r}function jX(n,e){const[t,r]=B.useState(0),i=B.useRef({control:null,version:t,forceUpdate:()=>r(I=>I+1)}).current,o=B.useRef(null),a=B.useRef(null),u=B.useMemo(()=>LX(n),[n.layers,n.views,n.children]);let f=!0;const d=I=>{var F;return f&&n.viewState?(i.viewStateUpdateRequested=I,null):(i.viewStateUpdateRequested=null,(F=n.onViewStateChange)==null?void 0:F.call(n,I))},p=I=>{var F;f?i.interactionStateUpdateRequested=I:(i.interactionStateUpdateRequested=null,(F=n.onInteractionStateChange)==null||F.call(n,I))},m=B.useMemo(()=>{const I={...n,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:u.layers,views:u.views,onViewStateChange:d,onInteractionStateChange:p};return delete I._customRender,i.deck&&i.deck.setProps(I),I},[n]);B.useEffect(()=>{const I=n.Deck||S1;return i.deck=$X(i,I,{...m,parent:o.current,canvas:a.current}),()=>{var F;return(F=i.deck)==null?void 0:F.finalize()}},[]),MX(()=>{HC(i);const{viewStateUpdateRequested:I,interactionStateUpdateRequested:F}=i;I&&d(I),F&&p(F)}),B.useImperativeHandle(e,()=>zX(i),[]);const v=i.deck&&i.deck.isInitialized?i.deck.getViewports():void 0,{ContextProvider:x,width:b="100%",height:w="100%",id:S,style:R}=n,{containerStyle:C,canvasStyle:O}=B.useMemo(()=>VX({width:b,height:w,style:R}),[b,w,R]);if(!i.viewStateUpdateRequested&&i.lastRenderedViewports===v||i.version!==t){i.lastRenderedViewports=v,i.version=t;const I=BX({children:u.children,deck:i.deck,ContextProvider:x}),F=B.createElement("canvas",{key:"canvas",id:S||"deckgl-overlay",ref:a,style:O});i.control=B.createElement("div",{id:`${S||"deckgl"}-wrapper`,ref:o,style:C},[F,I])}return f=!1,i.control}const WX=B.forwardRef(jX),HX=.5;class XC extends hg{constructor(t){const r=t.loader,s={height:r[0].shape.at(-2),width:r[0].shape.at(-1)};St(s.width&&s.height);const i=XX(r);super({id:`labels-${t.id}`,extent:[0,0,s.width,s.height],tileSize:i,minZoom:Math.round(-(r.length-1)),opacity:t.opacity,maxZoom:0,modelMatrix:t.modelMatrix,colors:t.colors,zoomOffset:Math.round(Math.log2(t.modelMatrix?t.modelMatrix.getScale()[0]:1)),updateTriggers:{getTileData:[t.loader,t.selection]},async getTileData({index:o,signal:a}){const{x:u,y:f,z:d}=o,p=r[Math.round(-d)],m={x:u,y:f,signal:a,selection:t.selection};let{data:v,width:x,height:b}=await p.getTile(m);return St(!(v instanceof Float32Array)&&!(v instanceof Float64Array),`The pixels of labels MUST be integer data types, got ${JSON.stringify(p.dtype)}`),{data:v,width:x,height:b}}});E(this,"state")}renderSubLayers(t){const{tile:r,data:s,...i}=t,[[o,a],[u,f]]=r.boundingBox;St(i.extent,"missing extent");const[d,p,m,v]=i.extent;return new YC({id:`tile-${r.index.x}.${r.index.y}.${r.index.z}-${i.id}`,pixelData:s,opacity:i.opacity,modelMatrix:i.modelMatrix,colorTexture:this.state.colorTexture,bounds:[un(o,0,m),un(f,0,v),un(u,0,m),un(a,0,v)],image:new ImageData(s.width,s.height),pickable:!1})}updateState({props:t,oldProps:r,changeFlags:s,...i}){var o;if(super.updateState({props:t,oldProps:r,changeFlags:s,...i}),t.colors!==r.colors||!this.state.colorTexture){(o=this.state.colorTexture)==null||o.destroy();const a=YX({source:t.colors,maxTextureDimension2D:this.context.device.limits.maxTextureDimension2D});this.setState({colorTexture:this.context.device.createTexture({width:a.width,height:a.height,data:a.data,dimension:"2d",mipmaps:!1,sampler:{minFilter:"nearest",magFilter:"nearest",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},format:"rgba8unorm"})})}}}E(XC,"layerName","VizarrLabelLayer");class YC extends Rf{constructor(){super(...arguments);E(this,"state")}getShaders(){const t={Uint8Array:"usampler2D",Uint16Array:"usampler2D",Uint32Array:"usampler2D",Int8Array:"isampler2D",Int16Array:"isampler2D",Int32Array:"isampler2D"}[yS(this.props.pixelData.data)];return{...super.getShaders(),fs:`#version 300 es
#define SHADER_NAME grayscale-bitmap-layer-fragment-shader

precision highp float;
precision highp int;
precision highp ${t};

uniform ${t} grayscaleTexture;
uniform sampler2D colorTexture;
uniform float colorTextureWidth;
uniform float colorTextureHeight;
uniform float opacity;

in vec2 vTexCoord;
out vec4 fragColor;

void main() {
  int index = int(texture(grayscaleTexture, vTexCoord).r);
  float x = (mod(float(index), colorTextureWidth) + 0.5) / colorTextureWidth;
  float y = (floor(float(index) / colorTextureWidth) + 0.5) / colorTextureHeight;
  vec2 uv = vec2(x, y);
  vec3 color = texture(colorTexture, uv).rgb;
  fragColor = vec4(color, ((index > 0) ? 1.0 : 0.0) * opacity);
}
`}}updateState({props:t,oldProps:r,changeFlags:s,...i}){var o;super.updateState({props:t,oldProps:r,changeFlags:s,...i}),t.pixelData!==r.pixelData&&((o=this.state.texture)==null||o.destroy(),this.setState({texture:this.context.device.createTexture({width:t.pixelData.width,height:t.pixelData.height,data:t.pixelData.data,dimension:"2d",mipmaps:!1,sampler:{minFilter:"nearest",magFilter:"nearest",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},format:{Uint8Array:"r8uint",Uint16Array:"r16uint",Uint32Array:"r32uint",Int8Array:"r8sint",Int16Array:"r16sint",Int32Array:"r32sint"}[yS(t.pixelData.data)]})}))}draw(t){const{model:r,texture:s}=this.state,{colorTexture:i}=this.props;r&&s&&i&&(r.setUniforms({colorTextureWidth:i.width,colorTextureHeight:i.height}),r.setBindings({grayscaleTexture:s,colorTexture:i})),super.draw(t)}}E(YC,"layerName","VizarrGrayscaleBitmapLayer");function XX(n){const e=n[0].tileSize;return St(n.every(t=>t.tileSize===e),"resolutions must all have the same tile size"),e}const mS=new WeakSet;function YX(n){const{source:e,maxTextureDimension2D:t}=n,r={data:vS,width:vS.length/4,height:1};if(!e)return r;const s=Math.max(...e.map(u=>u.labelValue))+1,i=Math.min(s,t),o=Math.ceil(s/i);if(i>t||o>t)return mS.has(e)||(console.warn("[vizarr] Skipping color palette from OME-NGFF `image-label` source: max texture dimension limit."),mS.add(e)),r;const a=new Uint8Array(i*o*4);for(const{labelValue:u,rgba:f}of e){const d=u%i,m=(Math.floor(u/i)*i+d)*4;a[m]=f[0],a[m+1]=f[1],a[m+2]=f[2],a[m+3]=f[3]}return{data:a,width:i,height:o}}const vS=Uint8Array.from([[0,73,73],[0,146,146],[255,109,182],[255,182,219],[73,0,146],[0,109,219],[182,109,255],[109,182,255],[182,219,255],[146,0,0],[146,72,0],[219,109,0],[36,255,36],[255,255,109],[255,255,255]].flatMap(n=>[...n,255]));function yS(n){return n.constructor.name}async function qX(n,e){const{color:t,contrast_limits:r,visibility:s,name:i,colormap:o="",opacity:a=1}=n,u=e[e.length-1],f=Array(e[0].shape.length).fill(0),d=r??await X_(u,f);return{loader:e,name:i,channel_axis:null,colors:[t??js.white],names:["channel_0"],contrast_limits:[d],visibilities:[s??!0],model_matrix:xf(n.model_matrix),defaults:{selection:f,colormap:o,opacity:a},axis_labels:e[0].labels}}async function KX(n,e,t){const{names:r,contrast_limits:s,name:i,model_matrix:o,opacity:a=1,colormap:u=""}=n;let{visibilities:f,colors:d}=n;const p=e[0].shape[t];for(const v of[s,f,r,d])if(v){const x=Object.keys({channelProp:v})[0];St(v.length===p,`channel_axis is length ${p} and provided channel_axis property ${x} is different size.`)}f=f||r4(p),d=d||s4(p,f);const m=s??await o4(e[e.length-1],t,f);return{loader:e,name:i,channel_axis:t,colors:d,names:r??ju(p).map(v=>`channel_${v}`),contrast_limits:m,visibilities:f,model_matrix:xf(o),defaults:{selection:Array(e[0].shape.length).fill(0),colormap:u,opacity:a},axis_labels:e[0].labels}}async function ZX(n){const e=await s8(n.source);let t,r;if(e instanceof Gp){let d=ba(e.attrs);if(N3(d))return U3(n,e,d.plate);if(h8(d))return k8(n,e,d.well);if(Wu(d))return M8(n,e,d);if(Object.keys(d).length===0&&e.path){const p=await $n(e.resolve(".."),{kind:"group"}),m=ba(p.attrs);if(N3(m))return U3(n,p,m.plate)}if(g8(d)){let p=`${t8}?source=${n.source}`;throw new a4("Please open in ome-ngff-validator",p)}St(Wu(d),"Group is missing multiscales specification."),t=await W_(e,d.multiscales),d.multiscales[0].axes&&(r=dc(d.multiscales))}else t=[e];const{channel_axis:s,labels:i}=QX(n,r,t[0]),o=_f(t[0]),a=t.map(d=>new Ql(d,{labels:i,tileSize:o})),[u]=a;if("channel_axis"in n||s>-1)return n=n,KX(n,a,Number(n.channel_axis??s));if(u.shape.length===2||!("channel_axis"in n))return qX(n,a);throw Error("Failed to load image.")}function QX(n,e,t){const r=n.axis_labels,s="channel_axis"in n?Number(n.channel_axis):void 0;if(e){const a=r??yf(e),u=s??e.findIndex(f=>f.type==="channel");return{labels:a,channel_axis:u}}const i=r??o8(t),o=s??i.indexOf("c");return{labels:i,channel_axis:o}}function qC(n){const{selection:e,opacity:t,colormap:r}=n.defaults,s=[],i=[],o=[],a=[],u=n.visibilities.flatMap((p,m)=>p?m:[]);for(const p of u.slice(0,pa)){const m=[...e];Number.isInteger(n.channel_axis)&&(m[n.channel_axis]=p),s.push(m),i.push(H_(n.colors[p])),o.push(n.contrast_limits[p]??[0,255]),a.push(!0)}const f={id:n.id,selections:s,colors:i,contrastLimits:o,contrastLimitsRange:[...o],channelsVisible:a,opacity:t,colormap:r,modelMatrix:n.model_matrix,onClick:n.onClick};if(n.loaders)return{kind:"grid",layerProps:{...f,loaders:n.loaders,columns:n.columns,rows:n.rows},on:!0};if(n.loader.length===1)return{kind:"image",layerProps:{...f,loader:n.loader[0]},on:!0};let d;return n.labels&&n.labels.length>0&&(d=n.labels.map((p,m)=>({on:!1,transformSourceSelection:GX(p.loader[0],n.loader[0]),layerProps:{id:`${n.id}_${m}`,loader:p.loader,modelMatrix:p.modelMatrix,opacity:HX,colors:p.colors}}))),{kind:"multiscale",layerProps:{...f,loader:n.loader},on:!0,labels:d}}function GX(n,e){St(e.shape.length===e.labels.length,`Image source axes and shape are not same rank. Got ${JSON.stringify(e)}`),St(n.shape.length===n.labels.length,`Label axes and shape are not same rank. Got ${JSON.stringify(n)}`),St(n.labels.every(r=>e.labels.includes(r)),`Label axes MUST be a subset of source. Source: ${JSON.stringify(e.labels)} Labels: ${JSON.stringify(n.labels)}`);const t=new Set(m8(n.labels,n.shape).filter(([r,s])=>s===1).map(([r,s])=>r));return r=>n.labels.map(s=>t.has(s)?0:r[e.labels.indexOf(s)])}const JX=Object.freeze(Object.defineProperty({__proto__:null,createSourceData:ZX,initLayerStateFromSource:qC},Symbol.toStringTag,{value:"Module"})),eY=255,_S=[0,0,0],KC=6,tY="-apple-system, 'Helvetica Neue', Arial, sans-serif",xS={Uint8:{format:"r8uint",dataFormat:gt.RED_INTEGER,type:gt.UNSIGNED_BYTE,max:2**8-1,sampler:"usampler2D"},Uint16:{format:"r16uint",dataFormat:gt.RED_INTEGER,type:gt.UNSIGNED_SHORT,max:2**16-1,sampler:"usampler2D"},Uint32:{format:"r32uint",dataFormat:gt.RED_INTEGER,type:gt.UNSIGNED_INT,max:2**32-1,sampler:"usampler2D"},Float32:{format:"r32float",dataFormat:gt.RED,type:gt.FLOAT,max:3.4*10**38,sampler:"sampler2D"},Int8:{format:"r8sint",dataFormat:gt.RED_INTEGER,type:gt.BYTE,max:2**7-1,sampler:"isampler2D"},Int16:{format:"r16sint",dataFormat:gt.RED_INTEGER,type:gt.SHORT,max:2**15-1,sampler:"isampler2D"},Int32:{format:"r32sint",dataFormat:gt.RED_INTEGER,type:gt.INT,max:2**31-1,sampler:"isampler2D"},Float64:{format:"r32float",dataFormat:gt.RED,type:gt.FLOAT,max:3.4*10**38,sampler:"sampler2D",cast:n=>new Float32Array(n)}},ZC=`vec4 apply_transparent_color(vec3 color, vec3 transparentColor, bool useTransparentColor, float opacity){
  return vec4(color, (color == transparentColor && useTransparentColor) ? 0. : opacity);
}
`,nY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(1,1,1,0);
  const float e1 = 1.0;
  const vec4 v1 = vec4(1,1,1,1);
  float a0 = smoothstep(e0,e1,x);
  return mix(v0,v1,a0)*step(e0,x)*step(x,e1);
}
`,rY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(1,0,0,1);
  const float e1 = 1.0;
  const vec4 v1 = vec4(1,1,0,1);
  float a0 = smoothstep(e0,e1,x);
  return mix(v0,v1,a0)*step(e0,x)*step(x,e1);
}
`,sY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.1568627450980392,0.10196078431372549,0.17254901960784313,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.23137254901960785,0.19215686274509805,0.35294117647058826,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.25098039215686274,0.2980392156862745,0.5450980392156862,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.24705882352941178,0.43137254901960786,0.592156862745098,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.2823529411764706,0.5568627450980392,0.6196078431372549,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.3333333333333333,0.6823529411764706,0.6392156862745098,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.47058823529411764,0.807843137254902,0.6392156862745098,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.7333333333333333,0.9019607843137255,0.6745098039215687,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9921568627450981,0.996078431372549,0.8,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,iY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0,1);
  const float e1 = 0.2;
  const vec4 v1 = vec4(0.9019607843137255,0,0,1);
  const float e2 = 0.4;
  const vec4 v2 = vec4(0.9019607843137255,0.8235294117647058,0,1);
  const float e3 = 0.7;
  const vec4 v3 = vec4(1,1,1,1);
  const float e4 = 1.0;
  const vec4 v4 = vec4(0.6274509803921569,0.7843137254901961,1,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),mix(v3,v4,a3)*step(e3,x)*step(x,e4)
  )));
}
`,oY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,1,1);
  const float e1 = 1.0;
  const vec4 v1 = vec4(1,0,0,1);
  float a0 = smoothstep(e0,e1,x);
  return mix(v0,v1,a0)*step(e0,x)*step(x,e1);
}
`,aY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0,1);
  const float e1 = 0.376;
  const vec4 v1 = vec4(0.32941176470588235,0.32941176470588235,0.4549019607843137,1);
  const float e2 = 0.753;
  const vec4 v2 = vec4(0.6627450980392157,0.7843137254901961,0.7843137254901961,1);
  const float e3 = 1.0;
  const vec4 v3 = vec4(1,1,1,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),mix(v2,v3,a2)*step(e2,x)*step(x,e3)
  ));
}
`,lY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.1843137254901961,0.058823529411764705,0.24313725490196078,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.3411764705882353,0.09019607843137255,0.33725490196078434,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.5098039215686274,0.10980392156862745,0.38823529411764707,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.6705882352941176,0.1607843137254902,0.3764705882352941,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.807843137254902,0.2627450980392157,0.33725490196078434,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.9019607843137255,0.41568627450980394,0.32941176470588235,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.9490196078431372,0.5843137254901961,0.403921568627451,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.9764705882352941,0.7568627450980392,0.5294117647058824,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.996078431372549,0.9294117647058824,0.6901960784313725,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,cY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.07058823529411765,0.1411764705882353,0.0784313725490196,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.09803921568627451,0.24705882352941178,0.1607843137254902,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.09411764705882353,0.3568627450980392,0.23137254901960785,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.050980392156862744,0.4666666666666667,0.2823529411764706,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.07058823529411765,0.5803921568627451,0.3137254901960784,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.3137254901960784,0.6784313725490196,0.34901960784313724,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.5176470588235295,0.7686274509803922,0.47843137254901963,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.6862745098039216,0.8666666666666667,0.6352941176470588,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.8431372549019608,0.9764705882352941,0.8156862745098039,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,uY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.49019607843137253,0,0.7019607843137254,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.4549019607843137,0,0.8549019607843137,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.3843137254901961,0.2901960784313726,0.9294117647058824,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.26666666666666666,0.5725490196078431,0.9058823529411765,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0,0.8,0.7725490196078432,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0,0.9686274509803922,0.5725490196078431,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0,1,0.34509803921568627,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.1568627450980392,1,0.03137254901960784,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.5764705882352941,1,0,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,fY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0,1);
  const float e1 = 0.804;
  const vec4 v1 = vec4(1,0.6274509803921569,0.4,1);
  const float e2 = 1.0;
  const vec4 v2 = vec4(1,0.7803921568627451,0.4980392156862745,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),mix(v1,v2,a1)*step(e1,x)*step(x,e2)
  );
}
`,dY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0,1);
  const float e1 = 0.07;
  const vec4 v1 = vec4(0.08627450980392157,0.0196078431372549,0.23137254901960785,1);
  const float e2 = 0.13;
  const vec4 v2 = vec4(0.23529411764705882,0.01568627450980392,0.4117647058823529,1);
  const float e3 = 0.2;
  const vec4 v3 = vec4(0.42745098039215684,0.00392156862745098,0.5294117647058824,1);
  const float e4 = 0.27;
  const vec4 v4 = vec4(0.6313725490196078,0,0.5764705882352941,1);
  const float e5 = 0.33;
  const vec4 v5 = vec4(0.8235294117647058,0.00784313725490196,0.5568627450980392,1);
  const float e6 = 0.4;
  const vec4 v6 = vec4(0.984313725490196,0.043137254901960784,0.4823529411764706,1);
  const float e7 = 0.47;
  const vec4 v7 = vec4(1,0.11372549019607843,0.3803921568627451,1);
  const float e8 = 0.53;
  const vec4 v8 = vec4(1,0.21176470588235294,0.27058823529411763,1);
  const float e9 = 0.6;
  const vec4 v9 = vec4(1,0.3333333333333333,0.1803921568627451,1);
  const float e10 = 0.67;
  const vec4 v10 = vec4(1,0.47058823529411764,0.13333333333333333,1);
  const float e11 = 0.73;
  const vec4 v11 = vec4(1,0.615686274509804,0.1450980392156863,1);
  const float e12 = 0.8;
  const vec4 v12 = vec4(0.9450980392156862,0.7490196078431373,0.2235294117647059,1);
  const float e13 = 0.87;
  const vec4 v13 = vec4(0.8784313725490196,0.8627450980392157,0.36470588235294116,1);
  const float e14 = 0.93;
  const vec4 v14 = vec4(0.8549019607843137,0.9450980392156862,0.5568627450980392,1);
  const float e15 = 1.0;
  const vec4 v15 = vec4(0.8901960784313725,0.9921568627450981,0.7764705882352941,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  float a8 = smoothstep(e8,e9,x);
  float a9 = smoothstep(e9,e10,x);
  float a10 = smoothstep(e10,e11,x);
  float a11 = smoothstep(e11,e12,x);
  float a12 = smoothstep(e12,e13,x);
  float a13 = smoothstep(e13,e14,x);
  float a14 = smoothstep(e14,e15,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),
    max(mix(v7,v8,a7)*step(e7,x)*step(x,e8),
    max(mix(v8,v9,a8)*step(e8,x)*step(x,e9),
    max(mix(v9,v10,a9)*step(e9,x)*step(x,e10),
    max(mix(v10,v11,a10)*step(e10,x)*step(x,e11),
    max(mix(v11,v12,a11)*step(e11,x)*step(x,e12),
    max(mix(v12,v13,a12)*step(e12,x)*step(x,e13),
    max(mix(v13,v14,a13)*step(e13,x)*step(x,e14),mix(v14,v15,a14)*step(e14,x)*step(x,e15)
  ))))))))))))));
}
`,hY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.21176470588235294,0.054901960784313725,0.1411764705882353,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.34901960784313724,0.09019607843137255,0.3137254901960784,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.43137254901960786,0.17647058823529413,0.5176470588235295,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.47058823529411764,0.30196078431372547,0.6980392156862745,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.47058823529411764,0.44313725490196076,0.8352941176470589,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.45098039215686275,0.592156862745098,0.8941176470588236,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.5254901960784314,0.7254901960784313,0.8901960784313725,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.6941176470588235,0.8392156862745098,0.8901960784313725,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9019607843137255,0.9450980392156862,0.9450980392156862,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,pY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0.5098039215686274,1);
  const float e1 = 0.1;
  const vec4 v1 = vec4(0,0.7058823529411765,0.7058823529411765,1);
  const float e2 = 0.2;
  const vec4 v2 = vec4(0.1568627450980392,0.8235294117647058,0.1568627450980392,1);
  const float e3 = 0.4;
  const vec4 v3 = vec4(0.9019607843137255,0.9019607843137255,0.19607843137254902,1);
  const float e4 = 0.6;
  const vec4 v4 = vec4(0.47058823529411764,0.27450980392156865,0.0784313725490196,1);
  const float e5 = 1.0;
  const vec4 v5 = vec4(1,1,1,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),mix(v4,v5,a4)*step(e4,x)*step(x,e5)
  ))));
}
`,gY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0,1);
  const float e1 = 0.15;
  const vec4 v1 = vec4(0.11764705882352941,0,0.39215686274509803,1);
  const float e2 = 0.4;
  const vec4 v2 = vec4(0.47058823529411764,0,0.39215686274509803,1);
  const float e3 = 0.6;
  const vec4 v3 = vec4(0.6274509803921569,0.35294117647058826,0,1);
  const float e4 = 0.8;
  const vec4 v4 = vec4(0.9019607843137255,0.7843137254901961,0,1);
  const float e5 = 1.0;
  const vec4 v5 = vec4(1,0.9803921568627451,0.8627450980392157,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),mix(v4,v5,a4)*step(e4,x)*step(x,e5)
  ))));
}
`,mY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.11764705882352941,0.01568627450980392,0.43137254901960786,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.1843137254901961,0.054901960784313725,0.6901960784313725,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.1607843137254902,0.17647058823529413,0.9254901960784314,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.09803921568627451,0.38823529411764707,0.8313725490196079,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.26666666666666666,0.5137254901960784,0.7843137254901961,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.4470588235294118,0.611764705882353,0.7725490196078432,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.615686274509804,0.7098039215686275,0.796078431372549,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.7843137254901961,0.8156862745098039,0.8470588235294118,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9450980392156862,0.9294117647058824,0.9254901960784314,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,vY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.23529411764705882,0.03529411764705882,0.07058823529411765,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.39215686274509803,0.06666666666666667,0.10588235294117647,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.5568627450980392,0.0784313725490196,0.11372549019607843,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.6941176470588235,0.16862745098039217,0.10588235294117647,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.7529411764705882,0.3411764705882353,0.24705882352941178,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.803921568627451,0.49019607843137253,0.4117647058823529,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.8470588235294118,0.6352941176470588,0.5803921568627451,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.8901960784313725,0.7803921568627451,0.7568627450980392,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9450980392156862,0.9294117647058824,0.9254901960784314,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,yY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0.26666666666666666,0.10588235294117647,1);
  const float e1 = 0.125;
  const vec4 v1 = vec4(0,0.42745098039215684,0.17254901960784313,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.13725490196078433,0.5450980392156862,0.27058823529411763,1);
  const float e3 = 0.375;
  const vec4 v3 = vec4(0.2549019607843137,0.6705882352941176,0.36470588235294116,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.4549019607843137,0.7686274509803922,0.4627450980392157,1);
  const float e5 = 0.625;
  const vec4 v5 = vec4(0.6313725490196078,0.8509803921568627,0.6078431372549019,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.7803921568627451,0.9137254901960784,0.7529411764705882,1);
  const float e7 = 0.875;
  const vec4 v7 = vec4(0.8980392156862745,0.9607843137254902,0.8784313725490196,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9686274509803922,0.9882352941176471,0.9607843137254902,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,_Y=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0,1);
  const float e1 = 1.0;
  const vec4 v1 = vec4(1,1,1,1);
  float a0 = smoothstep(e0,e1,x);
  return mix(v0,v1,a0)*step(e0,x)*step(x,e1);
}
`,xY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0,1);
  const float e1 = 0.3;
  const vec4 v1 = vec4(0.9019607843137255,0,0,1);
  const float e2 = 0.6;
  const vec4 v2 = vec4(1,0.8235294117647058,0,1);
  const float e3 = 1.0;
  const vec4 v3 = vec4(1,1,1,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),mix(v2,v3,a2)*step(e2,x)*step(x,e3)
  ));
}
`,bY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(1,0,0,1);
  const float e1 = 0.169;
  const vec4 v1 = vec4(0.9921568627450981,1,0.00784313725490196,1);
  const float e2 = 0.173;
  const vec4 v2 = vec4(0.9686274509803922,1,0.00784313725490196,1);
  const float e3 = 0.337;
  const vec4 v3 = vec4(0,0.9882352941176471,0.01568627450980392,1);
  const float e4 = 0.341;
  const vec4 v4 = vec4(0,0.9882352941176471,0.0392156862745098,1);
  const float e5 = 0.506;
  const vec4 v5 = vec4(0.00392156862745098,0.9764705882352941,1,1);
  const float e6 = 0.671;
  const vec4 v6 = vec4(0.00784313725490196,0,0.9921568627450981,1);
  const float e7 = 0.675;
  const vec4 v7 = vec4(0.03137254901960784,0,0.9921568627450981,1);
  const float e8 = 0.839;
  const vec4 v8 = vec4(1,0,0.984313725490196,1);
  const float e9 = 0.843;
  const vec4 v9 = vec4(1,0,0.9607843137254902,1);
  const float e10 = 1.0;
  const vec4 v10 = vec4(1,0,0.023529411764705882,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  float a8 = smoothstep(e8,e9,x);
  float a9 = smoothstep(e9,e10,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),
    max(mix(v7,v8,a7)*step(e7,x)*step(x,e8),
    max(mix(v8,v9,a8)*step(e8,x)*step(x,e9),mix(v9,v10,a9)*step(e9,x)*step(x,e10)
  )))))))));
}
`,wY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0.01568627450980392,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.12156862745098039,0.047058823529411764,0.2823529411764706,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.3333333333333333,0.058823529411764705,0.42745098039215684,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.5333333333333333,0.13333333333333333,0.41568627450980394,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.7294117647058823,0.21176470588235294,0.3333333333333333,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.8901960784313725,0.34901960784313724,0.2,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.9764705882352941,0.5490196078431373,0.0392156862745098,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.9764705882352941,0.788235294117647,0.19607843137254902,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9882352941176471,1,0.6431372549019608,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,TY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0.5137254901960784,1);
  const float e1 = 0.125;
  const vec4 v1 = vec4(0,0.23529411764705882,0.6666666666666666,1);
  const float e2 = 0.375;
  const vec4 v2 = vec4(0.0196078431372549,1,1,1);
  const float e3 = 0.625;
  const vec4 v3 = vec4(1,1,0,1);
  const float e4 = 0.875;
  const vec4 v4 = vec4(0.9803921568627451,0,0,1);
  const float e5 = 1.0;
  const vec4 v5 = vec4(0.5019607843137255,0,0,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),mix(v4,v5,a4)*step(e4,x)*step(x,e5)
  ))));
}
`,SY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,0.01568627450980392,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.10980392156862745,0.06274509803921569,0.26666666666666666,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.30980392156862746,0.07058823529411765,0.4823529411764706,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.5058823529411764,0.1450980392156863,0.5058823529411764,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.7098039215686275,0.21176470588235294,0.47843137254901963,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.8980392156862745,0.3137254901960784,0.39215686274509803,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.984313725490196,0.5294117647058824,0.3803921568627451,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.996078431372549,0.7607843137254902,0.5294117647058824,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9882352941176471,0.9921568627450981,0.7490196078431373,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,EY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.25098039215686274,0.0196078431372549,0.0196078431372549,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.41568627450980394,0.023529411764705882,0.058823529411764705,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.5647058823529412,0.10196078431372549,0.027450980392156862,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.6588235294117647,0.25098039215686274,0.011764705882352941,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.7372549019607844,0.39215686274509803,0.01568627450980392,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.807843137254902,0.5333333333333333,0.043137254901960784,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.8627450980392157,0.6823529411764706,0.09803921568627451,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.9058823529411765,0.8431372549019608,0.17254901960784313,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9725490196078431,0.996078431372549,0.4117647058823529,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,AY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.2,0.0784313725490196,0.09411764705882353,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.35294117647058826,0.12549019607843137,0.13725490196078433,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.5058823529411764,0.17254901960784313,0.13333333333333333,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.6235294117647059,0.26666666666666666,0.09803921568627451,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.7137254901960784,0.38823529411764707,0.07450980392156863,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.7803921568627451,0.5254901960784314,0.08627450980392157,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.8313725490196079,0.6705882352941176,0.13725490196078433,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.8666666666666667,0.8235294117647058,0.21176470588235294,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.8823529411764706,0.9921568627450981,0.29411764705882354,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,CY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.5686274509803921,0.4117647058823529,0.07058823529411765,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.7215686274509804,0.2784313725490196,0.14901960784313725,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.7294117647058823,0.22745098039215686,0.45098039215686275,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.6274509803921569,0.2784313725490196,0.7254901960784313,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.43137254901960786,0.3803921568627451,0.8549019607843137,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.19607843137254902,0.4823529411764706,0.6431372549019608,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.12156862745098039,0.5137254901960784,0.43137254901960786,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.30196078431372547,0.5058823529411764,0.13333333333333333,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.5686274509803921,0.4117647058823529,0.07058823529411765,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,RY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,1,1);
  const float e1 = 0.1;
  const vec4 v1 = vec4(0.2,0.6,1,1);
  const float e2 = 0.2;
  const vec4 v2 = vec4(0.4,0.8,1,1);
  const float e3 = 0.3;
  const vec4 v3 = vec4(0.6,0.8,1,1);
  const float e4 = 0.4;
  const vec4 v4 = vec4(0.8,0.8,1,1);
  const float e5 = 0.5;
  const vec4 v5 = vec4(1,1,1,1);
  const float e6 = 0.6;
  const vec4 v6 = vec4(1,0.8,1,1);
  const float e7 = 0.7;
  const vec4 v7 = vec4(1,0.6,1,1);
  const float e8 = 0.8;
  const vec4 v8 = vec4(1,0.4,0.8,1);
  const float e9 = 0.9;
  const vec4 v9 = vec4(1,0.4,0.4,1);
  const float e10 = 1.0;
  const vec4 v10 = vec4(1,0,0,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  float a8 = smoothstep(e8,e9,x);
  float a9 = smoothstep(e9,e10,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),
    max(mix(v7,v8,a7)*step(e7,x)*step(x,e8),
    max(mix(v8,v9,a8)*step(e8,x)*step(x,e9),mix(v9,v10,a9)*step(e9,x)*step(x,e10)
  )))))))));
}
`,PY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.050980392156862744,0.03137254901960784,0.5294117647058824,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.29411764705882354,0.011764705882352941,0.6313725490196078,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.49019607843137253,0.011764705882352941,0.6588235294117647,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.6588235294117647,0.13333333333333333,0.5882352941176471,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.796078431372549,0.27450980392156865,0.4745098039215686,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.8980392156862745,0.4196078431372549,0.36470588235294116,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.9725490196078431,0.5803921568627451,0.2549019607843137,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.9921568627450981,0.7647058823529411,0.1568627450980392,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9411764705882353,0.9764705882352941,0.12941176470588237,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,IY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.047058823529411764,0.2,0.5137254901960784,1);
  const float e1 = 0.25;
  const vec4 v1 = vec4(0.0392156862745098,0.5333333333333333,0.7294117647058823,1);
  const float e2 = 0.5;
  const vec4 v2 = vec4(0.9490196078431372,0.8274509803921568,0.2196078431372549,1);
  const float e3 = 0.75;
  const vec4 v3 = vec4(0.9490196078431372,0.5607843137254902,0.2196078431372549,1);
  const float e4 = 1.0;
  const vec4 v4 = vec4(0.8509803921568627,0.11764705882352941,0.11764705882352941,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),mix(v3,v4,a3)*step(e3,x)*step(x,e4)
  )));
}
`,kY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.49019607843137253,0,0.7019607843137254,1);
  const float e1 = 0.1;
  const vec4 v1 = vec4(0.7803921568627451,0,0.7058823529411765,1);
  const float e2 = 0.2;
  const vec4 v2 = vec4(1,0,0.4745098039215686,1);
  const float e3 = 0.3;
  const vec4 v3 = vec4(1,0.4235294117647059,0,1);
  const float e4 = 0.4;
  const vec4 v4 = vec4(0.8705882352941177,0.7607843137254902,0,1);
  const float e5 = 0.5;
  const vec4 v5 = vec4(0.5882352941176471,1,0,1);
  const float e6 = 0.6;
  const vec4 v6 = vec4(0,1,0.21568627450980393,1);
  const float e7 = 0.7;
  const vec4 v7 = vec4(0,0.9647058823529412,0.5882352941176471,1);
  const float e8 = 0.8;
  const vec4 v8 = vec4(0.19607843137254902,0.6549019607843137,0.8705882352941177,1);
  const float e9 = 0.9;
  const vec4 v9 = vec4(0.403921568627451,0.2,0.9215686274509803,1);
  const float e10 = 1.0;
  const vec4 v10 = vec4(0.48627450980392156,0,0.7294117647058823,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  float a8 = smoothstep(e8,e9,x);
  float a9 = smoothstep(e9,e10,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),
    max(mix(v7,v8,a7)*step(e7,x)*step(x,e8),
    max(mix(v8,v9,a8)*step(e8,x)*step(x,e9),mix(v9,v10,a9)*step(e9,x)*step(x,e10)
  )))))))));
}
`,MY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.5882352941176471,0,0.35294117647058826,1);
  const float e1 = 0.125;
  const vec4 v1 = vec4(0,0,0.7843137254901961,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0,0.09803921568627451,1,1);
  const float e3 = 0.375;
  const vec4 v3 = vec4(0,0.596078431372549,1,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.17254901960784313,1,0.5882352941176471,1);
  const float e5 = 0.625;
  const vec4 v5 = vec4(0.592156862745098,1,0,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(1,0.9176470588235294,0,1);
  const float e7 = 0.875;
  const vec4 v7 = vec4(1,0.43529411764705883,0,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(1,0,0,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,OY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.0196078431372549,0.0392156862745098,0.6745098039215687,1);
  const float e1 = 0.35;
  const vec4 v1 = vec4(0.41568627450980394,0.5372549019607843,0.9686274509803922,1);
  const float e2 = 0.5;
  const vec4 v2 = vec4(0.7450980392156863,0.7450980392156863,0.7450980392156863,1);
  const float e3 = 0.6;
  const vec4 v3 = vec4(0.8627450980392157,0.6666666666666666,0.5176470588235295,1);
  const float e4 = 0.7;
  const vec4 v4 = vec4(0.9019607843137255,0.5686274509803921,0.35294117647058826,1);
  const float e5 = 1.0;
  const vec4 v5 = vec4(0.6980392156862745,0.0392156862745098,0.10980392156862745,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),mix(v4,v5,a4)*step(e4,x)*step(x,e5)
  ))));
}
`,NY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.16470588235294117,0.09411764705882353,0.4235294117647059,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.12941176470588237,0.19607843137254902,0.6352941176470588,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.058823529411764705,0.35294117647058826,0.5686274509803921,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.1568627450980392,0.4627450980392157,0.5372549019607843,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.23137254901960785,0.5725490196078431,0.5294117647058824,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.30980392156862746,0.6862745098039216,0.49411764705882355,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.47058823529411764,0.796078431372549,0.40784313725490196,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.7568627450980392,0.8666666666666667,0.39215686274509803,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9921568627450981,0.9372549019607843,0.6039215686274509,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,DY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(1,0,1,1);
  const float e1 = 1.0;
  const vec4 v1 = vec4(1,1,0,1);
  float a0 = smoothstep(e0,e1,x);
  return mix(v0,v1,a0)*step(e0,x)*step(x,e1);
}
`,LY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0.5019607843137255,0.4,1);
  const float e1 = 1.0;
  const vec4 v1 = vec4(1,1,0.4,1);
  float a0 = smoothstep(e0,e1,x);
  return mix(v0,v1,a0)*step(e0,x)*step(x,e1);
}
`,FY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.01568627450980392,0.13725490196078433,0.2,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.09019607843137255,0.2,0.47843137254901963,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.3333333333333333,0.23137254901960785,0.615686274509804,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.5058823529411764,0.30980392156862746,0.5607843137254902,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.6862745098039216,0.37254901960784315,0.5098039215686274,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.8705882352941177,0.4392156862745098,0.396078431372549,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.9764705882352941,0.5725490196078431,0.25882352941176473,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.9764705882352941,0.7686274509803922,0.2549019607843137,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9098039215686274,0.9803921568627451,0.3568627450980392,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,BY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.13333333333333333,0.12156862745098039,0.10588235294117647,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.2549019607843137,0.19607843137254902,0.1607843137254902,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.3843137254901961,0.27058823529411763,0.20392156862745098,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.5137254901960784,0.34901960784313724,0.2235294117647059,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.6313725490196078,0.4392156862745098,0.23137254901960785,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.7254901960784313,0.5490196078431373,0.25882352941176473,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.792156862745098,0.6823529411764706,0.34509803921568627,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.8470588235294118,0.8196078431372549,0.49411764705882355,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9137254901960784,0.9647058823529412,0.6705882352941176,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,UY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.06666666666666667,0.12549019607843137,0.25098039215686274,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.13725490196078433,0.20392156862745098,0.4549019607843137,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.11372549019607843,0.3176470588235294,0.611764705882353,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.12156862745098039,0.44313725490196076,0.6352941176470588,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.19607843137254902,0.5647058823529412,0.6627450980392157,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.3411764705882353,0.6784313725490196,0.6901960784313725,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.5843137254901961,0.7686274509803922,0.7411764705882353,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.796078431372549,0.8666666666666667,0.8274509803921568,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.996078431372549,0.984313725490196,0.9019607843137255,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,VY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.09019607843137255,0.13725490196078433,0.07450980392156863,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.09411764705882353,0.25098039215686274,0.14901960784313725,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.043137254901960784,0.37254901960784315,0.17647058823529413,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.15294117647058825,0.4823529411764706,0.13725490196078433,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.37254901960784315,0.5725490196078431,0.047058823529411764,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.596078431372549,0.6470588235294118,0.07058823529411765,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.788235294117647,0.7294117647058823,0.27058823529411763,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.9137254901960784,0.8470588235294118,0.5372549019607843,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(1,0.9921568627450981,0.803921568627451,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,zY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.26666666666666666,0.00392156862745098,0.32941176470588235,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.2784313725490196,0.17254901960784313,0.47843137254901963,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.23137254901960785,0.3176470588235294,0.5450980392156862,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(0.17254901960784313,0.44313725490196076,0.5568627450980392,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.12941176470588237,0.5647058823529412,0.5529411764705883,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(0.15294117647058825,0.6784313725490196,0.5058823529411764,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.3607843137254902,0.7843137254901961,0.38823529411764707,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.6666666666666666,0.8627450980392157,0.19607843137254902,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.9921568627450981,0.9058823529411765,0.1450980392156863,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,$Y=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.49019607843137253,0,0.7019607843137254,1);
  const float e1 = 0.13;
  const vec4 v1 = vec4(0.6745098039215687,0,0.7333333333333333,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.8588235294117647,0,0.6666666666666666,1);
  const float e3 = 0.38;
  const vec4 v3 = vec4(1,0,0.5098039215686274,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(1,0.24705882352941178,0.2901960784313726,1);
  const float e5 = 0.63;
  const vec4 v5 = vec4(1,0.4823529411764706,0,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.9176470588235294,0.6901960784313725,0,1);
  const float e7 = 0.88;
  const vec4 v7 = vec4(0.7450980392156863,0.8941176470588236,0,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(0.5764705882352941,1,0,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,jY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0,0,1,1);
  const float e1 = 1.0;
  const vec4 v1 = vec4(0,1,0.5019607843137255,1);
  float a0 = smoothstep(e0,e1,x);
  return mix(v0,v1,a0)*step(e0,x)*step(x,e1);
}
`,WY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.03137254901960784,0.11372549019607843,0.34509803921568627,1);
  const float e1 = 0.125;
  const vec4 v1 = vec4(0.1450980392156863,0.20392156862745098,0.5803921568627451,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.13333333333333333,0.3686274509803922,0.6588235294117647,1);
  const float e3 = 0.375;
  const vec4 v3 = vec4(0.11372549019607843,0.5686274509803921,0.7529411764705882,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.2549019607843137,0.7137254901960784,0.7686274509803922,1);
  const float e5 = 0.625;
  const vec4 v5 = vec4(0.4980392156862745,0.803921568627451,0.7333333333333333,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.7803921568627451,0.9137254901960784,0.7058823529411765,1);
  const float e7 = 0.875;
  const vec4 v7 = vec4(0.9294117647058824,0.9725490196078431,0.8509803921568627,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(1,1,0.8509803921568627,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,HY=`vec4 apply_cmap (float x) {
  const float e0 = 0.0;
  const vec4 v0 = vec4(0.5019607843137255,0,0.14901960784313725,1);
  const float e1 = 0.125;
  const vec4 v1 = vec4(0.7411764705882353,0,0.14901960784313725,1);
  const float e2 = 0.25;
  const vec4 v2 = vec4(0.8901960784313725,0.10196078431372549,0.10980392156862745,1);
  const float e3 = 0.375;
  const vec4 v3 = vec4(0.9882352941176471,0.3058823529411765,0.16470588235294117,1);
  const float e4 = 0.5;
  const vec4 v4 = vec4(0.9921568627450981,0.5529411764705883,0.23529411764705882,1);
  const float e5 = 0.625;
  const vec4 v5 = vec4(0.996078431372549,0.6980392156862745,0.2980392156862745,1);
  const float e6 = 0.75;
  const vec4 v6 = vec4(0.996078431372549,0.8509803921568627,0.4627450980392157,1);
  const float e7 = 0.875;
  const vec4 v7 = vec4(1,0.9294117647058824,0.6274509803921569,1);
  const float e8 = 1.0;
  const vec4 v8 = vec4(1,1,0.8,1);
  float a0 = smoothstep(e0,e1,x);
  float a1 = smoothstep(e1,e2,x);
  float a2 = smoothstep(e2,e3,x);
  float a3 = smoothstep(e3,e4,x);
  float a4 = smoothstep(e4,e5,x);
  float a5 = smoothstep(e5,e6,x);
  float a6 = smoothstep(e6,e7,x);
  float a7 = smoothstep(e7,e8,x);
  return max(mix(v0,v1,a0)*step(e0,x)*step(x,e1),
    max(mix(v1,v2,a1)*step(e1,x)*step(x,e2),
    max(mix(v2,v3,a2)*step(e2,x)*step(x,e3),
    max(mix(v3,v4,a3)*step(e3,x)*step(x,e4),
    max(mix(v4,v5,a4)*step(e4,x)*step(x,e5),
    max(mix(v5,v6,a5)*step(e5,x)*step(x,e6),
    max(mix(v6,v7,a6)*step(e6,x)*step(x,e7),mix(v7,v8,a7)*step(e7,x)*step(x,e8)
  )))))));
}
`,QC={__proto__:null,alpha:nY,autumn:rY,bathymetry:sY,blackbody:iY,bluered:oY,bone:aY,cdom:lY,chlorophyll:cY,cool:uY,copper:fY,cubehelix:dY,density:hY,earth:pY,electric:gY,freesurface_blue:mY,freesurface_red:vY,greens:yY,greys:_Y,hot:xY,hsv:bY,inferno:wY,jet:TY,magma:SY,oxygen:EY,par:AY,phase:CY,picnic:RY,plasma:PY,portland:IY,rainbow:MY,rainbow_soft:kY,rdbu:OY,salinity:NY,spring:DY,summer:LY,temperature:FY,turbidity:BY,velocity_blue:UY,velocity_green:VY,viridis:zY,warm:$Y,winter:jY,yignbu:WY,yiorrd:HY};function XY(n,e){return{name:`additive-colormap-${n}`,fs:`uniform float opacity;
uniform bool useTransparentColor;

${ZC}
${e}

vec4 colormap(float intensity) {
  return vec4(apply_transparent_color(apply_cmap(min(1.,intensity)).xyz, apply_cmap(0.).xyz, useTransparentColor, opacity));
}`,inject:{"fs:DECKGL_MUTATE_COLOR":`  float intensityCombo = 0.;
  intensityCombo += max(0.,intensity0);
  intensityCombo += max(0.,intensity1);
  intensityCombo += max(0.,intensity2);
  intensityCombo += max(0.,intensity3);
  intensityCombo += max(0.,intensity4);
  intensityCombo += max(0.,intensity5);
  rgba = colormap(intensityCombo);`}}}const Ph={colormap:{type:"string",value:"viridis",compare:!0},opacity:{type:"number",value:1,compare:!0},useTransparentColor:{type:"boolean",value:!1,compare:!0}},GC=class extends Fa{getShaders(){var t;const n=((t=this==null?void 0:this.props)==null?void 0:t.colormap)||Ph.colormap.value,e=QC[n];if(!e)throw Error(`No colormap named ${n} found in registry`);return{modules:[XY(n,e)]}}updateState({props:n,oldProps:e,changeFlags:t,...r}){if(super.updateState({props:n,oldProps:e,changeFlags:t,...r}),n.colormap!==e.colormap){const{device:s}=this.context;this.state.model&&(this.state.model.destroy(),this.setState({model:this._getModel(s)}))}}draw(){var r;const{useTransparentColor:n=Ph.useTransparentColor.value,opacity:e=Ph.opacity.value}=this.props,t={opacity:e,useTransparentColor:n};(r=this.state.model)==null||r.setUniforms(t)}};GC.extensionName="AdditiveColormapExtension";GC.defaultProps=Ph;function YY(n,e,t){for(let r=0;r<t;r+=1)n.push(e);return n}const bS=[[0,0,255],[0,255,0],[255,0,255],[255,255,0],[255,128,0],[0,255,255],[255,255,255],[255,0,0]];function F1(n){if(n>bS.length)throw new Error("Too many colors");return bS.slice(0,n)}function B1({colors:n,channelsVisible:e}){const t=n.map((i,o)=>e[o]?i.map(a=>a/eY):_S),r=KC-t.length;return YY(t,_S,r).reduce((i,o)=>i.concat(o),[])}const qY=`uniform vec3 transparentColor;
uniform bool useTransparentColor;
uniform float opacity;

uniform vec3 colors[6];

${ZC}

void mutate_color(inout vec3 rgb, float intensity0, float intensity1, float intensity2, float intensity3, float intensity4, float intensity5) { 
  rgb += max(0.0, min(1.0, intensity0)) * vec3(colors[0]);
  rgb += max(0.0, min(1.0, intensity1)) * vec3(colors[1]);
  rgb += max(0.0, min(1.0, intensity2)) * vec3(colors[2]);
  rgb += max(0.0, min(1.0, intensity3)) * vec3(colors[3]);
  rgb += max(0.0, min(1.0, intensity4)) * vec3(colors[4]);
  rgb += max(0.0, min(1.0, intensity5)) * vec3(colors[5]);
}

vec4 apply_opacity(vec3 rgb) {
  return vec4(apply_transparent_color(rgb, transparentColor, useTransparentColor, opacity));
}
`,KY=`vec3 rgb = rgba.rgb;
mutate_color(rgb, intensity0, intensity1, intensity2, intensity3, intensity4, intensity5);
rgba = apply_opacity(rgb);
`,ZY={name:"color-palette-module",fs:qY,inject:{"fs:DECKGL_MUTATE_COLOR":KY}},Ih={colors:{type:"array",value:null,compare:!0},opacity:{type:"number",value:1,compare:!0},transparentColor:{type:"array",value:null,compare:!0},useTransparentColor:{type:"boolean",value:!1,compare:!0}},gc=class extends Fa{getShaders(){return{...super.getShaders(),modules:[ZY]}}draw(){var a;const{colors:n,channelsVisible:e,opacity:t=Ih.opacity.value,transparentColor:r=Ih.transparentColor.value,useTransparentColor:s=Ih.useTransparentColor.value}=this.props,o={colors:B1({channelsVisible:e||this.selections.map(()=>!0),colors:n||F1(this.props.selections.length)}),opacity:t,transparentColor:(r||[0,0,0]).map(u=>u/255),useTransparentColor:!!s};(a=this.state.model)==null||a.setUniforms(o)}};gc.extensionName="ColorPaletteExtension";gc.defaultProps=Ih;const QY=`// lens bounds for ellipse
uniform float majorLensAxis;
uniform float minorLensAxis;
uniform vec2 lensCenter;

// lens uniforms
uniform bool lensEnabled;
uniform int lensSelection;
uniform vec3 lensBorderColor;
uniform float lensBorderRadius;

// color palette
uniform vec3 colors[6];

bool frag_in_lens_bounds(vec2 vTexCoord) {
  // Check membership in what is (not visually, but effectively) an ellipse.
  // Since the fragment space is a unit square and the real coordinates could be longer than tall,
  // to get a circle visually we have to treat the check as that of an ellipse to get the effect of a circle.

  // Check membership in ellipse.
  return pow((lensCenter.x - vTexCoord.x) / majorLensAxis, 2.) + pow((lensCenter.y - vTexCoord.y) / minorLensAxis, 2.) < (1. - lensBorderRadius);
}

bool frag_on_lens_bounds(vec2 vTexCoord) {
  // Same as the above, except this checks the boundary.

  float ellipseDistance = pow((lensCenter.x - vTexCoord.x) / majorLensAxis, 2.) + pow((lensCenter.y - vTexCoord.y) / minorLensAxis, 2.);

  // Check membership on "bourndary" of ellipse.
  return ellipseDistance <= 1. && ellipseDistance >= (1. - lensBorderRadius);
}
// Return a float for boolean arithmetic calculation.
float get_use_color_float(vec2 vTexCoord, int channelIndex) {
  bool isFragInLensBounds = frag_in_lens_bounds(vTexCoord);
  bool inLensAndUseLens = lensEnabled && isFragInLensBounds;
  return float(int((inLensAndUseLens && channelIndex == lensSelection) || (!inLensAndUseLens)));
 
}
void mutate_color(inout vec3 rgb, float intensity0, float intensity1, float intensity2, float intensity3, float intensity4, float intensity5, vec2 vTexCoord){
  float useColorValue = 0.;

  useColorValue = get_use_color_float(vTexCoord, 0);
  rgb += max(0., min(1., intensity0)) * max(vec3(colors[0]), (1. - useColorValue) * vec3(1., 1., 1.));

  useColorValue = get_use_color_float(vTexCoord, 1);
  rgb += max(0., min(1., intensity1)) * max(vec3(colors[1]), (1. - useColorValue) * vec3(1., 1., 1.));

  useColorValue = get_use_color_float(vTexCoord, 2);
  rgb += max(0., min(1., intensity2)) * max(vec3(colors[2]), (1. - useColorValue) * vec3(1., 1., 1.));

  useColorValue = get_use_color_float(vTexCoord, 3);
  rgb += max(0., min(1., intensity3)) * max(vec3(colors[3]), (1. - useColorValue) * vec3(1., 1., 1.));

  useColorValue = get_use_color_float(vTexCoord, 4);
  rgb += max(0., min(1., intensity4)) * max(vec3(colors[4]), (1. - useColorValue) * vec3(1., 1., 1.));

  useColorValue = get_use_color_float(vTexCoord, 5);
  rgb += max(0., min(1., intensity5)) * max(vec3(colors[5]), (1. - useColorValue) * vec3(1., 1., 1.));
}
`,GY={name:"lens-module",fs:QY,inject:{"fs:DECKGL_MUTATE_COLOR":`
   vec3 rgb = rgba.rgb;
   mutate_color(rgb, intensity0, intensity1, intensity2, intensity3, intensity4, intensity5, vTexCoord);
   rgba = vec4(rgb, 1.);
  `,"fs:#main-end":`
      bool isFragOnLensBounds = frag_on_lens_bounds(vTexCoord);
      fragColor = (lensEnabled && isFragOnLensBounds) ? vec4(lensBorderColor, 1.) : fragColor;
  `}},El={lensEnabled:{type:"boolean",value:!1,compare:!0},lensSelection:{type:"number",value:0,compare:!0},lensRadius:{type:"number",value:100,compare:!0},lensBorderColor:{type:"array",value:[255,255,255],compare:!0},lensBorderRadius:{type:"number",value:.02,compare:!0},colors:{type:"array",value:null,compare:!0}},JC=class extends Fa{getShaders(){return{...super.getShaders(),modules:[GY]}}initializeState(){const n=this.getCurrentLayer();if(n.isComposite)return;const e=()=>{const{viewportId:t}=n.props,{lensRadius:r=El.lensRadius.value}=this.props;if(!t){n.setState({unprojectLensBounds:[0,0,0,0]});return}const{mousePosition:s}=n.context,i=n.context.deck.viewManager.views.filter(u=>u.id===t)[0],o=n.context.deck.viewManager.viewState[t],a=i.makeViewport({...o,viewState:o});if(s&&a.containsPixel(s)){const u={x:s.x-a.x,y:s.y-a.y},d=[[u.x-r,u.y],[u.x,u.y+r],[u.x+r,u.y],[u.x,u.y-r]].map((p,m)=>a.unproject(p)[m%2]);n.setState({unprojectLensBounds:d})}else n.setState({unprojectLensBounds:[0,0,0,0]})};this.context.deck&&this.context.deck.eventManager.on({pointermove:e,pointerleave:e,wheel:e}),this.setState({onMouseMove:e,unprojectLensBounds:[0,0,0,0]})}draw(){var F;const{unprojectLensBounds:n=[0,0,0,0]}=this.state,{bounds:e,lensEnabled:t=El.lensEnabled.value,lensSelection:r=El.lensSelection.value,lensBorderColor:s=El.lensBorderColor.value,lensBorderRadius:i=El.lensBorderRadius.value,colors:o,channelsVisible:a}=this.props,[u,f,d,p]=n,[m,v,x,b]=e,w=(u-m)/(x-m),S=(f-b)/(v-b),R=(d-m)/(x-m),C=(p-b)/(v-b),O=B1({channelsVisible:a||this.selections.map(()=>!0),colors:o||F1(this.props.selections.length)}),I={majorLensAxis:(R-w)/2,minorLensAxis:(S-C)/2,lensCenter:[(R+w)/2,(S+C)/2],lensEnabled:t,lensSelection:r,lensBorderColor:s,lensBorderRadius:i,colors:O};(F=this.state.model)==null||F.setUniforms(I)}finalizeState(){var n,e,t;this.context.deck&&this.context.deck.eventManager.off({pointermove:(n=this.state)==null?void 0:n.onMouseMove,pointerleave:(e=this.state)==null?void 0:e.onMouseMove,wheel:(t=this.state)==null?void 0:t.onMouseMove})}};JC.extensionName="LensExtension";JC.defaultProps=El;function JY(n,e){const t=`${e}

vec4 colormap(float intensity, float opacity) {
  return vec4(apply_cmap(min(1.,intensity)).xyz, opacity);
}`;return{name:`additive-colormap-3d-${n}`,fs:t}}const eR={colormap:{type:"string",value:"viridis",compare:!0}},If=class extends Fa{constructor(...e){super(e),this.opts=this.opts||{}}getShaders(){var r;const e=((r=this==null?void 0:this.props)==null?void 0:r.colormap)||eR.colormap.value,t=QC[e];return{...super.getShaders(),modules:[JY(e,t)]}}updateState({props:e,oldProps:t,changeFlags:r,...s}){if(super.updateState({props:e,oldProps:t,changeFlags:r,...s}),e.colormap!==t.colormap){const{device:i}=this.context;this.state.model&&(this.state.model.destroy(),this.setState({model:this._getModel(i)}))}}};If.extensionName="BaseExtension";If.defaultProps=eR;const eq="",tq=`  float intensityArray[6] = float[6](intensityValue0, intensityValue1, intensityValue2, intensityValue3, intensityValue4, intensityValue5);
  float total = 0.0;

  for(int i = 0; i < 6; i++) {
    total += intensityArray[i];
  }
  // Do not go past 1 in opacity/colormap value.
  total = min(total, 1.0);

  vec4 val_color = colormap(total, total);

  // Opacity correction
  val_color.a = 1.0 - pow(1.0 - val_color.a, 1.0);
  color.rgb += (1.0 - color.a) * val_color.a * val_color.rgb;
  color.a += (1.0 - color.a) * val_color.a;
  if (color.a >= 0.95) {
    break;
  }
  p += ray_dir * dt;
`,nq="",rq=class extends If{constructor(e){super(e),this.rendering={_BEFORE_RENDER:eq,_RENDER:tq,_AFTER_RENDER:nq}}};rq.extensionName="AdditiveBlendExtension";const sq=`  float maxVals[6] = float[6](-1.0, -1.0, -1.0, -1.0, -1.0, -1.0);
`,iq=`  float intensityArray[6] = float[6](intensityValue0, intensityValue1, intensityValue2, intensityValue3, intensityValue4, intensityValue5);

  for(int i = 0; i < 6; i++) {
    if(intensityArray[i] > maxVals[i]) {
      maxVals[i] = intensityArray[i];
    }
  }
`,oq=`  float total = 0.0;
  for(int i = 0; i < 6; i++) {
    total += maxVals[i];
  }
  // Do not go past 1 in opacity/colormap value.
  total = min(total, 1.0);
  color = colormap(total, total);
`,aq=class extends If{constructor(e){super(e),this.rendering={_BEFORE_RENDER:sq,_RENDER:iq,_AFTER_RENDER:oq}}};aq.extensionName="MaximumIntensityProjectionExtension";const lq=`  float minVals[6] = float[6](1. / 0., 1. / 0., 1. / 0., 1. / 0., 1. / 0., 1. / 0.);
`,cq=`  float intensityArray[6] = float[6](intensityValue0, intensityValue1, intensityValue2, intensityValue3, intensityValue4, intensityValue5);

  for(int i = 0; i < 6; i++) {
    if(intensityArray[i] < minVals[i]) {
      minVals[i] = intensityArray[i];
    }
  }
`,uq=`  float total = 0.0;
  for(int i = 0; i < 6; i++) {
    total += minVals[i];
  }
  // Do not go past 1 in opacity/colormap value.
  total = min(total, 1.0);
  color = colormap(total, total);
`,fq=class extends If{constructor(e){super(e),this.rendering={_BEFORE_RENDER:lq,_RENDER:cq,_AFTER_RENDER:uq}}};fq.extensionName="MinimumIntensityProjectionExtension";const dq={colors:{type:"array",value:null,compare:!0}},kf=class extends Fa{constructor(...n){super(n),this.opts=this.opts||{}}draw(){var s;const{colors:n,channelsVisible:e}=this.props,r={colors:B1({channelsVisible:e||this.selections.map(()=>!0),colors:n||F1(this.props.selections.length)})};(s=this.state.model)==null||s.setUniforms(r)}};kf.extensionName="BaseExtension";kf.defaultProps=dq;const hq="",pq=`  vec3 rgbCombo = vec3(0.0);
  vec3 hsvCombo = vec3(0.0);
  float intensityArray[6] = float[6](intensityValue0, intensityValue1, intensityValue2, intensityValue3, intensityValue4, intensityValue5);
  float total = 0.0;
  for(int i = 0; i < 6; i++) {
    float intensityValue = intensityArray[i];
    rgbCombo += max(0.0, min(1.0, intensityValue)) * colors[i];
    total += intensityValue;
  }
  // Do not go past 1 in opacity.
  total = min(total, 1.0);
  vec4 val_color = vec4(rgbCombo, total);
  // Opacity correction
  val_color.a = 1.0 - pow(1.0 - val_color.a, 1.0);
  color.rgb += (1.0 - color.a) * val_color.a * val_color.rgb;
  color.a += (1.0 - color.a) * val_color.a;
  if (color.a >= 0.95) {
    break;
  }
`,gq="",tR=class extends kf{constructor(n){super(n),this.rendering={_BEFORE_RENDER:hq,_RENDER:pq,_AFTER_RENDER:gq}}};tR.extensionName="AdditiveBlendExtension";const mq=`  float maxVals[6] = float[6](-1.0, -1.0, -1.0, -1.0, -1.0, -1.0);
`,vq=`  float intensityArray[6] = float[6](intensityValue0, intensityValue1, intensityValue2, intensityValue3, intensityValue4, intensityValue5);

  for(int i = 0; i < 6; i++) {
    if(intensityArray[i] > maxVals[i]) {
      maxVals[i] = intensityArray[i];
    }
  }
`,yq=`  vec3 rgbCombo = vec3(0.0);
  for(int i = 0; i < 6; i++) {
    rgbCombo += max(0.0, min(1.0, maxVals[i])) * vec3(colors[i]);
  }
  color = vec4(rgbCombo, 1.0);
`,_q=class extends kf{constructor(n){super(n),this.rendering={_BEFORE_RENDER:mq,_RENDER:vq,_AFTER_RENDER:yq}}};_q.extensionName="MaximumIntensityProjectionExtension";const xq=`  float minVals[6] = float[6](1. / 0., 1. / 0., 1. / 0., 1. / 0., 1. / 0., 1. / 0.);
`,bq=`  float intensityArray[6] = float[6](intensityValue0, intensityValue1, intensityValue2, intensityValue3, intensityValue4, intensityValue5);

  for(int i = 0; i < 6; i++) {
    if(intensityArray[i] < minVals[i]) {
      minVals[i] = intensityArray[i];
    }
  }
`,wq=`  vec3 rgbCombo = vec3(0.0);
  for(int i = 0; i < 6; i++) {
    rgbCombo += max(0.0, min(1.0, minVals[i])) * vec3(colors[i]);
  }
  color = vec4(rgbCombo, 1.0);
`,Tq=class extends kf{constructor(n){super(n),this.rendering={_BEFORE_RENDER:xq,_RENDER:bq,_AFTER_RENDER:wq}}};Tq.extensionName="MinimumIntensityProjectionExtension";const nR={AdditiveBlendExtension:tR},LZ={AddCompression:1},FZ={None:0,Deflate:1,Zstandard:2},Sq=new Map;function Ei(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>Sq.set(t,e))}Ei([void 0,1],()=>Fr(()=>import("./raw-BRCDq2n0.js"),[],import.meta.url).then(n=>n.default));Ei(5,()=>Fr(()=>import("./lzw-DD0ZGr4X.js"),[],import.meta.url).then(n=>n.default));Ei(6,()=>{throw new Error("old style JPEG compression is not supported.")});Ei(7,()=>Fr(()=>import("./jpeg-BamV8XBm.js"),[],import.meta.url).then(n=>n.default));Ei([8,32946],()=>Fr(()=>import("./deflate-BTTP7dV-.js"),__vite__mapDeps([4,5]),import.meta.url).then(n=>n.default));Ei(32773,()=>Fr(()=>import("./packbits-B1purkGE.js"),[],import.meta.url).then(n=>n.default));Ei(34887,()=>Fr(()=>import("./lerc-Dqj69v3t.js"),__vite__mapDeps([6,5]),import.meta.url).then(async n=>(await n.zstd.init(),n)).then(n=>n.default));Ei(50001,()=>Fr(()=>import("./webimage-r6otvKjv.js"),[],import.meta.url).then(n=>n.default));function Eq(n,e){let t=n.length-e,r=0;do{for(let s=e;s>0;s--)n[r+e]+=n[r],r++;t-=e}while(t>0)}function Aq(n,e,t){let r=0,s=n.length;const i=s/t;for(;s>e;){for(let a=e;a>0;--a)n[r+e]+=n[r],++r;s-=e}const o=n.slice();for(let a=0;a<i;++a)for(let u=0;u<t;++u)n[t*a+u]=o[(t-u-1)*i+a]}function Cq(n,e,t,r,s,i){if(e===1)return n;for(let u=0;u<s.length;++u){if(s[u]%8!==0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(s[u]!==s[0])throw new Error("When decoding with predictor, all samples must have the same size.")}const o=s[0]/8,a=i===2?1:s.length;for(let u=0;u<r&&!(u*a*t*o>=n.byteLength);++u){let f;if(e===2){switch(s[0]){case 8:f=new Uint8Array(n,u*a*t*o,a*t*o);break;case 16:f=new Uint16Array(n,u*a*t*o,a*t*o/2);break;case 32:f=new Uint32Array(n,u*a*t*o,a*t*o/4);break;default:throw new Error(`Predictor 2 not allowed with ${s[0]} bits per sample.`)}Eq(f,a)}else e===3&&(f=new Uint8Array(n,u*a*t*o,a*t*o),Aq(f,a,o))}return n}class Rq{async decode(e,t){const r=await this.decodeBlock(t),s=e.Predictor||1;if(s!==1){const i=!e.StripOffsets,o=i?e.TileWidth:e.ImageWidth,a=i?e.TileLength:e.RowsPerStrip||e.ImageLength;return Cq(r,s,o,a,e.BitsPerSample,e.PlanarConfiguration)}return r}}var _t;(function(n){n.assertEqual=s=>s;function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},n.getValidEnumValues=s=>{const i=n.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return n.objectValues(o)},n.objectValues=s=>n.objectKeys(s).map(function(i){return s[i]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},n.find=(s,i)=>{for(const o of s)if(i(o))return o},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}n.joinValues=r,n.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(_t||(_t={}));var wS;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(wS||(wS={}));const Le=_t.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),oo=n=>{switch(typeof n){case"undefined":return Le.undefined;case"string":return Le.string;case"number":return isNaN(n)?Le.nan:Le.number;case"boolean":return Le.boolean;case"function":return Le.function;case"bigint":return Le.bigint;case"symbol":return Le.symbol;case"object":return Array.isArray(n)?Le.array:n===null?Le.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?Le.promise:typeof Map<"u"&&n instanceof Map?Le.map:typeof Set<"u"&&n instanceof Set?Le.set:typeof Date<"u"&&n instanceof Date?Le.date:Le.object;default:return Le.unknown}},Ae=_t.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ts extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let a=r,u=0;for(;u<o.path.length;){const f=o.path[u];u===o.path.length-1?(a[f]=a[f]||{_errors:[]},a[f]._errors.push(t(o))):a[f]=a[f]||{_errors:[]},a=a[f],u++}}};return s(this),r}static assert(e){if(!(e instanceof ts))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,_t.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}ts.create=n=>new ts(n);const Qu=(n,e)=>{let t;switch(n.code){case Ae.invalid_type:n.received===Le.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case Ae.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,_t.jsonStringifyReplacer)}`;break;case Ae.unrecognized_keys:t=`Unrecognized key(s) in object: ${_t.joinValues(n.keys,", ")}`;break;case Ae.invalid_union:t="Invalid input";break;case Ae.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${_t.joinValues(n.options)}`;break;case Ae.invalid_enum_value:t=`Invalid enum value. Expected ${_t.joinValues(n.options)}, received '${n.received}'`;break;case Ae.invalid_arguments:t="Invalid function arguments";break;case Ae.invalid_return_type:t="Invalid function return type";break;case Ae.invalid_date:t="Invalid date";break;case Ae.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:_t.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case Ae.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case Ae.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case Ae.custom:t="Invalid input";break;case Ae.invalid_intersection_types:t="Intersection results could not be merged";break;case Ae.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case Ae.not_finite:t="Number must be finite";break;default:t=e.defaultError,_t.assertNever(n)}return{message:t}};let Pq=Qu;function Gy(){return Pq}const Jy=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,i=[...t,...s.path||[]],o={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let a="";const u=r.filter(f=>!!f).slice().reverse();for(const f of u)a=f(o,{data:e,defaultError:a}).message;return{...s,path:i,message:a}};function Oe(n,e){const t=Gy(),r=Jy({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===Qu?void 0:Qu].filter(s=>!!s)});n.common.issues.push(r)}class lr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return st;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const i=await s.key,o=await s.value;r.push({key:i,value:o})}return lr.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return st;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const st=Object.freeze({status:"aborted"}),yu=n=>({status:"dirty",value:n}),Tr=n=>({status:"valid",value:n}),TS=n=>n.status==="aborted",SS=n=>n.status==="dirty",oc=n=>n.status==="valid",hp=n=>typeof Promise<"u"&&n instanceof Promise;function pp(n,e,t,r){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(n)}function rR(n,e,t,r,s){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}var We;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(We||(We={}));var _u,xu;class Xs{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ES=(n,e)=>{if(oc(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ts(n.common.issues);return this._error=t,this._error}}};function ot(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>{var u,f;const{message:d}=n;return o.code==="invalid_enum_value"?{message:d??a.defaultError}:typeof a.data>"u"?{message:(u=d??r)!==null&&u!==void 0?u:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(f=d??t)!==null&&f!==void 0?f:a.defaultError}},description:s}}class dt{get description(){return this._def.description}_getType(e){return oo(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:oo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new lr,ctx:{common:e.parent.common,data:e.data,parsedType:oo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(hp(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const s={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:oo(e)},i=this._parseSync({data:e,path:s.path,parent:s});return ES(s,i)}"~validate"(e){var t,r;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:oo(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:s});return oc(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((r=(t=i==null?void 0:i.message)===null||t===void 0?void 0:t.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(i=>oc(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:oo(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(hp(s)?s:Promise.resolve(s));return ES(r,i)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:Ae.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new wi({schema:this,typeName:Je.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return mi.create(this,this._def)}nullable(){return Ia.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ws.create(this)}promise(){return Gu.create(this,this._def)}or(e){return yp.create([this,e],this._def)}and(e){return _p.create(this,e,this._def)}transform(e){return new wi({...ot(this._def),schema:this,typeName:Je.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Sp({...ot(this._def),innerType:this,defaultValue:t,typeName:Je.ZodDefault})}brand(){return new aR({typeName:Je.ZodBranded,type:this,...ot(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Ep({...ot(this._def),innerType:this,catchValue:t,typeName:Je.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return gg.create(this,e)}readonly(){return Ap.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Iq=/^c[^\s-]{8,}$/i,kq=/^[0-9a-z]+$/,Mq=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Oq=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Nq=/^[a-z0-9_-]{21}$/i,Dq=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Lq=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Fq=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Bq="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let _v;const Uq=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Vq=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,zq=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,$q=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,jq=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Wq=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,sR="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Hq=new RegExp(`^${sR}$`);function iR(n){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`),e}function Xq(n){return new RegExp(`^${iR(n)}$`)}function Yq(n){let e=`${sR}T${iR(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function qq(n,e){return!!((e==="v4"||!e)&&Uq.test(n)||(e==="v6"||!e)&&zq.test(n))}function Kq(n,e){if(!Dq.test(n))return!1;try{const[t]=n.split("."),r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function Zq(n,e){return!!((e==="v4"||!e)&&Vq.test(n)||(e==="v6"||!e)&&$q.test(n))}class $s extends dt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Le.string){const i=this._getOrReturnCtx(e);return Oe(i,{code:Ae.invalid_type,expected:Le.string,received:i.parsedType}),st}const r=new lr;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?Oe(s,{code:Ae.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&Oe(s,{code:Ae.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Fq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"email",code:Ae.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")_v||(_v=new RegExp(Bq,"u")),_v.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"emoji",code:Ae.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Oq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"uuid",code:Ae.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Nq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"nanoid",code:Ae.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Iq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"cuid",code:Ae.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")kq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"cuid2",code:Ae.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Mq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"ulid",code:Ae.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Oe(s,{validation:"url",code:Ae.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"regex",code:Ae.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Yq(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?Hq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?Xq(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Lq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"duration",code:Ae.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?qq(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"ip",code:Ae.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?Kq(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"jwt",code:Ae.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?Zq(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"cidr",code:Ae.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?jq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"base64",code:Ae.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Wq.test(e.data)||(s=this._getOrReturnCtx(e,s),Oe(s,{validation:"base64url",code:Ae.invalid_string,message:i.message}),r.dirty()):_t.assertNever(i);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:Ae.invalid_string,...We.errToObj(r)})}_addCheck(e){return new $s({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...We.errToObj(e)})}url(e){return this._addCheck({kind:"url",...We.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...We.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...We.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...We.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...We.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...We.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...We.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...We.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...We.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...We.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...We.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...We.errToObj(e)})}datetime(e){var t,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...We.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...We.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...We.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...We.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...We.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...We.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...We.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...We.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...We.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...We.errToObj(t)})}nonempty(e){return this.min(1,We.errToObj(e))}trim(){return new $s({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new $s({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new $s({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}$s.create=n=>{var e;return new $s({checks:[],typeName:Je.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...ot(n)})};function Qq(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,i=parseInt(n.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class Ca extends dt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Le.number){const i=this._getOrReturnCtx(e);return Oe(i,{code:Ae.invalid_type,expected:Le.number,received:i.parsedType}),st}let r;const s=new lr;for(const i of this._def.checks)i.kind==="int"?_t.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Oe(r,{code:Ae.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Oe(r,{code:Ae.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Oe(r,{code:Ae.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Qq(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Oe(r,{code:Ae.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Oe(r,{code:Ae.not_finite,message:i.message}),s.dirty()):_t.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,We.toString(t))}gt(e,t){return this.setLimit("min",e,!1,We.toString(t))}lte(e,t){return this.setLimit("max",e,!0,We.toString(t))}lt(e,t){return this.setLimit("max",e,!1,We.toString(t))}setLimit(e,t,r,s){return new Ca({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:We.toString(s)}]})}_addCheck(e){return new Ca({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:We.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:We.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:We.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:We.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:We.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:We.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:We.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:We.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:We.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&_t.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Ca.create=n=>new Ca({checks:[],typeName:Je.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...ot(n)});class Ra extends dt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Le.bigint)return this._getInvalidInput(e);let r;const s=new lr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Oe(r,{code:Ae.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Oe(r,{code:Ae.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Oe(r,{code:Ae.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):_t.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Oe(t,{code:Ae.invalid_type,expected:Le.bigint,received:t.parsedType}),st}gte(e,t){return this.setLimit("min",e,!0,We.toString(t))}gt(e,t){return this.setLimit("min",e,!1,We.toString(t))}lte(e,t){return this.setLimit("max",e,!0,We.toString(t))}lt(e,t){return this.setLimit("max",e,!1,We.toString(t))}setLimit(e,t,r,s){return new Ra({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:We.toString(s)}]})}_addCheck(e){return new Ra({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:We.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:We.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:We.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:We.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:We.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ra.create=n=>{var e;return new Ra({checks:[],typeName:Je.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...ot(n)})};class gp extends dt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Le.boolean){const r=this._getOrReturnCtx(e);return Oe(r,{code:Ae.invalid_type,expected:Le.boolean,received:r.parsedType}),st}return Tr(e.data)}}gp.create=n=>new gp({typeName:Je.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...ot(n)});class ac extends dt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Le.date){const i=this._getOrReturnCtx(e);return Oe(i,{code:Ae.invalid_type,expected:Le.date,received:i.parsedType}),st}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Oe(i,{code:Ae.invalid_date}),st}const r=new lr;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),Oe(s,{code:Ae.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):_t.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ac({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:We.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:We.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}ac.create=n=>new ac({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:Je.ZodDate,...ot(n)});class e_ extends dt{_parse(e){if(this._getType(e)!==Le.symbol){const r=this._getOrReturnCtx(e);return Oe(r,{code:Ae.invalid_type,expected:Le.symbol,received:r.parsedType}),st}return Tr(e.data)}}e_.create=n=>new e_({typeName:Je.ZodSymbol,...ot(n)});class mp extends dt{_parse(e){if(this._getType(e)!==Le.undefined){const r=this._getOrReturnCtx(e);return Oe(r,{code:Ae.invalid_type,expected:Le.undefined,received:r.parsedType}),st}return Tr(e.data)}}mp.create=n=>new mp({typeName:Je.ZodUndefined,...ot(n)});class vp extends dt{_parse(e){if(this._getType(e)!==Le.null){const r=this._getOrReturnCtx(e);return Oe(r,{code:Ae.invalid_type,expected:Le.null,received:r.parsedType}),st}return Tr(e.data)}}vp.create=n=>new vp({typeName:Je.ZodNull,...ot(n)});class t_ extends dt{constructor(){super(...arguments),this._any=!0}_parse(e){return Tr(e.data)}}t_.create=n=>new t_({typeName:Je.ZodAny,...ot(n)});class $l extends dt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Tr(e.data)}}$l.create=n=>new $l({typeName:Je.ZodUnknown,...ot(n)});class Ro extends dt{_parse(e){const t=this._getOrReturnCtx(e);return Oe(t,{code:Ae.invalid_type,expected:Le.never,received:t.parsedType}),st}}Ro.create=n=>new Ro({typeName:Je.ZodNever,...ot(n)});class n_ extends dt{_parse(e){if(this._getType(e)!==Le.undefined){const r=this._getOrReturnCtx(e);return Oe(r,{code:Ae.invalid_type,expected:Le.void,received:r.parsedType}),st}return Tr(e.data)}}n_.create=n=>new n_({typeName:Je.ZodVoid,...ot(n)});class Ws extends dt{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==Le.array)return Oe(t,{code:Ae.invalid_type,expected:Le.array,received:t.parsedType}),st;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(o||a)&&(Oe(t,{code:o?Ae.too_big:Ae.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(Oe(t,{code:Ae.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(Oe(t,{code:Ae.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>s.type._parseAsync(new Xs(t,o,t.path,a)))).then(o=>lr.mergeArray(r,o));const i=[...t.data].map((o,a)=>s.type._parseSync(new Xs(t,o,t.path,a)));return lr.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new Ws({...this._def,minLength:{value:e,message:We.toString(t)}})}max(e,t){return new Ws({...this._def,maxLength:{value:e,message:We.toString(t)}})}length(e,t){return new Ws({...this._def,exactLength:{value:e,message:We.toString(t)}})}nonempty(e){return this.min(1,e)}}Ws.create=(n,e)=>new Ws({type:n,minLength:null,maxLength:null,exactLength:null,typeName:Je.ZodArray,...ot(e)});function Al(n){if(n instanceof cn){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=mi.create(Al(r))}return new cn({...n._def,shape:()=>e})}else return n instanceof Ws?new Ws({...n._def,type:Al(n.element)}):n instanceof mi?mi.create(Al(n.unwrap())):n instanceof Ia?Ia.create(Al(n.unwrap())):n instanceof bi?bi.create(n.items.map(e=>Al(e))):n}class cn extends dt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=_t.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Le.object){const f=this._getOrReturnCtx(e);return Oe(f,{code:Ae.invalid_type,expected:Le.object,received:f.parsedType}),st}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Ro&&this._def.unknownKeys==="strip"))for(const f in s.data)o.includes(f)||a.push(f);const u=[];for(const f of o){const d=i[f],p=s.data[f];u.push({key:{status:"valid",value:f},value:d._parse(new Xs(s,p,s.path,f)),alwaysSet:f in s.data})}if(this._def.catchall instanceof Ro){const f=this._def.unknownKeys;if(f==="passthrough")for(const d of a)u.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(f==="strict")a.length>0&&(Oe(s,{code:Ae.unrecognized_keys,keys:a}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const d of a){const p=s.data[d];u.push({key:{status:"valid",value:d},value:f._parse(new Xs(s,p,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const f=[];for(const d of u){const p=await d.key,m=await d.value;f.push({key:p,value:m,alwaysSet:d.alwaysSet})}return f}).then(f=>lr.mergeObjectSync(r,f)):lr.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return We.errToObj,new cn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var s,i,o,a;const u=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,r).message)!==null&&o!==void 0?o:r.defaultError;return t.code==="unrecognized_keys"?{message:(a=We.errToObj(e).message)!==null&&a!==void 0?a:u}:{message:u}}}:{}})}strip(){return new cn({...this._def,unknownKeys:"strip"})}passthrough(){return new cn({...this._def,unknownKeys:"passthrough"})}extend(e){return new cn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new cn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Je.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new cn({...this._def,catchall:e})}pick(e){const t={};return _t.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new cn({...this._def,shape:()=>t})}omit(e){const t={};return _t.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new cn({...this._def,shape:()=>t})}deepPartial(){return Al(this)}partial(e){const t={};return _t.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}),new cn({...this._def,shape:()=>t})}required(e){const t={};return _t.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof mi;)i=i._def.innerType;t[r]=i}}),new cn({...this._def,shape:()=>t})}keyof(){return oR(_t.objectKeys(this.shape))}}cn.create=(n,e)=>new cn({shape:()=>n,unknownKeys:"strip",catchall:Ro.create(),typeName:Je.ZodObject,...ot(e)});cn.strictCreate=(n,e)=>new cn({shape:()=>n,unknownKeys:"strict",catchall:Ro.create(),typeName:Je.ZodObject,...ot(e)});cn.lazycreate=(n,e)=>new cn({shape:n,unknownKeys:"strip",catchall:Ro.create(),typeName:Je.ZodObject,...ot(e)});class yp extends dt{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new ts(a.ctx.common.issues));return Oe(t,{code:Ae.invalid_union,unionErrors:o}),st}if(t.common.async)return Promise.all(r.map(async i=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const u of r){const f={...t,common:{...t.common,issues:[]},parent:null},d=u._parseSync({data:t.data,path:t.path,parent:f});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:f}),f.common.issues.length&&o.push(f.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(u=>new ts(u));return Oe(t,{code:Ae.invalid_union,unionErrors:a}),st}}get options(){return this._def.options}}yp.create=(n,e)=>new yp({options:n,typeName:Je.ZodUnion,...ot(e)});const li=n=>n instanceof bp?li(n.schema):n instanceof wi?li(n.innerType()):n instanceof wp?[n.value]:n instanceof Pa?n.options:n instanceof Tp?_t.objectValues(n.enum):n instanceof Sp?li(n._def.innerType):n instanceof mp?[void 0]:n instanceof vp?[null]:n instanceof mi?[void 0,...li(n.unwrap())]:n instanceof Ia?[null,...li(n.unwrap())]:n instanceof aR||n instanceof Ap?li(n.unwrap()):n instanceof Ep?li(n._def.innerType):[];class U1 extends dt{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Le.object)return Oe(t,{code:Ae.invalid_type,expected:Le.object,received:t.parsedType}),st;const r=this.discriminator,s=t.data[r],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(Oe(t,{code:Ae.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),st)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const s=new Map;for(const i of t){const o=li(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new U1({typeName:Je.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...ot(r)})}}function r_(n,e){const t=oo(n),r=oo(e);if(n===e)return{valid:!0,data:n};if(t===Le.object&&r===Le.object){const s=_t.objectKeys(e),i=_t.objectKeys(n).filter(a=>s.indexOf(a)!==-1),o={...n,...e};for(const a of i){const u=r_(n[a],e[a]);if(!u.valid)return{valid:!1};o[a]=u.data}return{valid:!0,data:o}}else if(t===Le.array&&r===Le.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<n.length;i++){const o=n[i],a=e[i],u=r_(o,a);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return t===Le.date&&r===Le.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class _p extends dt{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(TS(i)||TS(o))return st;const a=r_(i.value,o.value);return a.valid?((SS(i)||SS(o))&&t.dirty(),{status:t.value,value:a.data}):(Oe(r,{code:Ae.invalid_intersection_types}),st)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}_p.create=(n,e,t)=>new _p({left:n,right:e,typeName:Je.ZodIntersection,...ot(t)});class bi extends dt{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Le.array)return Oe(r,{code:Ae.invalid_type,expected:Le.array,received:r.parsedType}),st;if(r.data.length<this._def.items.length)return Oe(r,{code:Ae.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),st;!this._def.rest&&r.data.length>this._def.items.length&&(Oe(r,{code:Ae.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...r.data].map((o,a)=>{const u=this._def.items[a]||this._def.rest;return u?u._parse(new Xs(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>lr.mergeArray(t,o)):lr.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new bi({...this._def,rest:e})}}bi.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new bi({items:n,typeName:Je.ZodTuple,rest:null,...ot(e)})};class xp extends dt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Le.object)return Oe(r,{code:Ae.invalid_type,expected:Le.object,received:r.parsedType}),st;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Xs(r,a,r.path,a)),value:o._parse(new Xs(r,r.data[a],r.path,a)),alwaysSet:a in r.data});return r.common.async?lr.mergeObjectAsync(t,s):lr.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof dt?new xp({keyType:e,valueType:t,typeName:Je.ZodRecord,...ot(r)}):new xp({keyType:$s.create(),valueType:e,typeName:Je.ZodRecord,...ot(t)})}}class s_ extends dt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Le.map)return Oe(r,{code:Ae.invalid_type,expected:Le.map,received:r.parsedType}),st;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,u],f)=>({key:s._parse(new Xs(r,a,r.path,[f,"key"])),value:i._parse(new Xs(r,u,r.path,[f,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const u of o){const f=await u.key,d=await u.value;if(f.status==="aborted"||d.status==="aborted")return st;(f.status==="dirty"||d.status==="dirty")&&t.dirty(),a.set(f.value,d.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const u of o){const f=u.key,d=u.value;if(f.status==="aborted"||d.status==="aborted")return st;(f.status==="dirty"||d.status==="dirty")&&t.dirty(),a.set(f.value,d.value)}return{status:t.value,value:a}}}}s_.create=(n,e,t)=>new s_({valueType:e,keyType:n,typeName:Je.ZodMap,...ot(t)});class lc extends dt{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Le.set)return Oe(r,{code:Ae.invalid_type,expected:Le.set,received:r.parsedType}),st;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Oe(r,{code:Ae.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Oe(r,{code:Ae.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function o(u){const f=new Set;for(const d of u){if(d.status==="aborted")return st;d.status==="dirty"&&t.dirty(),f.add(d.value)}return{status:t.value,value:f}}const a=[...r.data.values()].map((u,f)=>i._parse(new Xs(r,u,r.path,f)));return r.common.async?Promise.all(a).then(u=>o(u)):o(a)}min(e,t){return new lc({...this._def,minSize:{value:e,message:We.toString(t)}})}max(e,t){return new lc({...this._def,maxSize:{value:e,message:We.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}lc.create=(n,e)=>new lc({valueType:n,minSize:null,maxSize:null,typeName:Je.ZodSet,...ot(e)});class Nu extends dt{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Le.function)return Oe(t,{code:Ae.invalid_type,expected:Le.function,received:t.parsedType}),st;function r(a,u){return Jy({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Gy(),Qu].filter(f=>!!f),issueData:{code:Ae.invalid_arguments,argumentsError:u}})}function s(a,u){return Jy({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Gy(),Qu].filter(f=>!!f),issueData:{code:Ae.invalid_return_type,returnTypeError:u}})}const i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Gu){const a=this;return Tr(async function(...u){const f=new ts([]),d=await a._def.args.parseAsync(u,i).catch(v=>{throw f.addIssue(r(u,v)),f}),p=await Reflect.apply(o,this,d);return await a._def.returns._def.type.parseAsync(p,i).catch(v=>{throw f.addIssue(s(p,v)),f})})}else{const a=this;return Tr(function(...u){const f=a._def.args.safeParse(u,i);if(!f.success)throw new ts([r(u,f.error)]);const d=Reflect.apply(o,this,f.data),p=a._def.returns.safeParse(d,i);if(!p.success)throw new ts([s(d,p.error)]);return p.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Nu({...this._def,args:bi.create(e).rest($l.create())})}returns(e){return new Nu({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Nu({args:e||bi.create([]).rest($l.create()),returns:t||$l.create(),typeName:Je.ZodFunction,...ot(r)})}}class bp extends dt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}bp.create=(n,e)=>new bp({getter:n,typeName:Je.ZodLazy,...ot(e)});class wp extends dt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Oe(t,{received:t.data,code:Ae.invalid_literal,expected:this._def.value}),st}return{status:"valid",value:e.data}}get value(){return this._def.value}}wp.create=(n,e)=>new wp({value:n,typeName:Je.ZodLiteral,...ot(e)});function oR(n,e){return new Pa({values:n,typeName:Je.ZodEnum,...ot(e)})}class Pa extends dt{constructor(){super(...arguments),_u.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return Oe(t,{expected:_t.joinValues(r),received:t.parsedType,code:Ae.invalid_type}),st}if(pp(this,_u)||rR(this,_u,new Set(this._def.values)),!pp(this,_u).has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return Oe(t,{received:t.data,code:Ae.invalid_enum_value,options:r}),st}return Tr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Pa.create(e,{...this._def,...t})}exclude(e,t=this._def){return Pa.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}_u=new WeakMap;Pa.create=oR;class Tp extends dt{constructor(){super(...arguments),xu.set(this,void 0)}_parse(e){const t=_t.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Le.string&&r.parsedType!==Le.number){const s=_t.objectValues(t);return Oe(r,{expected:_t.joinValues(s),received:r.parsedType,code:Ae.invalid_type}),st}if(pp(this,xu)||rR(this,xu,new Set(_t.getValidEnumValues(this._def.values))),!pp(this,xu).has(e.data)){const s=_t.objectValues(t);return Oe(r,{received:r.data,code:Ae.invalid_enum_value,options:s}),st}return Tr(e.data)}get enum(){return this._def.values}}xu=new WeakMap;Tp.create=(n,e)=>new Tp({values:n,typeName:Je.ZodNativeEnum,...ot(e)});class Gu extends dt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Le.promise&&t.common.async===!1)return Oe(t,{code:Ae.invalid_type,expected:Le.promise,received:t.parsedType}),st;const r=t.parsedType===Le.promise?t.data:Promise.resolve(t.data);return Tr(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Gu.create=(n,e)=>new Gu({type:n,typeName:Je.ZodPromise,...ot(e)});class wi extends dt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Je.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{Oe(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return st;const u=await this._def.schema._parseAsync({data:a,path:r.path,parent:r});return u.status==="aborted"?st:u.status==="dirty"||t.value==="dirty"?yu(u.value):u});{if(t.value==="aborted")return st;const a=this._def.schema._parseSync({data:o,path:r.path,parent:r});return a.status==="aborted"?st:a.status==="dirty"||t.value==="dirty"?yu(a.value):a}}if(s.type==="refinement"){const o=a=>{const u=s.refinement(a,i);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?st:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?st:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!oc(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>oc(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:t.value,value:a})):o);_t.assertNever(s)}}wi.create=(n,e,t)=>new wi({schema:n,typeName:Je.ZodEffects,effect:e,...ot(t)});wi.createWithPreprocess=(n,e,t)=>new wi({schema:e,effect:{type:"preprocess",transform:n},typeName:Je.ZodEffects,...ot(t)});class mi extends dt{_parse(e){return this._getType(e)===Le.undefined?Tr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}mi.create=(n,e)=>new mi({innerType:n,typeName:Je.ZodOptional,...ot(e)});class Ia extends dt{_parse(e){return this._getType(e)===Le.null?Tr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ia.create=(n,e)=>new Ia({innerType:n,typeName:Je.ZodNullable,...ot(e)});class Sp extends dt{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===Le.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Sp.create=(n,e)=>new Sp({innerType:n,typeName:Je.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ot(e)});class Ep extends dt{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return hp(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ts(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ts(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Ep.create=(n,e)=>new Ep({innerType:n,typeName:Je.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ot(e)});class i_ extends dt{_parse(e){if(this._getType(e)!==Le.nan){const r=this._getOrReturnCtx(e);return Oe(r,{code:Ae.invalid_type,expected:Le.nan,received:r.parsedType}),st}return{status:"valid",value:e.data}}}i_.create=n=>new i_({typeName:Je.ZodNaN,...ot(n)});class aR extends dt{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class gg extends dt{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?st:i.status==="dirty"?(t.dirty(),yu(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?st:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new gg({in:e,out:t,typeName:Je.ZodPipeline})}}class Ap extends dt{_parse(e){const t=this._def.innerType._parse(e),r=s=>(oc(s)&&(s.value=Object.freeze(s.value)),s);return hp(t)?t.then(s=>r(s)):r(t)}unwrap(){return this._def.innerType}}Ap.create=(n,e)=>new Ap({innerType:n,typeName:Je.ZodReadonly,...ot(e)});cn.lazycreate;var Je;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(Je||(Je={}));const vi=$s.create;Ca.create;i_.create;Ra.create;gp.create;ac.create;e_.create;mp.create;vp.create;t_.create;const Gq=$l.create;Ro.create;n_.create;Ws.create;const bs=cn.create;cn.strictCreate;yp.create;U1.create;_p.create;bi.create;xp.create;s_.create;lc.create;Nu.create;bp.create;wp.create;const V1=Pa.create;Tp.create;Gu.create;wi.create;mi.create;Ia.create;const o_=wi.createWithPreprocess;gg.create;const Jn={string:n=>$s.create({...n,coerce:!0}),number:n=>Ca.create({...n,coerce:!0}),boolean:n=>gp.create({...n,coerce:!0}),bigint:n=>Ra.create({...n,coerce:!0}),date:n=>ac.create({...n,coerce:!0})};var Jq=Object.defineProperty,eK=(n,e,t)=>e in n?Jq(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,tK=(n,e,t)=>(eK(n,e+"",t),t);class nK extends Rq{constructor(e){super(),tK(this,"maxUncompressedSize");const t=e.TileWidth||e.ImageWidth,r=e.TileLength||e.ImageLength,s=e.BitsPerSample[0]/8;this.maxUncompressedSize=t*r*s}async decodeBlock(e){const t=new Uint8Array(e);return(await decompress(t,this.maxUncompressedSize)).buffer}}function rK(n){if(!Number.isInteger(n))throw Error("Not an integer.");const e=new ArrayBuffer(4);new DataView(e).setInt32(0,n,!1);const r=new Uint8Array(e);return Array.from(r)}function Ju(n){const e=n[n.length-1];return e===3||e===4}function mg(n){const e=Ju(n.shape),[t,r]=n.shape.slice(e?-3:-2);return{height:t,width:r}}const lR="__vivSignalAborted";function Mf({attr:n,...e}){return{...n,...e}}function a_(n){return Array.isArray(n)?n:[n]}const sK=V1(["XYZCT","XYZTC","XYCTZ","XYCZT","XYTCZ","XYTZC"]),iK=V1(["int8","int16","int32","uint8","uint16","uint32","float","bit","double","complex","double-complex"]),xv=V1(["Ym","Zm","Em","Pm","Tm","Gm","Mm","km","hm","dam","m","dm","cm","mm","µm","nm","pm","fm","am","zm","ym","Å","thou","li","in","ft","yd","mi","ua","ly","pc","pt","pixel","reference frame"]),oK=bs({}).extend({attr:bs({ID:vi(),SamplesPerPixel:Jn.number().optional(),Name:vi().optional(),Color:Jn.number().transform(rK).optional()})}).transform(Mf),aK=bs({}).extend({attr:bs({FileName:vi()})}).transform(Mf),lK=bs({UUID:aK.optional()}).extend({attr:bs({IFD:Jn.number().default(0),PlaneCount:Jn.number().default(1),FirstT:Jn.number().optional(),FirstC:Jn.number().optional(),FirstZ:Jn.number().optional()})}).transform(Mf),cK=bs({Channel:o_(a_,oK.array()),TiffData:o_(a_,lK.array()).optional()}).extend({attr:bs({ID:vi(),DimensionOrder:sK,Type:iK,SizeT:Jn.number(),SizeC:Jn.number(),SizeZ:Jn.number(),SizeY:Jn.number(),SizeX:Jn.number(),PhysicalSizeX:Jn.number().optional(),PhysicalSizeY:Jn.number().optional(),PhysicalSizeZ:Jn.number().optional(),SignificantBits:Jn.number().optional(),PhysicalSizeXUnit:xv.optional().default("µm"),PhysicalSizeYUnit:xv.optional().default("µm"),PhysicalSizeZUnit:xv.optional().default("µm"),BigEndian:vi().transform(n=>n.toLowerCase()==="true").optional(),Interleaved:vi().transform(n=>n.toLowerCase()==="true").optional()})}).transform(Mf).transform(({Channel:n,...e})=>({Channels:n,...e})),uK=bs({AquisitionDate:vi().optional().default(""),Description:Gq().optional().default(""),Pixels:cK}).extend({attr:bs({ID:vi(),Name:vi().optional()})}).transform(Mf);bs({Image:o_(a_,uK.array())});Ei(5,()=>nK);function fK(n){return[...Array(n).keys()]}function cR(n,e,t){for(let r=0;r<t;r+=1)n.push(e);return n}function z1(n){const e=xS[n];if(!e){const t=Object.keys(xS);throw Error(`Dtype not supported, got ${n}. Must be one of ${t}.`)}return e}function uR({contrastLimits:n=[],channelsVisible:e,domain:t,dtype:r}){const s=(t==null?void 0:t[1])||z1(r).max,i=n.map((u,f)=>e[f]?u:[s,s]),o=KC-i.length;if(o<0)throw Error(`${i.lengths} channels passed in, but only 6 are allowed.`);return cR(i,[s,s],o).reduce((u,f)=>u.concat(f),[])}function dK(n){var s;const{x:e,y:t,z:r}=((s=n==null?void 0:n.meta)==null?void 0:s.physicalSizes)??{};if(e!=null&&e.size&&(t!=null&&t.size)&&(r!=null&&r.size)){const i=Math.min(r.size,e.size,t.size),o=[e.size/i,t.size/i,r.size/i];return new At().scale(o)}return new At().identity()}function hK(n){const e=new A1().makeViewport({viewState:n,height:n.height,width:n.width});return[e.unproject([0,0]),e.unproject([e.width,0]),e.unproject([e.width,e.height]),e.unproject([0,e.height])]}const Cp=[1,2,3,4,5,10,20,25,50,100,200,250,500,1e3],pK=Cp[0],gK=Cp[Cp.length-1],l_=[{symbol:"Y",exponent:24},{symbol:"Z",exponent:21},{symbol:"E",exponent:18},{symbol:"P",exponent:15},{symbol:"T",exponent:12},{symbol:"G",exponent:9},{symbol:"M",exponent:6},{symbol:"k",exponent:3},{symbol:"h",exponent:2},{symbol:"da",exponent:1},{symbol:"",exponent:0},{symbol:"d",exponent:-1},{symbol:"c",exponent:-2},{symbol:"m",exponent:-3},{symbol:"µ",exponent:-6},{symbol:"n",exponent:-9},{symbol:"p",exponent:-12},{symbol:"f",exponent:-15},{symbol:"a",exponent:-18},{symbol:"z",exponent:-21},{symbol:"y",exponent:-24}];function mK(n,e){if(!e||e==="m")return n;if(e.length>1){let t=e.substring(0,e.length-1);t==="u"&&(t="µ");const r=l_.find(s=>s.symbol===t);if(r)return n*10**r.exponent}throw new Error("Received unknown unit")}function vK(n){let e=0;(n<pK||n>gK)&&(e=Math.floor(Math.log10(n)));let t=l_.find(o=>o.exponent%3===0&&o.exponent<=e),r=n/10**t.exponent;r>500&&r<=1e3&&(t=l_.find(o=>o.exponent%3===0&&o.exponent<=e+3),r=n/10**t.exponent);const s=Cp.find(o=>o>r);return[s*10**t.exponent,s,t.symbol]}function yK(n){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");const e=new Uint8Array(n.length+n.length/3);for(let t=0;t<n.length/3;t+=1)e[t*4]=n[t*3],e[t*4+1]=n[t*3+1],e[t*4+2]=n[t*3+2],e[t*4+3]=255;return e}const pi={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},fR={...Rf.defaultProps,pickable:{type:"boolean",value:!0,compare:!0},coordinateSystem:tt.CARTESIAN},_K=(n,e)=>{const t=e?"true":"false",r=`vec3(${(e||[0,0,0]).map(s=>String(s/255)).join(",")})`;switch(n){case pi.RGB:return`color[3] = (${t} && (color.rgb == ${r})) ? 0.0 : color.a;`;case pi.WhiteIsZero:return`          float value = 1.0 - (color.r / 256.0);
          color = vec4(value, value, value, (${t} && vec3(value, value, value) == ${r}) ? 0.0 : color.a);
        `;case pi.BlackIsZero:return`          float value = (color.r / 256.0);
          color = vec4(value, value, value, (${t} && vec3(value, value, value) == ${r}) ? 0.0 : color.a);
        `;case pi.YCbCr:return`          float y = color[0];
          float cb = color[1];
          float cr = color[2];
          color[0] = (y + (1.40200 * (cr - .5)));
          color[1] = (y - (0.34414 * (cb - .5)) - (0.71414 * (cr - .5)));
          color[2] = (y + (1.77200 * (cb - .5)));
          color[3] = (${t} && distance(color.rgb, ${r}) < 0.01) ? 0.0 : color.a;
        `;default:return console.error("Unsupported photometric interpretation or none provided.  No transformation will be done to image data"),""}},xK=n=>{switch(n){case pi.RGB:return[0,0,0,0];case pi.WhiteIsZero:return[255,255,255,0];case pi.BlackIsZero:return[0,0,0,0];case pi.YCbCr:return[16,128,128,0];default:return console.error("Unsupported photometric interpretation or none provided.  No transformation will be done to image data"),[0,0,0,0]}};class $1 extends Rf{_getModel(e){const{photometricInterpretation:t,transparentColorInHook:r}=this.props,s=_K(t,r);return new rr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1,inject:{"fs:DECKGL_FILTER_COLOR":s}})}}const Of=class extends ss{initializeState(n){const{device:e}=this.context;e.setParametersWebGL({[gt.UNPACK_ALIGNMENT]:1,[gt.PACK_ALIGNMENT]:1}),super.initializeState(n)}renderLayers(){const{photometricInterpretation:n,transparentColor:e}=this.props,t=xK(n);return this.props.image.data=yK(this.props.image.data),new $1(this.props,{transparentColor:t,transparentColorInHook:e,id:`${this.props.id}-wrapped`})}};Of.layerName="BitmapLayer";Of.PHOTOMETRIC_INTERPRETATIONS=pi;Of.defaultProps={...fR,image:{type:"object",value:{},compare:!0},transparentColor:{type:"array",value:[0,0,0],compare:!0},photometricInterpretation:{type:"number",value:2,compare:!0}};$1.defaultProps=fR;$1.layerName="BitmapLayerWrapper";const bK=`float apply_contrast_limits(float intensity, vec2 contrastLimits) {
    return  max(0., (intensity - contrastLimits[0]) / max(0.0005, (contrastLimits[1] - contrastLimits[0])));
}
`,wK={name:"channel-intensity",defines:{SAMPLER_TYPE:"usampler2D",COLORMAP_FUNCTION:""},fs:bK},TK=`#version 300 es
#define SHADER_NAME xr-layer-fragment-shader

precision highp float;
precision highp int;
precision highp SAMPLER_TYPE;

// our texture
uniform SAMPLER_TYPE channel0;
uniform SAMPLER_TYPE channel1;
uniform SAMPLER_TYPE channel2;
uniform SAMPLER_TYPE channel3;
uniform SAMPLER_TYPE channel4;
uniform SAMPLER_TYPE channel5;

in vec2 vTexCoord;

// range
uniform vec2 contrastLimits[6];

out vec4 fragColor;

void main() {

  float intensity0 = float(texture(channel0, vTexCoord).r);
  DECKGL_PROCESS_INTENSITY(intensity0, contrastLimits[0], 0);
  float intensity1 = float(texture(channel1, vTexCoord).r);
  DECKGL_PROCESS_INTENSITY(intensity1, contrastLimits[1], 1);
  float intensity2 = float(texture(channel2, vTexCoord).r);
  DECKGL_PROCESS_INTENSITY(intensity2, contrastLimits[2], 2);
  float intensity3 = float(texture(channel3, vTexCoord).r);
  DECKGL_PROCESS_INTENSITY(intensity3, contrastLimits[3], 3);
  float intensity4 = float(texture(channel4, vTexCoord).r);
  DECKGL_PROCESS_INTENSITY(intensity4, contrastLimits[4], 4);
  float intensity5 = float(texture(channel5, vTexCoord).r);
  DECKGL_PROCESS_INTENSITY(intensity5, contrastLimits[5], 5);

  DECKGL_MUTATE_COLOR(fragColor, intensity0, intensity1, intensity2, intensity3, intensity4, intensity5, vTexCoord);


  geometry.uv = vTexCoord;
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,SK=`#version 300 es
#define SHADER_NAME xr-layer-vertex-shader

in vec2 texCoords;
in vec3 positions;
in vec3 positions64Low;
in vec3 instancePickingColors;
out vec2 vTexCoord;

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;
  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  vTexCoord = texCoords;
  vec4 color = vec4(0.);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,EK={fs:TK,vs:SK};function AS(n,e,t){const r=t==="linear",s=z1(r?"Float32":n);return{shaderModule:EK,filter:t,cast:r?i=>new Float32Array(i):i=>i,...s}}const AK={pickable:{type:"boolean",value:!0,compare:!0},coordinateSystem:tt.CARTESIAN,channelData:{type:"object",value:{},compare:!0},bounds:{type:"array",value:[0,0,1,1],compare:!0},contrastLimits:{type:"array",value:[],compare:!0},channelsVisible:{type:"array",value:[],compare:!0},dtype:{type:"string",value:"Uint16",compare:!0},interpolation:{type:"string",value:"nearest",compare:!0}},cc=class extends Br{getShaders(){const{dtype:n,interpolation:e}=this.props,{shaderModule:t,sampler:r}=AS(n,this.context.device,e),s=this._isHookDefinedByExtensions("fs:DECKGL_PROCESS_INTENSITY"),i={...wK,inject:{}};return s||(i.inject["fs:DECKGL_PROCESS_INTENSITY"]=`
        intensity = apply_contrast_limits(intensity, contrastLimits);
      `),super.getShaders({...t,defines:{SAMPLER_TYPE:r},modules:[Oo,No,i]})}_isHookDefinedByExtensions(n){const{extensions:e}=this.props;return e==null?void 0:e.some(t=>{const r=t.getShaders(),{inject:s={},modules:i=[]}=r,o=s[n],a=i.some(u=>u==null?void 0:u.inject[n]);return o||a})}initializeState(){const{device:n}=this.context;n.setParametersWebGL({[gt.UNPACK_ALIGNMENT]:1,[gt.PACK_ALIGNMENT]:1}),this.getAttributeManager().add({positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:this.calculatePositions,noAlloc:!0}}),this.setState({numInstances:1,positions:new Float64Array(12)});const t=Gl.getDefaultShaderAssembler(),r="fs:DECKGL_MUTATE_COLOR(inout vec4 rgba, float intensity0, float intensity1, float intensity2, float intensity3, float intensity4, float intensity5, vec2 vTexCoord)",s="fs:DECKGL_PROCESS_INTENSITY(inout float intensity, vec2 contrastLimits, int channelIndex)";t._hookFunctions.includes(r)||t.addShaderHook(r),t._hookFunctions.includes(s)||t.addShaderHook(s)}finalizeState(){super.finalizeState(),this.state.textures&&Object.values(this.state.textures).forEach(n=>n==null?void 0:n.delete())}updateState({props:n,oldProps:e,changeFlags:t,...r}){var i,o;if(super.updateState({props:n,oldProps:e,changeFlags:t,...r}),t.extensionsChanged||n.interpolation!==e.interpolation){const{device:a}=this.context;this.state.model&&this.state.model.destroy(),this.setState({model:this._getModel(a)}),this.getAttributeManager().invalidateAll()}(n.channelData!==e.channelData&&((i=n.channelData)==null?void 0:i.data)!==((o=e.channelData)==null?void 0:o.data)||n.interpolation!==e.interpolation)&&this.loadChannelTextures(n.channelData);const s=this.getAttributeManager();n.bounds!==e.bounds&&s.invalidate("positions")}_getModel(n){return n?new rr(n,{...this.getShaders(),id:this.props.id,geometry:new _i({topology:"triangle-list",vertexCount:6,indices:new Uint16Array([0,1,3,1,2,3]),attributes:{texCoords:{value:new Float32Array([0,1,0,0,1,0,1,1]),size:2}}}),bufferLayout:this.getAttributeManager().getBufferLayouts(),isInstanced:!1}):null}calculatePositions(n){const{positions:e}=this.state,{bounds:t}=this.props;e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[0],e[4]=t[3],e[5]=0,e[6]=t[2],e[7]=t[3],e[8]=0,e[9]=t[2],e[10]=t[1],e[11]=0,n.value=e}draw(n){const{uniforms:e}=n,{textures:t,model:r}=this.state;if(t&&r){const{contrastLimits:s,domain:i,dtype:o,channelsVisible:a}=this.props,u=Object.values(t).filter(d=>d).length,f=uR({contrastLimits:s.slice(0,u),channelsVisible:a.slice(0,u),domain:i,dtype:o});r.setUniforms({...e,contrastLimits:f},{disableWarnings:!1}),r.setBindings(t),r.draw(n)}}loadChannelTextures(n){const e={channel0:null,channel1:null,channel2:null,channel3:null,channel4:null,channel5:null};if(this.state.textures&&Object.values(this.state.textures).forEach(t=>t==null?void 0:t.delete()),n&&Object.keys(n).length>0&&n.data){n.data.forEach((t,r)=>{e[`channel${r}`]=this.dataToTexture(t,n.width,n.height)},this);for(const t in e){if(!e.channel0)throw new Error("Bad texture state!");e[t]||(e[t]=e.channel0)}this.setState({textures:e})}}dataToTexture(n,e,t){var i;const{interpolation:r}=this.props,s=AS(this.props.dtype,this.context.device,r);return this.context.device.createTexture({width:e,height:t,dimension:"2d",data:((i=s.cast)==null?void 0:i.call(s,n))??n,mipmaps:!1,sampler:{minFilter:s.filter,magFilter:s.filter,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},format:s.format})}};cc.layerName="XRLayer";cc.defaultProps=AK;const CK={pickable:{type:"boolean",value:!0,compare:!0},coordinateSystem:tt.CARTESIAN,contrastLimits:{type:"array",value:[],compare:!0},channelsVisible:{type:"array",value:[],compare:!0},selections:{type:"array",value:[],compare:!0},domain:{type:"array",value:[],compare:!0},viewportId:{type:"string",value:"",compare:!0},loader:{type:"object",value:{getRaster:async()=>({data:[],height:0,width:0}),dtype:"Uint16",shape:[]},compare:!0},onClick:{type:"function",value:null,compare:!0},onViewportLoad:{type:"function",value:null,compare:!0},interpolation:{type:"number",value:"nearest",compare:!0},extensions:{type:"array",value:[new gc],compare:!0}},Nf=class extends ss{finalizeState(){this.state.abortController.abort()}updateState({props:e,oldProps:t}){const r=e.loader!==t.loader,s=e.selections!==t.selections;if(r||s){const{loader:i,selections:o=[],onViewportLoad:a}=this.props,u=new AbortController;this.setState({abortController:u});const{signal:f}=u,d=m=>i.getRaster({selection:m,signal:f}),p=o.map(d);Promise.all(p).then(m=>{var x,b;const v={data:m.map(w=>w.data),width:(x=m[0])==null?void 0:x.width,height:(b=m[0])==null?void 0:b.height};Ju(i.shape)&&(v.data=v.data[0],v.data.length===v.width*v.height*3&&(v.format="rgba8unorm")),a&&a(v),this.setState({...v})}).catch(m=>{if(m!==lR)throw m})}}getPickingInfo({info:e,sourceLayer:t}){return e.sourceLayer=t,e.tile=t.props.tile,e}renderLayers(){const{loader:e,id:t}=this.props,{dtype:r}=e,{width:s,height:i,data:o}=this.state;if(!(s&&i))return null;const a=[0,i,s,0];if(Ju(e.shape)){const{photometricInterpretation:u=2}=e.meta;return new Of(this.props,{image:this.state,photometricInterpretation:u,bounds:a,id:`image-sub-layer-${a}-${t}`,extensions:[]})}return new cc(this.props,{channelData:{data:o,height:i,width:s},bounds:a,id:`image-sub-layer-${a}-${t}`,dtype:r})}};Nf.layerName="ImageLayer";Nf.defaultProps=CK;function RK(n){const{bbox:{left:e,top:t,right:r,bottom:s},index:{x:i,y:o,z:a}}=n.tile,{data:u,id:f,loader:d,maxZoom:p}=n;if([e,s,r,t].some(w=>w<0)||!u)return null;const m=d[0],{height:v,width:x}=mg(m),b=[e,u.height<m.tileSize?v:s,u.width<m.tileSize?x:r,t];if(Ju(m.shape)){const{photometricInterpretation:w=2}=m.meta;return new Of(n,{image:u,photometricInterpretation:w,bounds:b,id:`tile-sub-layer-${b}-${f}`,tileId:{x:i,y:o,z:a},extensions:[]})}return new cc(n,{channelData:u,bounds:b,id:`tile-sub-layer-${b}-${f}`,tileId:{x:i,y:o,z:a},interpolation:a===p?"nearest":"linear"})}const PK={pickable:{type:"boolean",value:!0,compare:!0},coordinateSystem:tt.CARTESIAN,contrastLimits:{type:"array",value:[],compare:!0},channelsVisible:{type:"array",value:[],compare:!0},renderSubLayers:{type:"function",value:RK,compare:!1},dtype:{type:"string",value:"Uint16",compare:!0},domain:{type:"array",value:[],compare:!0},viewportId:{type:"string",value:"",compare:!0},interpolation:{type:"number",value:null,compare:!0}};class j1 extends hg{_updateTileset(){this.props.viewportId||super._updateTileset(),(this.props.viewportId&&this.context.viewport.id===this.props.viewportId||!this.state.tileset._viewport)&&super._updateTileset()}}j1.layerName="MultiscaleImageLayerBase";j1.defaultProps=PK;const IK={pickable:{type:"boolean",value:!0,compare:!0},onHover:{type:"function",value:null,compare:!1},contrastLimits:{type:"array",value:[],compare:!0},channelsVisible:{type:"array",value:[],compare:!0},domain:{type:"array",value:[],compare:!0},viewportId:{type:"string",value:"",compare:!0},maxRequests:{type:"number",value:10,compare:!0},onClick:{type:"function",value:null,compare:!0},refinementStrategy:{type:"string",value:null,compare:!0},excludeBackground:{type:"boolean",value:!1,compare:!0},extensions:{type:"array",value:[new gc],compare:!0}},W1=class extends ss{renderLayers(){const{loader:e,selections:t,opacity:r,viewportId:s,onTileError:i,onHover:o,id:a,onClick:u,modelMatrix:f,excludeBackground:d,refinementStrategy:p}=this.props,{tileSize:m,dtype:v}=e[0],x=async({index:{x:$,y:q,z:K},signal:le})=>{if(!t||t.length===0)return null;const he=Math.round(-K),pe=se=>{const ye={x:$,y:q,selection:se,signal:le};return e[he].getTile(ye)};try{const se=await Promise.all(t.map(pe)),ye={data:se.map(Me=>Me.data),width:se[0].width,height:se[0].height};return Ju(e[he].shape)&&(ye.data=ye.data[0],ye.data.length===ye.width*ye.height*3&&(ye.format="rgba8unorm")),ye}catch(se){if(se===lR)return null;throw se}},{height:b,width:w}=mg(e[0]),S=new j1(this.props,{id:`Tiled-Image-${a}`,getTileData:x,dtype:v,tileSize:m,zoomOffset:Math.round(Math.log2(f?f.getScale()[0]:1)),extent:[0,0,w,b],minZoom:Math.round(-(e.length-1)),maxZoom:0,refinementStrategy:p||(r===1?"best-available":"no-overlap"),updateTriggers:{getTileData:[e,t]},onTileError:i||e[0].onTileError}),R=e[e.length-1],C=typeof R.getRaster=="function",O=f?f.clone():new At;return[C&&!d&&new Nf(this.props,{id:`Background-Image-${a}`,loader:R,modelMatrix:O.scale(2**(e.length-1)),visible:!s||this.context.viewport.id===s,onHover:o,onClick:u,interpolation:"linear",onViewportLoad:null}),S]}};W1.layerName="MultiscaleImageLayer";W1.defaultProps=IK;const kK={pickable:{type:"boolean",value:!0,compare:!0},loader:{type:"object",value:{getRaster:async()=>({data:[],height:0,width:0}),getRasterSize:()=>({height:0,width:0}),dtype:"<u2"},compare:!0},id:{type:"string",value:"",compare:!0},boundingBox:{type:"array",value:[[0,0],[0,1],[1,1],[1,0]],compare:!0},boundingBoxColor:{type:"array",value:[255,0,0],compare:!0},boundingBoxOutlineWidth:{type:"number",value:1,compare:!0},viewportOutlineColor:{type:"array",value:[255,190,0],compare:!0},viewportOutlineWidth:{type:"number",value:2,compare:!0},overviewScale:{type:"number",value:1,compare:!0},zoom:{type:"number",value:1,compare:!0},extensions:{type:"array",value:[new gc],compare:!0}},dR=class extends ss{renderLayers(){const{loader:n,id:e,zoom:t,boundingBox:r,boundingBoxColor:s,boundingBoxOutlineWidth:i,viewportOutlineColor:o,viewportOutlineWidth:a,overviewScale:u}=this.props,{width:f,height:d}=mg(n[0]),p=n.length-1,m=n[p],v=new Nf(this.props,{id:`viewport-${e}`,modelMatrix:new At().scale(2**p*u),loader:m}),x=new cp({id:`bounding-box-overview-${e}`,coordinateSystem:tt.CARTESIAN,data:[r],getPolygon:S=>S,filled:!1,stroked:!0,getLineColor:s,getLineWidth:i*2**t}),b=new cp({id:`viewport-outline-${e}`,coordinateSystem:tt.CARTESIAN,data:[[[0,0],[f*u,0],[f*u,d*u],[0,d*u]]],getPolygon:S=>S,filled:!1,stroked:!0,getLineColor:o,getLineWidth:a*2**t});return[v,x,b]}};dR.layerName="OverviewLayer";dR.defaultProps=kK;function MK(n,e,t){const r=n[2][0]-n[0][0],s=n[2][1]-n[0][1];switch(e){case"bottom-right":{const i=n[2][1]-s*t,o=n[2][0]-r*t;return[i,o]}case"top-right":{const i=n[0][1]+s*t,o=n[2][0]-r*t;return[i,o]}case"top-left":{const i=n[0][1]+s*t,o=n[0][0]+r*t;return[i,o]}case"bottom-left":{const i=n[2][1]-s*t,o=n[0][0]+r*t;return[i,o]}default:throw new Error(`Position ${e} not found`)}}const OK={pickable:{type:"boolean",value:!0,compare:!0},viewState:{type:"object",value:{zoom:0,target:[0,0,0],width:1,height:1},compare:!0},unit:{type:"string",value:"",compare:!0},size:{type:"number",value:1,compare:!0},position:{type:"string",value:"bottom-right",compare:!0},length:{type:"number",value:.085,compare:!0},snap:{type:"boolean",value:!1,compare:!0}},hR=class extends ss{renderLayers(){const{id:n,unit:e,size:t,position:r,viewState:s,length:i,snap:o}=this.props,a=hK(s),{zoom:u}=s,d=(a[2][0]-a[0][0])*.05,p=Math.max(2**(-u+1.5),(a[2][1]-a[0][1])*.007);let m=d,v=(d*t).toPrecision(5),x=e;if(o){const $=mK(t,e),q=d*$,[K,le,he]=vK(q);m=K/$,v=le,x=`${he}m`}const[b,w]=MK(a,r,i),S=w+d,R=r.endsWith("-left"),C=new Ou({id:`scale-bar-length-${n}`,coordinateSystem:tt.CARTESIAN,data:[[[R?w:S-m,b],[R?w+m:S,b]]],getSourcePosition:$=>$[0],getTargetPosition:$=>$[1],getWidth:2,getColor:[220,220,220]}),O=new Ou({id:`scale-bar-height-left-${n}`,coordinateSystem:tt.CARTESIAN,data:[[[R?w:S-m,b-p],[R?w:S-m,b+p]]],getSourcePosition:$=>$[0],getTargetPosition:$=>$[1],getWidth:2,getColor:[220,220,220]}),I=new Ou({id:`scale-bar-height-right-${n}`,coordinateSystem:tt.CARTESIAN,data:[[[R?w+m:S,b-p],[R?w+m:S,b+p]]],getSourcePosition:$=>$[0],getTargetPosition:$=>$[1],getWidth:2,getColor:[220,220,220]}),F=new pc({id:`units-label-layer-${n}`,coordinateSystem:tt.CARTESIAN,data:[{text:`${v}${x}`,position:[R?w+d*.5:S-d*.5,b+p*4]}],getColor:[220,220,220,255],getSize:12,fontFamily:tY,sizeUnits:"meters",sizeScale:2**-u,characterSet:[...x.split(""),...fK(10).map($=>String($)),".","e","+"]});return[C,O,I,F]}};hR.layerName="ScaleBarLayer";hR.defaultProps=OK;const NK=`#version 300 es
precision highp int;
precision highp float;
precision highp SAMPLER_TYPE;

uniform highp SAMPLER_TYPE volume0;
uniform highp SAMPLER_TYPE volume1;
uniform highp SAMPLER_TYPE volume2;
uniform highp SAMPLER_TYPE volume3;
uniform highp SAMPLER_TYPE volume4;
uniform highp SAMPLER_TYPE volume5;

uniform vec3 scaledDimensions;

uniform mat4 scale;

uniform vec3 normals[NUM_PLANES];
uniform float distances[NUM_PLANES];

// color
uniform vec3 colors[6];

// slices
uniform vec2 xSlice;
uniform vec2 ySlice;
uniform vec2 zSlice;

// range
uniform vec2 contrastLimits[6];

in vec3 vray_dir;
flat in vec3 transformed_eye;
out vec4 color;

vec2 intersect_box(vec3 orig, vec3 dir) {
	vec3 box_min = vec3(xSlice[0], ySlice[0], zSlice[0]);
	vec3 box_max = vec3(xSlice[1], ySlice[1], zSlice[1]);
	vec3 inv_dir = 1. / dir;
	vec3 tmin_tmp = (box_min - orig) * inv_dir;
	vec3 tmax_tmp = (box_max - orig) * inv_dir;
	vec3 tmin = min(tmin_tmp, tmax_tmp);
	vec3 tmax = max(tmin_tmp, tmax_tmp);
	float t0 = max(tmin.x, max(tmin.y, tmin.z));
  float t1 = min(tmax.x, min(tmax.y, tmax.z));
  vec2 val = vec2(t0, t1);
	return val;
}

float linear_to_srgb(float x) {
	if (x <= 0.0031308f) {
		return 12.92f * x;
	}
	return 1.055f * pow(x, 1.f / 2.4f) - 0.055f;
}

// Pseudo-random number gen from
// http://www.reedbeta.com/blog/quick-and-easy-gpu-random-numbers-in-d3d11/
// with some tweaks for the range of values
float wang_hash(int seed) {
	seed = (seed ^ 61) ^ (seed >> 16);
	seed *= 9;
	seed = seed ^ (seed >> 4);
	seed *= 0x27d4eb2d;
	seed = seed ^ (seed >> 15);
	return float(seed % 2147483647) / float(2147483647);
}


void main(void) {
	// Step 1: Normalize the view ray
	vec3 ray_dir = normalize(vray_dir);

	// Step 2: Intersect the ray with the volume bounds to find the interval
	// along the ray overlapped by the volume.
	vec2 t_hit = intersect_box(transformed_eye, ray_dir);
	if (t_hit.x > t_hit.y) {
		discard;
	}
	// We don't want to sample voxels behind the eye if it's
	// inside the volume, so keep the starting point at or in front
	// of the eye
	t_hit.x = max(t_hit.x, 0.);

	// Step 3: Compute the step size to march through the volume grid
	vec3 dt_vec = 1. / (scale * vec4(abs(ray_dir), 1.)).xyz;
	float dt = 1. * min(dt_vec.x, min(dt_vec.y, dt_vec.z));

	float offset = wang_hash(int(gl_FragCoord.x + 640. * gl_FragCoord.y));

	// Step 4: Starting from the entry point, march the ray through the volume
	// and sample it
	vec3 p = transformed_eye + (t_hit.x + offset * dt) * ray_dir;

	// TODO: Probably want to stop this process at some point to improve performance when marching down the edges.
	_BEFORE_RENDER
	for (float t = t_hit.x; t < t_hit.y; t += dt) {
		// Check if this point is on the "positive" side or "negative" side of the plane - only show positive.
		float canShow = 1.;
		for (int i = 0; i < NUM_PLANES; i += 1) {
			canShow *= max(0., sign(dot(normals[i], p) + distances[i]));
		}
		// Do not show coordinates outside 0-1 box.
		// Something about the undefined behavior outside the box causes the additive blender to 
		// render some very odd artifacts.
		float canShowXCoordinate = max(p.x - 0., 0.) * max(1. - p.x , 0.);
		float canShowYCoordinate = max(p.y - 0., 0.) * max(1. - p.y , 0.);
		float canShowZCoordinate = max(p.z - 0., 0.) * max(1. - p.z , 0.);
		float canShowCoordinate = float(ceil(canShowXCoordinate * canShowYCoordinate * canShowZCoordinate));
		canShow = canShowCoordinate * canShow;
		float intensityValue0 = float(texture(volume0, p).r);
		DECKGL_PROCESS_INTENSITY(intensityValue0, contrastLimits[0], 0);
		intensityValue0 = canShow * intensityValue0;
		float intensityValue1 = float(texture(volume1, p).r);
		DECKGL_PROCESS_INTENSITY(intensityValue1, contrastLimits[1], 1);
		intensityValue1 = canShow * intensityValue1;
		float intensityValue2 = float(texture(volume2, p).r);
  		DECKGL_PROCESS_INTENSITY(intensityValue2, contrastLimits[2], 2);
		intensityValue2 = canShow * intensityValue2;
		float intensityValue3 = float(texture(volume3, p).r);
  		DECKGL_PROCESS_INTENSITY(intensityValue3, contrastLimits[3], 3);
		intensityValue3 = canShow * intensityValue3;
    	float intensityValue4 = float(texture(volume4, p).r);
  		DECKGL_PROCESS_INTENSITY(intensityValue4, contrastLimits[4], 4);
		intensityValue4 = canShow * intensityValue4;
		float intensityValue5 = float(texture(volume5, p).r);
  		DECKGL_PROCESS_INTENSITY(intensityValue5, contrastLimits[5], 5);
		intensityValue5 = canShow * intensityValue5;

		_RENDER

		p += ray_dir * dt;
	}
	_AFTER_RENDER
  color.r = linear_to_srgb(color.r);
  color.g = linear_to_srgb(color.g);
  color.b = linear_to_srgb(color.b);
}
`,DK=`#version 300 es
#define SHADER_NAME xr-layer-vertex-shader

// Unit-cube vertices
in vec3 positions;

// Eye position - last column of the inverted view matrix
uniform vec3 eye_pos;
// Projection matrix
uniform mat4 proj;
// Model Matrix
uniform mat4 model;
// View Matrix
uniform mat4 view;
// A matrix for scaling in the model space before any transformations.
// This projects the unit cube up to match the "pixel size" multiplied by the physical size ratio, if provided.
uniform mat4 scale;
uniform mat4 resolution;


out vec3 vray_dir;
flat out vec3 transformed_eye;

void main() {

  // Step 1: Standard MVP transformation (+ the scale matrix) to place the positions on your 2D screen ready for rasterization + fragment processing.
  gl_Position = proj * view * model * scale * resolution * vec4(positions, 1.);

  // Step 2: Invert the eye back from world space to the normalized 0-1 cube world space because ray casting on the fragment shader runs in 0-1 space.
  // Geometrically, the transformed_eye is a position relative to the 0-1 normalized vertices, which themselves are the inverse of the model + scale trasnformation.
  // See below for an example which does not involve a scale transformation, for simplicity, but motivates geometrically the needed transformation on eye_pos.
  /*
  This first diagram is a skewed volume (i.e a "shear" model matrix applied) top down with the eye marked as #, all in world space
       ^
    ___|__
    \\  |  \\
     \\ |   \\
      \\|____\\
       | 
       | 
       |
       #

  This next diagram shows the volume after the inverse model matrix has placed it back in model coordinates, but the eye still in world space. 
       ^
    ___|___
    |  |  |
    |  |  |
    |__|__|
       |
       |
       |
       #

  Finally, we apply the inverse model matrix transformation to the eye as well to bring it too into world space.
  Notice that the ray here matches the "voxels" through which the first ray also passes, as desired.
         ^
    ____/__
    |  /  |
    | /   |
    |/____|
    /
   /
  /
 #
  */
  transformed_eye = (inverse(resolution) * inverse(scale) * inverse(model) * (vec4(eye_pos, 1.))).xyz;

  // Step 3: Rays are from eye to vertices so that they get interpolated over the fragments.
  vray_dir = positions - transformed_eye;
}
`,LK={name:"channel-intensity-module",fs:`    float apply_contrast_limits(float intensity, vec2 contrastLimits) {
      float contrastLimitsAppliedToIntensity = (intensity - contrastLimits[0]) / max(0.0005, (contrastLimits[1] - contrastLimits[0]));
      return max(0., contrastLimitsAppliedToIntensity);
    }
  `},FK=[1,1,0,0,1,0,1,1,1,0,1,1,0,0,1,0,1,0,0,0,0,1,1,0,1,0,0,1,1,1,1,0,1,0,0,1,1,0,0,0,0,0],CS=1,BK={pickable:!1,coordinateSystem:tt.CARTESIAN,channelData:{type:"object",value:{},compare:!0},contrastLimits:{type:"array",value:[],compare:!0},dtype:{type:"string",value:"Uint8",compare:!0},xSlice:{type:"array",value:null,compare:!0},ySlice:{type:"array",value:null,compare:!0},zSlice:{type:"array",value:null,compare:!0},clippingPlanes:{type:"array",value:[],compare:!0},resolutionMatrix:{type:"object",value:new At,compare:!0},channelsVisible:{type:"array",value:[],compare:!0},extensions:{type:"array",value:[new nR.AdditiveBlendExtension],compare:!0}};function RS(){const n=z1("Float32");return{...n,sampler:n.sampler.replace("2D","3D"),cast:e=>new Float32Array(e)}}function UK(n){let e={};if(n.forEach(t=>{e=t.rendering}),!e._RENDER)throw new Error("XR3DLayer requires at least one extension to define opts.rendering as an object with _RENDER as a property at the minimum.");return e}const H1=class extends Br{initializeState(){const{device:n}=this.context;n.setParametersWebGL({[gt.UNPACK_ALIGNMENT]:1,[gt.PACK_ALIGNMENT]:1});const e=Gl.getDefaultShaderAssembler(),t="fs:DECKGL_PROCESS_INTENSITY(inout float intensity, vec2 contrastLimits, int channelIndex)";e._hookFunctions.includes(t)||e.addShaderHook(t)}_isHookDefinedByExtensions(n){const{extensions:e}=this.props;return e==null?void 0:e.some(t=>{const r=t.getShaders();if(r){const{inject:s={},modules:i=[]}=r,o=s[n],a=i.some(u=>{var f;return(f=u==null?void 0:u.inject)==null?void 0:f[n]});return o||a}return!1})}getShaders(){const{clippingPlanes:n,extensions:e}=this.props,{sampler:t}=RS(),{_BEFORE_RENDER:r,_RENDER:s,_AFTER_RENDER:i}=UK(e),o=this._isHookDefinedByExtensions("fs:DECKGL_PROCESS_INTENSITY"),a={inject:{},...LK};return o||(a.inject["fs:DECKGL_PROCESS_INTENSITY"]=`
        intensity = apply_contrast_limits(intensity, contrastLimits);
      `),super.getShaders({vs:DK,fs:NK.replace("_BEFORE_RENDER",r).replace("_RENDER",s).replace("_AFTER_RENDER",i),defines:{SAMPLER_TYPE:t,NUM_PLANES:String(n.length||CS)},modules:[a]})}finalizeState(){super.finalizeState(),this.state.textures&&Object.values(this.state.textures).forEach(n=>n==null?void 0:n.delete())}updateState({props:n,oldProps:e,changeFlags:t}){var r,s;if(t.extensionsChanged||n.colormap!==e.colormap||n.renderingMode!==e.renderingMode||n.clippingPlanes.length!==e.clippingPlanes.length){const{device:i}=this.context;this.state.model&&this.state.model.destroy(),this.setState({model:this._getModel(i)})}n.channelData&&((r=n==null?void 0:n.channelData)==null?void 0:r.data)!==((s=e==null?void 0:e.channelData)==null?void 0:s.data)&&this.loadTexture(n.channelData)}_getModel(n){return n?new rr(n,{...this.getShaders(),geometry:new _i({topology:"triangle-strip",attributes:{positions:new Float32Array(FK)}})}):null}draw(n){const{uniforms:e}=n,{textures:t,model:r,scaleMatrix:s}=this.state,{contrastLimits:i,xSlice:o,ySlice:a,zSlice:u,modelMatrix:f,channelsVisible:d,domain:p,dtype:m,clippingPlanes:v,resolutionMatrix:x}=this.props,{viewMatrix:b,viewMatrixInverse:w,projectionMatrix:S}=this.context.viewport;if(t&&r&&s){const R=uR({contrastLimits:i,channelsVisible:d,domain:p,dtype:m}),C=s.clone().invert(),O=x.clone().invert(),I=cR(v.map(q=>q.clone().transform(C).transform(O)),new ic([1,0,0]),v.length||CS),F=I.flatMap(q=>q.normal),$=I.map(q=>q.distance);r.setUniforms({...e,contrastLimits:R,xSlice:new Float32Array(o?o.map(q=>q/s[0]/x[0]):[0,1]),ySlice:new Float32Array(a?a.map(q=>q/s[5]/x[5]):[0,1]),zSlice:new Float32Array(u?u.map(q=>q/s[10]/x[10]):[0,1]),eye_pos:new Float32Array([w[12],w[13],w[14]]),view:b,proj:S,scale:s,resolution:x,model:f||new At,normals:F,distances:$},{disableWanings:!1}),r.setBindings(t),r.draw(n)}}loadTexture(n){const e={volume0:null,volume1:null,volume2:null,volume3:null,volume4:null,volume5:null};if(this.state.textures&&Object.values(this.state.textures).forEach(t=>t==null?void 0:t.delete()),n&&Object.keys(n).length>0&&n.data){const{height:t,width:r,depth:s}=n;n.data.forEach((i,o)=>{e[`volume${o}`]=this.dataToTexture(i,r,t,s)},this);for(const i in e){if(!e.volume0)throw new Error("Bad texture state!");e[i]||(e[i]=e.volume0)}this.setState({textures:e,scaleMatrix:new At().scale(this.props.physicalSizeScalingMatrix.transformPoint([r,t,s]))})}}dataToTexture(n,e,t,r){var o;const s=RS();return this.context.device.createTexture({width:e,height:t,depth:r,dimension:"3d",data:((o=s.cast)==null?void 0:o.call(s,n))??n,format:s.format,mipmaps:!1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge"}})}};H1.layerName="XR3DLayer";H1.defaultProps=BK;async function VK({source:n,selection:e,onUpdate:t=()=>{},downsampleDepth:r=1,signal:s}){const{shape:i,labels:o,dtype:a}=n,{height:u,width:f}=mg(n),d=i[o.indexOf("z")],p=Math.max(1,Math.floor(d/r)),m=u*f,v=`${a}Array`,x=globalThis[v],b=new x(m*p);return await Promise.all(new Array(p).fill(0).map(async(w,S)=>{const R={...e,z:S*r},{data:C}=await n.getRaster({selection:R,signal:s});let O=0;for(t();O<m;){const I=S*m+(m-O-1),F=(f-O-1)%f+f*Math.floor(O/f);b[I]=C[F],O+=1}t()})),{data:b,height:u,width:f,depth:p}}const zK=(n,e,t)=>new pc({id:`text-${t}`,coordinateSystem:tt.CARTESIAN,data:[{text:n,position:e.position}],getColor:[220,220,220,255],getSize:25,sizeUnits:"meters",sizeScale:2**-e.zoom,fontFamily:"Helvetica"}),$K={pickable:!1,coordinateSystem:tt.CARTESIAN,contrastLimits:{type:"array",value:[],compare:!0},channelsVisible:{type:"array",value:[],compare:!0},selections:{type:"array",value:[],compare:!0},resolution:{type:"number",value:0,compare:!0},domain:{type:"array",value:[],compare:!0},loader:{type:"object",value:[{getRaster:async()=>({data:[],height:0,width:0}),dtype:"Uint16",shape:[1],labels:["z"]}],compare:!0},xSlice:{type:"array",value:null,compare:!0},ySlice:{type:"array",value:null,compare:!0},zSlice:{type:"array",value:null,compare:!0},clippingPlanes:{type:"array",value:[],compare:!0},onUpdate:{type:"function",value:()=>{},compare:!0},useProgressIndicator:{type:"boolean",value:!0,compare:!0},extensions:{type:"array",value:[new nR.AdditiveBlendExtension],compare:!0}},pR=class extends ss{clearState(){this.setState({height:null,width:null,depth:null,data:null,physicalSizeScalingMatrix:null,resolutionMatrix:null,progress:0,abortController:null})}finalizeState(){this.state.abortController.abort()}updateState({oldProps:n,props:e}){const t=e.loader!==n.loader,r=e.resolution!==n.resolution,s=e.selections!==n.selections;if(r&&this.clearState(),t||s||r){const{loader:i,selections:o=[],resolution:a,onViewportLoad:u}=this.props,f=i[a];let d=0;const p=(f.shape[f.labels.indexOf("z")]>>a)*o.length,m=()=>{d+=.5/p,this.props.onUpdate&&this.props.onUpdate({progress:d}),this.setState({progress:d})},v=new AbortController;this.setState({abortController:v});const{signal:x}=v,b=o.map(S=>VK({selection:S,source:f,onUpdate:m,downsampleDepth:2**a,signal:x})),w=dK(i[a]);Promise.all(b).then(S=>{var C,O,I;u&&u(S);const R={data:S.map(F=>F.data),width:(C=S[0])==null?void 0:C.width,height:(O=S[0])==null?void 0:O.height,depth:(I=S[0])==null?void 0:I.depth};this.setState({...R,physicalSizeScalingMatrix:w,resolutionMatrix:new At().scale(2**a)})})}}renderLayers(){const{loader:n,id:e,resolution:t,useProgressIndicator:r}=this.props,{dtype:s}=n[t],{data:i,width:o,height:a,depth:u,progress:f,physicalSizeScalingMatrix:d,resolutionMatrix:p}=this.state;if(!(o&&a)&&r){const{viewport:m}=this.context;return zK(`Loading Volume ${String((f||0)*100).slice(0,5)}%...`,m,e)}return new H1(this.props,{channelData:{data:i,width:o,height:a,depth:u},id:`XR3DLayer-0-${a}-${o}-0-${t}-${e}`,physicalSizeScalingMatrix:d,parameters:{[gt.CULL_FACE]:!0,[gt.CULL_FACE_MODE]:gt.FRONT,[gt.DEPTH_TEST]:!1,blendFunc:[gt.SRC_ALPHA,gt.ONE],blend:!0},resolutionMatrix:p,dtype:s})}};pR.layerName="VolumeLayer";pR.defaultProps=$K;function jK(n,e,t=[0,0],r=1){const[s,i]=t,o=n*r+s,a=e*r+i;return[s,a,o,i]}function WK(n){const[e]=n,{width:t,height:r}=e.data;for(const{data:s}of n)s&&St(s.width===t&&s.height===r,"Grid data is not same shape.");return{width:t,height:r}}function PS(n){const{loaders:e,selections:t=[]}=n;let{concurrency:r}=n;return r&&t.length>0&&(r=Math.ceil(r/t.length)),_4(e,async i=>{const o=t.map(u=>i.loader.getRaster({selection:u})),a=await Promise.all(o);return{...i,data:{data:a.map(u=>u.data),width:a[0].width,height:a[0].height}}},{concurrency:r})}var va,u_,gR;class c_ extends ss{constructor(){super(...arguments);yt(this,va)}initializeState(){rt(this,va,{gridData:[],width:0,height:0},gR),PS(this.props).then(t=>{const{width:r,height:s}=WK(t);this.setState({gridData:t,width:r,height:s})})}updateState({props:t,oldProps:r,changeFlags:s}){const{propsChanged:i}=s,o=typeof i=="string"&&i.includes("props.loaders"),a=t.selections!==r.selections;(o||a)&&PS(this.props).then(u=>{this.setState({gridData:u})})}getPickingInfo({info:t}){if(!t.coordinate)return t;const r=this.props.spacer||0,{width:s,height:i}=Te(this,va,u_),[o,a]=t.coordinate,u=Math.floor(a/(i+r)),f=Math.floor(o/(s+r));return{...t,gridCoord:{row:u,column:f}}}renderLayers(){const{gridData:t,width:r,height:s}=Te(this,va,u_);if(r===0||s===0)return null;const{rows:i,columns:o,spacer:a=0,id:u=""}=this.props,f=t.map(d=>{const p=d.row*(s+a),m=d.col*(r+a),v={channelData:d.data,bounds:jK(r,s,[m,p]),id:`${u}-GridLayer-${d.row}-${d.col}`,dtype:d.loader.dtype||"Uint16",pickable:!1,extensions:[new gc]};return new cc({...this.props,...v})});if(this.props.pickable){const d=i*(s+a),p=o*(r+a),v={data:[{polygon:[[0,0],[p,0],[p,d],[0,d]]}],getPolygon:b=>b.polygon,getFillColor:[0,0,0,0],getLineColor:[0,0,0,0],pickable:!0,id:`${u}-GridLayer-picking`},x=new Pf({...this.props,...v});f.push(x)}if(this.props.text){const d=new pc({id:`${u}-GridLayer-text`,data:t,getPosition:p=>[p.col*(r+a),p.row*(s+a)],getText:p=>p.name,getColor:[255,255,255,255],getSize:16,getAngle:0,getTextAnchor:"start",getAlignmentBaseline:"top"});f.push(d)}return f}}va=new WeakSet,u_=function(){return this.state},gR=function(t){this.state=t},E(c_,"layerName","VizarrGridLayer"),E(c_,"defaultProps",{...cc.defaultProps,loaders:{type:"array",value:[],compare:!0},spacer:{type:"number",value:5,compare:!0},rows:{type:"number",value:0,compare:!0},columns:{type:"number",value:0,compare:!0},concurrency:{type:"number",value:10,compare:!1},text:{type:"boolean",value:!1,compare:!0},onClick:{type:"function",value:null,compare:!0},onHover:{type:"function",value:null,compare:!0}});class mR extends W1{constructor(e){super(e)}}E(mR,"layerName","VizarMultiscaleImageLayer");class vR extends Nf{constructor(e){super(e)}}E(vR,"layerName","VizarrImageLayer");const bv=Vn(null),yR=Vn(null),_R=Vn(null),f_=Vn([]),HK=Vn(null,async(n,e,t)=>{const{createSourceData:r}=await Fr(async()=>{const{createSourceData:i}=await Promise.resolve().then(()=>JX);return{createSourceData:i}},void 0,import.meta.url),s=Math.random().toString(36).slice(2);try{const i=await r(t),o=n(f_);i.name||(i.name=`image_${Object.keys(o).length}`),e(f_,[...o,{id:s,...i}])}catch(i){c4(i,Error),i instanceof a4?e(_R,{message:i.message,url:i.url}):e(yR,i.message)}}),xR=w8(f_),bR=Y_(n=>Vn({...qC(n),id:n.id}),(n,e)=>n.id===e.id),XK={image:vR,multiscale:mR,grid:c_},YK=Y_(n=>Vn(e=>{const{on:t,layerProps:r,kind:s}=e(n);if(!t)return null;const i=XK[s];return new i(r)})),qK=Y_(n=>Vn(e=>{const{on:t,labels:r,layerProps:s}=e(n);return!t||!r?[]:r.map(i=>i.on?new XC({...i.layerProps,selection:i.transformSourceSelection(s.selections[0])}):null)})),KK=Vn(n=>{const e=[];for(const t of n(xR)){const r=bR(n(t));e.push(YK(r)),e.push(qK(r))}return n(E8(e)).flat()});function ZK(){const[n]=Ts(),{acquisitionId:e,acquisitions:t}=n;if(!t)return null;const r=s=>{let i=s.target.value;const o=new URL(window.location.href);i==="-1"?o.searchParams.delete("acquisition"):o.searchParams.set("acquisition",i),window.location.href=decodeURIComponent(o.href)};return ae.jsx(ae.Fragment,{children:ae.jsx(kt,{children:ae.jsxs(R_,{fullWidth:!0,style:{fontSize:"0.7em"},onChange:r,value:e,children:[ae.jsx("option",{value:"-1",children:"Filter by Acquisition"},"-1"),t.map(s=>(s=s,ae.jsxs("option",{value:s.id,children:["Acquisition: ",s.name]},s.id)))]})})})}function QK(){const[n,e]=Ts(),[t,r]=Si(),[s,i]=B.useState(null),o=m=>{i(m.currentTarget)},a=()=>{i(null)},u=async m=>{a();const v=+m.target.value,x=[...n.defaults.selection];n.channel_axis&&(x[n.channel_axis]=v);let b;if(n.contrast_limits[v])b=n.contrast_limits[v];else{const w=f4(t.layerProps),S=Array.isArray(w)?w[w.length-1]:w;b=await X_(S,x),e(R=>{const C=[...R.contrast_limits];return C[v]=b,{...R,contrast_limits:C}})}r(w=>{const{layerProps:S}=w,R=[...S.selections,x],C=[...S.colors,H_(n.colors[v])],O=[...S.contrastLimitsRange,b],I=[...S.channelsVisible,!0];return{...w,layerProps:{...S,selections:R,colors:C,contrastLimits:O,contrastLimitsRange:[...O],channelsVisible:I}}})},{names:f}=n,d=!!s,p=d?`layer-${n.id}-add-channel`:void 0;return ae.jsxs(ae.Fragment,{children:[ae.jsx(Hs,{onClick:o,"aria-describedby":p,style:{backgroundColor:"transparent",padding:0,zIndex:2,cursor:"pointer"},disabled:t.layerProps.selections.length===pa,children:ae.jsx(EE,{})}),ae.jsx(C_,{id:p,open:d,anchorEl:s,onClose:a,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:ae.jsxs(mf,{style:{padding:"0px 4px",marginBottom:4,width:"8em"},children:[ae.jsx(ar,{variant:"caption",children:"selection: "}),ae.jsx(Dr,{}),ae.jsxs(R_,{fullWidth:!0,style:{fontSize:"0.7em"},id:`layer-${n.id}-channel-select`,onChange:u,children:[ae.jsx("option",{"aria-label":"None",value:"",children:"None"}),f.map((m,v)=>ae.jsx("option",{value:v,children:m},m))]})]})})]})}const GK=Po({root:{width:"5.5em",fontSize:"0.7em"}})(A_);function JK({axisIndex:n,max:e}){const[t]=Ts(),[r,s]=Si(),[i,o]=B.useState(null),a=v=>{o(v.currentTarget)},u=()=>{o(null)},f=v=>{let x=+v.target.value;x<0&&(x=0),x>e&&(x=e),s(b=>{let w={...b.layerProps};return w.selections=w.selections.map(S=>{let R=[...S];return R[n]=x,R}),{...b,layerProps:w}})},d=!!i,p=d?`${n}-index-${t.id}-options`:void 0,m=r.layerProps.selections[0]?r.layerProps.selections[0][n]:1;return ae.jsxs(ae.Fragment,{children:[ae.jsx(Hs,{onClick:a,"aria-describedby":p,style:{backgroundColor:"transparent",padding:0,zIndex:2,cursor:"pointer"},children:ae.jsx(AE,{})}),ae.jsx(C_,{id:p,open:d,anchorEl:i,onClose:u,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:ae.jsxs(mf,{style:{padding:"0px 4px",marginBottom:4},children:[ae.jsx(ar,{variant:"caption",children:"Index:"}),ae.jsx(Dr,{}),ae.jsx(GK,{value:m,onChange:f,type:"number",id:"max",fullWidth:!1}),ae.jsx(Dr,{})]})})]})}const eZ=Po({root:{color:"white",padding:"10px 0px 5px 0px",marginRight:"5px"},active:{boxshadow:"0px 0px 0px 8px rgba(158, 158, 158, 0.16)"}})(Qp);function tZ({axisIndex:n,max:e}){const[t,r]=Si(),[s]=Ts(),{axis_labels:i}=s;let o=i[n];(o==="t"||o==="z")&&(o=o.toUpperCase());const[a,u]=B.useState(0);B.useEffect(()=>{u(t.layerProps.selections[0]?t.layerProps.selections[0][n]:1)},[t.layerProps.selections,n]);const f=()=>{r(p=>{let m={...p.layerProps};return m.selections=m.selections.map(v=>{let x=[...v];return x[n]=a,x}),{...p,layerProps:m}})},d=(p,m)=>{u(m)};return ae.jsxs(ae.Fragment,{children:[ae.jsxs(kt,{children:[ae.jsxs(kt,{container:!0,justifyContent:"space-between",children:[ae.jsx(kt,{item:!0,xs:10,children:ae.jsx("div",{style:{width:165,overflow:"hidden",textOverflow:"ellipsis"},children:ae.jsxs(ar,{variant:"caption",noWrap:!0,children:[o,": ",a,"/",e]})})}),ae.jsx(kt,{item:!0,xs:1,children:ae.jsx(JK,{axisIndex:n,max:e})})]}),ae.jsx(kt,{container:!0,justifyContent:"space-between",children:ae.jsx(kt,{item:!0,xs:12,children:ae.jsx(eZ,{value:a,onChange:d,onChangeCommitted:f,min:0,max:e,step:1})})})]}),ae.jsx(Dr,{})]})}function nZ(){const[n]=Ts(),{axis_labels:e,channel_axis:t,loader:r}=n,s=e.slice(0,-2).map((i,o)=>[i,o,r[0].shape[o]]).filter(i=>i[1]===t?!1:i[2]>1).map(([i,o,a])=>ae.jsx(tZ,{axisIndex:o,max:a-1},i));return s.length===0?null:ae.jsxs(ae.Fragment,{children:[ae.jsx(kt,{children:s}),ae.jsx(Dr,{})]})}const rZ=Kp(()=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"2px"},button:{padding:"3px",width:"16px",height:"16px"}})),sZ=Object.entries(js).map(([n,e])=>[n,H_(e)]);function iZ({handleChange:n}){const e=rZ();return ae.jsx("div",{className:e.container,"aria-label":"color-swatch",children:sZ.map(([t,r])=>ae.jsx(Hs,{className:e.button,onClick:()=>n(r),children:ae.jsx(O5,{fontSize:"small",style:{color:`rgb(${r})`}})},t))})}const IS=Po({root:{width:"5.5em",fontSize:"0.7em"}})(A_);function oZ({channelIndex:n}){const[e]=Ts(),[t,r]=Si(),[s,i]=B.useState(null),{channel_axis:o,names:a}=e,u=R=>{i(R.currentTarget)},f=()=>{i(null)},d=R=>{r(C=>{const O=[...C.layerProps.colors];return O[n]=R,{...C,layerProps:{...C.layerProps,colors:O}}})},p=R=>{const C=R.target.id;let O=+R.target.value;O<0&&(O=0),r(I=>{const F=[...I.layerProps.contrastLimitsRange],$=[...I.layerProps.contrastLimits],[q,K]=F[n],[le,he]=$[n],[pe,se]=C==="min"?[O,K]:[q,O];return pe>le&&($[n]=[pe,he]),se<he&&($[n]=[le,se]),F[n]=[pe,se],{...I,layerProps:{...I.layerProps,contrastLimits:$,contrastLimitsRange:F}}})},m=()=>{r(R=>{const{layerProps:C}=R,O=[...C.colors],I=[...C.contrastLimits],F=[...C.contrastLimitsRange],$=[...C.selections],q=[...C.channelsVisible];return O.splice(n,1),I.splice(n,1),F.splice(n,1),$.splice(n,1),q.splice(n,1),{...R,layerProps:{...C,colors:O,selections:$,channelsVisible:q,contrastLimits:I,contrastLimitsRange:F}}})},v=R=>{r(C=>{const O=[...C.layerProps.selections],I=[...O[n]];return Number.isInteger(o)&&(I[o]=+R.target.value,O[n]=I),{...C,layerProps:{...C.layerProps,selections:O}}})},x=!!s,b=x?`channel-${n}-${e.name}-options`:void 0,[w,S]=t.layerProps.contrastLimitsRange[n];return ae.jsxs(ae.Fragment,{children:[ae.jsx(Hs,{onClick:u,"aria-describedby":b,style:{backgroundColor:"transparent",padding:0,zIndex:2,cursor:"pointer"},children:ae.jsx(AE,{})}),ae.jsx(C_,{id:b,open:x,anchorEl:s,onClose:f,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:ae.jsxs(mf,{style:{padding:"0px 4px",marginBottom:4},children:[ae.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ae.jsx(ar,{variant:"caption",children:"remove:"}),ae.jsx(Hs,{onClick:m,children:ae.jsx(PE,{})})]}),ae.jsx(Dr,{}),ae.jsx(ar,{variant:"caption",children:"selection:"}),ae.jsx(Dr,{}),ae.jsx(R_,{fullWidth:!0,style:{fontSize:"0.7em"},id:`layer-${e.name}-channel-select`,onChange:v,value:t.layerProps.selections[n][o],children:a.map((R,C)=>ae.jsxs("option",{value:C,children:["(",C,") ",R]},R))}),ae.jsx(Dr,{}),ae.jsx(ar,{variant:"caption",children:"contrast limits:"}),ae.jsx(Dr,{}),ae.jsx(IS,{value:w,onChange:p,type:"number",id:"min",fullWidth:!1}),ae.jsx(IS,{value:S,onChange:p,type:"number",id:"max",fullWidth:!1}),ae.jsx(Dr,{}),ae.jsx(ar,{variant:"caption",children:"color:"}),ae.jsx(Dr,{}),ae.jsx("div",{style:{display:"flex",justifyContent:"center"},children:ae.jsx(iZ,{handleChange:d})})]})})]})}function aZ({channelIndex:n}){const[e]=Ts(),[t,r]=Si(),s=(S,R)=>{r(C=>{const O=[...C.layerProps.contrastLimits];return O[n]=R,{...C,layerProps:{...C.layerProps,contrastLimits:O}}})},i=()=>{r(S=>{const R=[...S.layerProps.channelsVisible];return R[n]=!R[n],{...S,layerProps:{...S.layerProps,channelsVisible:R}}})},o=t.layerProps,a=[...o.contrastLimits[n]],u=`rgb(${o.colormap?[255,255,255]:o.colors[n]})`,f=o.channelsVisible[n],[d,p]=o.contrastLimitsRange[n],{channel_axis:m,names:v}=e,x=o.selections[n],b=Number.isInteger(m)?x[m]:0,w=v[b];return ae.jsxs(ae.Fragment,{children:[ae.jsxs(kt,{container:!0,justifyContent:"space-between",wrap:"nowrap",children:[ae.jsx(kt,{item:!0,xs:10,children:ae.jsx("div",{style:{width:165,overflow:"hidden",textOverflow:"ellipsis"},children:ae.jsx(ar,{variant:"caption",noWrap:!0,children:w})})}),ae.jsx(kt,{item:!0,xs:1,children:ae.jsx(oZ,{channelIndex:n})})]}),ae.jsxs(kt,{container:!0,justifyContent:"space-between",children:[ae.jsx(kt,{item:!0,xs:2,children:ae.jsx(Hs,{style:{color:u,backgroundColor:"transparent",padding:0,zIndex:2},onClick:i,children:f?ae.jsx(CE,{}):ae.jsx(RE,{})})}),ae.jsx(kt,{item:!0,xs:10,children:ae.jsx(Qp,{value:a,onChange:s,min:d,max:p,step:.01,style:{padding:"10px 0px 5px 0px",color:u}})})]})]})}function lZ({labelIndex:n}){const[e]=Ts(),[t,r]=Si();St(e.labels&&t.kind==="multiscale"&&t.labels,"Missing image labels");const s=(a,u)=>{r(f=>(St(f.kind==="multiscale"&&f.labels,"Missing image labels"),{...f,labels:f.labels.with(n,{...f.labels[n],layerProps:{...f.labels[n].layerProps,opacity:u}})}))},{name:i}=e.labels[n],o=t.labels[n];return ae.jsxs(ae.Fragment,{children:[ae.jsx(kt,{container:!0,justifyContent:"space-between",wrap:"nowrap",children:ae.jsx("div",{style:{width:165,overflow:"hidden",textOverflow:"ellipsis"},children:ae.jsx(ar,{variant:"caption",noWrap:!0,children:i})})}),ae.jsxs(kt,{container:!0,justifyContent:"space-between",children:[ae.jsx(kt,{item:!0,xs:2,children:ae.jsx(Hs,{style:{backgroundColor:"transparent",padding:0,zIndex:2},onClick:()=>{r(a=>(St(a.kind==="multiscale"&&a.labels,"Missing image labels"),{...a,labels:a.labels.with(n,{...a.labels[n],on:!a.labels[n].on})}))},children:o.on?ae.jsx(CE,{}):ae.jsx(RE,{})})}),ae.jsx(kt,{item:!0,xs:10,children:ae.jsx(Qp,{value:o.layerProps.opacity,onChange:s,min:0,max:1,step:.01,style:{padding:"10px 0px 5px 0px"}})})]})]})}const cZ=Po({root:{color:"white",padding:"10px 0px 5px 0px",marginRight:"5px"},active:{boxshadow:"0px 0px 0px 8px rgba(158, 158, 158, 0.16)"}})(Qp);function uZ(){const[n,e]=Si(),t=(r,s)=>{const i=s;e(o=>({...o,layerProps:{...o.layerProps,opacity:i}}))};return ae.jsx(cZ,{value:n.layerProps.opacity,onChange:t,min:0,max:1,step:.01})}const fZ=Po({root:{padding:"2px 5px",borderLeft:"1px solid rgba(150, 150, 150, .2)",borderRight:"1px solid rgba(150, 150, 150, .2)"}})(aM);function dZ(){var t;const[n]=Si(),e=n.layerProps.selections.length;return ae.jsx(fZ,{children:ae.jsxs(kt,{container:!0,direction:"column",children:[ae.jsx(ZK,{}),ae.jsx(kt,{children:ae.jsxs(kt,{container:!0,justifyContent:"space-between",children:[ae.jsx(kt,{item:!0,xs:3,children:ae.jsx(ar,{variant:"caption",children:"opacity:"})}),ae.jsx(kt,{item:!0,xs:8,children:ae.jsx(uZ,{})})]})}),ae.jsx(nZ,{}),ae.jsxs(kt,{container:!0,justifyContent:"space-between",children:[ae.jsx(kt,{item:!0,xs:3,children:ae.jsx(ar,{variant:"caption",children:"channels:"})}),ae.jsx(kt,{item:!0,xs:1,children:ae.jsx(QK,{})})]}),ae.jsx(Dr,{}),ae.jsx(kt,{children:ju(e).map(r=>ae.jsx(aZ,{channelIndex:r},r))}),((t=n.labels)==null?void 0:t.length)&&ae.jsxs(ae.Fragment,{children:[ae.jsx(kt,{container:!0,justifyContent:"space-between",children:ae.jsx(ar,{variant:"caption",children:"labels:"})}),ae.jsx(Dr,{}),ae.jsx(kt,{children:n.labels.map((r,s)=>ae.jsx(lZ,{labelIndex:s},r.layerProps.id))})]})]})})}function hZ(){const[n]=Ts(),[e,t]=Si(),r=s=>{s.stopPropagation(),t(i=>{const o=!i.on;return{...i,on:o}})};return ae.jsx(Hs,{"aria-label":`toggle-layer-visibility-${n.id}`,onClick:r,style:{backgroundColor:"transparent",marginTop:"2px",color:`rgb(255, 255, 255, ${e.on?1:.5})`},children:e.on?ae.jsx(N5,{}):ae.jsx(D5,{})})}const pZ=Po({root:{borderBottom:"1px solid rgba(150, 150, 150, .125)",backgroundColor:"rgba(150, 150, 150, 0.25)",display:"block",padding:"0 3px",height:27,minHeight:27,overflow:"hidden",transition:"none","&$expanded":{minHeight:27}},content:{margin:0,"&$expanded":{margin:0}},expanded:{}})(xM);function gZ({name:n}){const[e]=Ts(),t=`layer-controller-${e.id}`;return ae.jsx(pZ,{"aria-controls":t,id:t,children:ae.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[ae.jsx(hZ,{}),ae.jsx(ar,{style:{marginTop:"4px",marginLeft:"5px"},variant:"body2",children:n})]})})}const mZ=Po({root:{borderBottom:"1px solid rgba(150, 150, 150, .2)",width:200,boxshadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:0,padding:0}},expanded:{padding:1}})(sM);function vZ(){const[n]=Ts(),e=bR(n);return ae.jsx(p4.Provider,{value:e,children:ae.jsxs(mZ,{defaultExpanded:!0,children:[ae.jsx(gZ,{name:n.name??""}),ae.jsx(dZ,{})]})})}const yZ=Kp({root:{zIndex:1,position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.7)",borderRadius:"5px",left:"5px",top:"5px"},scroll:{maxHeight:500,overflowX:"hidden",overflowY:"scroll","&::-webkit-scrollbar":{display:"none",background:"transparent"},scrollbarWidth:"none",flexDirection:"column"}});function _Z(n){const e=Vu(xR),[t,r]=B.useReducer(i=>!i,!(n.open??!0)),s=yZ();return ae.jsx("div",{className:s.root,style:{padding:`0px 5px ${t?0:5}px 5px`},children:ae.jsxs(kt,{container:!0,direction:"column",alignItems:"flex-start",children:[ae.jsx(Hs,{style:{backgroundColor:"transparent",padding:0},onClick:r,children:t?ae.jsx(EE,{}):ae.jsx(PE,{})}),ae.jsx("div",{className:s.scroll,style:{display:t?"none":"flex"},children:e.map(i=>ae.jsx(h4.Provider,{value:i,children:ae.jsx(vZ,{})},`${i}`))})]})})}function xZ(){var o;const n=B.useRef(null),[e,t]=v8(),r=Vu(KK),s=r[0];if((o=n.current)!=null&&o.deck&&!e&&s){const{deck:a}=n.current;t(a8({image:bZ(s),viewport:a,padding:a.width<400?10:a.width<600?30:50,matrix:s.props.modelMatrix}))}const i={preserveDrawingBuffer:!0};return ae.jsx(WX,{ref:n,layers:r,viewState:e&&{ortho:e},onViewStateChange:a=>t(a.viewState),views:[new A1({id:"ortho",controller:!0})],glOptions:i})}function bZ({props:n}){const e=f4(n),[t,r]=Array.isArray(e)?[e[0],e.length]:[e,0],s=i4(t.shape);let[i,o]=t.shape.slice(s?-3:-2);return u4(n)&&(i=(i+5)*n.rows,o=(o+5)*n.columns),{height:i,width:o,maxZoom:r}}GE.set("jpeg2k",()=>Fr(()=>import("./jpeg2k-HwDsNbN8.js"),[],import.meta.url).then(n=>n.default));var au={},kS;function wZ(){if(kS)return au;kS=1,Object.defineProperty(au,"__esModule",{value:!0}),au.default=void 0;var n={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#d5d5d5",A200:"#aaaaaa",A400:"#303030",A700:"#616161"},e=n;return au.default=e,au}var TZ=wZ();const MS=ka(TZ),SZ=HS({palette:{type:"dark",primary:MS,secondary:MS},props:{MuiButton:{size:"small"},MuiButtonBase:{disableRipple:!0},MuiFilledInput:{margin:"dense"},MuiFormControl:{margin:"dense"},MuiFormHelperText:{margin:"dense"},MuiIconButton:{size:"small"},MuiInputBase:{margin:"dense"},MuiInputLabel:{margin:"dense"},MuiOutlinedInput:{margin:"dense"}},overrides:{MuiSlider:{thumb:{"&:focus, &:hover":{boxShadow:"none"},height:11,width:5,borderRadius:"15%",marginLeft:-1}},MuiInput:{underline:{"&&&&:hover:before":{borderBottom:"1px solid #fff"}}},MuiPaper:{root:{backgroundColor:"rgba(0, 0, 0, 0.8)"}},MuiSvgIcon:{root:{width:"0.7em",height:"0.7em"}}}}),VZ="0.3.0",EZ=Kp({errorContainer:{position:"fixed",top:0,bottom:0,left:0,right:0,color:"#fff",display:"flex",alignItems:"center",textAlign:"center",justifyContent:"center",fontSize:"120%"}});function zZ(n,e={}){const t=B.createRef(),r=u8(),s=Vn(f=>f(bv),(f,d,p)=>{const m=typeof p=="function"?p(f(bv)):p;m&&r.emit("viewStateChange",{target:m.target,zoom:m.zoom}),d(bv,p)}),{promise:i,resolve:o}=c8();function a(){const f=Vu(yR),d=Vu(_R),p=Xv(HK),m=Xv(s);B.useImperativeHandle(t,()=>({addImage:p,setViewState:m,on:r.on.bind(r),destroy:()=>u.unmount()}),[m,p]),B.useEffect(()=>{t.current&&o(t.current)},[]);const v=EZ();return ae.jsxs(ae.Fragment,{children:[f===null&&d===null&&ae.jsxs(ay.Provider,{value:s,children:[ae.jsx(_Z,{open:e.menuOpen??!0}),ae.jsx(xZ,{})]}),f!==null&&ae.jsx("div",{className:v.errorContainer,children:ae.jsx("p",{children:`Error: server replied with "${f}" when loading the resource`})}),d!==null&&ae.jsx("div",{className:v.errorContainer,children:ae.jsxs(ar,{variant:"h5",children:[d.message,ae.jsxs(i5,{href:d.url,children:[" ",d.url," "]})]})})]})}let u=M5.createRoot(n);return u.render(ae.jsx(kk,{theme:SZ,children:ae.jsx(P5,{children:ae.jsx(ay.Provider,{value:s,children:ae.jsx(a,{})})})})),i}export{Rq as BaseDecoder,FZ as LercAddCompression,LZ as LercParameters,zZ as createViewer,e4 as fetch_range,ka as getDefaultExportFromCjs,qN as merge_init,RZ as strip_prefix,PZ as uri2href,VZ as version};
//# sourceMappingURL=vizarr-qhGIIUrm.js.map
